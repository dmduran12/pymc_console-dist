import{c as e,aA as t,ck as a,cl as s,I as i,cm as n,K as c,m as r,cn as l,av as o}from"./index-C4aif3MV.js";import{r as d,j as m,c as x}from"./vendor-react-54o2BuWt.js";import{C as p}from"./DataBox-BGMFZ3VD.js";import{G as h}from"./git-branch-CkJHr8ko.js";import{D as g}from"./house-CP2xz7WS.js";import{L as y}from"./loader-circle-CvQ-wfqF.js";const j=e("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),u=e("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),f=e("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]),v=e("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]]);function b({label:e,icon:t,status:a,detail:s}){return m.jsxs("div",{className:x("flex items-center gap-3 py-3 px-4 radius-inset transition-base","active"===a&&"bg-accent-primary/10","complete"===a&&"bg-accent-primary/10 ring-2 ring-inset ring-accent-primary","pending"===a&&"opacity-40"),children:[m.jsx("div",{className:x("w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 transition-all duration-300","active"===a&&"bg-accent-primary/20","complete"===a&&"bg-accent-primary/20","pending"===a&&"bg-subtle-fill"),children:"complete"===a?m.jsx(p,{className:"w-4 h-4 text-accent-primary"}):"active"===a?m.jsx(y,{className:"w-4 h-4 animate-spin text-accent-primary"}):m.jsx("span",{className:"text-text-muted",children:t})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("div",{className:x("text-sm font-medium transition-colors","active"===a&&"text-accent-primary","complete"===a&&"text-accent-primary","pending"===a&&"text-text-muted"),children:e}),s&&"pending"!==a&&m.jsx("div",{className:"text-xs text-text-muted mt-0.5 truncate",children:s})]})]})}const k=d.memo(function({isOpen:e,onClose:x}){const{packetCacheState:y,triggerDeepAnalysis:u}=t(),f=a(),v=s(),k=y.packetCount,[N,w]=d.useState("fetching");d.useEffect(()=>{e&&u()},[e,u]),d.useEffect(()=>{if(e)if(y.isTopologyLoading)w("fetching");else if(f)w("analyzing"),setTimeout(()=>w("building"),500),setTimeout(()=>w("discovering"),1e3);else if(v>0&&!y.isTopologyLoading){w("complete");const e=setTimeout(()=>{x()},1500);return()=>clearTimeout(e)}},[e,y.isTopologyLoading,f,v,x]);const M="complete"===N,T=y.loadProgress,z=d.useMemo(()=>T&&T.target>0?`Loading... ${(T.loaded/1e3).toFixed(1)}k / ${(T.target/1e3).toFixed(1)}k packets (${T.percent}%)`:k>0?`${k.toLocaleString()} packets loaded`:"Connecting to database...",[T,k]),C=e=>{const t=["fetching","analyzing","building","discovering","complete"],a=t.indexOf(N),s=t.indexOf(e);return s<a?"complete":s===a?"active":"pending"},D=M?x:()=>{};return m.jsx(i,{open:e,onClose:D,size:"sm",bottomSheet:!1,children:m.jsx(n,{isLoading:!M,borderRadius:16,children:m.jsx(c,{className:"p-6 radius-card overflow-hidden",children:M?m.jsxs("div",{className:"flex flex-col items-center py-6",children:[m.jsx(r.div,{variants:l,initial:"hidden",animate:"visible",className:"w-16 h-16 rounded-full flex items-center justify-center mb-4 bg-accent-primary/20",children:m.jsx(p,{className:"w-8 h-8 text-accent-primary"})}),m.jsx("h3",{className:"text-lg font-semibold text-accent-primary",children:"Ready!"})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[m.jsx("div",{className:"w-10 h-10 radius-inset flex items-center justify-center bg-accent-primary/15",children:m.jsx(h,{className:"w-5 h-5 text-accent-primary"})}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-base font-semibold text-text-primary",children:"Deep Analysis"}),m.jsx("p",{className:"text-xs text-text-muted",children:"Building mesh topology"})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(b,{label:"Fetching Packets",icon:m.jsx(j,{className:"w-4 h-4"}),status:C("fetching"),detail:z}),m.jsx(b,{label:"Analyzing Database",icon:m.jsx(g,{className:"w-4 h-4"}),status:C("analyzing"),detail:"Processing packet paths"}),m.jsx(b,{label:"Building Topology",icon:m.jsx(h,{className:"w-4 h-4"}),status:C("building"),detail:"Computing mesh edges"}),m.jsx(b,{label:"Discovering Nodes",icon:m.jsx(o,{className:"w-4 h-4"}),status:C("discovering"),detail:"Viterbi HMM ghost detection"})]}),m.jsx("p",{className:"text-xs text-text-muted text-center mt-5",children:"This may take a few seconds..."})]})})})})});export{k as D,u as E,v as M,f as a,j as b};
