import{r as e,j as t,f as s,i as a,X as r,a5 as n,ab as l,aX as c,aY as i,k as d,p as o,aZ as u,ag as x,a_ as m,a$ as p,b0 as h,aP as b,av as y,b1 as g,ak as f,b2 as j,a8 as v,a2 as N,$ as w,aa as k,b3 as C}from"./vendor-react-CVaYKp51.js";import{c as _}from"./recharts-ccH8-7Db.js";import{_ as S,al as T,am as F,N as E,an as P,ao as L,ap as R,aq as A,ak as M,ar as I,as as D,at as z,au as K,av as q,aw as H,ax as O,ay as $,az as Y}from"./index-D7mmFuyN.js";import{H as V}from"./HashBadge-D1AhNxni.js";import{C as X}from"./ConfirmModal-B0fvKmXF.js";import{P as B,b as U,a as G,c as W}from"./PageLayout-C47bL7PI.js";import{R as Z,C as J}from"./Grid-CoebUagJ.js";import"./vendor-core-WoOfkQwm.js";import"./deckgl-DTsmDcfs.js";const Q=e.memo(function(){const{theme:e}=S(),{colorScheme:s}=e,a=T.find(e=>e.colorScheme===s)??T[0],r=a.displaySize,n=`clamp(${.8*r}rem, ${.6*r}rem + 1.5vw, ${1.4*r}rem)`;return t.jsx("div",{className:"w-32 sm:w-40 flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"font-medium transition-all duration-300 leading-none text-center truncate",style:{fontFamily:a.displayFont,color:a.displayColor,fontSize:n,fontOpticalSizing:"auto",letterSpacing:"-0.03em"},children:a.displayName})})}),ee=e.memo(function(){const{theme:s,setThemePreset:a,setBrightness:r}=S(),{colorScheme:n,brightness:l}=s,[c,i]=e.useState(!1),[d,o]=e.useState(!1),u=e.useRef(null),x=e.useRef(null),m=(T.find(e=>e.colorScheme===n)??T[0]).id,p=e.useCallback((e,t)=>{if(!x.current)return l;const s=(x.current.y-e)/(t?200:80)*100;return Math.round(Math.max(0,Math.min(100,x.current.brightness+s)))},[l]),h=e.useCallback(e=>{a(e),i(!0)},[a]),b=e.useCallback(e=>{r(e)},[r]),y=e.useCallback(e=>{const t=T.find(t=>t.id===e);t&&F(t.backgroundImage)},[]);return t.jsx("div",{className:"grid grid-cols-4 gap-2 flex-shrink-0",children:T.map(e=>{const s=m===e.id,a=s&&(c||d);return t.jsxs("div",{ref:s?u:void 0,title:e.displayName,className:_("flex flex-col items-center gap-1 p-0.5 rounded-sm transition-all duration-300 ease-out",s?"ring-2 ring-accent-primary scale-105 cursor-ns-resize":"cursor-pointer"),onMouseEnter:()=>{s?i(!0):y(e.id)},onMouseLeave:()=>!d&&i(!1),onClick:()=>!s&&h(e.id),onTouchStart:e=>{if(!s)return;e.preventDefault();const t=e.touches[0];x.current={y:t.clientY,brightness:l},o(!0),i(!0);const a=e=>{e.preventDefault();const t=e.touches[0];b(p(t.clientY,!0))},r=()=>{document.removeEventListener("touchmove",a),document.removeEventListener("touchend",r),x.current=null,o(!1),setTimeout(()=>i(!1),1500)};document.addEventListener("touchmove",a,{passive:!1}),document.addEventListener("touchend",r)},onMouseDown:e=>{if(!s)return;e.preventDefault(),x.current={y:e.clientY,brightness:l},o(!0),i(!0);const t=e=>{b(p(e.clientY,!1))},a=()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",a),x.current=null,o(!1)};document.addEventListener("mousemove",t),document.addEventListener("mouseup",a)},children:[t.jsxs("div",{className:"glass-thumbnail w-10 h-10",children:["kde breeze"===e.id?t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#242627]",style:{opacity:a?.4:1},children:t.jsx("span",{className:"text-[#58b99d] text-xl font-bold font-mono",children:">"})}):t.jsx("div",{className:"absolute bg-cover bg-center transition-opacity duration-200",style:{inset:0,backgroundImage:`url(${e.backgroundImage})`,opacity:a?.4:1,filter:"brightness(1.3)"}}),s&&t.jsxs("div",{className:_("absolute inset-0 transition-opacity duration-200",a?"opacity-100":"opacity-0"),children:[t.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 transition-all duration-100 ease-out",style:{height:100-l+"%"}}),t.jsx("div",{className:"absolute inset-x-1 h-0.5 bg-white rounded-full shadow-lg transition-all duration-100 ease-out",style:{top:100-l+"%"}}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsxs("span",{className:"text-[10px] font-mono font-bold text-white drop-shadow-lg",children:[l,"%"]})})]})]}),t.jsx("div",{className:"flex flex-col gap-0.5",children:e.paletteColors.map((e,s)=>t.jsx("div",{className:"flex gap-0.5 justify-center",children:e.map((e,s)=>t.jsx("div",{className:"w-1.5 h-1.5 rounded-xs",style:{backgroundColor:e}},s))},s))})]},e.id)})})}),te=e.memo(function({layout:e="horizontal"}){return"logo-only"===e?t.jsx(Q,{}):"thumbnails-only"===e?t.jsx(ee,{}):"vertical"===e?t.jsxs("div",{className:"flex flex-col items-center gap-4",children:[t.jsx(Q,{}),t.jsx(ee,{})]}):t.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[t.jsx("div",{className:"flex items-center justify-center",children:t.jsx(Q,{})}),t.jsx("div",{className:"flex-shrink-0",children:t.jsx(ee,{})})]})}),se=[{value:7.8,label:"7.8 kHz"},{value:10.4,label:"10.4 kHz"},{value:15.6,label:"15.6 kHz"},{value:20.8,label:"20.8 kHz"},{value:31.25,label:"31.25 kHz"},{value:41.7,label:"41.7 kHz"},{value:62.5,label:"62.5 kHz"},{value:125,label:"125 kHz"},{value:250,label:"250 kHz"},{value:500,label:"500 kHz"}],ae=[5,6,7,8,9,10,11,12],re=[{value:5,label:"4/5"},{value:6,label:"4/6"},{value:7,label:"4/7"},{value:8,label:"4/8"}],ne="radioConfig",le="repeaterSettings",ce="operatingMode";function ie({node:e,level:s,expandedKeys:a,selectedKeyId:r,globalFloodPolicy:n,onSelect:l,onToggle:c}){const i=a.has(e.id),d=r===e.id,o=e.children&&e.children.length>0,u="allow"===n;return t.jsxs("div",{children:[t.jsxs("div",{className:_("flex items-center gap-2 h-[36px] px-3 rounded-full cursor-pointer transition-colors",d?"bg-accent-primary/15":"hover:bg-white/[0.02]",u&&"opacity-50 cursor-not-allowed"),style:{marginLeft:16*s+"px"},onClick:()=>!u&&l(e.id),children:[o?t.jsx("button",{onClick:t=>{t.stopPropagation(),c(e.id)},className:"p-1 hover:bg-white/[0.05] rounded-full transition-colors",children:t.jsx(k,{className:_("w-3.5 h-3.5 text-text-muted transition-transform",i&&"rotate-90")})}):t.jsx("span",{className:"w-5"}),t.jsx(C,{className:"w-4 h-4 text-accent-primary flex-shrink-0"}),t.jsx("span",{className:"type-data text-text-primary flex-1 truncate",children:e.name}),t.jsx("span",{className:_("type-data-xs px-2 py-0.5 rounded-full","allow"===e.floodPolicy?"bg-accent-success/15 text-accent-success":"bg-accent-danger/15 text-accent-danger"),children:"allow"===e.floodPolicy?"Allow":"Deny"})]}),o&&i&&t.jsx("div",{children:e.children.map(e=>t.jsx(ie,{node:e,level:s+1,expandedKeys:a,selectedKeyId:r,globalFloodPolicy:n,onSelect:l,onToggle:c},e.id))})]})}function de(){var k,C,S,T,F,Q;const{stats:ee,setMode:de,clearModeMutation:oe,setDutyCycleConfig:ue,clearDutyCycleMutation:xe,fetchStats:me,startMutation:pe,clearMutation:he}=E(),be=null==(k=null==ee?void 0:ee.config)?void 0:k.radio,ye=null==(C=null==ee?void 0:ee.config)?void 0:C.repeater,ge=null==(S=null==ee?void 0:ee.config)?void 0:S.duty_cycle,fe=(null==ee?void 0:ee.node_name)||(null==(T=null==ee?void 0:ee.config)?void 0:T.node_name)||"Unknown Node",je=(null==ye?void 0:ye.mode)??"forward",ve=(null==ge?void 0:ge.enforcement_enabled)??!1,Ne=null==(F=null==ee?void 0:ee.config)?void 0:F.delays,[we,ke]=e.useState(!1),[Ce,_e]=e.useState(""),[Se,Te]=e.useState(62.5),[Fe,Ee]=e.useState(7),[Pe,Le]=e.useState(5),[Re,Ae]=e.useState(""),[Me,Ie]=e.useState("idle"),[De,ze]=e.useState(null),Ke=e.useRef(null),qe=e.useRef(null),[He,Oe]=e.useState(!1),[$e,Ye]=e.useState(""),[Ve,Xe]=e.useState(""),[Be,Ue]=e.useState(""),[Ge,We]=e.useState("idle"),Ze=e.useRef(null),Je=e.useRef(null),[Qe,et]=e.useState(!1),[tt,st]=e.useState(""),[at,rt]=e.useState(""),[nt,lt]=e.useState(""),[ct,it]=e.useState(""),[dt,ot]=e.useState("idle"),[ut,xt]=e.useState(null),mt=e.useRef(null),pt=e.useRef(null),[ht,bt]=e.useState("idle"),[yt,gt]=e.useState("idle"),[ft,jt]=e.useState(null),[vt,Nt]=e.useState(null),wt=e.useRef(!0),kt=e.useRef(null),Ct=e.useRef(null),_t=e.useRef(null),St=e.useRef(null),Tt=e.useRef(!1),Ft=e.useRef(!1);e.useEffect(()=>(wt.current=!0,()=>{wt.current=!1,kt.current&&clearTimeout(kt.current),Ct.current&&clearTimeout(Ct.current),_t.current&&clearTimeout(_t.current),St.current&&clearTimeout(St.current),Mt.current&&clearTimeout(Mt.current),It.current&&clearTimeout(It.current),qe.current&&clearTimeout(qe.current),Ze.current&&clearTimeout(Ze.current),pt.current&&clearTimeout(pt.current)}),[]),e.useEffect(()=>{const e=e=>{if(we||Qe||He)return e.preventDefault(),e.returnValue="You have unsaved changes. Are you sure you want to leave?",e.returnValue};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[we,Qe,He]);const Et=null==(Q=null==ee?void 0:ee.config)?void 0:Q.web,[Pt,Lt]=e.useState("idle"),[Rt,At]=e.useState(null),Mt=e.useRef(null),It=e.useRef(null),Dt=e.useRef(!1),[zt,Kt]=e.useState([]),[qt,Ht]=e.useState(!1),[Ot,$t]=e.useState(null),[Yt,Vt]=e.useState(!1),[Xt,Bt]=e.useState(""),[Ut,Gt]=e.useState(null),[Wt,Zt]=e.useState(!1),[Jt,Qt]=e.useState(null),[es,ts]=e.useState(!1),[ss,as]=e.useState(!1),[rs,ns]=e.useState(!1),[ls,cs]=e.useState([]),[is,ds]=e.useState(!1),[os,us]=e.useState(null),[xs,ms]=e.useState("deny"),[ps,hs]=e.useState(!1),[bs,ys]=e.useState(null),[gs,fs]=e.useState(new Set),[js,vs]=e.useState(!1),[Ns,ws]=e.useState(!1),[ks,Cs]=e.useState(!1),[_s,Ss]=e.useState(null),[Ts,Fs]=e.useState(null),[Es,Ps]=e.useState(""),[Ls,Rs]=e.useState("deny"),[As,Ms]=e.useState(!1),[Is,Ds]=e.useState(!0),[zs,Ks]=e.useState(!1),[qs,Hs]=e.useState(!0),[Os,$s]=e.useState("idle"),[Ys,Vs]=e.useState(!1),[Xs,Bs]=e.useState(!1),Us=e.useRef(!1);e.useEffect(()=>{const e=we&&!Us.current;Us.current=we,be&&e&&(_e((be.frequency/1e6).toFixed(3)),Te(be.bandwidth/1e3),Ee(be.spreading_factor),Le(be.coding_rate),Ae(String(be.tx_power)))},[be,we]);const Gs=e.useMemo(()=>{if(!be||!we)return!1;const e=be.frequency/1e6,t=be.bandwidth/1e3,s=parseFloat(Ce)||0;return Math.abs(s-e)>1e-4||Se!==t||Fe!==be.spreading_factor||Pe!==be.coding_rate||parseInt(Re)!==be.tx_power},[be,we,Ce,Se,Fe,Pe,Re]),Ws=e.useCallback(()=>{ke(!1),ze(null),be&&(_e((be.frequency/1e6).toFixed(3)),Te(be.bandwidth/1e3),Ee(be.spreading_factor),Le(be.coding_rate),Ae(String(be.tx_power)))},[be]);e.useEffect(()=>{if(!we)return;const e=e=>{"loading"!==Me&&Ke.current&&!Ke.current.contains(e.target)&&Ws()};return document.addEventListener("mouseup",e),()=>{document.removeEventListener("mouseup",e)}},[we,Ws,Me]);const Zs=e.useCallback(()=>{const e=null==Ne?void 0:Ne.tx_delay_factor;return e&&"object"==typeof e&&"parsedValue"in e?e.parsedValue??1:"number"==typeof e?e:1},[Ne]),Js=e.useCallback(()=>{const e=null==Ne?void 0:Ne.direct_tx_delay_factor;return"number"==typeof e?e:.5},[Ne]),Qs=e.useCallback(()=>{const e=null==ge?void 0:ge.max_airtime_percent;return"number"==typeof e?e:e&&"object"==typeof e&&"parsedValue"in e?e.parsedValue??6:6},[ge]),ea=e.useCallback(()=>{Ye(Zs().toFixed(2)),Xe(Js().toFixed(2)),Ue(Qs().toFixed(1)),Oe(!0)},[Zs,Js,Qs]),ta=e.useCallback(()=>{Oe(!1)},[]);e.useEffect(()=>{if(!He)return;const e=e=>{"loading"!==Ge&&Je.current&&!Je.current.contains(e.target)&&ta()};return document.addEventListener("mouseup",e),()=>document.removeEventListener("mouseup",e)},[He,ta,Ge]);const sa=e.useCallback(()=>{var e,t,s;st(fe),rt((null==(e=null==ye?void 0:ye.latitude)?void 0:e.toString())||"0"),lt((null==(t=null==ye?void 0:ye.longitude)?void 0:t.toString())||"0"),it((null==(s=null==ye?void 0:ye.send_advert_interval_hours)?void 0:s.toString())||"0"),xt(null),et(!0)},[fe,ye]),aa=e.useCallback(()=>{et(!1),xt(null)},[]);e.useEffect(()=>{if(!Qe)return;const e=e=>{"loading"!==dt&&mt.current&&!mt.current.contains(e.target)&&aa()};return document.addEventListener("mouseup",e),()=>document.removeEventListener("mouseup",e)},[Qe,aa,dt]);const ra=async()=>{var e;if("loading"===Pt)return;const t=(null==Et?void 0:Et.cors_enabled)??!1,s=!t,a=t;Mt.current&&clearTimeout(Mt.current),It.current&&clearTimeout(It.current),Dt.current=!1,At(s),Lt("loading"),Mt.current=setTimeout(()=>{Dt.current||wt.current&&(At(a),Lt("error"),It.current=setTimeout(()=>{wt.current&&(Lt("idle"),At(null))},2e3))},1e4);try{const t=await I({web:{cors_enabled:s}});if(Dt.current=!0,Mt.current&&clearTimeout(Mt.current),!wt.current)return;t.success||(null==(e=t.data)?void 0:e.persisted)?(await me(),Lt("success"),It.current=setTimeout(()=>{wt.current&&(Lt("idle"),At(null))},2e3)):(At(a),Lt("error"),It.current=setTimeout(()=>{wt.current&&(Lt("idle"),At(null))},2e3))}catch{if(Dt.current=!0,Mt.current&&clearTimeout(Mt.current),!wt.current)return;At(a),Lt("error"),It.current=setTimeout(()=>{wt.current&&(Lt("idle"),At(null))},2e3)}};e.useEffect(()=>{(async()=>{Hs(!0);try{const e=await D();e.success&&e.data?Ks(e.data.exists):Ks(!1);const t=null==Et?void 0:Et.web_path;Ds(!t||""===t)}catch{Ks(!1)}finally{Hs(!1)}})()},[null==Et?void 0:Et.web_path]);const na=async e=>{var t;if("loading"!==Os){$s("loading");try{const s=await I({web:{web_path:e?null:"/opt/pymc_console/web/html"}});if(!wt.current)return;s.success||(null==(t=s.data)?void 0:t.persisted)?(Ds(e),$s("success"),Vs(!0),setTimeout(()=>{wt.current&&$s("idle")},2e3)):($s("error"),setTimeout(()=>{wt.current&&$s("idle")},2e3))}catch{if(!wt.current)return;$s("error"),setTimeout(()=>{wt.current&&$s("idle")},2e3)}}},la=e.useCallback(async()=>{Ht(!0),$t(null);try{const e=await P();Kt(e.tokens||[])}catch(e){$t(e instanceof Error?e.message:"Failed to fetch tokens")}finally{Ht(!1)}},[]);e.useEffect(()=>{la()},[la]);const ca=async()=>{if(Xt.trim()){ts(!0),$t(null);try{const e=await K(Xt.trim());Gt(e.token||null),Vt(!1),Zt(!0),Bt(""),await la()}catch(e){$t(e instanceof Error?e.message:"Failed to create token")}finally{ts(!1)}}else $t("Token name is required")},ia=e=>e?new Date(1e3*e).toLocaleString():"Never",da=e.useCallback(e=>{const t=new Map,s=[];return e.forEach(e=>{const s={id:e.id,name:e.name,floodPolicy:e.flood_policy,transport_key:e.transport_key,last_used:e.last_used,parent_id:e.parent_id,children:[]};t.set(e.id,s)}),t.forEach(e=>{e.parent_id&&t.has(e.parent_id)?t.get(e.parent_id).children.push(e):s.push(e)}),s},[]),oa=e.useCallback(async()=>{ds(!0),us(null);try{const e=await L();e.success&&e.data?cs(da(e.data)):us(e.error||"Failed to load transport keys")}catch(e){us(e instanceof Error?e.message:"Unknown error occurred")}finally{ds(!1)}},[da]);e.useEffect(()=>{oa()},[oa]);const ua=e.useCallback((e,t)=>{for(const s of e){if(s.id===t)return s;if(s.children){const e=ua(s.children,t);if(e)return e}}return null},[]),xa=e.useCallback(()=>{if(!bs)return;const e=ua(ls,bs);return null==e?void 0:e.name},[bs,ls,ua]),ma=e.useCallback(e=>{fs(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),pa=async e=>{hs(!0),us(null);try{const t=await H("allow"===e);t.success?ms(e):us(t.error||"Failed to update global flood policy")}catch(t){us(t instanceof Error?t.message:"Failed to update global flood policy")}finally{hs(!1)}},ha=async()=>{if(Es.trim()){Ms(!0),us(null);try{const e=await O({name:Es.trim(),flood_policy:Ls,parent_id:bs??void 0});e.success?(await oa(),vs(!1),Ps(""),Rs("deny")):us(e.error||"Failed to add transport key")}catch(e){us(e instanceof Error?e.message:"Failed to add transport key")}finally{Ms(!1)}}else us("Key name is required")},ba=e.useCallback(()=>{if(!bs)return;const e=ua(ls,bs);e&&(Ss({...e}),ws(!0))},[bs,ls,ua]);e.useEffect(()=>{const e=e=>{"Escape"===e.key&&(js&&(vs(!1),Ps(""),Rs("deny")),Ns&&(ws(!1),Ss(null)),ks&&(Cs(!1),Fs(null)),Yt&&(Vt(!1),Bt("")),Wt&&(Zt(!1),Gt(null)))};if(js||Ns||ks||Yt||Wt)return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[js,Ns,ks,Yt,Wt]);const ya=e.useCallback(()=>{if(!bs)return;const e=ua(ls,bs);e&&(Fs(e),Cs(!0))},[bs,ls,ua]);return t.jsxs(B,{children:[t.jsx(U,{title:"Configuration",icon:t.jsx(s,{})}),t.jsxs(Z,{template:"standard",children:[t.jsx(J,{span:12,md:6,children:t.jsx(G,{children:t.jsxs("div",{ref:mt,children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h2",{className:"type-subheading text-text-primary flex items-center gap-2",children:[t.jsx(a,{className:"icon-md text-accent-primary"}),"Repeater Settings"]}),t.jsx("div",{className:"flex items-center gap-1",children:ye&&(Qe?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:aa,disabled:"loading"===dt,className:_("p-2 rounded-lg transition-colors","loading"===dt?"text-text-muted cursor-not-allowed":"text-text-muted hover:text-accent-danger hover:bg-accent-danger/10"),title:"Cancel",children:t.jsx(r,{className:"w-4 h-4"})}),t.jsx("button",{onClick:async()=>{if("loading"!==dt){pt.current&&clearTimeout(pt.current),pe(le),ot("loading"),xt(null);try{const e={};tt&&tt!==fe&&(e.node_name=tt);const t=parseFloat(at);isNaN(t)||t===(null==ye?void 0:ye.latitude)||(e.latitude=t);const s=parseFloat(nt);isNaN(s)||s===(null==ye?void 0:ye.longitude)||(e.longitude=s);const a=parseInt(ct);if(isNaN(a)||a===(null==ye?void 0:ye.send_advert_interval_hours)||(e.flood_advert_interval_hours=a),0===Object.keys(e).length)return xt({success:!0,message:"No changes to save"}),ot("idle"),void he(le);const r=await M(e);if(!wt.current)return void he(le);if(r.success&&r.data){const e=r.data.applied.join(", ");xt({success:!0,message:`Updated: ${e}`}),await me({force:!0}),ot("success"),pt.current=setTimeout(()=>{wt.current&&(ot("idle"),et(!1),xt(null),he(le))},1500)}else xt({success:!1,message:r.error||"Failed to save"}),ot("error"),he(le),pt.current=setTimeout(()=>{wt.current&&ot("idle")},2e3)}catch(e){if(!wt.current)return void he(le);xt({success:!1,message:String(e)}),ot("error"),he(le),pt.current=setTimeout(()=>{wt.current&&ot("idle")},2e3)}}},disabled:"loading"===dt,className:_("p-2 rounded-lg transition-colors","loading"===dt?"text-accent-primary cursor-wait":"success"===dt?"text-accent-success":"error"===dt?"text-accent-danger":"text-accent-success hover:bg-accent-success/10"),title:"Save changes",children:"loading"===dt?t.jsx(n,{className:"w-4 h-4 animate-spin"}):"success"===dt?t.jsx(l,{className:"w-4 h-4"}):"error"===dt?t.jsx(r,{className:"w-4 h-4"}):t.jsx(l,{className:"w-4 h-4"})})]}):t.jsx("button",{onClick:sa,className:"p-2 rounded-lg transition-colors text-text-muted hover:text-text-primary hover:bg-bg-subtle",title:"Edit repeater settings",children:t.jsx(c,{className:"w-4 h-4"})}))})]}),ut&&t.jsx("div",{className:_("text-xs mb-3 px-2 py-1.5 rounded-md",ut.success?"text-accent-success bg-accent-success/10":"text-accent-danger bg-accent-danger/10"),children:ut.message}),ye?t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:"Node Name"}),t.jsx("div",{className:_("h-[38px] rounded-full px-4 flex items-center transition-colors",Qe?"bg-white/5":"bg-white/[0.02]"),children:Qe?t.jsx("input",{type:"text",value:tt,onChange:e=>st(e.target.value),maxLength:50,className:"w-full bg-transparent text-text-primary focus:outline-none type-data",placeholder:"Enter node name"}):t.jsx("span",{className:"type-data text-text-primary",children:fe})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:Qe?"Latitude (°)":"Latitude"}),t.jsx("div",{className:_("h-[38px] rounded-full px-4 flex items-center transition-colors",Qe?"bg-white/5":"bg-white/[0.02]"),children:Qe?t.jsx("input",{type:"number",value:at,onChange:e=>rt(e.target.value),step:"0.000001",min:"-90",max:"90",className:"w-full bg-transparent text-text-primary focus:outline-none type-data"}):t.jsx("span",{className:"type-data text-text-primary",children:0!==ye.latitude?ye.latitude.toFixed(6):"Not set"})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:Qe?"Longitude (°)":"Longitude"}),t.jsx("div",{className:_("h-[38px] rounded-full px-4 flex items-center transition-colors",Qe?"bg-white/5":"bg-white/[0.02]"),children:Qe?t.jsx("input",{type:"number",value:nt,onChange:e=>lt(e.target.value),step:"0.000001",min:"-180",max:"180",className:"w-full bg-transparent text-text-primary focus:outline-none type-data"}):t.jsx("span",{className:"type-data text-text-primary",children:0!==ye.longitude?ye.longitude.toFixed(6):"Not set"})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:Qe?"Advert Interval (hours)":"Advert Interval"}),t.jsx("div",{className:_("h-[38px] rounded-full px-4 flex items-center transition-colors",Qe?"bg-white/5":"bg-white/[0.02]"),children:Qe?t.jsx("input",{type:"number",value:ct,onChange:e=>it(e.target.value),min:"0",max:"48",className:"w-full bg-transparent text-text-primary focus:outline-none type-data"}):t.jsx("span",{className:"type-data text-text-primary",children:ye.send_advert_interval_hours>0?`${ye.send_advert_interval_hours}h`:"Disabled"})}),Qe&&t.jsx("p",{className:"type-data-xs text-text-muted mt-1 ml-4",children:"0 = disabled, 3-48 hours"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:"Score-based TX"}),t.jsx("div",{className:"h-[38px] rounded-full px-4 flex items-center bg-white/[0.02]",children:t.jsx("span",{className:"type-data text-text-primary",children:ye.use_score_for_tx?"Enabled":"Disabled"})})]})]}):t.jsx("p",{className:"text-text-muted",children:"Loading repeater settings..."})]})})}),t.jsx(J,{span:12,md:6,children:t.jsx(G,{children:t.jsxs("div",{ref:Ke,children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h2",{className:"type-subheading text-text-primary flex items-center gap-2",children:[t.jsx(i,{className:"icon-md text-accent-primary"}),"Radio Configuration"]}),t.jsx("div",{className:"flex items-center gap-1",children:be&&(we?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:Ws,disabled:"loading"===Me,className:_("p-2 rounded-lg transition-colors","loading"===Me?"text-text-muted cursor-not-allowed":"text-text-muted hover:text-accent-danger hover:bg-accent-danger/10"),title:"Cancel",children:t.jsx(r,{className:"w-4 h-4"})}),t.jsx("button",{onClick:async()=>{if("loading"!==Me){qe.current&&clearTimeout(qe.current),pe(ne),Ie("loading"),ze(null);try{const e={},t=parseFloat(Ce),s=be?be.frequency/1e6:0;Math.abs(t-s)>1e-4&&(e.frequency_mhz=t);const a=be?be.bandwidth/1e3:0;Se!==a&&(e.bandwidth_khz=Se),Fe!==(null==be?void 0:be.spreading_factor)&&(e.spreading_factor=Fe),Pe!==(null==be?void 0:be.coding_rate)&&(e.coding_rate=Pe);const r=parseInt(Re);if(r!==(null==be?void 0:be.tx_power)&&(e.tx_power=r),0===Object.keys(e).length)return ze({success:!0,message:"No changes to save"}),Ie("idle"),void he(ne);const n=await M(e);if(!wt.current)return void he(ne);if(n.success&&n.data){const e=n.data.applied.join(", "),t=n.data.live_update?" (applied live)":" (restart required)";ze({success:!0,message:`Updated: ${e}${t}`}),await me({force:!0}),Ie("success"),qe.current=setTimeout(()=>{wt.current&&(Ie("idle"),ke(!1),ze(null),he(ne))},1500)}else ze({success:!1,message:n.error||"Failed to save"}),Ie("error"),he(ne),qe.current=setTimeout(()=>{wt.current&&Ie("idle")},2e3)}catch(e){if(!wt.current)return void he(ne);ze({success:!1,message:String(e)}),Ie("error"),he(ne),qe.current=setTimeout(()=>{wt.current&&Ie("idle")},2e3)}}},disabled:"loading"===Me||!Gs,className:_("p-2 rounded-lg transition-colors","loading"===Me?"text-accent-primary cursor-wait":"success"===Me?"text-accent-success":"error"===Me?"text-accent-danger":Gs?"text-accent-success hover:bg-accent-success/10":"text-text-muted cursor-not-allowed"),title:Gs?"Save changes":"No changes to save",children:"loading"===Me?t.jsx(n,{className:"w-4 h-4 animate-spin"}):"success"===Me?t.jsx(l,{className:"w-4 h-4"}):"error"===Me?t.jsx(r,{className:"w-4 h-4"}):t.jsx(l,{className:"w-4 h-4"})})]}):t.jsx("button",{onClick:()=>{be&&(_e((be.frequency/1e6).toFixed(3)),Te(be.bandwidth/1e3),Ee(be.spreading_factor),Le(be.coding_rate),Ae(String(be.tx_power))),ze(null),ke(!0)},className:"p-2 rounded-lg transition-colors text-text-muted hover:text-text-primary hover:bg-bg-subtle",title:"Edit radio settings",children:t.jsx(c,{className:"w-4 h-4"})}))})]}),De&&t.jsx("div",{className:_("text-xs mb-3 px-2 py-1.5 rounded-md",De.success?"text-accent-success bg-accent-success/10":"text-accent-danger bg-accent-danger/10"),children:De.message}),be?t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:we?"Frequency (MHz)":"Frequency"}),t.jsx("div",{className:_("h-[38px] rounded-full px-4 flex items-center transition-colors",we?"bg-white/5":"bg-white/[0.02]"),children:we?t.jsx("input",{type:"number",value:Ce,onChange:e=>_e(e.target.value),step:"0.001",min:"400",max:"930",className:"w-full bg-transparent text-text-primary focus:outline-none type-data"}):t.jsx("span",{className:"type-data text-text-primary",children:R(be.frequency)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:we?"TX Power (dBm)":"TX Power"}),t.jsx("div",{className:_("h-[38px] rounded-full px-4 flex items-center transition-colors",we?"bg-white/5":"bg-white/[0.02]"),children:we?t.jsx("input",{type:"number",value:Re,onChange:e=>Ae(e.target.value),min:"-9",max:"22",className:"w-full bg-transparent text-text-primary focus:outline-none type-data"}):t.jsxs("span",{className:"type-data text-text-primary",children:[be.tx_power," dBm"]})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:"Bandwidth"}),t.jsx("div",{className:_("h-[38px] rounded-full px-4 flex items-center transition-colors relative",we?"bg-white/5":"bg-white/[0.02]"),children:we?t.jsxs(t.Fragment,{children:[t.jsx("select",{value:Se,onChange:e=>Te(parseFloat(e.target.value)),className:"w-full bg-transparent text-text-primary focus:outline-none appearance-none cursor-pointer type-data pr-6",children:se.map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))}),t.jsx(d,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]}):t.jsx("span",{className:"type-data text-text-primary",children:A(be.bandwidth)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:"Spreading Factor"}),t.jsx("div",{className:_("h-[38px] rounded-full px-4 flex items-center transition-colors relative",we?"bg-white/5":"bg-white/[0.02]"),children:we?t.jsxs(t.Fragment,{children:[t.jsx("select",{value:Fe,onChange:e=>Ee(parseInt(e.target.value)),className:"w-full bg-transparent text-text-primary focus:outline-none appearance-none cursor-pointer type-data pr-6",children:ae.map(e=>t.jsxs("option",{value:e,children:["SF",e]},e))}),t.jsx(d,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]}):t.jsxs("span",{className:"type-data text-text-primary",children:["SF",be.spreading_factor]})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:"Coding Rate"}),t.jsx("div",{className:_("h-[38px] rounded-full px-4 flex items-center transition-colors relative",we?"bg-white/5":"bg-white/[0.02]"),children:we?t.jsxs(t.Fragment,{children:[t.jsx("select",{value:Pe,onChange:e=>Le(parseInt(e.target.value)),className:"w-full bg-transparent text-text-primary focus:outline-none appearance-none cursor-pointer type-data pr-6",children:re.map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))}),t.jsx(d,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]}):t.jsxs("span",{className:"type-data text-text-primary",children:["4/",be.coding_rate]})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:"Preamble"}),t.jsx("div",{className:"h-[38px] rounded-full px-4 flex items-center bg-white/[0.02]",children:t.jsxs("span",{className:"type-data text-text-primary",children:[be.preamble_length," symbols"]})})]})]}):t.jsx("p",{className:"text-text-muted",children:"Loading radio configuration..."})]})})})]}),t.jsxs(Z,{template:"standard",children:[t.jsx(J,{span:12,md:6,children:t.jsx(G,{children:t.jsxs("div",{ref:Je,children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h2",{className:"type-subheading text-text-primary flex items-center gap-3",children:[t.jsx(o,{className:"icon-md text-icon-card-title"}),"Operating Mode"]}),t.jsx("div",{className:"flex items-center gap-1",children:He?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:async()=>{if("loading"!==Ge){Ze.current&&clearTimeout(Ze.current),pe(ce),We("loading");try{const e=await M({tx_delay_factor:parseFloat($e),direct_tx_delay_factor:parseFloat(Ve)});if(await ue({max_airtime_percent:parseFloat(Be),enforcement_enabled:ve}),!wt.current)return void he(ce);e.success&&e.data?(await me({force:!0}),We("success"),Ze.current=setTimeout(()=>{wt.current&&(We("idle"),Oe(!1),he(ce))},1500)):(We("error"),he(ce),Ze.current=setTimeout(()=>{wt.current&&We("idle")},2e3))}catch{if(!wt.current)return void he(ce);We("error"),he(ce),Ze.current=setTimeout(()=>{wt.current&&We("idle")},2e3)}}},disabled:"loading"===Ge,className:_("p-2 rounded-lg transition-colors","loading"===Ge?"text-accent-primary cursor-wait":"success"===Ge?"text-accent-success":"error"===Ge?"text-accent-danger":"text-accent-success hover:bg-accent-success/10"),title:"Save",children:"loading"===Ge?t.jsx(n,{className:"w-4 h-4 animate-spin"}):"success"===Ge?t.jsx(l,{className:"w-4 h-4"}):"error"===Ge?t.jsx(r,{className:"w-4 h-4"}):t.jsx(l,{className:"w-4 h-4"})}),t.jsx("button",{onClick:ta,className:"p-2 rounded-lg text-text-muted hover:text-accent-danger hover:bg-accent-danger/10",title:"Cancel",children:t.jsx(r,{className:"w-4 h-4"})})]}):t.jsx("button",{onClick:ea,className:"p-2 rounded-lg transition-colors text-text-muted hover:text-text-primary hover:bg-bg-subtle",title:"Edit settings",children:t.jsx(c,{className:"w-4 h-4"})})})]}),t.jsx("p",{className:"type-label text-text-muted mb-3",children:"Control how the repeater handles packets"}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[t.jsxs("div",{className:"flex-1 space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("label",{className:"type-label text-text-muted",children:"Repeat"}),t.jsx("div",{className:"flex items-center gap-2",children:(()=>{const e=null!==ft?ft:"forward"===je;return t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:async()=>{if("loading"===ht)return;const t=!e,s="forward"===je;kt.current&&clearTimeout(kt.current),Ct.current&&clearTimeout(Ct.current),Tt.current=!1,jt(t),bt("loading"),kt.current=setTimeout(()=>{Tt.current||wt.current&&(jt(s),bt("error"),Ct.current=setTimeout(()=>{wt.current&&(bt("idle"),jt(null))},2e3))},1e4);try{if(await de(t?"forward":"monitor"),Tt.current=!0,kt.current&&clearTimeout(kt.current),!wt.current)return;bt("success"),Ct.current=setTimeout(()=>{wt.current&&(bt("idle"),jt(null),oe())},2e3)}catch{if(Tt.current=!0,kt.current&&clearTimeout(kt.current),!wt.current)return;jt(s),bt("error"),Ct.current=setTimeout(()=>{wt.current&&(bt("idle"),jt(null))},2e3)}},disabled:"loading"===ht,className:_("relative inline-flex h-6 w-11 items-center rounded-full transition-colors border-2",e?"bg-toggle-on border-toggle-on":"bg-toggle-off border-border-subtle","loading"===ht&&"opacity-70"),"aria-label":"Toggle forward mode",children:t.jsx("span",{className:_("inline-block h-4 w-4 transform rounded-full bg-white transition-transform shadow-lg",e?"translate-x-5":"translate-x-0.5")})}),t.jsx("span",{className:_("type-data text-sm w-7",e?"text-accent-success":"text-text-muted"),children:e?"On":"Off"}),"loading"===ht&&t.jsx(n,{className:"w-4 h-4 text-text-muted animate-spin"}),"success"===ht&&t.jsx(l,{className:"w-4 h-4 text-accent-success"}),"error"===ht&&t.jsx(r,{className:"w-4 h-4 text-accent-danger"})]})})()})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("label",{className:"type-label text-text-muted",children:"Duty Cycle"}),t.jsx("div",{className:"flex items-center gap-2",children:(()=>{const e=null!==vt?vt:ve;return t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:async()=>{if("loading"===yt)return;const t=!e,s=ve;_t.current&&clearTimeout(_t.current),St.current&&clearTimeout(St.current),Ft.current=!1,Nt(t),gt("loading"),_t.current=setTimeout(()=>{Ft.current||wt.current&&(Nt(s),gt("error"),St.current=setTimeout(()=>{wt.current&&(gt("idle"),Nt(null))},2e3))},1e4);try{if(await ue({max_airtime_percent:Qs(),enforcement_enabled:t}),Ft.current=!0,_t.current&&clearTimeout(_t.current),!wt.current)return;gt("success"),St.current=setTimeout(()=>{wt.current&&(gt("idle"),Nt(null),xe())},2e3)}catch{if(Ft.current=!0,_t.current&&clearTimeout(_t.current),!wt.current)return;Nt(s),gt("error"),St.current=setTimeout(()=>{wt.current&&(gt("idle"),Nt(null))},2e3)}},disabled:"loading"===yt,className:_("relative inline-flex h-6 w-11 items-center rounded-full transition-colors border-2",e?"bg-toggle-on border-toggle-on":"bg-toggle-off border-border-subtle","loading"===yt&&"opacity-70"),"aria-label":"Toggle duty cycle",children:t.jsx("span",{className:_("inline-block h-4 w-4 transform rounded-full bg-white transition-transform shadow-lg",e?"translate-x-5":"translate-x-0.5")})}),t.jsx("span",{className:_("type-data text-sm w-7",e?"text-accent-success":"text-text-muted"),children:e?"On":"Off"}),"loading"===yt&&t.jsx(n,{className:"w-4 h-4 text-text-muted animate-spin"}),"success"===yt&&t.jsx(l,{className:"w-4 h-4 text-accent-success"}),"error"===yt&&t.jsx(r,{className:"w-4 h-4 text-accent-danger"})]})})()})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("label",{className:"type-label text-text-muted",children:"Max Airtime"}),t.jsx("div",{className:_("h-[32px] rounded-full px-3 flex items-center justify-end transition-colors min-w-[80px]",He?"bg-white/5":"bg-white/[0.02]"),children:He?t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"number",value:Be,onChange:e=>Ue(e.target.value),step:"0.5",min:"0.1",max:"100",className:"w-12 bg-transparent text-text-primary text-right focus:outline-none type-data"}),t.jsx("span",{className:"text-text-muted type-data",children:"%"})]}):t.jsxs("span",{className:"type-data text-text-primary",children:[Qs().toFixed(1),"%"]})})]})]}),t.jsx("div",{className:"hidden sm:block w-px bg-border-subtle"}),t.jsxs("div",{className:"flex-1 pt-4 sm:pt-0 border-t sm:border-t-0 border-border-subtle",children:[t.jsx("label",{className:"type-label text-text-muted block mb-3",children:"TX Delays"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"type-label text-text-muted",children:"Flood"}),t.jsx("div",{className:_("h-[32px] rounded-full px-3 flex items-center justify-end transition-colors min-w-[80px]",He?"bg-white/5":"bg-white/[0.02]"),children:He?t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"number",value:$e,onChange:e=>Ye(e.target.value),step:"0.1",min:"0",max:"5",className:"w-12 bg-transparent text-text-primary text-right focus:outline-none type-data"}),t.jsx("span",{className:"text-text-muted type-data",children:"x"})]}):t.jsxs("span",{className:"type-data text-text-primary",children:[Zs().toFixed(2),"x"]})})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"type-label text-text-muted",children:"Direct"}),t.jsx("div",{className:_("h-[32px] rounded-full px-3 flex items-center justify-end transition-colors min-w-[80px]",He?"bg-white/5":"bg-white/[0.02]"),children:He?t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"number",value:Ve,onChange:e=>Xe(e.target.value),step:"0.1",min:"0",max:"5",className:"w-12 bg-transparent text-text-primary text-right focus:outline-none type-data"}),t.jsx("span",{className:"text-text-muted type-data",children:"s"})]}):t.jsxs("span",{className:"type-data text-text-primary",children:[Js().toFixed(2),"s"]})})]})]})]})]})]})})}),t.jsx(J,{span:12,md:6,children:t.jsxs(G,{children:[t.jsx(W,{icon:t.jsx(s,{}),title:"App Settings",largeTitle:!0}),t.jsx("p",{className:"type-body-sm text-text-muted mb-4",children:"Appearance and web server options."}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("span",{className:"type-body text-text-primary font-medium block",children:"Enable CORS"}),t.jsx("span",{className:"type-body-sm text-text-muted",children:"Allow cross-origin API access"})]}),t.jsx("div",{className:"flex items-center gap-2",children:(()=>{const e=null!==Rt?Rt:(null==Et?void 0:Et.cors_enabled)??!1;return t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:ra,disabled:"loading"===Pt,className:_("relative inline-flex h-6 w-11 items-center rounded-full transition-colors border-2",e?"bg-toggle-on border-toggle-on":"bg-toggle-off border-border-subtle","loading"===Pt&&"opacity-70"),title:e?"Disable CORS":"Enable CORS",children:t.jsx("span",{className:_("inline-block h-4 w-4 transform rounded-full bg-white transition-transform shadow-lg",e?"translate-x-5":"translate-x-0.5")})}),"loading"===Pt&&t.jsx(n,{className:"w-4 h-4 text-text-muted animate-spin"}),"success"===Pt&&t.jsx(l,{className:"w-4 h-4 text-accent-success"}),"error"===Pt&&t.jsx(r,{className:"w-4 h-4 text-accent-danger"})]})})()})]}),t.jsxs("div",{children:[t.jsx("span",{className:"type-body text-text-primary font-medium block mb-2",children:"Theme"}),t.jsx(te,{})]})]})]})})]}),t.jsx(Z,{template:"auto",children:t.jsxs(G,{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"type-heading text-text-primary flex items-center gap-2",children:[t.jsx(u,{className:"icon-md text-accent-primary"}),"Regions / Transport Keys"]}),t.jsx("p",{className:"type-body-sm text-text-muted mt-1",children:"Manage regional key hierarchy for flood control"})]}),t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.jsxs("button",{onClick:()=>vs(!0),disabled:"allow"===xs,className:_("flex items-center gap-1.5 h-[32px] px-3 rounded-full transition-colors type-body-sm font-medium","allow"===xs?"bg-white/[0.02] text-text-muted cursor-not-allowed":"bg-accent-success/10 hover:bg-accent-success/20 text-accent-success"),children:[t.jsx(x,{className:"w-3.5 h-3.5"}),"Add"]}),t.jsx("button",{onClick:ba,disabled:!bs||"allow"===xs,className:_("h-[32px] px-3 rounded-full transition-colors type-body-sm font-medium",bs&&"allow"!==xs?"bg-accent-primary/10 hover:bg-accent-primary/20 text-accent-primary":"bg-white/[0.02] text-text-muted cursor-not-allowed"),children:"Edit"}),t.jsx("button",{onClick:ya,disabled:!bs||"allow"===xs,className:_("h-[32px] px-3 rounded-full transition-colors type-body-sm font-medium",bs&&"allow"!==xs?"bg-accent-danger/10 hover:bg-accent-danger/20 text-accent-danger":"bg-white/[0.02] text-text-muted cursor-not-allowed"),children:"Delete"})]})]}),t.jsx("div",{className:"bg-white/[0.02] rounded-2xl p-4 mb-4",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:_("w-10 h-10 rounded-full flex items-center justify-center","allow"===xs?"bg-accent-success/20":"bg-accent-danger/20"),children:"allow"===xs?t.jsx(m,{className:"w-5 h-5 text-accent-success"}):t.jsx(p,{className:"w-5 h-5 text-accent-danger"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"type-body text-text-primary font-medium",children:"Global Flood Policy"}),t.jsx("p",{className:"type-body-sm text-text-muted",children:"Master control for repeater flooding"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"flex bg-white/[0.02] rounded-full p-1",children:[t.jsx("button",{onClick:()=>pa("deny"),disabled:ps,className:_("px-4 py-1.5 rounded-full transition-colors type-body-sm font-medium","deny"===xs?"bg-accent-danger/20 text-accent-danger":"text-text-muted hover:text-text-secondary",ps&&"opacity-50"),children:"Deny"}),t.jsx("button",{onClick:()=>pa("allow"),disabled:ps,className:_("px-4 py-1.5 rounded-full transition-colors type-body-sm font-medium","allow"===xs?"bg-accent-success/20 text-accent-success":"text-text-muted hover:text-text-secondary",ps&&"opacity-50"),children:"Allow"})]}),ps&&t.jsx(n,{className:"w-4 h-4 animate-spin text-text-muted"})]})]})}),os&&t.jsx("div",{className:"type-body-sm mb-3 px-3 py-2 rounded-full text-accent-danger bg-accent-danger/10",children:os}),t.jsx("div",{className:"bg-white/[0.02] rounded-2xl p-4 min-h-[120px]",children:is?t.jsxs("div",{className:"flex items-center justify-center py-6",children:[t.jsx(n,{className:"w-5 h-5 animate-spin text-accent-primary mr-2"}),t.jsx("span",{className:"type-body-sm text-text-muted",children:"Loading transport keys..."})]}):0===ls.length?t.jsxs("div",{className:"text-center py-6",children:[t.jsx("div",{className:"w-12 h-12 rounded-full bg-white/[0.02] mx-auto mb-3 flex items-center justify-center",children:t.jsx(u,{className:"w-6 h-6 text-text-muted/50"})}),t.jsx("p",{className:"type-body text-text-muted",children:"No transport keys found"}),t.jsx("p",{className:"type-body-sm text-text-muted/70 mt-1",children:"Add your first transport key to get started"})]}):t.jsx("div",{className:"space-y-1",children:ls.map(e=>t.jsx(ie,{node:e,level:0,expandedKeys:gs,selectedKeyId:bs,globalFloodPolicy:xs,onSelect:ys,onToggle:ma},e.id))})})]})}),t.jsx(Z,{template:"auto",children:t.jsxs(G,{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"type-heading text-text-primary flex items-center gap-2",children:[t.jsx(h,{className:"icon-md text-accent-primary"}),"API Tokens"]}),t.jsx("p",{className:"type-body-sm text-text-muted mt-1",children:"Manage API tokens for machine-to-machine authentication"})]}),t.jsxs("button",{onClick:()=>Vt(!0),className:"flex items-center justify-center gap-2 h-[32px] px-4 bg-accent-primary/10 hover:bg-accent-primary/20 text-accent-primary rounded-full transition-colors type-body-sm font-medium",children:[t.jsx(x,{className:"w-4 h-4"}),"Create Token"]})]}),t.jsx("div",{className:"bg-accent-tertiary/5 rounded-2xl p-4 mb-4",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-tertiary/20 flex items-center justify-center flex-shrink-0",children:t.jsx(b,{className:"w-4 h-4 text-accent-tertiary"})}),t.jsxs("div",{className:"type-body-sm text-text-muted",children:[t.jsxs("p",{children:[t.jsx("span",{className:"text-text-secondary",children:"API tokens"})," are used for machine-to-machine authentication. Include the token in the ",t.jsx("code",{className:"type-code bg-accent-tertiary/20 px-1.5 py-0.5 rounded-full text-accent-tertiary",children:"X-API-Key"})," header when making API requests."]}),t.jsx("p",{className:"mt-1 text-text-muted/70",children:"Tokens are only shown once at creation. Store them securely."})]})]})}),Ot&&t.jsx("div",{className:"type-body-sm mb-3 px-3 py-2 rounded-full text-accent-danger bg-accent-danger/10",children:Ot}),qt&&0===zt.length?t.jsxs("div",{className:"flex items-center justify-center py-6",children:[t.jsx(n,{className:"w-5 h-5 animate-spin text-accent-primary mr-2"}),t.jsx("span",{className:"type-body-sm text-text-muted",children:"Loading tokens..."})]}):zt.length>0?t.jsx("div",{className:"space-y-2",children:zt.map(e=>t.jsx("div",{className:"bg-white/[0.02] hover:bg-white/[0.04] rounded-2xl p-4 transition-colors",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-accent-primary/10 flex items-center justify-center flex-shrink-0",children:t.jsx(h,{className:"w-5 h-5 text-accent-primary"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("h3",{className:"type-body text-text-primary font-medium truncate",children:e.name}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:gap-4 mt-0.5",children:[t.jsxs("span",{className:"type-data-sm text-text-muted truncate",children:["Created: ",ia(e.created_at)]}),t.jsxs("span",{className:"type-data-sm text-text-muted truncate",children:["Last used: ",ia(e.last_used)]})]})]})]}),t.jsxs("button",{onClick:()=>Qt({id:e.id,name:e.name}),disabled:ss,className:"h-[32px] px-4 bg-accent-danger/10 hover:bg-accent-danger/20 text-accent-danger rounded-full transition-colors disabled:opacity-50 type-body-sm font-medium flex items-center justify-center gap-1.5",children:[t.jsx(y,{className:"w-3.5 h-3.5"}),"Revoke"]})]})},e.id))}):t.jsxs("div",{className:"bg-white/[0.02] rounded-2xl p-6 text-center",children:[t.jsx("div",{className:"w-14 h-14 rounded-full bg-white/[0.02] mx-auto mb-4 flex items-center justify-center",children:t.jsx(h,{className:"w-7 h-7 text-text-muted/50"})}),t.jsx("h3",{className:"type-body text-text-primary font-medium mb-1",children:"No API Tokens"}),t.jsx("p",{className:"type-body-sm text-text-muted mb-4",children:"Create a token to enable API access"}),t.jsx("button",{onClick:()=>Vt(!0),className:"h-[32px] px-4 bg-accent-primary/10 hover:bg-accent-primary/20 text-accent-primary rounded-full transition-colors type-body-sm font-medium",children:"Create Your First Token"})]})]})}),t.jsx(Z,{template:"auto",children:t.jsxs(G,{children:[t.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:t.jsxs("div",{children:[t.jsxs("h2",{className:"type-heading text-text-primary flex items-center gap-2",children:[t.jsx(g,{className:"icon-md text-accent-primary"}),"Web Frontend"]}),t.jsx("p",{className:"type-body-sm text-text-muted mt-1",children:"Choose which web interface to use"})]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:_("flex items-start gap-3 p-4 bg-white/[0.02] rounded-2xl border-2 cursor-pointer transition-all",Is?"border-accent-primary bg-accent-primary/5":"border-transparent hover:border-accent-primary/30","loading"===Os&&"opacity-50 pointer-events-none"),children:[t.jsx("input",{type:"radio",name:"frontend",checked:Is,onChange:()=>na(!0),disabled:"loading"===Os,className:"mt-1 h-4 w-4 text-accent-primary focus:ring-accent-primary focus:ring-offset-bg-elevated"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"type-body text-text-primary font-medium",children:"Default Frontend"}),t.jsx("a",{href:"https://github.com/rightup/pyMC_Repeater",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"type-data-xs bg-accent-tertiary/15 text-accent-tertiary px-2.5 py-0.5 rounded-full font-medium hover:bg-accent-tertiary/25 transition-colors",children:"@RightUp"})]}),t.jsx("div",{className:"type-body-sm text-text-muted mt-1",children:"Built-in pyMC Repeater web interface"}),t.jsx("div",{className:"type-data-xs text-text-muted/60 mt-1 font-mono",children:"/opt/pymc_repeater/repeater/web/html"})]})]}),t.jsxs("label",{className:_("flex items-start gap-3 p-4 bg-white/[0.02] rounded-2xl border-2 cursor-pointer transition-all",Is?"border-transparent hover:border-accent-primary/30":"border-accent-primary bg-accent-primary/5","loading"===Os&&"opacity-50 pointer-events-none"),children:[t.jsx("input",{type:"radio",name:"frontend",checked:!Is,onChange:()=>na(!1),disabled:"loading"===Os,className:"mt-1 h-4 w-4 text-accent-primary focus:ring-accent-primary focus:ring-offset-bg-elevated"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"type-body text-text-primary font-medium",children:"PyMC Console"}),t.jsx("span",{className:"type-data-xs bg-accent-secondary/15 text-accent-secondary px-2.5 py-0.5 rounded-full font-medium",children:"@Treehouse ⚡"})]}),t.jsx("div",{className:"type-body-sm text-text-muted mt-1",children:"Alternative web interface for pyMC Repeater"}),t.jsx("div",{className:"type-data-xs text-text-muted/60 mt-1 font-mono",children:"/opt/pymc_console/web/html"})]})]})]}),!qs&&t.jsx("div",{className:_("bg-white/[0.02] rounded-2xl p-4",zs?"border border-accent-success/20":"border border-accent-tertiary/20"),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:_("w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",zs?"bg-accent-success/20":"bg-accent-tertiary/20"),children:zs?t.jsx(f,{className:"w-4 h-4 text-accent-success"}):t.jsx(b,{className:"w-4 h-4 text-accent-tertiary"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"type-body text-text-primary font-medium",children:zs?"PyMC Console has been detected":"PyMC Console Not Installed"}),zs?t.jsxs("p",{className:"type-body-sm text-text-muted mt-1",children:["PyMC Console is installed at ",t.jsx("code",{className:"type-code bg-accent-success/10 px-1.5 py-0.5 rounded-full text-accent-success",children:"/opt/pymc_console/web/html"})]}):t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"type-body-sm text-text-muted mt-1 mb-3",children:["PyMC Console must be installed at ",t.jsx("code",{className:"type-code bg-accent-tertiary/10 px-1.5 py-0.5 rounded-full text-accent-tertiary",children:"/opt/pymc_console/web/html"})," before selecting this option."]}),t.jsxs("a",{href:"https://github.com/dmduran12/pymc_console-dist",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 h-[32px] px-4 bg-accent-tertiary/10 hover:bg-accent-tertiary/20 text-accent-tertiary rounded-full type-body-sm font-medium transition-colors",children:[t.jsx(j,{className:"w-4 h-4"}),"PyMC Console Install Instructions"]})]})]})]})}),Ys&&t.jsx("div",{className:"bg-white/[0.02] rounded-2xl p-4 border border-accent-secondary/30",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-secondary/20 flex items-center justify-center flex-shrink-0",children:t.jsx(v,{className:"w-4 h-4 text-accent-secondary"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"type-body text-text-primary font-medium",children:"Service restart required"}),t.jsx("p",{className:"type-body-sm text-text-muted mt-1",children:"Web frontend changes will take effect after restarting the pymc-repeater service."})]})]}),t.jsx("button",{onClick:async()=>{if(!Xs){Bs(!0);try{await z(),Vs(!1),setTimeout(()=>{window.location.reload()},2e3)}catch{Vs(!1),setTimeout(()=>{window.location.reload()},3e3)}}},disabled:Xs,className:"h-[32px] px-4 bg-accent-secondary/10 hover:bg-accent-secondary/20 text-accent-secondary rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 whitespace-nowrap type-body-sm font-medium",children:Xs?t.jsxs(t.Fragment,{children:[t.jsx(n,{className:"w-4 h-4 animate-spin"}),"Restarting..."]}):t.jsxs(t.Fragment,{children:[t.jsx(N,{className:"w-4 h-4"}),"Restart Now"]})})]})})]})]})}),t.jsx(Z,{template:"auto",children:t.jsxs(G,{children:[t.jsx(W,{icon:t.jsx(o,{}),title:"Node Information",largeTitle:!0}),ee?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"type-label text-text-muted",children:"Node Name"}),t.jsx("p",{className:"type-body text-text-primary mt-1",children:fe})]}),t.jsxs("div",{children:[t.jsx("span",{className:"type-label text-text-muted",children:"Version"}),t.jsxs("p",{className:"type-data text-text-primary mt-1",children:["v",ee.version]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"type-label text-text-muted",children:"Core Version"}),t.jsxs("p",{className:"type-data text-text-primary mt-1",children:["v",ee.core_version]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"type-label text-text-muted",children:"Local Hash"}),t.jsx("div",{className:"mt-1",children:ee.local_hash?t.jsx(V,{hash:ee.local_hash,size:"sm"}):t.jsx("span",{className:"type-data-sm text-text-muted",children:"N/A"})})]})]}),ee.public_key&&t.jsxs("div",{className:"mt-4 pt-4 border-t border-border-subtle",children:[t.jsx("span",{className:"type-label text-text-muted",children:"Public Key"}),t.jsx("div",{className:"mt-1",children:t.jsx(V,{hash:ee.public_key,prefixLength:12,suffixLength:8})})]})]}):t.jsx("p",{className:"text-text-muted",children:"Loading node information..."})]})}),Yt&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&Vt(!1),role:"dialog","aria-modal":"true","aria-labelledby":"create-token-modal-title",children:t.jsxs("div",{className:"bg-bg-elevated border border-border-subtle rounded-xl p-6 max-w-md w-full shadow-2xl",children:[t.jsx("h3",{id:"create-token-modal-title",className:"type-subheading text-text-primary mb-4",children:"Create API Token"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Token Name"}),t.jsx("input",{type:"text",value:Xt,onChange:e=>Bt(e.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",className:"w-full px-4 py-2 bg-bg-subtle border border-border-subtle rounded-lg text-text-primary placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-primary/50 transition-colors",onKeyDown:e=>"Enter"===e.key&&ca(),autoFocus:!0}),t.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Give your token a descriptive name to identify its purpose"})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{Vt(!1),Bt(""),$t(null)},disabled:es,className:"px-4 py-2 bg-bg-subtle hover:bg-bg-elevated text-text-secondary rounded-lg border border-border-subtle transition-colors disabled:opacity-50",children:"Cancel"}),t.jsx("button",{onClick:ca,disabled:es||!Xt.trim(),className:"px-4 py-2 bg-accent-primary/20 hover:bg-accent-primary/30 text-text-primary rounded-lg border border-accent-primary/50 transition-colors disabled:opacity-50 flex items-center gap-2",children:es?t.jsxs(t.Fragment,{children:[t.jsx(n,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):"Create Token"})]})]})]})}),Wt&&Ut&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&Zt(!1),role:"dialog","aria-modal":"true","aria-labelledby":"show-token-modal-title",children:t.jsxs("div",{className:"bg-bg-elevated border border-border-subtle rounded-xl p-6 max-w-lg w-full shadow-2xl",children:[t.jsx("h3",{id:"show-token-modal-title",className:"type-subheading text-text-primary mb-4",children:"Token Created Successfully"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-accent-secondary/10 border border-accent-secondary/30 rounded-lg p-3",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(v,{className:"w-4 h-4 text-accent-secondary flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-text-secondary",children:[t.jsx("strong",{children:"Save this token now!"})," For security reasons, it will not be shown again."]})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Your API Token"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{value:Ut,readOnly:!0,className:"flex-1 px-4 py-2 bg-bg-subtle border border-border-subtle rounded-lg text-text-primary font-mono text-sm"}),t.jsxs("button",{onClick:()=>{Ut&&(navigator.clipboard.writeText(Ut),ns(!0),setTimeout(()=>ns(!1),2e3))},className:"px-4 py-2 bg-accent-primary/20 hover:bg-accent-primary/30 text-text-primary rounded-lg border border-accent-primary/50 transition-colors flex items-center gap-2",title:"Copy to clipboard",children:[rs?t.jsx(l,{className:"w-4 h-4 text-accent-success"}):t.jsx(w,{className:"w-4 h-4"}),rs?"Copied!":"Copy"]})]})]}),t.jsxs("div",{className:"bg-accent-tertiary/10 border border-accent-tertiary/30 rounded-lg p-3",children:[t.jsx("p",{className:"text-sm text-text-secondary mb-2",children:t.jsx("strong",{children:"Usage Example:"})}),t.jsxs("code",{className:"block bg-accent-tertiary/20 px-3 py-2 rounded text-xs text-accent-tertiary font-mono overflow-x-auto",children:['curl -H "X-API-Key: ',Ut.slice(0,12),'..." ',window.location.origin,"/api/stats"]})]}),t.jsx("div",{className:"flex justify-end mt-6",children:t.jsx("button",{onClick:()=>{Zt(!1),Gt(null)},className:"px-4 py-2 bg-accent-primary/20 hover:bg-accent-primary/30 text-text-primary rounded-lg border border-accent-primary/50 transition-colors",children:"Done"})})]})]})}),t.jsx(X,{isOpen:!!Jt,title:"Revoke API Token",message:`Are you sure you want to revoke the token '${null==Jt?void 0:Jt.name}'? This action cannot be undone.`,confirmLabel:ss?"Revoking...":"Revoke",cancelLabel:"Cancel",variant:"danger",onConfirm:async()=>{if(Jt){as(!0),$t(null);try{await q(Jt.id),await la(),Qt(null)}catch(e){$t(e instanceof Error?e.message:"Failed to revoke token")}finally{as(!1)}}},onCancel:()=>Qt(null)}),js&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&vs(!1),role:"dialog","aria-modal":"true","aria-labelledby":"add-key-modal-title",children:t.jsxs("div",{className:"bg-bg-elevated border border-border-subtle rounded-xl p-6 max-w-md w-full shadow-2xl",children:[t.jsx("h3",{id:"add-key-modal-title",className:"type-subheading text-text-primary mb-4",children:"Add Transport Key"}),t.jsxs("div",{className:"space-y-4",children:[bs&&t.jsxs("div",{className:"bg-accent-tertiary/10 border border-accent-tertiary/30 rounded-lg p-3 text-sm text-text-secondary",children:["Adding as child of: ",t.jsx("strong",{className:"text-text-primary",children:xa()})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Key Name"}),t.jsx("input",{type:"text",value:Es,onChange:e=>Ps(e.target.value),placeholder:"e.g., Region Name, Group Key",className:"w-full px-4 py-2 bg-bg-subtle border border-border-subtle rounded-lg text-text-primary placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-primary/50 transition-colors",onKeyDown:e=>"Enter"===e.key&&ha(),autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Flood Policy"}),t.jsxs("div",{className:"flex bg-bg-subtle rounded-lg border border-border-subtle p-1",children:[t.jsx("button",{onClick:()=>Rs("deny"),className:_("flex-1 px-3 py-2 text-sm font-medium rounded transition-colors","deny"===Ls?"bg-accent-danger/20 text-accent-danger border border-accent-danger/50":"text-text-muted hover:text-text-secondary"),children:"DENY"}),t.jsx("button",{onClick:()=>Rs("allow"),className:_("flex-1 px-3 py-2 text-sm font-medium rounded transition-colors","allow"===Ls?"bg-accent-success/20 text-accent-success border border-accent-success/50":"text-text-muted hover:text-text-secondary"),children:"ALLOW"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{vs(!1),Ps(""),Rs("deny")},disabled:As,className:"px-4 py-2 bg-bg-subtle hover:bg-bg-elevated text-text-secondary rounded-lg border border-border-subtle transition-colors disabled:opacity-50",children:"Cancel"}),t.jsx("button",{onClick:ha,disabled:As||!Es.trim(),className:"px-4 py-2 bg-accent-primary/20 hover:bg-accent-primary/30 text-text-primary rounded-lg border border-accent-primary/50 transition-colors disabled:opacity-50 flex items-center gap-2",children:As?t.jsxs(t.Fragment,{children:[t.jsx(n,{className:"w-4 h-4 animate-spin"}),"Adding..."]}):"Add Key"})]})]})]})}),Ns&&_s&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&ws(!1),role:"dialog","aria-modal":"true","aria-labelledby":"edit-key-modal-title",children:t.jsxs("div",{className:"bg-bg-elevated border border-border-subtle rounded-xl p-6 max-w-md w-full shadow-2xl",children:[t.jsx("h3",{id:"edit-key-modal-title",className:"type-subheading text-text-primary mb-4",children:"Edit Transport Key"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Key Name"}),t.jsx("input",{type:"text",value:_s.name,onChange:e=>Ss({..._s,name:e.target.value}),className:"w-full px-4 py-2 bg-bg-subtle border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/50 transition-colors",autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Flood Policy"}),t.jsxs("div",{className:"flex bg-bg-subtle rounded-lg border border-border-subtle p-1",children:[t.jsx("button",{onClick:()=>Ss({..._s,floodPolicy:"deny"}),className:_("flex-1 px-3 py-2 text-sm font-medium rounded transition-colors","deny"===_s.floodPolicy?"bg-accent-danger/20 text-accent-danger border border-accent-danger/50":"text-text-muted hover:text-text-secondary"),children:"DENY"}),t.jsx("button",{onClick:()=>Ss({..._s,floodPolicy:"allow"}),className:_("flex-1 px-3 py-2 text-sm font-medium rounded transition-colors","allow"===_s.floodPolicy?"bg-accent-success/20 text-accent-success border border-accent-success/50":"text-text-muted hover:text-text-secondary"),children:"ALLOW"})]})]}),_s.transport_key&&t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Transport Key"}),t.jsx("code",{className:"block bg-bg-subtle px-3 py-2 rounded-lg text-xs text-text-muted font-mono overflow-x-auto",children:_s.transport_key})]}),t.jsxs("div",{className:"flex justify-between gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{ws(!1),Fs(_s),Cs(!0),Ss(null)},disabled:As,className:"px-4 py-2 bg-accent-danger/20 hover:bg-accent-danger/30 text-accent-danger rounded-lg border border-accent-danger/50 transition-colors disabled:opacity-50",children:"Delete"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>{ws(!1),Ss(null)},disabled:As,className:"px-4 py-2 bg-bg-subtle hover:bg-bg-elevated text-text-secondary rounded-lg border border-border-subtle transition-colors disabled:opacity-50",children:"Cancel"}),t.jsx("button",{onClick:async()=>{if(_s){Ms(!0),us(null);try{const e=await $(_s.id,{name:_s.name,flood_policy:_s.floodPolicy});e.success?(await oa(),ws(!1),Ss(null)):us(e.error||"Failed to update transport key")}catch(e){us(e instanceof Error?e.message:"Failed to update transport key")}finally{Ms(!1)}}},disabled:As||!_s.name.trim(),className:"px-4 py-2 bg-accent-primary/20 hover:bg-accent-primary/30 text-text-primary rounded-lg border border-accent-primary/50 transition-colors disabled:opacity-50 flex items-center gap-2",children:As?t.jsxs(t.Fragment,{children:[t.jsx(n,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):"Save"})]})]})]})]})}),ks&&Ts&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&Cs(!1),role:"dialog","aria-modal":"true","aria-labelledby":"delete-key-modal-title",children:t.jsxs("div",{className:"bg-bg-elevated border border-border-subtle rounded-xl p-6 max-w-md w-full shadow-2xl",children:[t.jsx("h3",{id:"delete-key-modal-title",className:"type-subheading text-text-primary mb-4",children:"Delete Transport Key"}),t.jsxs("p",{className:"text-text-secondary mb-4",children:["Are you sure you want to delete ",t.jsxs("strong",{className:"text-text-primary",children:["'",Ts.name,"'"]}),"?"]}),Ts.children&&Ts.children.length>0&&t.jsx("div",{className:"bg-accent-secondary/10 border border-accent-secondary/30 rounded-lg p-3 mb-4",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(v,{className:"w-4 h-4 text-accent-secondary flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-text-secondary",children:["This key has ",Ts.children.length," child key(s). Deleting will also remove all children."]})]})}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{Cs(!1),Fs(null)},disabled:As,className:"px-4 py-2 bg-bg-subtle hover:bg-bg-elevated text-text-secondary rounded-lg border border-border-subtle transition-colors disabled:opacity-50",children:"Cancel"}),t.jsx("button",{onClick:async()=>{if(Ts){Ms(!0),us(null);try{const e=await Y(Ts.id);e.success?(await oa(),Cs(!1),Fs(null),ys(null)):us(e.error||"Failed to delete transport key")}catch(e){us(e instanceof Error?e.message:"Failed to delete transport key")}finally{Ms(!1)}}},disabled:As,className:"px-4 py-2 bg-accent-danger/20 hover:bg-accent-danger/30 text-accent-danger rounded-lg border border-accent-danger/50 transition-colors disabled:opacity-50 flex items-center gap-2",children:As?t.jsxs(t.Fragment,{children:[t.jsx(n,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})}export{de as default};
