const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-BRMJGCre.js","assets/vendor-react-LGx7x4bU.js","assets/vendor-core-XI_xDZ-M.js","assets/Dashboard-CxSB01mj.js","assets/useThemeColors-CDku3_24.js","assets/PageLayout-CnsL5xgB.js","assets/PacketDetailModal-LHb59f85.js","assets/SignalIndicator-Ci688UvU.js","assets/HashBadge-r5aIfggE.js","assets/TimeRangeSelector--BNTWnYM.js","assets/Grid-DPCXRg-g.js","assets/Packets-BPJDPk-y.js","assets/Contacts-COOTfp9A.js","assets/ConfirmModal-Yxq_5ubp.js","assets/CollisionExplorerModal-a_jQ8jpb.js","assets/leaflet-CIGW-MKW.css","assets/Statistics-DHAWemnd.js","assets/usePolling-Cg1HN7dQ.js","assets/System-CrqEvWlQ.js","assets/Logs-EmlcQX3b.js","assets/Terminal-BR-c97NN.js","assets/Configuration-B6ZMct7J.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,s,n)=>((t,s,n)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n)(t,"symbol"!=typeof s?s+"":s,n);import{r as s,j as n,c as a,u as o,X as i,M as l,L as r,d as c,e as u,C as d,G as h,F as f,S as p,f as m,g,h as y,i as x,k as w,l as b,m as k,n as v,o as S,p as _,q as M,t as j,v as C,N as T,w as N,B as L}from"./vendor-react-LGx7x4bU.js";import{_ as P}from"./deckgl-DTsmDcfs.js";import{c as E}from"./recharts-BJfdDyUB.js";import"./vendor-core-XI_xDZ-M.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const A=[{id:"default",name:"Shades of Purple",dataTheme:null,previewColor:"#B39DF3"},{id:"amber",name:"Gruvbox",dataTheme:"amber",previewColor:"#fabd2f"},{id:"grey",name:"Deus",dataTheme:"grey",previewColor:"#83a598"},{id:"black",name:"Gotham",dataTheme:"black",previewColor:"#33859d"},{id:"flora",name:"Sonokai",dataTheme:"flora",previewColor:"#9ed072"},{id:"kanagawa",name:"Kanagawa",dataTheme:"kanagawa",previewColor:"#7E9CD8"}],I=[{id:"sand",src:"/assets/sand.jpg",suggestedScheme:"default",suggestedBrightness:80},{id:"water",src:"/assets/water.webp",suggestedScheme:"grey",suggestedBrightness:40},{id:"magma",src:"/assets/magma.webp",suggestedScheme:"amber",suggestedBrightness:50},{id:"stars",src:"/assets/stars.jpg",suggestedScheme:"black",suggestedBrightness:100},{id:"ribbons",src:"/assets/ribbons.webp",suggestedScheme:"flora",suggestedBrightness:75},{id:"folds",src:"/assets/folds.webp",suggestedScheme:"kanagawa",suggestedBrightness:50}],D=[{id:"default",name:"Shades of Purple",displayName:"BlkSand",colorScheme:"default",backgroundImage:"/assets/sand.jpg",paletteColors:[["#B49DFF","#F9D26F","#71F8E5","#39D98A","#FF5C7A"],["#4CFFB5","#FF8A5C","#A78BFA","#60A5FA","#F472B6"]],displayFont:"'Rubik Mono One', monospace",displayColor:"#4A4A52",displaySize:.8},{id:"amber",name:"Gruvbox",displayName:"Magma",colorScheme:"amber",backgroundImage:"/assets/magma.webp",paletteColors:[["#fabd2f","#fb4934","#8ec07c","#b8bb26","#d3869b"],["#fe8019","#83a598","#d65d0e","#928374","#ebdbb2"]],displayFont:"'Jacquard 12', serif",displayColor:"#fe8019",displaySize:1.75},{id:"grey",name:"Deus",displayName:"Waves",colorScheme:"grey",backgroundImage:"/assets/water.webp",paletteColors:[["#83a598","#a89984","#8ec07c","#d79921","#b16286"],["#fe8019","#cc241d","#7c6f64","#bdae93","#ebdbb2"]],displayFont:"'Cantora One', sans-serif",displayColor:"#83a598",displaySize:1.25},{id:"black",name:"Gotham",displayName:"Stars",colorScheme:"black",backgroundImage:"/assets/stars.jpg",paletteColors:[["#33859d","#edb54b","#26a98b","#c23127","#888ca6"],["#195465","#d26939","#99d1ce","#4e5165","#0c1014"]],displayFont:"'IBM Plex Mono', monospace",displayColor:"#c23127",displaySize:1.25},{id:"flora",name:"Sonokai",displayName:"Ribbon",colorScheme:"flora",backgroundImage:"/assets/ribbons.webp",paletteColors:[["#9ed072","#fc5d7c","#76cce0","#e7c664","#b39df3"],["#f39660","#7f8490","#e2e2e3","#55575e","#2c2e34"]],displayFont:"'Instrument Serif', serif",displayColor:"#E2E2E3",displaySize:1.4},{id:"kanagawa",name:"Kanagawa",displayName:"Folds",colorScheme:"kanagawa",backgroundImage:"/assets/folds.webp",paletteColors:[["#7E9CD8","#E46876","#7AA89F","#DCA561","#957FB8"],["#7FB4CA","#D27E99","#98BB6C","#727169","#1F1F28"]],displayFont:"'Inter', sans-serif",displayColor:"#7E9CD8",displaySize:1.25}],R={colorScheme:"grey",backgroundImage:"/assets/water.webp",brightness:60},z="pymc-color-scheme",F="pymc-background-image",O="pymc-bg-brightness",$="pymc-background";function W(e){(new Image).src=e}const H={50:.97,100:.92,200:.84,300:.73,400:.62,500:.5,600:.4,700:.32,800:.24,900:.16},B=[50,100,200,300,400,500,600,700,800,900],U=["red","orange","yellow","green","aqua","blue","purple"];function q(e,t,s){const n=e=>Math.round(Math.max(0,Math.min(255,e))).toString(16).padStart(2,"0");return`#${n(e)}${n(t)}${n(s)}`}function G(e){const t=e/255;return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function J(e){const t=e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055;return Math.round(255*t)}function V(e,t,s){const n=s*(Math.PI/180),a=t*Math.cos(n),o=t*Math.sin(n),i=e+.3963377774*a+.2158037573*o,l=e-.1055613458*a-.0638541728*o,r=e-.0894841775*a-1.291485548*o,c=i*i*i,u=l*l*l,d=r*r*r,h=-1.2684380046*c+2.6097574011*u-.3413193965*d,f=-.0041960863*c-.7034186147*u+1.707614701*d;return[J(4.0767416621*c-3.3077115913*u+.2309699292*d),J(h),J(f)]}function Y(e){const[t,s,n]=function(e){const t=e.replace("#","");return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e),[,a,o]=function(e,t,s){const n=G(e),a=G(t),o=G(s),i=.4122214708*n+.5363325363*a+.0514459929*o,l=.2119034982*n+.6806995451*a+.1073969566*o,r=.0883024619*n+.2817188376*a+.6299787005*o,c=Math.cbrt(i),u=Math.cbrt(l),d=Math.cbrt(r),h=.2104542553*c+.793617785*u-.0040720468*d,f=1.9779984951*c-2.428592205*u+.4505937099*d,p=.0259040371*c+.7827717662*u-.808675766*d,m=Math.sqrt(f*f+p*p);let g=Math.atan2(p,f)*(180/Math.PI);return g<0&&(g+=360),[h,m,g]}(t,s,n),i={};for(const l of B){const e=H[l],t=a*(1-.3*Math.abs(e-.5)),[s,n,r]=V(e,t,o);i[l]=q(s,n,r)}return i}function K(e){return"undefined"==typeof window?"":getComputedStyle(document.documentElement).getPropertyValue(e).trim()}function X(e,t){"undefined"!=typeof document&&document.documentElement.style.setProperty(e,t)}const Q="u-off",Z="u-label",ee="width",te="height",se="top",ne="bottom",ae="left",oe="right",ie="#000",le=ie+"0",re="mousemove",ce="mousedown",ue="mouseup",de="mouseenter",he="mouseleave",fe="dblclick",pe="change",me="dppxchange",ge="--",ye="undefined"!=typeof window,xe=ye?document:null,we=ye?window:null,be=ye?navigator:null;let ke,ve;function Se(e,t){if(null!=t){let s=e.classList;!s.contains(t)&&s.add(t)}}function _e(e,t){let s=e.classList;s.contains(t)&&s.remove(t)}function Me(e,t,s){e.style[t]=s+"px"}function je(e,t,s,n){let a=xe.createElement(e);return null!=t&&Se(a,t),null!=s&&s.insertBefore(a,n),a}function Ce(e,t){return je("div",e,t)}const Te=new WeakMap;function Ne(e,t,s,n,a){let o="translate("+t+"px,"+s+"px)";o!=Te.get(e)&&(e.style.transform=o,Te.set(e,o),t<0||s<0||t>n||s>a?Se(e,Q):_e(e,Q))}const Le=new WeakMap;function Pe(e,t,s){let n=t+s;n!=Le.get(e)&&(Le.set(e,n),e.style.background=t,e.style.borderColor=s)}const Ee=new WeakMap;function Ae(e,t,s,n){let a=t+""+s;a!=Ee.get(e)&&(Ee.set(e,a),e.style.height=s+"px",e.style.width=t+"px",e.style.marginLeft=n?-t/2+"px":0,e.style.marginTop=n?-s/2+"px":0)}const Ie={passive:!0},De={...Ie,capture:!0};function Re(e,t,s,n){t.addEventListener(e,s,n?De:Ie)}function ze(e,t,s,n){t.removeEventListener(e,s,Ie)}function Fe(e,t,s,n){let a;s=s||0;let o=(n=n||t.length-1)<=2147483647;for(;n-s>1;)a=o?s+n>>1:nt((s+n)/2),t[a]<e?s=a:n=a;return e-t[s]<=t[n]-e?s:n}function Oe(e){return(t,s,n)=>{let a=-1,o=-1;for(let i=s;i<=n;i++)if(e(t[i])){a=i;break}for(let i=n;i>=s;i--)if(e(t[i])){o=i;break}return[a,o]}}ye&&function e(){let t=devicePixelRatio;ke!=t&&(ke=t,ve&&ze(pe,ve,e),ve=matchMedia(`(min-resolution: ${ke-.001}dppx) and (max-resolution: ${ke+.001}dppx)`),Re(pe,ve,e),we.dispatchEvent(new CustomEvent(me)))}();const $e=e=>null!=e,We=e=>null!=e&&e>0,He=Oe($e),Be=Oe(We);function Ue(e,t,s,n){let a=ct(e),o=ct(t);e==t&&(-1==a?(e*=s,t/=s):(e/=s,t*=s));let i=10==s?ut:dt,l=1==o?ot:nt,r=(1==a?nt:ot)(i(st(e))),c=l(i(st(t))),u=rt(s,r),d=rt(s,c);return 10==s&&(r<0&&(u=Tt(u,-r)),c<0&&(d=Tt(d,-c))),n||2==s?(e=u*a,t=d*o):(e=Ct(e,u),t=jt(t,d)),[e,t]}function qe(e,t,s,n){let a=Ue(e,t,s,n);return 0==e&&(a[0]=0),0==t&&(a[1]=0),a}const Ge={mode:3,pad:.1},Je={pad:0,soft:null,mode:0},Ve={min:Je,max:Je};function Ye(e,t,s,n){return Ft(s)?Xe(e,t,s):(Je.pad=s,Je.soft=n?0:null,Je.mode=n?3:0,Xe(e,t,Ve))}function Ke(e,t){return null==e?t:e}function Xe(e,t,s){let n=s.min,a=s.max,o=Ke(n.pad,0),i=Ke(a.pad,0),l=Ke(n.hard,-ft),r=Ke(a.hard,ft),c=Ke(n.soft,ft),u=Ke(a.soft,-ft),d=Ke(n.mode,0),h=Ke(a.mode,0),f=t-e,p=ut(f),m=lt(st(e),st(t)),g=ut(m),y=st(g-p);(f<1e-24||y>10)&&(f=0,0!=e&&0!=t||(f=1e-24,2==d&&c!=ft&&(o=0),2==h&&u!=-ft&&(i=0)));let x=f||m||1e3,w=ut(x),b=rt(10,nt(w)),k=Tt(Ct(e-x*(0==f?0==e?.1:1:o),b/10),24),v=e>=c&&(1==d||3==d&&k<=c||2==d&&k>=c)?c:ft,S=lt(l,k<v&&e>=v?v:it(v,k)),_=Tt(jt(t+x*(0==f?0==t?.1:1:i),b/10),24),M=t<=u&&(1==h||3==h&&_>=u||2==h&&_<=u)?u:-ft,j=it(r,_>M&&t<=M?M:lt(M,_));return S==j&&0==S&&(j=100),[S,j]}const Qe=new Intl.NumberFormat(ye?be.language:"en-US"),Ze=e=>Qe.format(e),et=Math,tt=et.PI,st=et.abs,nt=et.floor,at=et.round,ot=et.ceil,it=et.min,lt=et.max,rt=et.pow,ct=et.sign,ut=et.log10,dt=et.log2,ht=(e,t=1)=>et.asinh(e/t),ft=1/0;function pt(e){return 1+(0|ut((e^e>>31)-(e>>31)))}function mt(e,t,s){return it(lt(e,t),s)}function gt(e){return"function"==typeof e}function yt(e){return gt(e)?e:()=>e}const xt=e=>e,wt=(e,t)=>t,bt=e=>null,kt=e=>!0,vt=(e,t)=>e==t,St=/\.\d*?(?=9{6,}|0{6,})/gm,_t=e=>{if(Rt(e)||Nt.has(e))return e;const t=`${e}`,s=t.match(St);if(null==s)return e;let n=s[0].length-1;if(-1!=t.indexOf("e-")){let[e,s]=t.split("e");return+`${_t(e)}e${s}`}return Tt(e,n)};function Mt(e,t){return _t(Tt(_t(e/t))*t)}function jt(e,t){return _t(ot(_t(e/t))*t)}function Ct(e,t){return _t(nt(_t(e/t))*t)}function Tt(e,t=0){if(Rt(e))return e;let s=10**t,n=e*s*(1+Number.EPSILON);return at(n)/s}const Nt=new Map;function Lt(e){return((""+e).split(".")[1]||"").length}function Pt(e,t,s,n){let a=[],o=n.map(Lt);for(let i=t;i<s;i++){let t=st(i),s=Tt(rt(e,i),t);for(let l=0;l<n.length;l++){let r=10==e?+`${n[l]}e${i}`:n[l]*s,c=(i>=0?0:t)+(i>=o[l]?0:o[l]),u=10==e?r:Tt(r,c);a.push(u),Nt.set(u,c)}}return a}const Et={},At=[],It=[null,null],Dt=Array.isArray,Rt=Number.isInteger;function zt(e){return"string"==typeof e}function Ft(e){let t=!1;if(null!=e){let s=e.constructor;t=null==s||s==Object}return t}function Ot(e){return null!=e&&"object"==typeof e}const $t=Object.getPrototypeOf(Uint8Array),Wt="__proto__";function Ht(e,t=Ft){let s;if(Dt(e)){let n=e.find(e=>null!=e);if(Dt(n)||t(n)){s=Array(e.length);for(let n=0;n<e.length;n++)s[n]=Ht(e[n],t)}else s=e.slice()}else if(e instanceof $t)s=e.slice();else if(t(e)){s={};for(let n in e)n!=Wt&&(s[n]=Ht(e[n],t))}else s=e;return s}function Bt(e){let t=arguments;for(let s=1;s<t.length;s++){let n=t[s];for(let t in n)t!=Wt&&(Ft(e[t])?Bt(e[t],Ht(n[t])):e[t]=Ht(n[t]))}return e}function Ut(e,t,s){for(let n,a=0,o=-1;a<t.length;a++){let i=t[a];if(i>o){for(n=i-1;n>=0&&null==e[n];)e[n--]=null;for(n=i+1;n<s&&null==e[n];)e[o=n++]=null}}}const qt="undefined"==typeof queueMicrotask?e=>Promise.resolve().then(e):queueMicrotask,Gt=["January","February","March","April","May","June","July","August","September","October","November","December"],Jt=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Vt(e){return e.slice(0,3)}const Yt=Jt.map(Vt),Kt=Gt.map(Vt),Xt={MMMM:Gt,MMM:Kt,WWWW:Jt,WWW:Yt};function Qt(e){return(e<10?"0":"")+e}const Zt={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,t)=>t.MMMM[e.getMonth()],MMM:(e,t)=>t.MMM[e.getMonth()],MM:e=>Qt(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>Qt(e.getDate()),D:e=>e.getDate(),WWWW:(e,t)=>t.WWWW[e.getDay()],WWW:(e,t)=>t.WWW[e.getDay()],HH:e=>Qt(e.getHours()),H:e=>e.getHours(),h:e=>{let t=e.getHours();return 0==t?12:t>12?t-12:t},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>Qt(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>Qt(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>{return((t=e.getMilliseconds())<10?"00":t<100?"0":"")+t;var t}};function es(e,t){t=t||Xt;let s,n=[],a=/\{([a-z]+)\}|[^{]+/gi;for(;s=a.exec(e);)n.push("{"==s[0][0]?Zt[s[1]]:s[0]);return e=>{let s="";for(let a=0;a<n.length;a++)s+="string"==typeof n[a]?n[a]:n[a](e,t);return s}}const ts=(new Intl.DateTimeFormat).resolvedOptions().timeZone,ss=e=>e%1==0,ns=[1,2,2.5,5],as=Pt(10,-32,0,ns),os=Pt(10,0,32,ns),is=os.filter(ss),ls=as.concat(os),rs="{YYYY}",cs="\n"+rs,us="{M}/{D}",ds="\n"+us,hs=ds+"/{YY}",fs="{aa}",ps="{h}:{mm}"+fs,ms="\n"+ps,gs=":{ss}",ys=null;function xs(e){let t=1e3*e,s=60*t,n=60*s,a=24*n,o=30*a,i=365*a;return[(1==e?Pt(10,0,3,ns).filter(ss):Pt(10,-3,0,ns)).concat([t,5*t,10*t,15*t,30*t,s,5*s,10*s,15*s,30*s,n,2*n,3*n,4*n,6*n,8*n,12*n,a,2*a,3*a,4*a,5*a,6*a,7*a,8*a,9*a,10*a,15*a,o,2*o,3*o,4*o,6*o,i,2*i,5*i,10*i,25*i,50*i,100*i]),[[i,rs,ys,ys,ys,ys,ys,ys,1],[28*a,"{MMM}",cs,ys,ys,ys,ys,ys,1],[a,us,cs,ys,ys,ys,ys,ys,1],[n,"{h}"+fs,hs,ys,ds,ys,ys,ys,1],[s,ps,hs,ys,ds,ys,ys,ys,1],[t,gs,hs+" "+ps,ys,ds+" "+ps,ys,ms,ys,1],[e,gs+".{fff}",hs+" "+ps,ys,ds+" "+ps,ys,ms,ys,1]],function(t){return(l,r,c,u,d,h)=>{let f=[],p=d>=i,m=d>=o&&d<i,g=t(c),y=Tt(g*e,3),x=Cs(g.getFullYear(),p?0:g.getMonth(),m||p?1:g.getDate()),w=Tt(x*e,3);if(m||p){let s=m?d/o:0,n=p?d/i:0,a=y==w?y:Tt(Cs(x.getFullYear()+n,x.getMonth()+s,1)*e,3),l=new Date(at(a/e)),r=l.getFullYear(),c=l.getMonth();for(let o=0;a<=u;o++){let i=Cs(r+n*o,c+s*o,1),l=i-t(Tt(i*e,3));a=Tt((+i+l)*e,3),a<=u&&f.push(a)}}else{let o=d>=a?a:d,i=w+(nt(c)-nt(y))+jt(y-w,o);f.push(i);let p=t(i),m=p.getHours()+p.getMinutes()/s+p.getSeconds()/n,g=d/n,x=h/l.axes[r]._space;for(;i=Tt(i+d,1==e?0:3),!(i>u);)if(g>1){let e=nt(Tt(m+g,6))%24,s=t(i).getHours()-e;s>1&&(s=-1),i-=s*n,m=(m+g)%24,Tt((i-f[f.length-1])/d,3)*x>=.7&&f.push(i)}else f.push(i)}return f}}]}const[ws,bs,ks]=xs(1),[vs,Ss,_s]=xs(.001);function Ms(e,t){return e.map(e=>e.map((s,n)=>0==n||8==n||null==s?s:t(1==n||0==e[8]?s:e[1]+s)))}function js(e,t){return(s,n,a,o,i)=>{let l,r,c,u,d,h,f=t.find(e=>i>=e[0])||t[t.length-1];return n.map(t=>{let s=e(t),n=s.getFullYear(),a=s.getMonth(),o=s.getDate(),i=s.getHours(),p=s.getMinutes(),m=s.getSeconds(),g=n!=l&&f[2]||a!=r&&f[3]||o!=c&&f[4]||i!=u&&f[5]||p!=d&&f[6]||m!=h&&f[7]||f[1];return l=n,r=a,c=o,u=i,d=p,h=m,g(s)})}}function Cs(e,t,s){return new Date(e,t,s)}function Ts(e,t){return t(e)}function Ns(e,t){return(s,n,a,o)=>null==o?ge:t(e(n))}Pt(2,-53,53,[1]);const Ls={show:!0,live:!0,isolate:!1,mount:()=>{},markers:{show:!0,width:2,stroke:function(e,t){let s=e.series[t];return s.width?s.stroke(e,t):s.points.width?s.points.stroke(e,t):null},fill:function(e,t){return e.series[t].fill(e,t)},dash:"solid"},idx:null,idxs:null,values:[]},Ps=[0,0];function Es(e,t,s,n=!0){return e=>{0==e.button&&(!n||e.target==t)&&s(e)}}function As(e,t,s,n=!0){return e=>{(!n||e.target==t)&&s(e)}}const Is={show:!0,x:!0,y:!0,lock:!1,move:function(e,t,s){return Ps[0]=t,Ps[1]=s,Ps},points:{one:!1,show:function(e,t){let s=e.cursor.points,n=Ce(),a=s.size(e,t);Me(n,ee,a),Me(n,te,a);let o=a/-2;Me(n,"marginLeft",o),Me(n,"marginTop",o);let i=s.width(e,t,a);return i&&Me(n,"borderWidth",i),n},size:function(e,t){return e.series[t].points.size},width:0,stroke:function(e,t){let s=e.series[t].points;return s._stroke||s._fill},fill:function(e,t){let s=e.series[t].points;return s._fill||s._stroke}},bind:{mousedown:Es,mouseup:Es,click:Es,dblclick:Es,mousemove:As,mouseleave:As,mouseenter:As},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,click:(e,t)=>{t.stopPropagation(),t.stopImmediatePropagation()},_x:!1,_y:!1},focus:{dist:(e,t,s,n,a)=>n-a,prox:-1,bias:0},hover:{skip:[void 0],prox:null,bias:0},left:-10,top:-10,idx:null,dataIdx:null,idxs:null,event:null},Ds={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},Rs=Bt({},Ds,{filter:wt}),zs=Bt({},Rs,{size:10}),Fs=Bt({},Ds,{show:!1}),Os='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',$s="bold "+Os,Ws={show:!0,scale:"x",stroke:ie,space:50,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:$s,side:2,grid:Rs,ticks:zs,border:Fs,font:Os,lineGap:1.5,rotate:0},Hs={show:!0,scale:"x",auto:!1,sorted:1,min:ft,max:-ft,idxs:[]};function Bs(e,t,s,n,a){return t.map(e=>null==e?"":Ze(e))}function Us(e,t,s,n,a,o,i){let l=[],r=Nt.get(a)||0;for(let c=s=i?s:Tt(jt(s,a),r);c<=n;c=Tt(c+a,r))l.push(Object.is(c,-0)?0:c);return l}function qs(e,t,s,n,a,o,i){const l=[],r=e.scales[e.axes[t].scale].log,c=nt((10==r?ut:dt)(s));a=rt(r,c),10==r&&(a=ls[Fe(a,ls)]);let u=s,d=a*r;10==r&&(d=ls[Fe(d,ls)]);do{l.push(u),u+=a,10!=r||Nt.has(u)||(u=Tt(u,Nt.get(a))),u>=d&&(d=(a=u)*r,10==r&&(d=ls[Fe(d,ls)]))}while(u<=n);return l}function Gs(e,t,s,n,a,o,i){let l=e.scales[e.axes[t].scale].asinh,r=n>l?qs(e,t,lt(l,s),n,a):[l],c=n>=0&&s<=0?[0]:[];return(s<-l?qs(e,t,lt(l,-n),-s,a):[l]).reverse().map(e=>-e).concat(c,r)}const Js=/./,Vs=/[12357]/,Ys=/[125]/,Ks=/1/,Xs=(e,t,s,n)=>e.map((e,a)=>4==t&&0==e||a%n==0&&s.test(e.toExponential()[e<0?1:0])?e:null);function Qs(e,t,s,n,a){let o=e.axes[s],i=o.scale,l=e.scales[i],r=e.valToPos,c=o._space,u=r(10,i),d=r(9,i)-u>=c?Js:r(7,i)-u>=c?Vs:r(5,i)-u>=c?Ys:Ks;if(d==Ks){let e=st(r(1,i)-u);if(e<c)return Xs(t.slice().reverse(),l.distr,d,ot(c/e)).reverse()}return Xs(t,l.distr,d,1)}function Zs(e,t,s,n,a){let o=e.axes[s],i=o.scale,l=o._space,r=e.valToPos,c=st(r(1,i)-r(2,i));return c<l?Xs(t.slice().reverse(),3,Js,ot(l/c)).reverse():t}function en(e,t,s,n){return null==n?ge:null==t?"":Ze(t)}const tn={show:!0,scale:"y",stroke:ie,space:30,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:$s,side:3,grid:Rs,ticks:zs,border:Fs,font:Os,lineGap:1.5,rotate:0},sn={scale:null,auto:!0,sorted:0,min:ft,max:-ft},nn=(e,t,s,n,a)=>a,an={show:!0,auto:!0,sorted:0,gaps:nn,alpha:1,facets:[Bt({},sn,{scale:"x"}),Bt({},sn,{scale:"y"})]},on={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:nn,alpha:1,points:{show:function(e,t){let{scale:s,idxs:n}=e.series[0],a=e._data[0],o=e.valToPos(a[n[0]],s,!0),i=e.valToPos(a[n[1]],s,!0),l=st(i-o)/(e.series[t].points.space*ke);return n[1]-n[0]<=l},filter:null},values:null,min:ft,max:-ft,idxs:[],path:null,clip:null};function ln(e,t,s,n,a){return s/10}const rn={time:!0,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},cn=Bt({},rn,{time:!1,ori:1}),un={};function dn(e,t){let s=un[e];return s||(s={key:e,plots:[],sub(e){s.plots.push(e)},unsub(e){s.plots=s.plots.filter(t=>t!=e)},pub(e,t,n,a,o,i,l){for(let r=0;r<s.plots.length;r++)s.plots[r]!=t&&s.plots[r].pub(e,t,n,a,o,i,l)}},null!=e&&(un[e]=s)),s}function hn(e,t,s){const n=e.mode,a=e.series[t],o=2==n?e._data[t]:e._data,i=e.scales,l=e.bbox;let r=o[0],c=2==n?o[1]:o[t],u=2==n?i[a.facets[0].scale]:i[e.series[0].scale],d=2==n?i[a.facets[1].scale]:i[a.scale],h=l.left,f=l.top,p=l.width,m=l.height,g=e.valToPosH,y=e.valToPosV;return 0==u.ori?s(a,r,c,u,d,g,y,h,f,p,m,bn,vn,_n,jn,Tn):s(a,r,c,u,d,y,g,f,h,m,p,kn,Sn,Mn,Cn,Nn)}function fn(e,t){let s=0,n=0,a=Ke(e.bands,At);for(let o=0;o<a.length;o++){let e=a[o];e.series[0]==t?s=e.dir:e.series[1]==t&&(1==e.dir?n|=1:n|=2)}return[s,1==n?-1:2==n?1:3==n?2:0]}function pn(e,t,s,n,a){let o=e.mode,i=e.series[t],l=2==o?i.facets[1].scale:i.scale,r=e.scales[l];return-1==a?r.min:1==a?r.max:3==r.distr?1==r.dir?r.min:r.max:0}function mn(e,t,s,n,a,o){return hn(e,t,(e,t,i,l,r,c,u,d,h,f,p)=>{let m=e.pxRound;const g=l.dir*(0==l.ori?1:-1),y=0==l.ori?vn:Sn;let x,w;1==g?(x=s,w=n):(x=n,w=s);let b=m(c(t[x],l,f,d)),k=m(u(i[x],r,p,h)),v=m(c(t[w],l,f,d)),S=m(u(1==o?r.max:r.min,r,p,h)),_=new Path2D(a);return y(_,v,S),y(_,b,S),y(_,b,k),_})}function gn(e,t,s,n,a,o){let i=null;if(e.length>0){i=new Path2D;const l=0==t?_n:Mn;let r=s;for(let t=0;t<e.length;t++){let s=e[t];if(s[1]>s[0]){let e=s[0]-r;e>0&&l(i,r,n,e,n+o),r=s[1]}}let c=s+a-r,u=10;c>0&&l(i,r,n-u/2,c,n+o+u)}return i}function yn(e,t,s,n,a,o,i){let l=[],r=e.length;for(let c=1==a?s:n;c>=s&&c<=n;c+=a)if(null===t[c]){let u=c,d=c;if(1==a)for(;++c<=n&&null===t[c];)d=c;else for(;--c>=s&&null===t[c];)d=c;let h=o(e[u]),f=d==u?h:o(e[d]),p=u-a;h=i<=0&&p>=0&&p<r?o(e[p]):h;let m=d+a;f=i>=0&&m>=0&&m<r?o(e[m]):f,f>=h&&l.push([h,f])}return l}function xn(e){return 0==e?xt:1==e?at:t=>Mt(t,e)}function wn(e){let t=0==e?bn:kn,s=0==e?(e,t,s,n,a,o)=>{e.arcTo(t,s,n,a,o)}:(e,t,s,n,a,o)=>{e.arcTo(s,t,a,n,o)},n=0==e?(e,t,s,n,a)=>{e.rect(t,s,n,a)}:(e,t,s,n,a)=>{e.rect(s,t,a,n)};return(e,a,o,i,l,r=0,c=0)=>{0==r&&0==c?n(e,a,o,i,l):(r=it(r,i/2,l/2),c=it(c,i/2,l/2),t(e,a+r,o),s(e,a+i,o,a+i,o+l,r),s(e,a+i,o+l,a,o+l,c),s(e,a,o+l,a,o,c),s(e,a,o,a+i,o,r),e.closePath())}}const bn=(e,t,s)=>{e.moveTo(t,s)},kn=(e,t,s)=>{e.moveTo(s,t)},vn=(e,t,s)=>{e.lineTo(t,s)},Sn=(e,t,s)=>{e.lineTo(s,t)},_n=wn(0),Mn=wn(1),jn=(e,t,s,n,a,o)=>{e.arc(t,s,n,a,o)},Cn=(e,t,s,n,a,o)=>{e.arc(s,t,n,a,o)},Tn=(e,t,s,n,a,o,i)=>{e.bezierCurveTo(t,s,n,a,o,i)},Nn=(e,t,s,n,a,o,i)=>{e.bezierCurveTo(s,t,a,n,i,o)};function Ln(e){return(e,t,s,n,a)=>hn(e,t,(t,o,i,l,r,c,u,d,h,f,p)=>{let m,g,{pxRound:y,points:x}=t;0==l.ori?(m=bn,g=jn):(m=kn,g=Cn);const w=Tt(x.width*ke,3);let b=(x.size-x.width)/2*ke,k=Tt(2*b,3),v=new Path2D,S=new Path2D,{left:_,top:M,width:j,height:C}=e.bbox;_n(S,_-k,M-k,j+2*k,C+2*k);const T=e=>{if(null!=i[e]){let t=y(c(o[e],l,f,d)),s=y(u(i[e],r,p,h));m(v,t+b,s),g(v,t,s,b,0,2*tt)}};if(a)a.forEach(T);else for(let e=s;e<=n;e++)T(e);return{stroke:w>0?v:null,fill:v,clip:S,flags:3}})}function Pn(e){return(t,s,n,a,o,i)=>{n!=a&&(o!=n&&i!=n&&e(t,s,n),o!=a&&i!=a&&e(t,s,a),e(t,s,i))}}const En=Pn(vn),An=Pn(Sn);function In(e){const t=Ke(null==e?void 0:e.alignGaps,0);return(e,s,n,a)=>hn(e,s,(o,i,l,r,c,u,d,h,f,p,m)=>{[n,a]=He(l,n,a);let g,y,x=o.pxRound,w=e=>x(u(e,r,p,h)),b=e=>x(d(e,c,m,f));0==r.ori?(g=vn,y=En):(g=Sn,y=An);const k=r.dir*(0==r.ori?1:-1),v={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:1},S=v.stroke;let _=!1;if(a-n>=4*p){let t,s,o,c=t=>e.posToVal(t,r.key,!0),u=null,d=null,h=w(i[1==k?n:a]),f=w(i[n]),p=w(i[a]),m=c(1==k?f+1:p-1);for(let e=1==k?n:a;e>=n&&e<=a;e+=k){let n=i[e],a=(1==k?n<m:n>m)?h:w(n),o=l[e];a==h?null!=o?(s=o,null==u?(g(S,a,b(s)),t=u=d=s):s<u?u=s:s>d&&(d=s)):null===o&&(_=!0):(null!=u&&y(S,h,b(u),b(d),b(t),b(s)),null!=o?(s=o,g(S,a,b(s)),u=d=t=s):(u=d=null,null===o&&(_=!0)),h=a,m=c(h+k))}null!=u&&u!=d&&o!=h&&y(S,h,b(u),b(d),b(t),b(s))}else for(let e=1==k?n:a;e>=n&&e<=a;e+=k){let t=l[e];null===t?_=!0:null!=t&&g(S,w(i[e]),b(t))}let[M,j]=fn(e,s);if(null!=o.fill||0!=M){let t=v.fill=new Path2D(S),l=b(o.fillTo(e,s,o.min,o.max,M)),r=w(i[n]),c=w(i[a]);-1==k&&([c,r]=[r,c]),g(t,c,l),g(t,r,l)}if(!o.spanGaps){let c=[];_&&c.push(...yn(i,l,n,a,k,w,t)),v.gaps=c=o.gaps(e,s,n,a,c),v.clip=gn(c,r.ori,h,f,p,m)}return 0!=j&&(v.band=2==j?[mn(e,s,n,a,S,-1),mn(e,s,n,a,S,1)]:mn(e,s,n,a,S,j)),v})}function Dn(e,t,s,n,a,o,i=ft){if(e.length>1){let l=null;for(let r=0,c=1/0;r<e.length;r++)if(void 0!==t[r]){if(null!=l){let t=st(e[r]-e[l]);t<c&&(c=t,i=st(s(e[r],n,a,o)-s(e[l],n,a,o)))}l=r}}return i}function Rn(e,t,s,n,a,o){const i=e.length;if(i<2)return null;const l=new Path2D;if(s(l,e[0],t[0]),2==i)n(l,e[1],t[1]);else{let s=Array(i),n=Array(i-1),o=Array(i-1),r=Array(i-1);for(let a=0;a<i-1;a++)o[a]=t[a+1]-t[a],r[a]=e[a+1]-e[a],n[a]=o[a]/r[a];s[0]=n[0];for(let e=1;e<i-1;e++)0===n[e]||0===n[e-1]||n[e-1]>0!=n[e]>0?s[e]=0:(s[e]=3*(r[e-1]+r[e])/((2*r[e]+r[e-1])/n[e-1]+(r[e]+2*r[e-1])/n[e]),isFinite(s[e])||(s[e]=0));s[i-1]=n[i-2];for(let c=0;c<i-1;c++)a(l,e[c]+r[c]/3,t[c]+s[c]*r[c]/3,e[c+1]-r[c]/3,t[c+1]-s[c+1]*r[c]/3,e[c+1],t[c+1])}return l}const zn=new Set;function Fn(){for(let e of zn)e.syncRect(!0)}ye&&(Re("resize",we,Fn),Re("scroll",we,Fn,!0),Re(me,we,()=>{Qn.pxRatio=ke}));const On=In(),$n=Ln();function Wn(e,t,s,n){return(n?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map((e,n)=>Hn(e,n,t,s))}function Hn(e,t,s,n){return Bt({},0==t?s:n,e)}function Bn(e,t,s){return null==t?It:[t,s]}const Un=Bn;function qn(e,t,s){return null==t?It:Ye(t,s,.1,!0)}function Gn(e,t,s,n){return null==t?It:Ue(t,s,e.scales[n].log,!1)}const Jn=Gn;function Vn(e,t,s,n){return null==t?It:qe(t,s,e.scales[n].log,!1)}const Yn=Vn;function Kn(e){let t,s;return[e=e.replace(/(\d+)px/,(e,n)=>(t=at((s=+n)*ke))+"px"),t,s]}function Xn(e){e.show&&[e.font,e.labelFont].forEach(e=>{let t=Tt(e[2]*ke,1);e[0]=e[0].replace(/[0-9.]+px/,t+"px"),e[1]=t})}function Qn(e,t,s){const n={mode:Ke(e.mode,1)},a=n.mode;function o(e,t,s,n){let a=t.valToPct(e);return n+s*(-1==t.dir?1-a:a)}function i(e,t,s,n){let a=t.valToPct(e);return n+s*(-1==t.dir?a:1-a)}function l(e,t,s,n){return 0==t.ori?o(e,t,s,n):i(e,t,s,n)}n.valToPosH=o,n.valToPosV=i;let r=!1;n.status=0;const c=n.root=Ce("uplot");null!=e.id&&(c.id=e.id),Se(c,e.class),e.title&&(Ce("u-title",c).textContent=e.title);const u=je("canvas"),d=n.ctx=u.getContext("2d"),h=Ce("u-wrap",c);Re("click",h,e=>{e.target===p&&(Nn!=Mn||Ln!=jn)&&Zn.click(n,e)},!0);const f=n.under=Ce("u-under",h);h.appendChild(u);const p=n.over=Ce("u-over",h),m=+Ke((e=Ht(e)).pxAlign,1),g=xn(m);(e.plugins||[]).forEach(t=>{t.opts&&(e=t.opts(n,e)||e)});const y=e.ms||.001,x=n.series=1==a?Wn(e.series||[],Hs,on,!1):(w=e.series||[null],b=an,w.map((e,t)=>0==t?{}:Bt({},b,e)));var w,b;const k=n.axes=Wn(e.axes||[],Ws,tn,!0),v=n.scales={},S=n.bands=e.bands||[];S.forEach(e=>{e.fill=yt(e.fill||null),e.dir=Ke(e.dir,-1)});const _=2==a?x[1].facets[0].scale:x[0].scale,M={axes:function(){for(let e=0;e<k.length;e++){let t=k[e];if(!t.show||!t._show)continue;let s,a,o=t.side,i=o%2,r=t.stroke(n,e),c=0==o||3==o?-1:1,[u,h]=t._found;if(null!=t.label){let l=t.labelGap*c,f=at((t._lpos+l)*ke);Js(t.labelFont[0],r,"center",2==o?se:ne),d.save(),1==i?(s=a=0,d.translate(f,at(dt+St/2)),d.rotate((3==o?-tt:tt)/2)):(s=at(ct+xt/2),a=f);let p=gt(t.label)?t.label(n,e,u,h):t.label;d.fillText(p,s,a),d.restore()}if(0==h)continue;let f=v[t.scale],p=0==i?xt:St,m=0==i?ct:dt,y=t._splits,x=2==f.distr?y.map(e=>Rs[e]):y,w=2==f.distr?Rs[y[1]]-Rs[y[0]]:u,b=t.ticks,S=t.border,_=b.show?b.size:0,M=at(_*ke),j=at((2==t.alignTo?t._size-_-t.gap:t.gap)*ke),C=t._rotate*-tt/180,T=g(t._pos*ke),N=T+(M+j)*c;a=0==i?N:0,s=1==i?N:0,Js(t.font[0],r,1==t.align?ae:2==t.align?oe:C>0?ae:C<0?oe:0==i?"center":3==o?oe:ae,C||1==i?"middle":2==o?se:ne);let L=t.font[1]*t.lineGap,P=y.map(e=>g(l(e,f,p,m))),E=t._values;for(let e=0;e<E.length;e++){let t=E[e];if(null!=t){0==i?s=P[e]:a=P[e],t=""+t;let n=-1==t.indexOf("\n")?[t]:t.split(/\n/gm);for(let e=0;e<n.length;e++){let t=n[e];C?(d.save(),d.translate(s,a+e*L),d.rotate(C),d.fillText(t,0,0),d.restore()):d.fillText(t,s,a+e*L)}}}b.show&&fn(P,b.filter(n,x,e,h,w),i,o,T,M,Tt(b.width*ke,3),b.stroke(n,e),b.dash,b.cap);let A=t.grid;A.show&&fn(P,A.filter(n,x,e,h,w),i,0==i?2:1,0==i?dt:ct,0==i?St:xt,Tt(A.width*ke,3),A.stroke(n,e),A.dash,A.cap),S.show&&fn([T],[1],0==i?1:0,0==i?1:2,1==i?dt:ct,1==i?St:xt,Tt(S.width*ke,3),S.stroke(n,e),S.dash,S.cap)}Da("drawAxes")},series:function(){if(us>0){let e=x.some(e=>e._focus)&&Ds!=Yt.alpha;e&&(d.globalAlpha=Ds=Yt.alpha),x.forEach((e,s)=>{if(s>0&&e.show&&(Ks(s,!1),Ks(s,!0),null==e._paths)){let o=Ds;Ds!=e.alpha&&(d.globalAlpha=Ds=e.alpha);let i=2==a?[0,t[s][0].length-1]:function(e){let t=mt(ds-1,0,us-1),s=mt(hs+1,0,us-1);for(;null==e[t]&&t>0;)t--;for(;null==e[s]&&s<us-1;)s++;return[t,s]}(t[s]);e._paths=e.paths(n,s,i[0],i[1]),Ds!=o&&(d.globalAlpha=Ds=o)}}),x.forEach((e,t)=>{if(t>0&&e.show){let s=Ds;Ds!=e.alpha&&(d.globalAlpha=Ds=e.alpha),null!=e._paths&&Xs(t,!1);{let s=null!=e._paths?e._paths.gaps:null,a=e.points.show(n,t,ds,hs,s),o=e.points.filter(n,t,a,s);(a||o)&&(e.points._paths=e.points.paths(n,t,ds,hs,o),Xs(t,!0))}Ds!=s&&(d.globalAlpha=Ds=s),Da("drawSeries",t)}}),e&&(d.globalAlpha=Ds=1)}}},j=(e.drawOrder||["axes","series"]).map(e=>M[e]);function C(e){const t=3==e.distr?t=>ut(t>0?t:e.clamp(n,t,e.min,e.max,e.key)):4==e.distr?t=>ht(t,e.asinh):100==e.distr?t=>e.fwd(t):e=>e;return s=>{let n=t(s),{_min:a,_max:o}=e;return(n-a)/(o-a)}}function T(t){let s=v[t];if(null==s){let n=(e.scales||Et)[t]||Et;if(null!=n.from){T(n.from);let e=Bt({},v[n.from],n,{key:t});e.valToPct=C(e),v[t]=e}else{s=v[t]=Bt({},t==_?rn:cn,n),s.key=t;let e=s.time,o=s.range,i=Dt(o);if((t!=_||2==a&&!e)&&(!i||null!=o[0]&&null!=o[1]||(o={min:null==o[0]?Ge:{mode:1,hard:o[0],soft:o[0]},max:null==o[1]?Ge:{mode:1,hard:o[1],soft:o[1]}},i=!1),!i&&Ft(o))){let e=o;o=(t,s,n)=>null==s?It:Ye(s,n,e)}s.range=yt(o||(e?Un:t==_?3==s.distr?Jn:4==s.distr?Yn:Bn:3==s.distr?Gn:4==s.distr?Vn:qn)),s.auto=yt(!i&&s.auto),s.clamp=yt(s.clamp||ln),s._min=s._max=null,s.valToPct=C(s)}}}T("x"),T("y"),1==a&&x.forEach(e=>{T(e.scale)}),k.forEach(e=>{T(e.scale)});for(let Q in e.scales)T(Q);const N=v[_],L=N.distr;let P,E;0==N.ori?(Se(c,"u-hz"),P=o,E=i):(Se(c,"u-vt"),P=i,E=o);const A={};for(let Q in v){let e=v[Q];null==e.min&&null==e.max||(A[Q]={min:e.min,max:e.max},e.min=e.max=null)}const I=e.tzDate||(e=>new Date(at(e/y))),D=e.fmtDate||es,R=1==y?ks(I):_s(I),z=js(I,Ms(1==y?bs:Ss,D)),F=Ns(I,Ts("{YYYY}-{MM}-{DD} {h}:{mm}{aa}",D)),O=[],$=n.legend=Bt({},Ls,e.legend),W=n.cursor=Bt({},Is,{drag:{y:2==a}},e.cursor),H=$.show,B=W.show,U=$.markers;let q,G,J;$.idxs=O,U.width=yt(U.width),U.dash=yt(U.dash),U.stroke=yt(U.stroke),U.fill=yt(U.fill);let V,Y=[],K=[],X=!1,ie={};if($.live){const e=x[1]?x[1].values:null;X=null!=e,V=X?e(n,1,0):{_:0};for(let t in V)ie[t]=ge}if(H)if(q=je("table","u-legend",c),J=je("tbody",null,q),$.mount(n,q),X){G=je("thead",null,q,J);let e=je("tr",null,G);for(var pe in je("th",null,e),V)je("th",Z,e).textContent=pe}else Se(q,"u-inline"),$.live&&Se(q,"u-live");const ye={show:!0},be={show:!1},ve=new Map;function Te(e,t,s,a=!0){const o=ve.get(t)||{},i=W.bind[e](n,t,s,a);i&&(Re(e,t,o[e]=i),ve.set(t,o))}function Le(e,t,s){const n=ve.get(t)||{};for(let a in n)null!=e&&a!=e||(ze(a,t,n[a]),delete n[a]);null==e&&ve.delete(t)}let Ee=0,Ie=0,De=0,Oe=0,Je=0,Ve=0,Xe=Je,Qe=Ve,Ze=De,nt=Oe,ct=0,dt=0,xt=0,St=0;n.bbox={};let _t=!1,jt=!1,Ct=!1,Pt=!1,Rt=!1,$t=!1;function Wt(e,t,s){(s||e!=n.width||t!=n.height)&&Ut(e,t),yn(!1),Ct=!0,jt=!0,Dn()}function Ut(e,t){n.width=Ee=De=e,n.height=Ie=Oe=t,Je=Ve=0,function(){let e=!1,t=!1,s=!1,n=!1;k.forEach((a,o)=>{if(a.show&&a._show){let{side:o,_size:i}=a,l=o%2,r=i+(null!=a.label?a.labelSize:0);r>0&&(l?(De-=r,3==o?(Je+=r,n=!0):s=!0):(Oe-=r,0==o?(Ve+=r,e=!0):t=!0))}}),as[0]=e,as[1]=s,as[2]=t,as[3]=n,De-=cs[1]+cs[3],Je+=cs[3],Oe-=cs[2]+cs[0],Ve+=cs[0]}(),function(){let e=Je+De,t=Ve+Oe,s=Je,n=Ve;function a(a,o){switch(a){case 1:return e+=o,e-o;case 2:return t+=o,t-o;case 3:return s-=o,s+o;case 0:return n-=o,n+o}}k.forEach((e,t)=>{if(e.show&&e._show){let t=e.side;e._pos=a(t,e._size),null!=e.label&&(e._lpos=a(t,e.labelSize))}})}();let s=n.bbox;ct=s.left=Mt(Je*ke,.5),dt=s.top=Mt(Ve*ke,.5),xt=s.width=Mt(De*ke,.5),St=s.height=Mt(Oe*ke,.5)}const Gt=3;if(n.setSize=function({width:e,height:t}){Wt(e,t)},null==W.dataIdx){let e=W.hover,s=e.skip=new Set(e.skip??[]);s.add(void 0);let n=e.prox=yt(e.prox),a=e.bias??(e.bias=0);W.dataIdx=(e,o,i,l)=>{if(0==o)return i;let r=i,c=n(e,o,i,l)??ft,u=c>=0&&c<ft,d=0==N.ori?De:Oe,h=W.left,f=t[0],p=t[o];if(s.has(p[i])){r=null;let e,t=null,n=null;if(0==a||-1==a)for(e=i;null==t&&e-- >0;)s.has(p[e])||(t=e);if(0==a||1==a)for(e=i;null==n&&e++<p.length;)s.has(p[e])||(n=e);if(null!=t||null!=n)if(u){let e=h-(null==t?-1/0:P(f[t],N,d,0)),s=(null==n?1/0:P(f[n],N,d,0))-h;e<=s?e<=c&&(r=t):s<=c&&(r=n)}else r=null==n?t:null==t?n:i-t<=n-i?t:n}else u&&st(h-P(f[i],N,d,0))>c&&(r=null);return r}}const Jt=e=>{W.event=e};W.idxs=O,W._lock=!1;let Vt=W.points;Vt.show=yt(Vt.show),Vt.size=yt(Vt.size),Vt.stroke=yt(Vt.stroke),Vt.width=yt(Vt.width),Vt.fill=yt(Vt.fill);const Yt=n.focus=Bt({},e.focus||{alpha:.3},W.focus),Kt=Yt.prox>=0,Xt=Kt&&Vt.one;let Qt=[],Zt=[],ts=[];function ss(e,t){let s=Vt.show(n,t);if(s instanceof HTMLElement)return Se(s,"u-cursor-pt"),Se(s,e.class),Ne(s,-10,-10,De,Oe),p.insertBefore(s,Qt[t]),s}function ns(e,t){if(1==a||t>0){let t=1==a&&v[e.scale].time,s=e.value;e.value=t?zt(s)?Ns(I,Ts(s,D)):s||F:s||en,e.label=e.label||(t?"Time":"Value")}if(Xt||t>0){e.width=null==e.width?1:e.width,e.paths=e.paths||On||bt,e.fillTo=yt(e.fillTo||pn),e.pxAlign=+Ke(e.pxAlign,m),e.pxRound=xn(e.pxAlign),e.stroke=yt(e.stroke||null),e.fill=yt(e.fill||null),e._stroke=e._fill=e._paths=e._focus=null;let t=Tt(1*(3+2*(lt(1,e.width)||1)),3),s=e.points=Bt({},{size:t,width:lt(1,.2*t),stroke:e.stroke,space:2*t,paths:$n,_stroke:null,_fill:null},e.points);s.show=yt(s.show),s.filter=yt(s.filter),s.fill=yt(s.fill),s.stroke=yt(s.stroke),s.paths=yt(s.paths),s.pxAlign=e.pxAlign}if(H){let s=function(e,t){if(0==t&&(X||!$.live||2==a))return It;let s=[],o=je("tr","u-series",J,J.childNodes[t]);Se(o,e.class),e.show||Se(o,Q);let i=je("th",null,o);if(U.show){let e=Ce("u-marker",i);if(t>0){let s=U.width(n,t);s&&(e.style.border=s+"px "+U.dash(n,t)+" "+U.stroke(n,t)),e.style.background=U.fill(n,t)}}let l=Ce(Z,i);for(var r in e.label instanceof HTMLElement?l.appendChild(e.label):l.textContent=e.label,t>0&&(U.show||(l.style.color=e.width>0?U.stroke(n,t):U.fill(n,t)),Te("click",i,t=>{if(W._lock)return;Jt(t);let s=x.indexOf(e);if((t.ctrlKey||t.metaKey)!=$.isolate){let e=x.some((e,t)=>t>0&&t!=s&&e.show);x.forEach((t,n)=>{n>0&&ia(n,e?n==s?ye:be:ye,!0,za.setSeries)})}else ia(s,{show:!e.show},!0,za.setSeries)},!1),Kt&&Te(de,i,t=>{W._lock||(Jt(t),ia(x.indexOf(e),ua,!0,za.setSeries))},!1)),V){let e=je("td","u-value",o);e.textContent="--",s.push(e)}return[o,s]}(e,t);Y.splice(t,0,s[0]),K.splice(t,0,s[1]),$.values.push(null)}if(B){O.splice(t,0,null);let s=null;Xt?0==t&&(s=ss(e,t)):t>0&&(s=ss(e,t)),Qt.splice(t,0,s),Zt.splice(t,0,0),ts.splice(t,0,0)}Da("addSeries",t)}n.addSeries=function(e,t){t=null==t?x.length:t,e=1==a?Hn(e,t,Hs,on):Hn(e,t,{},an),x.splice(t,0,e),ns(x[t],t)},n.delSeries=function(e){if(x.splice(e,1),H){$.values.splice(e,1),K.splice(e,1);let t=Y.splice(e,1)[0];Le(null,t.firstChild),t.remove()}B&&(O.splice(e,1),Qt.splice(e,1)[0].remove(),Zt.splice(e,1),ts.splice(e,1)),Da("delSeries",e)};const as=[!1,!1,!1,!1];function os(e,t,s,n){let[a,o,i,l]=s,r=t%2,c=0;return 0==r&&(l||o)&&(c=0==t&&!a||2==t&&!i?at(Ws.size/3):0),1==r&&(a||i)&&(c=1==t&&!o||3==t&&!l?at(tn.size/2):0),c}const rs=n.padding=(e.padding||[os,os,os,os]).map(e=>yt(Ke(e,os))),cs=n._padding=rs.map((e,t)=>e(n,t,as,0));let us,ds=null,hs=null;const fs=1==a?x[0].idxs:null;let ps,ms,gs,ys,xs,Cs,Ps,Es,As,Ds,Rs=null,zs=!1;function Fs(e,s){if(t=null==e?[]:e,n.data=n._data=t,2==a){us=0;for(let e=1;e<x.length;e++)us+=t[e][0].length}else{0==t.length&&(n.data=n._data=t=[[]]),Rs=t[0],us=Rs.length;let e=t;if(2==L){e=t.slice();let s=e[0]=Array(us);for(let e=0;e<us;e++)s[e]=e}n._data=t=e}if(yn(!0),Da("setData"),2==L&&(Ct=!0),!1!==s){let e=N;e.auto(n,zs)?Os():oa(_,e.min,e.max),Pt=Pt||W.left>=0,$t=!0,Dn()}}function Os(){let e,s;zs=!0,1==a&&(us>0?(ds=fs[0]=0,hs=fs[1]=us-1,e=t[0][ds],s=t[0][hs],2==L?(e=ds,s=hs):e==s&&(3==L?[e,s]=Ue(e,e,N.log,!1):4==L?[e,s]=qe(e,e,N.log,!1):N.time?s=e+at(86400/y):[e,s]=Ye(e,s,.1,!0))):(ds=fs[0]=e=null,hs=fs[1]=s=null)),oa(_,e,s)}function $s(e,t,s,n,a,o){e??(e=le),s??(s=At),n??(n="butt"),a??(a=le),o??(o="round"),e!=ps&&(d.strokeStyle=ps=e),a!=ms&&(d.fillStyle=ms=a),t!=gs&&(d.lineWidth=gs=t),o!=xs&&(d.lineJoin=xs=o),n!=Cs&&(d.lineCap=Cs=n),s!=ys&&d.setLineDash(ys=s)}function Js(e,t,s,n){t!=ms&&(d.fillStyle=ms=t),e!=Ps&&(d.font=Ps=e),s!=Es&&(d.textAlign=Es=s),n!=As&&(d.textBaseline=As=n)}function Vs(e,t,s,a,o=0){if(a.length>0&&e.auto(n,zs)&&(null==t||null==t.min)){let t=Ke(ds,0),n=Ke(hs,a.length-1),i=null==s.min?function(e,t,s,n=0,a=!1){let o=a?Be:He,i=a?We:$e;[t,s]=o(e,t,s);let l=e[t],r=e[t];if(t>-1)if(1==n)l=e[t],r=e[s];else if(-1==n)l=e[s],r=e[t];else for(let c=t;c<=s;c++){let t=e[c];i(t)&&(t<l?l=t:t>r&&(r=t))}return[l??ft,r??-ft]}(a,t,n,o,3==e.distr):[s.min,s.max];e.min=it(e.min,s.min=i[0]),e.max=lt(e.max,s.max=i[1])}}n.setData=Fs;const Ys={min:null,max:null};function Ks(e,t){let s=t?x[e].points:x[e];s._stroke=s.stroke(n,e),s._fill=s.fill(n,e)}function Xs(e,s){let a=s?x[e].points:x[e],{stroke:o,fill:i,clip:l,flags:r,_stroke:c=a._stroke,_fill:u=a._fill,_width:h=a.width}=a._paths;h=Tt(h*ke,3);let f=null,p=h%2/2;s&&null==u&&(u=h>0?"#fff":c);let m=1==a.pxAlign&&p>0;if(m&&d.translate(p,p),!s){let e=ct-h/2,t=dt-h/2,s=xt+h,n=St+h;f=new Path2D,f.rect(e,t,s,n)}s?nn(c,h,a.dash,a.cap,u,o,i,r,l):function(e,s,a,o,i,l,r,c,u,d,h){let f=!1;0!=u&&S.forEach((p,m)=>{if(p.series[0]==e){let e,g=x[p.series[1]],y=t[p.series[1]],w=(g._paths||Et).band;Dt(w)&&(w=1==p.dir?w[0]:w[1]);let b=null;g.show&&w&&function(e,t,s){for(t=Ke(t,0),s=Ke(s,e.length-1);t<=s;){if(null!=e[t])return!0;t++}return!1}(y,ds,hs)?(b=p.fill(n,m)||l,e=g._paths.clip):w=null,nn(s,a,o,i,b,r,c,u,d,h,e,w),f=!0}}),f||nn(s,a,o,i,l,r,c,u,d,h)}(e,c,h,a.dash,a.cap,u,o,i,r,f,l),m&&d.translate(-p,-p)}const sn=3;function nn(e,t,s,n,a,o,i,l,r,c,u,h){$s(e,t,s,n,a),(r||c||h)&&(d.save(),r&&d.clip(r),c&&d.clip(c)),h?(l&sn)==sn?(d.clip(h),u&&d.clip(u),hn(a,i),un(e,o,t)):2&l?(hn(a,i),d.clip(h),un(e,o,t)):1&l&&(d.save(),d.clip(h),u&&d.clip(u),hn(a,i),d.restore(),un(e,o,t)):(hn(a,i),un(e,o,t)),(r||c||h)&&d.restore()}function un(e,t,s){s>0&&(t instanceof Map?t.forEach((e,t)=>{d.strokeStyle=ps=t,d.stroke(e)}):null!=t&&e&&d.stroke(t))}function hn(e,t){t instanceof Map?t.forEach((e,t)=>{d.fillStyle=ms=t,d.fill(e)}):null!=t&&e&&d.fill(t)}function fn(e,t,s,n,a,o,i,l,r,c){let u=i%2/2;1==m&&d.translate(u,u),$s(l,i,r,c,l),d.beginPath();let h,f,p,g,y=a+(0==n||3==n?-o:o);0==s?(f=a,g=y):(h=a,p=y);for(let m=0;m<e.length;m++)null!=t[m]&&(0==s?h=p=e[m]:f=g=e[m],d.moveTo(h,f),d.lineTo(p,g));d.stroke(),1==m&&d.translate(-u,-u)}function mn(e){let t=!0;return k.forEach((s,a)=>{if(!s.show)return;let o=v[s.scale];if(null==o.min)return void(s._show&&(t=!1,s._show=!1,yn(!1)));s._show||(t=!1,s._show=!0,yn(!1));let i=s.side,l=i%2,{min:r,max:c}=o,[u,d]=function(e,t,s,a){let o,i=k[e];if(a<=0)o=[0,0];else{let l=i._space=i.space(n,e,t,s,a);o=function(e,t,s,n,a){let o=lt(pt(e),pt(t)),i=t-e,l=Fe(a/n*i,s);do{let e=s[l],t=n*e/i;if(t>=a&&o+(e<5?Nt.get(e):0)<=17)return[e,t]}while(++l<s.length);return[0,0]}(t,s,i._incrs=i.incrs(n,e,t,s,a,l),a,l)}return i._found=o}(a,r,c,0==l?De:Oe);if(0==d)return;let h=2==o.distr,f=s._splits=s.splits(n,a,r,c,u,d,h),p=2==o.distr?f.map(e=>Rs[e]):f,m=2==o.distr?Rs[f[1]]-Rs[f[0]]:u,g=s._values=s.values(n,s.filter(n,p,a,d,m),a,d,m);s._rotate=2==i?s.rotate(n,g,a,d):0;let y=s._size;s._size=ot(s.size(n,g,a,e)),null!=y&&s._size!=y&&(t=!1)}),t}function gn(e){let t=!0;return rs.forEach((s,a)=>{let o=s(n,a,as,e);o!=cs[a]&&(t=!1),cs[a]=o}),t}function yn(e){x.forEach((t,s)=>{s>0&&(t._paths=null,e&&(1==a?(t.min=null,t.max=null):t.facets.forEach(e=>{e.min=null,e.max=null})))})}let wn,bn,kn,vn,Sn,_n,Mn,jn,Cn,Tn,Nn,Ln,Pn=!1,En=!1,An=[];function In(){En=!1;for(let e=0;e<An.length;e++)Da(...An[e]);An.length=0}function Dn(){Pn||(qt(Rn),Pn=!0)}function Rn(){if(_t&&(function(){for(let t in v){let e=v[t];null==A[t]&&(null==e.min||null!=A[_]&&e.auto(n,zs))&&(A[t]=Ys)}for(let t in v){let e=v[t];null==A[t]&&null!=e.from&&null!=A[e.from]&&(A[t]=Ys)}null!=A[_]&&yn(!0);let e={};for(let t in A){let s=A[t];if(null!=s){let o=e[t]=Ht(v[t],Ot);if(null!=s.min)Bt(o,s);else if(t!=_||2==a)if(0==us&&null==o.from){let e=o.range(n,null,null,t);o.min=e[0],o.max=e[1]}else o.min=ft,o.max=-ft}}if(us>0){x.forEach((s,o)=>{if(1==a){let a=s.scale,i=A[a];if(null==i)return;let l=e[a];if(0==o){let e=l.range(n,l.min,l.max,a);l.min=e[0],l.max=e[1],ds=Fe(l.min,t[0]),hs=Fe(l.max,t[0]),hs-ds>1&&(t[0][ds]<l.min&&ds++,t[0][hs]>l.max&&hs--),s.min=Rs[ds],s.max=Rs[hs]}else s.show&&s.auto&&Vs(l,i,s,t[o],s.sorted);s.idxs[0]=ds,s.idxs[1]=hs}else if(o>0&&s.show&&s.auto){let[n,a]=s.facets,i=n.scale,l=a.scale,[r,c]=t[o],u=e[i],d=e[l];null!=u&&Vs(u,A[i],n,r,n.sorted),null!=d&&Vs(d,A[l],a,c,a.sorted),s.min=a.min,s.max=a.max}});for(let t in e){let s=e[t],a=A[t];if(null==s.from&&(null==a||null==a.min)){let e=s.range(n,s.min==ft?null:s.min,s.max==-ft?null:s.max,t);s.min=e[0],s.max=e[1]}}}for(let t in e){let s=e[t];if(null!=s.from){let a=e[s.from];if(null==a.min)s.min=s.max=null;else{let e=s.range(n,a.min,a.max,t);s.min=e[0],s.max=e[1]}}}let s={},o=!1;for(let t in e){let n=e[t],a=v[t];if(a.min!=n.min||a.max!=n.max){a.min=n.min,a.max=n.max;let e=a.distr;a._min=3==e?ut(a.min):4==e?ht(a.min,a.asinh):100==e?a.fwd(a.min):a.min,a._max=3==e?ut(a.max):4==e?ht(a.max,a.asinh):100==e?a.fwd(a.max):a.max,s[t]=o=!0}}if(o){x.forEach((e,t)=>{2==a?t>0&&s.y&&(e._paths=null):s[e.scale]&&(e._paths=null)});for(let e in s)Ct=!0,Da("setScale",e);B&&W.left>=0&&(Pt=$t=!0)}for(let t in A)A[t]=null}(),_t=!1),Ct&&(function(){let e=!1,t=0;for(;!e;){t++;let s=mn(t),a=gn(t);e=t==Gt||s&&a,e||(Ut(n.width,n.height),jt=!0)}}(),Ct=!1),jt){if(Me(f,ae,Je),Me(f,se,Ve),Me(f,ee,De),Me(f,te,Oe),Me(p,ae,Je),Me(p,se,Ve),Me(p,ee,De),Me(p,te,Oe),Me(h,ee,Ee),Me(h,te,Ie),u.width=at(Ee*ke),u.height=at(Ie*ke),k.forEach(({_el:e,_show:t,_size:s,_pos:n,side:a})=>{if(null!=e)if(t){let t=a%2==1;Me(e,t?"left":"top",n-(3===a||0===a?s:0)),Me(e,t?"width":"height",s),Me(e,t?"top":"left",t?Ve:Je),Me(e,t?"height":"width",t?Oe:De),_e(e,Q)}else Se(e,Q)}),ps=ms=gs=xs=Cs=Ps=Es=As=ys=null,Ds=1,ba(!0),Je!=Xe||Ve!=Qe||De!=Ze||Oe!=nt){yn(!1);let e=De/Ze,t=Oe/nt;if(B&&!Pt&&W.left>=0){W.left*=e,W.top*=t,kn&&Ne(kn,at(W.left),0,De,Oe),vn&&Ne(vn,0,at(W.top),De,Oe);for(let s=0;s<Qt.length;s++){let n=Qt[s];null!=n&&(Zt[s]*=e,ts[s]*=t,Ne(n,ot(Zt[s]),ot(ts[s]),De,Oe))}}if(sa.show&&!Rt&&sa.left>=0&&sa.width>0){sa.left*=e,sa.width*=e,sa.top*=t,sa.height*=t;for(let e in Sa)Me(na,e,sa[e])}Xe=Je,Qe=Ve,Ze=De,nt=Oe}Da("setSize"),jt=!1}Ee>0&&Ie>0&&(d.clearRect(0,0,u.width,u.height),Da("drawClear"),j.forEach(e=>e()),Da("draw")),sa.show&&Rt&&(aa(sa),Rt=!1),B&&Pt&&(xa(null,!0,!1),Pt=!1),$.show&&$.live&&$t&&(ga(),$t=!1),r||(r=!0,n.status=1,Da("ready")),zs=!1,Pn=!1}function Fn(e,s){let a=v[e];if(null==a.from){if(0==us){let t=a.range(n,s.min,s.max,e);s.min=t[0],s.max=t[1]}if(s.min>s.max){let e=s.min;s.min=s.max,s.max=e}if(us>1&&null!=s.min&&null!=s.max&&s.max-s.min<1e-16)return;e==_&&2==a.distr&&us>0&&(s.min=Fe(s.min,t[0]),s.max=Fe(s.max,t[0]),s.min==s.max&&s.max++),A[e]=s,_t=!0,Dn()}}n.batch=function(e,t=!1){Pn=!0,En=t,e(n),Rn(),t&&An.length>0&&queueMicrotask(In)},n.redraw=(e,t)=>{Ct=t||!1,!1!==e?oa(_,N.min,N.max):Dn()},n.setScale=Fn;let Qn=!1;const Zn=W.drag;let ea=Zn.x,ta=Zn.y;B&&(W.x&&(wn=Ce("u-cursor-x",p)),W.y&&(bn=Ce("u-cursor-y",p)),0==N.ori?(kn=wn,vn=bn):(kn=bn,vn=wn),Nn=W.left,Ln=W.top);const sa=n.select=Bt({show:!0,over:!0,left:0,width:0,top:0,height:0},e.select),na=sa.show?Ce("u-select",sa.over?p:f):null;function aa(e,t){if(sa.show){for(let t in e)sa[t]=e[t],t in Sa&&Me(na,t,e[t]);!1!==t&&Da("setSelect")}}function oa(e,t,s){Fn(e,{min:t,max:s})}function ia(e,t,s,o){null!=t.focus&&function(e){if(e!=ca){let t=null==e,s=1!=Yt.alpha;x.forEach((n,o)=>{if(1==a||o>0){let a=t||0==o||o==e;n._focus=t?null:a,s&&function(e,t){x[e].alpha=t,B&&null!=Qt[e]&&(Qt[e].style.opacity=t),H&&Y[e]&&(Y[e].style.opacity=t)}(o,a?1:Yt.alpha)}}),ca=e,s&&Dn()}}(e),null!=t.show&&x.forEach((s,n)=>{n>0&&(e==n||null==e)&&(s.show=t.show,function(e){if(x[e].show)H&&_e(Y[e],Q);else if(H&&Se(Y[e],Q),B){let t=Xt?Qt[0]:Qt[e];null!=t&&Ne(t,-10,-10,De,Oe)}}(n),2==a?(oa(s.facets[0].scale,null,null),oa(s.facets[1].scale,null,null)):oa(s.scale,null,null),Dn())}),!1!==s&&Da("setSeries",e,t),o&&$a("setSeries",n,e,t)}let la,ra,ca;n.setSelect=aa,n.setSeries=ia,n.addBand=function(e,t){e.fill=yt(e.fill||null),e.dir=Ke(e.dir,-1),t=null==t?S.length:t,S.splice(t,0,e)},n.setBand=function(e,t){Bt(S[e],t)},n.delBand=function(e){null==e?S.length=0:S.splice(e,1)};const ua={focus:!0};function da(e,t,s){let n=v[t];s&&(e=e/ke-(1==n.ori?Ve:Je));let a=De;1==n.ori&&(a=Oe,e=a-e),-1==n.dir&&(e=a-e);let o=n._min,i=o+(n._max-o)*(e/a),l=n.distr;return 3==l?rt(10,i):4==l?((e,t=1)=>et.sinh(e)*t)(i,n.asinh):100==l?n.bwd(i):i}function ha(e,t){Me(na,ae,sa.left=e),Me(na,ee,sa.width=t)}function fa(e,t){Me(na,se,sa.top=e),Me(na,te,sa.height=t)}H&&Kt&&Te(he,q,e=>{W._lock||(Jt(e),null!=ca&&ia(null,ua,!0,za.setSeries))}),n.valToIdx=e=>Fe(e,t[0]),n.posToIdx=function(e,s){return Fe(da(e,_,s),t[0],ds,hs)},n.posToVal=da,n.valToPos=(e,t,s)=>0==v[t].ori?o(e,v[t],s?xt:De,s?ct:0):i(e,v[t],s?St:Oe,s?dt:0),n.setCursor=(e,t,s)=>{Nn=e.left,Ln=e.top,xa(null,t,s)};let pa=0==N.ori?ha:fa,ma=1==N.ori?ha:fa;function ga(e,t){if(null!=e&&(e.idxs?e.idxs.forEach((e,t)=>{O[t]=e}):void 0!==e.idx&&O.fill(e.idx),$.idx=O[0]),H&&$.live){for(let e=0;e<x.length;e++)(e>0||1==a&&!X)&&ya(e,O[e]);!function(){if(H&&$.live)for(let e=2==a?1:0;e<x.length;e++){if(0==e&&X)continue;let t=$.values[e],s=0;for(let n in t)K[e][s++].firstChild.nodeValue=t[n]}}()}$t=!1,!1!==t&&Da("setLegend")}function ya(e,s){let a,o=x[e],i=0==e&&2==L?Rs:t[e];X?a=o.values(n,e,s)??ie:(a=o.value(n,null==s?null:i[s],e,s),a=null==a?ie:{_:a}),$.values[e]=a}function xa(e,s,o){let i;Cn=Nn,Tn=Ln,[Nn,Ln]=W.move(n,Nn,Ln),W.left=Nn,W.top=Ln,B&&(kn&&Ne(kn,at(Nn),0,De,Oe),vn&&Ne(vn,0,at(Ln),De,Oe));let l=ds>hs;la=ft,ra=null;let r=0==N.ori?De:Oe,c=1==N.ori?De:Oe;if(Nn<0||0==us||l){i=W.idx=null;for(let e=0;e<x.length;e++){let t=Qt[e];null!=t&&Ne(t,-10,-10,De,Oe)}Kt&&ia(null,ua,!0,null==e&&za.setSeries),$.live&&(O.fill(i),$t=!0)}else{let e,s,o;1==a&&(e=0==N.ori?Nn:Ln,s=da(e,_),i=W.idx=Fe(s,t[0],ds,hs),o=P(t[0][i],N,r,0));let l=-10,u=-10,d=0,h=0,f=!0,p="",m="";for(let g=2==a?1:0;g<x.length;g++){let e=x[g],y=O[g],w=null==y?null:1==a?t[g][y]:t[g][1][y],b=W.dataIdx(n,g,i,s),k=null==b?null:1==a?t[g][b]:t[g][1][b];if($t=$t||k!=w||b!=y,O[g]=b,g>0&&e.show){let s=null==b?-10:b==i?o:P(1==a?t[0][b]:t[g][0][b],N,r,0),y=null==k?-10:E(k,1==a?v[e.scale]:v[e.facets[1].scale],c,0);if(Kt&&null!=k){let t=1==N.ori?Nn:Ln,s=st(Yt.dist(n,g,b,y,t));if(s<la){let n=Yt.bias;if(0!=n){let a=da(t,e.scale),o=a>=0?1:-1;o==(k>=0?1:-1)&&(1==o?1==n?k>=a:k<=a:1==n?k<=a:k>=a)&&(la=s,ra=g)}else la=s,ra=g}}if($t||Xt){let e,t;0==N.ori?(e=s,t=y):(e=y,t=s);let a,o,i,r,c,x,w=!0,b=Vt.bbox;if(null!=b){w=!1;let e=b(n,g);i=e.left,r=e.top,a=e.width,o=e.height}else i=e,r=t,a=o=Vt.size(n,g);if(x=Vt.fill(n,g),c=Vt.stroke(n,g),Xt)g==ra&&la<=Yt.prox&&(l=i,u=r,d=a,h=o,f=w,p=x,m=c);else{let e=Qt[g];null!=e&&(Zt[g]=i,ts[g]=r,Ae(e,a,o,w),Pe(e,x,c),Ne(e,ot(i),ot(r),De,Oe))}}}}if(Xt){let e=Yt.prox;if($t||(null==ca?la<=e:la>e||ra!=ca)){let e=Qt[0];null!=e&&(Zt[0]=l,ts[0]=u,Ae(e,d,h,f),Pe(e,p,m),Ne(e,ot(l),ot(u),De,Oe))}}}if(sa.show&&Qn)if(null!=e){let[t,s]=za.scales,[n,a]=za.match,[o,i]=e.cursor.sync.scales,l=e.cursor.drag;if(ea=l._x,ta=l._y,ea||ta){let l,u,d,h,f,{left:p,top:m,width:g,height:y}=e.select,x=e.scales[o].ori,w=e.posToVal,b=null!=t&&n(t,o),k=null!=s&&a(s,i);b&&ea?(0==x?(l=p,u=g):(l=m,u=y),d=v[t],h=P(w(l,o),d,r,0),f=P(w(l+u,o),d,r,0),pa(it(h,f),st(f-h))):pa(0,r),k&&ta?(1==x?(l=p,u=g):(l=m,u=y),d=v[s],h=E(w(l,i),d,c,0),f=E(w(l+u,i),d,c,0),ma(it(h,f),st(f-h))):ma(0,c)}else _a()}else{let e=st(Cn-Sn),t=st(Tn-_n);if(1==N.ori){let s=e;e=t,t=s}ea=Zn.x&&e>=Zn.dist,ta=Zn.y&&t>=Zn.dist;let s,n,a=Zn.uni;null!=a?ea&&ta&&(ea=e>=a,ta=t>=a,ea||ta||(t>e?ta=!0:ea=!0)):Zn.x&&Zn.y&&(ea||ta)&&(ea=ta=!0),ea&&(0==N.ori?(s=Mn,n=Nn):(s=jn,n=Ln),pa(it(s,n),st(n-s)),ta||ma(0,c)),ta&&(1==N.ori?(s=Mn,n=Nn):(s=jn,n=Ln),ma(it(s,n),st(n-s)),ea||pa(0,r)),ea||ta||(pa(0,0),ma(0,0))}if(Zn._x=ea,Zn._y=ta,null==e){if(o){if(null!=Fa){let[e,t]=za.scales;za.values[0]=null!=e?da(0==N.ori?Nn:Ln,e):null,za.values[1]=null!=t?da(1==N.ori?Nn:Ln,t):null}$a(re,n,Nn,Ln,De,Oe,i)}if(Kt){let e=o&&za.setSeries,t=Yt.prox;null==ca?la<=t&&ia(ra,ua,!0,e):la>t?ia(null,ua,!0,e):ra!=ca&&ia(ra,ua,!0,e)}}$t&&($.idx=i,ga()),!1!==s&&Da("setCursor")}n.setLegend=ga;let wa=null;function ba(e=!1){e?wa=null:(wa=p.getBoundingClientRect(),Da("syncRect",wa))}function ka(e,t,s,n,a,o,i){W._lock||Qn&&null!=e&&0==e.movementX&&0==e.movementY||(va(e,t,s,n,a,o,0,!1,null!=e),null!=e?xa(null,!0,!0):xa(t,!0,!1))}function va(e,t,s,a,o,i,r,c,u){if(null==wa&&ba(!1),Jt(e),null!=e)s=e.clientX-wa.left,a=e.clientY-wa.top;else{if(s<0||a<0)return Nn=-10,void(Ln=-10);let[e,n]=za.scales,r=t.cursor.sync,[c,u]=r.values,[d,h]=r.scales,[f,p]=za.match,m=t.axes[0].side%2==1,g=0==N.ori?De:Oe,y=1==N.ori?De:Oe,x=m?i:o,w=m?o:i,b=m?a:s,k=m?s:a;if(s=null!=d?f(e,d)?l(c,v[e],g,0):-10:g*(b/x),a=null!=h?p(n,h)?l(u,v[n],y,0):-10:y*(k/w),1==N.ori){let e=s;s=a,a=e}}!u||null!=t&&t.cursor.event.type!=re||((s<=1||s>=De-1)&&(s=Mt(s,De)),(a<=1||a>=Oe-1)&&(a=Mt(a,Oe))),c?(Sn=s,_n=a,[Mn,jn]=W.move(n,s,a)):(Nn=s,Ln=a)}Object.defineProperty(n,"rect",{get:()=>(null==wa&&ba(!1),wa)});const Sa={width:0,height:0,left:0,top:0};function _a(){aa(Sa,!1)}let Ma,ja,Ca,Ta;function Na(e,t,s,a,o,i,l){Qn=!0,ea=ta=Zn._x=Zn._y=!1,va(e,t,s,a,o,i,0,!0,!1),null!=e&&(Te(ue,xe,La,!1),$a(ce,n,Mn,jn,De,Oe,null));let{left:r,top:c,width:u,height:d}=sa;Ma=r,ja=c,Ca=u,Ta=d}function La(e,t,s,a,o,i,l){Qn=Zn._x=Zn._y=!1,va(e,t,s,a,o,i,0,!1,!0);let{left:r,top:c,width:u,height:d}=sa,h=u>0||d>0,f=Ma!=r||ja!=c||Ca!=u||Ta!=d;if(h&&f&&aa(sa),Zn.setScale&&h&&f){let e=r,t=u,s=c,n=d;if(1==N.ori&&(e=c,t=d,s=r,n=u),ea&&oa(_,da(e,_),da(e+t,_)),ta)for(let a in v){let e=v[a];a!=_&&null==e.from&&e.min!=ft&&oa(a,da(s+n,a),da(s,a))}_a()}else W.lock&&(W._lock=!W._lock,xa(t,!0,null!=e));null!=e&&(Le(ue,xe),$a(ue,n,Nn,Ln,De,Oe,null))}function Pa(e,t,s,a,o,i,l){W._lock||(Jt(e),Os(),_a(),null!=e&&$a(fe,n,Nn,Ln,De,Oe,null))}function Ea(){k.forEach(Xn),Wt(n.width,n.height,!0)}Re(me,we,Ea);const Aa={};Aa.mousedown=Na,Aa.mousemove=ka,Aa.mouseup=La,Aa.dblclick=Pa,Aa.setSeries=(e,t,s,a)=>{-1!=(s=(0,za.match[2])(n,t,s))&&ia(s,a,!0,!1)},B&&(Te(ce,p,Na),Te(re,p,ka),Te(de,p,e=>{Jt(e),ba(!1)}),Te(he,p,function(e,t,s,n,a,o,i){if(W._lock)return;Jt(e);let l=Qn;if(Qn){let e,t,s=!0,n=!0,a=10;0==N.ori?(e=ea,t=ta):(e=ta,t=ea),e&&t&&(s=Nn<=a||Nn>=De-a,n=Ln<=a||Ln>=Oe-a),e&&s&&(Nn=Nn<Mn?0:De),t&&n&&(Ln=Ln<jn?0:Oe),xa(null,!0,!0),Qn=!1}Nn=-10,Ln=-10,O.fill(null),xa(null,!0,!0),l&&(Qn=l)}),Te(fe,p,Pa),zn.add(n),n.syncRect=ba);const Ia=n.hooks=e.hooks||{};function Da(e,t,s){En?An.push([e,t,s]):e in Ia&&Ia[e].forEach(e=>{e.call(null,n,t,s)})}(e.plugins||[]).forEach(e=>{for(let t in e.hooks)Ia[t]=(Ia[t]||[]).concat(e.hooks[t])});const Ra=(e,t,s)=>s,za=Bt({key:null,setSeries:!1,filters:{pub:kt,sub:kt},scales:[_,x[1]?x[1].scale:null],match:[vt,vt,Ra],values:[null,null]},W.sync);2==za.match.length&&za.match.push(Ra),W.sync=za;const Fa=za.key,Oa=dn(Fa);function $a(e,t,s,n,a,o,i){za.filters.pub(e,t,s,n,a,o,i)&&Oa.pub(e,t,s,n,a,o,i)}function Wa(){Da("init",e,t),Fs(t||e.data,!1),A[_]?Fn(_,A[_]):Os(),Rt=sa.show&&(sa.width>0||sa.height>0),Pt=$t=!0,Wt(e.width,e.height)}return Oa.sub(n),n.pub=function(e,t,s,n,a,o,i){za.filters.sub(e,t,s,n,a,o,i)&&Aa[e](null,t,s,n,a,o,i)},n.destroy=function(){Oa.unsub(n),zn.delete(n),ve.clear(),ze(me,we,Ea),c.remove(),null==q||q.remove(),Da("destroy")},x.forEach(ns),k.forEach(function(e,t){if(e._show=e.show,e.show){let s=e.side%2,a=v[e.scale];null==a&&(e.scale=s?x[1].scale:_,a=v[e.scale]);let o=a.time;e.size=yt(e.size),e.space=yt(e.space),e.rotate=yt(e.rotate),Dt(e.incrs)&&e.incrs.forEach(e=>{!Nt.has(e)&&Nt.set(e,Lt(e))}),e.incrs=yt(e.incrs||(2==a.distr?is:o?1==y?ws:vs:ls)),e.splits=yt(e.splits||(o&&1==a.distr?R:3==a.distr?qs:4==a.distr?Gs:Us)),e.stroke=yt(e.stroke),e.grid.stroke=yt(e.grid.stroke),e.ticks.stroke=yt(e.ticks.stroke),e.border.stroke=yt(e.border.stroke);let i=e.values;e.values=Dt(i)&&!Dt(i[0])?yt(i):o?Dt(i)?js(I,Ms(i,D)):zt(i)?function(e,t){let s=es(t);return(t,n,a,o,i)=>n.map(t=>s(e(t)))}(I,i):i||z:i||Bs,e.filter=yt(e.filter||(a.distr>=3&&10==a.log?Qs:3==a.distr&&2==a.log?Zs:wt)),e.font=Kn(e.font),e.labelFont=Kn(e.labelFont),e._size=e.size(n,null,t,0),e._space=e._rotate=e._incrs=e._found=e._splits=e._values=null,e._size>0&&(as[t]=!0,e._el=Ce("u-axis",h))}}),s?s instanceof HTMLElement?(s.appendChild(c),Wa()):s(n,Wa):Wa(),n}Qn.assign=Bt,Qn.fmtNum=Ze,Qn.rangeNum=Ye,Qn.rangeLog=Ue,Qn.rangeAsinh=qe,Qn.orient=hn,Qn.pxRatio=ke,Qn.join=function(e,t){if(function(e){let t=e[0][0],s=t.length;for(let n=1;n<e.length;n++){let a=e[n][0];if(a.length!=s)return!1;if(a!=t)for(let e=0;e<s;e++)if(a[e]!=t[e])return!1}return!0}(e)){let t=e[0].slice();for(let s=1;s<e.length;s++)t.push(...e[s].slice(1));return function(e,t=100){const s=e.length;if(s<=1)return!0;let n=0,a=s-1;for(;n<=a&&null==e[n];)n++;for(;a>=n&&null==e[a];)a--;if(a<=n)return!0;const o=lt(1,nt((a-n+1)/t));for(let i=e[n],l=n+o;l<=a;l+=o){const t=e[l];if(null!=t){if(t<=i)return!1;i=t}}return!0}(t[0])||(t=function(e){let t=e[0],s=t.length,n=Array(s);for(let o=0;o<n.length;o++)n[o]=o;n.sort((e,s)=>t[e]-t[s]);let a=[];for(let o=0;o<e.length;o++){let t=e[o],i=Array(s);for(let e=0;e<s;e++)i[e]=t[n[e]];a.push(i)}return a}(t)),t}let s=new Set;for(let i=0;i<e.length;i++){let t=e[i][0],n=t.length;for(let e=0;e<n;e++)s.add(t[e])}let n=[Array.from(s).sort((e,t)=>e-t)],a=n[0].length,o=new Map;for(let i=0;i<a;i++)o.set(n[0][i],i);for(let i=0;i<e.length;i++){let s=e[i],l=s[0];for(let e=1;e<s.length;e++){let r=s[e],c=Array(a).fill(void 0),u=t?t[i][e]:1,d=[];for(let e=0;e<r.length;e++){let t=r[e],s=o.get(l[e]);null===t?0!=u&&(c[s]=t,2==u&&d.push(s)):c[s]=t}Ut(c,d,a),n.push(c)}}return n},Qn.fmtDate=es,Qn.tzDate=function(e,t){let s;return"UTC"==t||"Etc/UTC"==t?s=new Date(+e+6e4*e.getTimezoneOffset()):t==ts?s=e:(s=new Date(e.toLocaleString("en-US",{timeZone:t})),s.setMilliseconds(e.getMilliseconds())),s},Qn.sync=dn;{Qn.addGap=function(e,t,s){let n=e[e.length-1];n&&n[0]==t?n[1]=s:e.push([t,s])},Qn.clipGaps=gn;let e=Qn.paths={points:Ln};e.linear=In,e.stepped=function(e){const t=Ke(e.align,1),s=Ke(e.ascDesc,!1),n=Ke(e.alignGaps,0),a=Ke(e.extend,!1);return(e,o,i,l)=>hn(e,o,(r,c,u,d,h,f,p,m,g,y,x)=>{[i,l]=He(u,i,l);let w=r.pxRound,{left:b,width:k}=e.bbox,v=e=>w(f(e,d,y,m)),S=e=>w(p(e,h,x,g)),_=0==d.ori?vn:Sn;const M={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:1},j=M.stroke,C=d.dir*(0==d.ori?1:-1);let T=S(u[1==C?i:l]),N=v(c[1==C?i:l]),L=N,P=N;a&&-1==t&&(P=b,_(j,P,T)),_(j,N,T);for(let e=1==C?i:l;e>=i&&e<=l;e+=C){let s=u[e];if(null==s)continue;let n=v(c[e]),a=S(s);1==t?_(j,n,T):_(j,L,a),_(j,n,a),T=a,L=n}let E=L;a&&1==t&&(E=b+k,_(j,E,T));let[A,I]=fn(e,o);if(null!=r.fill||0!=A){let t=M.fill=new Path2D(j),s=S(r.fillTo(e,o,r.min,r.max,A));_(t,E,s),_(t,P,s)}if(!r.spanGaps){let a=[];a.push(...yn(c,u,i,l,C,v,n));let h=r.width*ke/2,f=s||1==t?h:-h,p=s||-1==t?-h:h;a.forEach(e=>{e[0]+=f,e[1]+=p}),M.gaps=a=r.gaps(e,o,i,l,a),M.clip=gn(a,d.ori,m,g,y,x)}return 0!=I&&(M.band=2==I?[mn(e,o,i,l,j,-1),mn(e,o,i,l,j,1)]:mn(e,o,i,l,j,I)),M})},e.bars=function(e){const t=Ke((e=e||Et).size,[.6,ft,1]),s=e.align||0,n=e.gap||0;let a=e.radius;a=null==a?[0,0]:"number"==typeof a?[a,0]:a;const o=yt(a),i=1-t[0],l=Ke(t[1],ft),r=Ke(t[2],1),c=Ke(e.disp,Et),u=Ke(e.each,e=>{}),{fill:d,stroke:h}=c;return(e,t,a,f)=>hn(e,t,(p,m,g,y,x,w,b,k,v,S,_)=>{let M,j,C=p.pxRound,T=s,N=n*ke,L=l*ke,P=r*ke;0==y.ori?[M,j]=o(e,t):[j,M]=o(e,t);const E=y.dir*(0==y.ori?1:-1);let A,I,D,R=0==y.ori?_n:Mn,z=0==y.ori?u:(e,t,s,n,a,o,i)=>{u(e,t,s,a,n,i,o)},F=Ke(e.bands,At).find(e=>e.series[0]==t),O=null!=F?F.dir:0,$=p.fillTo(e,t,p.min,p.max,O),W=C(b($,x,_,v)),H=S,B=C(p.width*ke),U=!1,q=null,G=null,J=null,V=null;null==d||0!=B&&null==h||(U=!0,q=d.values(e,t,a,f),G=new Map,new Set(q).forEach(e=>{null!=e&&G.set(e,new Path2D)}),B>0&&(J=h.values(e,t,a,f),V=new Map,new Set(J).forEach(e=>{null!=e&&V.set(e,new Path2D)})));let{x0:Y,size:K}=c;if(null!=Y&&null!=K){T=1,m=Y.values(e,t,a,f),2==Y.unit&&(m=m.map(t=>e.posToVal(k+t*S,y.key,!0)));let s=K.values(e,t,a,f);I=2==K.unit?s[0]*S:w(s[0],y,S,k)-w(0,y,S,k),H=Dn(m,g,w,y,S,k,H),D=H-I+N}else H=Dn(m,g,w,y,S,k,H),D=H*i+N,I=H-D;D<1&&(D=0),B>=I/2&&(B=0),D<5&&(C=xt);let X=D>0;I=C(mt(H-D-(X?B:0),P,L)),A=(0==T?I/2:T==E?0:I)-T*E*((0==T?N/2:0)+(X?B/2:0));const Q={stroke:null,fill:null,clip:null,band:null,gaps:null,flags:0},Z=U?null:new Path2D;let ee=null;if(null!=F)ee=e.data[F.series[1]];else{let{y0:s,y1:n}=c;null!=s&&null!=n&&(g=n.values(e,t,a,f),ee=s.values(e,t,a,f))}let te=M*I,se=j*I;for(let s=1==E?a:f;s>=a&&s<=f;s+=E){let n=g[s];if(null==n)continue;if(null!=ee){let e=ee[s]??0;if(n-e==0)continue;W=b(e,x,_,v)}let a=w(2!=y.distr||null!=c?m[s]:s,y,S,k),o=b(Ke(n,$),x,_,v),i=C(a-A),l=C(lt(o,W)),r=C(it(o,W)),u=l-r;if(null!=n){let a=n<0?se:te,o=n<0?te:se;U?(B>0&&null!=J[s]&&R(V.get(J[s]),i,r+nt(B/2),I,lt(0,u-B),a,o),null!=q[s]&&R(G.get(q[s]),i,r+nt(B/2),I,lt(0,u-B),a,o)):R(Z,i,r+nt(B/2),I,lt(0,u-B),a,o),z(e,t,s,i-B/2,r,I+B,u)}}return B>0?Q.stroke=U?V:Z:U||(Q._fill=0==p.width?p._fill:p._stroke??p._fill,Q.width=0),Q.fill=U?G:Z,Q})},e.spline=function(e){return function(e,t){const s=Ke(null==t?void 0:t.alignGaps,0);return(t,n,a,o)=>hn(t,n,(i,l,r,c,u,d,h,f,p,m,g)=>{[a,o]=He(r,a,o);let y,x,w,b=i.pxRound,k=e=>b(d(e,c,m,f)),v=e=>b(h(e,u,g,p));0==c.ori?(y=bn,w=vn,x=Tn):(y=kn,w=Sn,x=Nn);const S=c.dir*(0==c.ori?1:-1);let _=k(l[1==S?a:o]),M=_,j=[],C=[];for(let e=1==S?a:o;e>=a&&e<=o;e+=S)if(null!=r[e]){let t=k(l[e]);j.push(M=t),C.push(v(r[e]))}const T={stroke:e(j,C,y,w,x,b),fill:null,clip:null,band:null,gaps:null,flags:1},N=T.stroke;let[L,P]=fn(t,n);if(null!=i.fill||0!=L){let e=T.fill=new Path2D(N),s=v(i.fillTo(t,n,i.min,i.max,L));w(e,M,s),w(e,_,s)}if(!i.spanGaps){let e=[];e.push(...yn(l,r,a,o,S,k,s)),T.gaps=e=i.gaps(t,n,a,o,e),T.clip=gn(e,c.ori,f,p,m,g)}return 0!=P&&(T.band=2==P?[mn(t,n,a,o,N,-1),mn(t,n,a,o,N,1)]:mn(t,n,a,o,N,P)),T})}(Rn,e)}}const Zn=new Map;function ea(e){var t;if(!e.startsWith("var("))return e;const s=Zn.get(e);if(s)return s;const n=e.match(/var\(([^,)]+)(?:,\s*([^)]+))?\)/);if(!n)return e;const a=n[1].trim(),o=(null==(t=n[2])?void 0:t.trim())||"#888888",i=getComputedStyle(document.documentElement).getPropertyValue(a).trim()||o;return Zn.set(e,i),i}const ta=s.memo(function({timestamps:e,series:t,onHover:a,highlightedKey:o=null,cursorColor:i="rgba(255,255,255,0.5)"}){const l=s.useRef(null),r=s.useRef(null),c=s.useRef(t),u=s.useRef(o),d=s.useRef(a),h=s.useRef(e.length);c.current=t,u.current=o,d.current=a;const f=s.useMemo(()=>{const t=new Array(e.length).fill(1);return[e,t]},[e]),p=s.useMemo(()=>({hooks:{draw:e=>{!function(e,t,s){if(0===t.length)return;const n=e.ctx,a=e.bbox,o=a.left,i=a.top,l=a.width,r=a.height;if(l<=0||r<=0)return;const c=e.data[0],u=c.length;if(0===u)return;const d=c[0],h=c[u-1]-d||1,f=e=>{const t=c[e];return o+(t-d)/h*l},p=e=>i+r*(1-e);for(let m=0;m<t.length;m++){const e=t[m],a=new Array(u).fill(0),o=new Array(u).fill(0);for(let s=0;s<m;s++){const e=t[s].values;for(let t=0;t<u;t++)o[t]+=e[t]??0}for(let t=0;t<u;t++)a[t]=o[t]+(e.values[t]??0);const i=s&&s!==e.key?.3:1,l=ea(e.color);n.save(),n.globalAlpha=i,n.fillStyle=l,n.beginPath();let r=f(0),c=p(o[0]),d=p(a[0]);n.moveTo(r,c),n.lineTo(r,d);for(let t=1;t<u;t++){r=f(t);const e=d;d=p(a[t]),n.lineTo(r,e),n.lineTo(r,d)}for(let t=u-1;t>=0;t--){const e=f(t),s=p(o[t]);if(t===u-1)n.lineTo(e,s);else{const a=f(t+1);n.lineTo(a,s),n.lineTo(e,s)}}n.closePath(),n.fill(),n.restore()}}(e,c.current,u.current),function(e){const t=e.ctx,{left:s,top:n,width:a,height:o}=e.bbox,i=window.devicePixelRatio||1,l=function(){const e=getComputedStyle(document.documentElement);return{fontFamily:e.getPropertyValue("--font-data").trim()||'"JetBrains Mono", ui-monospace, monospace',textPrimary:e.getPropertyValue("--text-primary").trim()||"#FFFFFF"}}();t.save(),t.strokeStyle=l.textPrimary,t.globalAlpha=.15,t.lineWidth=1*i,t.setLineDash([4*i,4*i]);for(const c of[.2,.4,.6,.8]){const e=Math.round(n+o*(1-c))+.5;t.beginPath(),t.moveTo(Math.round(s),e),t.lineTo(Math.round(s+a),e),t.stroke()}t.restore(),t.save(),t.font=`bold ${10*i}px ${l.fontFamily}`,t.fillStyle=l.textPrimary,t.textBaseline="middle",t.textAlign="left";const r=8*i;for(const c of[0,20,40,60,80,100]){const e=n+o*(1-c/100),s=Math.max(n+r,Math.min(n+o-r,e));t.fillText(`${c}%`,0,s)}t.restore()}(e)}}}),[]),m=s.useMemo(()=>({width:400,height:200,padding:[8,0,0,32],cursor:{show:!0,x:!0,y:!1,drag:{x:!1,y:!1},points:{show:!1}},scales:{x:{time:!0},y:{range:[0,1]}},axes:[{show:!1},{show:!1}],series:[{},{show:!1}],hooks:{setCursor:[e=>{var t,s;const n=e.cursor.idx;if(null!=n&&n>=0){const s=e.data[0][n];null==(t=d.current)||t.call(d,n,s)}else null==(s=d.current)||s.call(d,null,null)}]},plugins:[p]}),[p]);s.useEffect(()=>{const t=l.current;if(!t||0===e.length)return;const s=h.current,n=e.length,a=Math.abs(n-s);if(!(!r.current||a>100||s>0&&a/s>.1)&&r.current)return r.current.setData(f),void(h.current=n);r.current&&r.current.destroy();const o=t.getBoundingClientRect(),i=Math.floor(o.width)||400,c=Math.floor(o.height)||200,u=new Qn({...m,width:i,height:c},f,t);return r.current=u,h.current=n,()=>{u.destroy(),r.current=null}},[m,f,e.length]),s.useEffect(()=>{const e=l.current;if(!e)return;const t=new ResizeObserver(e=>{const t=e[0];if(!t||!r.current)return;const{width:s,height:n}=t.contentRect;s>0&&n>0&&r.current.setSize({width:Math.floor(s),height:Math.floor(n)})});return t.observe(e),()=>{t.disconnect()}},[]),s.useEffect(()=>{r.current&&r.current.redraw()},[o,t]);const g=s.useCallback(()=>{null==a||a(null,null)},[a]);return 0===e.length?n.jsx("div",{className:"h-full flex items-center justify-center text-text-muted",children:"No data available"}):n.jsx("div",{ref:l,className:"w-full h-full rounded-2xl overflow-hidden",onMouseLeave:g})}),sa=s.createContext(null);function na({children:e}){const[t,a]=s.useState(()=>function(){if("undefined"==typeof window)return R;try{let t=localStorage.getItem(z),s=localStorage.getItem(F);const n=localStorage.getItem(O);if(!t&&!s){const e=localStorage.getItem($);if(e){const n=D.find(t=>t.id===e);n&&(t=n.colorScheme,s=n.backgroundImage,localStorage.setItem(z,t),localStorage.setItem(F,s),localStorage.removeItem($))}}const a="string"==typeof(e=t)&&A.some(t=>t.id===e)?t:R.colorScheme,o=s||R.backgroundImage;let i=R.brightness;if(n){const e=parseInt(n,10);!isNaN(e)&&e>=0&&e<=100&&(i=e)}return{colorScheme:a,backgroundImage:o,brightness:i}}catch{return R}var e}());s.useEffect(()=>{(function(e){const t=(s=e,A.find(e=>e.id===s)??A[0]);var s;t.dataTheme?document.documentElement.setAttribute("data-theme",t.dataTheme):document.documentElement.removeAttribute("data-theme")})(t.colorScheme),Zn.clear(),requestAnimationFrame(()=>{!function(){if("undefined"==typeof window)return;for(const t of U){const e=K(`--palette-${t}-bright`),s=K(`--palette-${t}`),n=e||s;if(!n)continue;const a=Y(n);for(const o of B)X(`--palette-${t}-${o}`,a[o])}const e=K("--palette-bg-4");if(e){const t=Y(e);for(const e of B)X(`--palette-neutral-${e}`,t[e])}}()})},[t.colorScheme]),s.useEffect(()=>{!function(e){if("undefined"!=typeof window)try{localStorage.setItem(z,e.colorScheme),localStorage.setItem(F,e.backgroundImage),localStorage.setItem(O,String(e.brightness))}catch{}}(t)},[t]),s.useEffect(()=>{I.forEach(e=>{(new Image).src=e.src})},[]);const o=s.useCallback(e=>{a(t=>({...t,colorScheme:e}))},[]),i=s.useCallback(e=>{const t=I.find(t=>t.src===e);a(s=>({...s,backgroundImage:e,brightness:(null==t?void 0:t.suggestedBrightness)??s.brightness}))},[]),l=s.useCallback(e=>{const t=Math.max(0,Math.min(100,Math.round(e)));a(e=>({...e,brightness:t}))},[]),r=s.useCallback(e=>{const t=D.find(t=>t.id===e);t&&a(e=>({...e,colorScheme:t.colorScheme,backgroundImage:t.backgroundImage}))},[]),c=s.useMemo(()=>({theme:t,setColorScheme:o,setBackgroundImage:i,setBrightness:l,setThemePreset:r}),[t,o,i,l,r]);return n.jsx(sa.Provider,{value:c,children:e})}function aa(){const e=s.useContext(sa);if(!e)throw new Error("useTheme must be used within a ThemeProvider. Wrap your app with <ThemeProvider> in App.tsx.");return e}const oa="0.9.135",ia="/assets/WCM_Waves-RN-_ocPH.gif",la=s.memo(function({height:e=16,className:t=""}){const s={fontFamily:"'Space Mono', monospace",fontSize:`${"string"==typeof e?parseFloat(e):e}px`,fontWeight:400,lineHeight:1,letterSpacing:"-0.02em",whiteSpace:"nowrap"},a="rgba(255, 255, 255, 0.7)",o="#FFFFFF";return n.jsxs("span",{className:t,style:s,role:"img","aria-label":"pyMC:Console",children:[n.jsx("span",{style:{color:a},children:"py"}),n.jsx("span",{style:{color:o},children:"MC"}),n.jsx("span",{style:{color:a},children:":"}),n.jsx("span",{style:{color:o},children:"Console"})]})}),ra={0:"REQ",1:"RESPONSE",2:"TXT_MSG",3:"ACK",4:"ADVERT",5:"GRP_TXT",6:"GRP_DATA",7:"ANON_REQ",8:"PATH",9:"TRACE",10:"MULTIPART",15:"RAW_CUSTOM"},ca={0:"T_FLOOD",1:"FLOOD",2:"DIRECT",3:"T_DIRECT"},ua={REQ:0,RESPONSE:1,TXT_MSG:2,ACK:3,ADVERT:4,GRP_TXT:5,GRP_DATA:6,ANON_REQ:7,PATH:8,TRACE:9,MULTIPART:10,RAW_CUSTOM:15};function da(e){return 1===e||0===e}const ha={spreadingFactor:7,bandwidthHz:125e3,codingRate:5,preambleLength:8,crcEnabled:!0,explicitHeader:!0};function fa(e){if(e.raw_packet){const t=e.raw_packet;if(/^[0-9a-fA-F]+$/.test(t)&&t.length%2==0)return t.length/2;if(/^[A-Za-z0-9+/=]+$/.test(t)){const e=(t.match(/=+$/)||[""])[0].length;return Math.floor(3*t.length/4)-e}return t.length}if(e.length&&e.length>0)return e.length;if(e.payload_length&&e.payload_length>0)return e.payload_length;if(e.payload){const t=e.payload;return/^[0-9a-fA-F]+$/.test(t)&&t.length%2==0?t.length/2:t.length}return 32}function pa(e,t={}){const s=t.spreadingFactor??ha.spreadingFactor,n=t.bandwidthHz??ha.bandwidthHz,a=t.codingRate??ha.codingRate,o=t.preambleLength??ha.preambleLength??8,i=t.crcEnabled??ha.crcEnabled?1:0,l=t.explicitHeader??ha.explicitHeader?0:1,r=s>=11&&n<=125e3?1:0,c=n/1e3,u=Math.pow(2,s)/c,d=(o+4.25)*u,h=Math.max(8*e-4*s+28+16*i-20*l,0),f=4*(s-2*r);return d+(8+Math.ceil(h/f)*a)*u}const ma="pymc_jwt_token",ga="pymc_client_id";function ya(){let e=localStorage.getItem(ga);return e||(e=`${Date.now()}-${Math.random().toString(36).substring(2,15)}`,localStorage.setItem(ga,e)),e}function xa(){return localStorage.getItem(ma)}function wa(e){localStorage.setItem(ma,e)}function ba(){localStorage.removeItem(ma)}function ka(){return!!xa()&&!Sa()}function va(e){try{const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(t).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(s)}catch{return null}}function Sa(){const e=xa();if(!e)return!0;const t=va(e);return!t||!t.exp||Date.now()>=1e3*t.exp-6e4}function _a(){const e=xa();if(!e)return!1;const t=va(e);if(!t||!t.exp)return!1;const s=1e3*t.exp-Date.now();return s>0&&s<18e4}function Ma(){const e=xa();if(!e)return null;const t=va(e);return t&&t.sub?t.sub:null}async function ja(e,t){try{const s=await fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t,client_id:ya()})}),n=s.headers.get("content-type");if(!n||!n.includes("application/json"))return{success:!1,error:`Server error: ${s.status}`};const a=await s.json();return a.success&&a.token?(wa(a.token),{success:!0}):{success:!1,error:a.error||"Login failed"}}catch(s){return{success:!1,error:"Connection error. Please try again."}}}async function Ca(){const e=xa();if(!e)return!1;try{const t=await fetch("/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({client_id:ya()})});if(!t.ok)return!1;const s=await t.json();return!(!s.success||!s.token||(wa(s.token),0))}catch(t){return!1}}function Ta(){ba()}const Na=Object.freeze(Object.defineProperty({__proto__:null,clearToken:ba,getClientId:ya,getToken:xa,getUsername:Ma,isAuthenticated:ka,isTokenExpired:Sa,login:ja,logout:Ta,parseJWT:va,refreshToken:Ca,setToken:wa,shouldRefreshToken:_a},Symbol.toStringTag,{value:"Module"})),La=new Map;let Pa=!1;async function Ea(e,t,s=!1){const n=function(e,t){return(null==t?void 0:t.method)&&"GET"!==t.method?"":e}(e,t);if(n){const e=La.get(n);if(e)return e}const a=`${e}`;!s&&_a()&&await Ca();const o=xa(),i=o?{Authorization:`Bearer ${o}`}:{};if(null==t?void 0:t.headers){const e=t.headers;e instanceof Headers?e.forEach((e,t)=>{i[t]=e}):Array.isArray(e)?e.forEach(([e,t])=>{i[e]=t}):Object.assign(i,e)}(null==t?void 0:t.body)&&(i["Content-Type"]="application/json");const l=(async()=>{const n=await fetch(a,{...t,headers:i});if(401===n.status){if(!s&&!Pa&&await Ca())return Ea(e,t,!0);throw Pa||(Pa=!0,ba(),window.location.href="/login"),new Error("Session expired. Please log in again.")}if(!n.ok)throw new Error(`API error: ${n.status} ${n.statusText}`);return n.json()})();return n&&(La.set(n,l),l.finally(()=>{La.delete(n)})),l}function Aa(e){return e&&"chat node"===e.toLowerCase()?"Companion":e}async function Ia(){return function(e){if(e.neighbors)for(const t of Object.values(e.neighbors))t.contact_type=Aa(t.contact_type);return e}(await Ea("/api/stats"))}async function Da(){return Ea("/api/logs")}async function Ra(e=24){return Ea(`/api/noise_floor_history?hours=${e}`)}async function za(){return Ea("/api/hardware_stats")}async function Fa(){return Ea("/api/send_advert",{method:"POST",body:"{}"})}async function Oa(e){return Ea("/api/set_mode",{method:"POST",body:JSON.stringify({mode:e})})}async function $a(e){return Ea("/api/set_duty_cycle",{method:"POST",body:JSON.stringify({enabled:e})})}const Wa=new Map;function Ha(e=!1){if(e)Wa.clear();else for(const[t]of Wa)parseInt(t.split("-")[0],10)<=60&&Wa.delete(t)}function Ba(e,t,s,n){const a=60*e/t,o=Math.floor(Date.now()/1e3),i=Math.floor(o/a)*a,l=i-60*e,r=s.filter(e=>e.timestamp>=l&&e.timestamp<=i),c=n?function(e){var t;const s=null==(t=null==e?void 0:e.config)?void 0:t.radio;return{spreadingFactor:(null==s?void 0:s.spreading_factor)??ha.spreadingFactor,bandwidthHz:(null==s?void 0:s.bandwidth)??ha.bandwidthHz,codingRate:(null==s?void 0:s.coding_rate)??ha.codingRate,preambleLength:(null==s?void 0:s.preamble_length)??ha.preambleLength,crcEnabled:!0,explicitHeader:!0}}(n):ha,u=function(e,t,s,n,a){const o=new Array(t),i=new Array(t),l=new Array(t),r=new Array(t),c=new Array(t);for(let d=0;d<t;d++){const e=s+d*n,t={bucket:d,start:e,end:e+n,count:0,airtime_ms:0,avg_snr:0,avg_rssi:0};o[d]={...t},i[d]={...t},l[d]={...t},r[d]={...t},c[d]={snr:0,rssi:0,count:0}}const u=e.length;for(let d=0;d<u;d++){const u=e[d],h=Math.floor((u.timestamp-s)/n);if(h<0||h>=t)continue;const f=pa(fa(u),a),p=u.packet_origin;"tx_local"===p?(i[h].count++,i[h].airtime_ms+=f):"tx_forward"===p||u.transmitted?(l[h].count++,l[h].airtime_ms+=f):u.drop_reason&&(r[h].count++,r[h].airtime_ms+=f),"tx_local"!==p&&(o[h].count++,o[h].airtime_ms+=f,c[h].snr+=u.snr||0,c[h].rssi+=u.rssi||0,c[h].count++)}for(let d=0;d<t;d++)c[d].count>0&&(o[d].avg_snr=c[d].snr/c[d].count,o[d].avg_rssi=c[d].rssi/c[d].count);return{received:o,transmitted:i,forwarded:l,dropped:r}}(r,t,l,a,c);return{time_range_minutes:e,bucket_count:t,bucket_duration_seconds:a,start_time:l,end_time:i,...u}}async function Ua(e){return Ea("/api/update_radio_config",{method:"POST",body:JSON.stringify(e)})}async function qa(e){return Ea("/api/set_log_level",{method:"POST",body:JSON.stringify({level:e})})}async function Ga(){return Ea("/api/transport_keys")}async function Ja(e){return Ea("/api/transport_keys",{method:"POST",body:JSON.stringify(e)})}async function Va(e,t){return Ea(`/api/transport_key/${e}`,{method:"PUT",body:JSON.stringify(t)})}async function Ya(e){return Ea(`/api/transport_key/${e}`,{method:"DELETE"})}async function Ka(e){return Ea("/api/global_flood_policy",{method:"POST",body:JSON.stringify({global_flood_allow:e})})}async function Xa(e,t=10){return Ea("/api/ping_neighbor",{method:"POST",body:JSON.stringify({target_id:e,timeout:t})})}async function Qa(e){return Ea("/api/update_web_config",{method:"POST",body:JSON.stringify(e)})}async function Za(){return Ea("/api/check_pymc_console")}async function eo(){return Ea("/api/restart_service",{method:"POST",body:"{}"})}async function to(){return Ea("/auth/tokens")}async function so(e){return Ea("/auth/tokens",{method:"POST",body:JSON.stringify({name:e})})}async function no(e){return Ea(`/auth/tokens/${e}`,{method:"DELETE"})}const ao="pymc-packet-cache",oo="pymc-packet-cache-meta",io=36e5,lo=75e3,ro=75e3,co=5e3,uo=75e3,ho=new class{constructor(){t(this,"packets",new Map),t(this,"sortedPackets",[]),t(this,"sortedDirty",!0),t(this,"meta",{oldestTimestamp:0,newestTimestamp:0,lastUpdated:0,packetCount:0,backgroundLoadComplete:!1,topologyLoadComplete:!1}),t(this,"isLoading",!1),t(this,"isBackgroundLoading",!1),t(this,"isTopologyLoading",!1),t(this,"listeners",new Set),t(this,"loadProgress",null),t(this,"statusMessage",""),this.loadFromStorage()}subscribe(e){return this.listeners.add(e),e(this.getState()),()=>this.listeners.delete(e)}getState(){return{isLoading:this.isLoading,isBackgroundLoading:this.isBackgroundLoading,isTopologyLoading:this.isTopologyLoading,backgroundLoadComplete:this.meta.backgroundLoadComplete,topologyLoadComplete:this.meta.topologyLoadComplete,packetCount:this.packets.size,statusMessage:this.statusMessage,loadProgress:this.loadProgress}}getPackets(){return this.sortedDirty&&(this.sortedPackets=Array.from(this.packets.values()).sort((e,t)=>(e.timestamp??0)-(t.timestamp??0)),this.sortedDirty=!1),this.sortedPackets}isStale(){return 0===this.packets.size||Date.now()-this.meta.lastUpdated>io}isHeavyLoadInProgress(){return this.isBackgroundLoading||this.isTopologyLoading}async initialLoad(e){if(this.isStale()&&this.packets.size>0&&this.clear(),this.meta.backgroundLoadComplete&&this.packets.size>0)return this.getPackets();this.isLoading=!0,this.loadProgress={loaded:0,target:lo,percent:0},this.statusMessage="Loading packets...",this.notifyListeners();try{let t;this.packets.size>0&&(this.packets.clear(),this.sortedPackets=[],this.sortedDirty=!0,this.meta.oldestTimestamp=0,this.meta.newestTimestamp=0);let s=0,n=0,a=0;const o=Math.ceil(15);for(let i=0;i<o;i++){const l=this.packets.size>0?Math.min(99,Math.round(this.packets.size/lo*100)):0;this.statusMessage="Loading packets...",this.loadProgress={loaded:this.packets.size,target:lo,percent:l},this.notifyListeners();const r=await this.fetchChunkWithRetry(t,co,i,o);if(null!==r){if(a=0,!(r.success&&r.data&&r.data.length>0))break;{const a=this.packets.size;this.mergePackets(r.data);const o=this.packets.size-a;s+=o;const i=Math.min(...r.data.map(e=>e.timestamp??1/0));if(i!==1/0&&(void 0===t||i<t)&&(t=i),e&&e(),0===o){if(n++,n>=2)break}else n=0;if(r.data.length<co)break;if(this.packets.size>=uo)break}i<o-1&&await this.delay(300)}else{if(a++,a>=5){this.statusMessage="Connection issues, loaded partial data",this.notifyListeners();break}await this.delay(2e3)}}this.enforceMemoryCap(),this.meta.backgroundLoadComplete=!0,this.loadProgress={loaded:this.packets.size,target:this.packets.size,percent:100},this.notifyListeners(),this.saveToStorage()}catch(t){this.statusMessage="Load failed"}finally{this.isLoading=!1,this.statusMessage="",this.loadProgress=null,this.notifyListeners()}return this.getPackets()}async quickLoad(){return this.initialLoad()}async backgroundLoad(){await this.initialLoad()}async topologyLoad(){if(!this.meta.topologyLoadComplete&&!this.isTopologyLoading)return this.doTopologyLoad()}async forceTopologyLoad(){if(!this.isTopologyLoading)return this.meta.topologyLoadComplete=!1,this.doTopologyLoad()}async forceDeepLoad(){return this.forceTopologyLoad()}async doTopologyLoad(){this.isTopologyLoading=!0,this.statusMessage="Fetching topology data...",this.loadProgress={loaded:0,target:ro,percent:0},this.notifyListeners();try{let e,t=0,s=0,n=0;const a=Math.ceil(15);for(let o=0;o<a;o++){const i=this.packets.size>0?Math.min(99,Math.round(this.packets.size/ro*100)):0;this.statusMessage=`Loading ${this.packets.size.toLocaleString()} packets...`,this.loadProgress={loaded:this.packets.size,target:ro,percent:i},this.notifyListeners();const l=await this.fetchChunkWithRetry(e,co,o,a);if(null!==l){if(n=0,!(l.success&&l.data&&l.data.length>0))break;{const n=this.packets.size;this.mergePackets(l.data);const a=this.packets.size-n;t+=a;const o=Math.min(...l.data.map(e=>e.timestamp??1/0));if(o!==1/0&&(void 0===e||o<e)&&(e=o),0===a){if(s++,s>=2)break}else s=0;if(l.data.length<co)break;if(this.packets.size>=uo)break}o<a-1&&await this.delay(300)}else{if(n++,n>=5){this.statusMessage="Connection issues, loaded partial data",this.notifyListeners();break}await this.delay(2e3)}}this.statusMessage=`Processing ${this.packets.size.toLocaleString()} packets...`,this.loadProgress={loaded:this.packets.size,target:this.packets.size,percent:100},this.notifyListeners(),this.enforceMemoryCap(),this.meta.topologyLoadComplete=!0,this.saveToStorage()}catch(e){this.statusMessage="Topology load failed"}finally{this.isTopologyLoading=!1,this.statusMessage="",this.loadProgress=null,this.notifyListeners()}}async poll(){try{const e=await this.fetchRecentPackets(100);if(e.success&&e.data){const t=this.packets.size;this.mergePackets(e.data),this.packets.size>t&&(this.saveToStorage(),this.notifyListeners())}}catch(e){}return this.getPackets()}clear(){this.packets.clear(),this.sortedPackets=[],this.sortedDirty=!0,this.meta={oldestTimestamp:0,newestTimestamp:0,lastUpdated:0,packetCount:0,backgroundLoadComplete:!1,topologyLoadComplete:!1},this.clearStorage(),this.notifyListeners()}mergePacketsDirectly(e){const t=this.packets.size;this.mergePackets(e);const s=this.packets.size-t;return s>0&&(this.enforceMemoryCap(),this.saveToStorage(),this.notifyListeners()),s}mergePackets(e){let t=!1;for(const s of e){const e=s.packet_hash;if(e&&!this.packets.has(e)){this.packets.set(e,s),t=!0;const n=s.timestamp??0;(0===this.meta.oldestTimestamp||n<this.meta.oldestTimestamp)&&(this.meta.oldestTimestamp=n),n>this.meta.newestTimestamp&&(this.meta.newestTimestamp=n)}}t&&(this.sortedDirty=!0),this.meta.lastUpdated=Date.now(),this.meta.packetCount=this.packets.size}notifyListeners(){const e=this.getState();for(const t of this.listeners)t(e)}waitForIdle(){return new Promise(e=>{"requestIdleCallback"in window?window.requestIdleCallback(()=>e(),{timeout:2e3}):setTimeout(e,100)})}delay(e){return new Promise(t=>setTimeout(t,e))}async fetchChunkWithRetry(e,t,s,n){for(let o=0;o<3;o++)try{return await this.fetchFilteredPackets(e,t)}catch(a){const e=2===o,t=1e3*Math.pow(2,o);a instanceof Error&&a.name,e||(this.statusMessage=`Retry in ${Math.round(t/1e3)}s...`,this.notifyListeners(),await this.delay(t))}return null}enforceMemoryCap(){if(this.packets.size<=uo)return;const e=this.getPackets(),t=e.length-uo;for(let s=0;s<t;s++){const t=e[s];t.packet_hash&&this.packets.delete(t.packet_hash)}this.sortedDirty=!0,this.meta.packetCount=this.packets.size,e.length>t&&(this.meta.oldestTimestamp=e[t].timestamp??0)}loadFromStorage(){if("undefined"!=typeof window)try{const e=localStorage.getItem(oo);e&&(this.meta=JSON.parse(e));const t=localStorage.getItem(ao);if(t){const e=JSON.parse(t);for(const t of e)t.packet_hash&&this.packets.set(t.packet_hash,t)}if(this.meta.lastUpdated>0&&Date.now()-this.meta.lastUpdated>io)return void this.clear();this.meta.backgroundLoadComplete=!1;const s=37500;this.meta.topologyLoadComplete&&this.packets.size<s&&(this.meta.topologyLoadComplete=!1),"deepLoadComplete"in this.meta&&delete this.meta.deepLoadComplete}catch(e){this.clear()}}saveToStorage(){if("undefined"!=typeof window)try{localStorage.setItem(oo,JSON.stringify(this.meta));const e=this.getPackets(),t=e.length>3e3?e.slice(-3e3):e;localStorage.setItem(ao,JSON.stringify(t))}catch(e){if(e instanceof DOMException&&"QuotaExceededError"===e.name)try{localStorage.removeItem(ao),localStorage.setItem(oo,JSON.stringify(this.meta))}catch{}}}clearStorage(){if("undefined"!=typeof window)try{localStorage.removeItem(ao),localStorage.removeItem(oo)}catch(e){}}async fetchRecentPackets(e=1e3,t=!1){const s=`/api/recent_packets?limit=${e}`,n=localStorage.getItem("pymc_jwt_token"),a={};n&&(a.Authorization=`Bearer ${n}`);const o=await fetch(s,{headers:a});if(401===o.status&&!t){const{refreshToken:t}=await P(async()=>{const{refreshToken:e}=await Promise.resolve().then(()=>Na);return{refreshToken:e}},void 0);if(await t())return this.fetchRecentPackets(e,!0)}if(!o.ok)throw new Error(`API error: ${o.status}`);return o.json()}async fetchFilteredPackets(e,t=5e3,s=!1){const n=new URLSearchParams;n.set("limit",String(t)),void 0!==e&&n.set("end_timestamp",String(e-.001));const a=`/api/filtered_packets?${n}`,o=localStorage.getItem("pymc_jwt_token"),i={};o&&(i.Authorization=`Bearer ${o}`);const l=new AbortController,r=setTimeout(()=>l.abort(),3e4);try{const n=await fetch(a,{headers:i,signal:l.signal});if(401===n.status&&!s){const{refreshToken:s}=await P(async()=>{const{refreshToken:e}=await Promise.resolve().then(()=>Na);return{refreshToken:e}},void 0);if(await s())return this.fetchFilteredPackets(e,t,!0)}if(!n.ok)throw new Error(`API error: ${n.status}`);return n.json()}finally{clearTimeout(r)}}};function fo(e){return{paths:e.paths,byEndpoints:new Map(e.byEndpointsEntries),canonicalPaths:new Map(e.canonicalPathsEntries),totalObservations:e.totalObservations,uniquePathCount:e.uniquePathCount}}function po(){return{paths:[],byEndpoints:new Map,canonicalPaths:new Map,totalObservations:0,uniquePathCount:0}}const mo=new class{constructor(){t(this,"worker",null),t(this,"listeners",new Set),t(this,"currentTopology",{edges:[],validatedEdges:[],weakEdges:[],certainEdges:[],uncertainEdges:[],edgeMap:new Map,maxPacketCount:0,maxCertainCount:0,neighborAffinity:new Map,fullAffinity:new Map,localPrefix:null,centrality:new Map,hubNodes:[],gatewayNodes:[],loops:[],loopEdgeKeys:new Set,txDelayRecommendations:new Map,pathRegistry:po(),edgeBetweenness:new Map,backboneEdges:[],nodeMobility:new Map,mobileNodes:[],pathHealth:[],lastHopNeighbors:[],disambiguationStats:{totalPrefixes:0,unambiguousPrefixes:0,collisionPrefixes:0,collisionRate:0,avgConfidence:0,lowConfidencePrefixes:[],highCollisionPrefixes:[],totalResolutions:0},discoveredNodes:[],viterbiStats:{totalPaths:0,pathsWithGhosts:0,avgPathCost:0,avgPathConfidence:0,observationOverrideCount:0,tracePacketsProcessed:0,pathPacketsProcessed:0,distantEdgesDiscovered:0,duplicateGroupsFound:0,duplicatePathsUnique:0,echolocationEdgesInferred:0}}),t(this,"isComputing",!1),t(this,"pendingRequest",null),t(this,"debounceTimer",null),t(this,"debounceMs",100),this.initWorker()}initWorker(){if("undefined"!=typeof window)try{this.worker=new Worker(new URL("/assets/topology.worker-BHEhB0-W.js",import.meta.url),{type:"module"}),this.worker.onmessage=e=>{this.handleWorkerMessage(e.data)},this.worker.onerror=e=>{}}catch(e){}}handleWorkerMessage(e){if(this.isComputing=!1,"error"!==e.type){var t;this.currentTopology={edges:(t=e.payload).edges??[],validatedEdges:t.validatedEdges??[],weakEdges:t.weakEdges??[],certainEdges:t.certainEdges??[],uncertainEdges:t.uncertainEdges??[],maxPacketCount:t.maxPacketCount??0,maxCertainCount:t.maxCertainCount??0,localPrefix:t.localPrefix??null,hubNodes:t.hubNodes??[],gatewayNodes:t.gatewayNodes??[],edgeMap:new Map(t.edgeMapEntries??[]),neighborAffinity:new Map(t.neighborAffinityEntries??[]),fullAffinity:new Map(t.fullAffinityEntries??[]),centrality:new Map(t.centralityEntries??[]),loops:t.loops??[],loopEdgeKeys:new Set(t.loopEdgeKeyEntries??[]),txDelayRecommendations:new Map(t.txDelayRecommendationEntries??[]),pathRegistry:t.pathRegistry?fo(t.pathRegistry):po(),edgeBetweenness:new Map(t.edgeBetweennessEntries??[]),backboneEdges:t.backboneEdges??[],nodeMobility:new Map(t.nodeMobilityEntries??[]),mobileNodes:t.mobileNodes??[],pathHealth:t.pathHealth??[],lastHopNeighbors:t.lastHopNeighbors??[],disambiguationStats:t.disambiguationStats??{totalPrefixes:0,unambiguousPrefixes:0,collisionPrefixes:0,collisionRate:0,avgConfidence:0,lowConfidencePrefixes:[],highCollisionPrefixes:[],totalResolutions:0},discoveredNodes:t.discoveredNodes??[],viterbiStats:t.viterbiStats??{totalPaths:0,pathsWithGhosts:0,avgPathCost:0,avgPathConfidence:0,observationOverrideCount:0,tracePacketsProcessed:0,pathPacketsProcessed:0,distantEdgesDiscovered:0,duplicateGroupsFound:0,duplicatePathsUnique:0,echolocationEdgesInferred:0}};for(const t of this.listeners)try{t(this.currentTopology,e.computeTimeMs)}catch(s){}if(this.pendingRequest){const e=this.pendingRequest;this.pendingRequest=null,this.computeInternal(e)}}}computeInternal(e){if(!this.worker)return;this.isComputing=!0;const t={type:"compute",payload:e};this.worker.postMessage(t)}compute(e,t,s,n,a,o,i,l){const r={packets:e,neighbors:t,localHash:s,localLat:n,localLon:a,airtimeMs:o,zeroHopNeighbors:i,terrainGrid:l,enableTerrainAware:void 0!==l};this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.debounceTimer=null,this.isComputing?this.pendingRequest=r:this.computeInternal(r)},this.debounceMs)}subscribe(e){return this.listeners.add(e),this.currentTopology.edges.length>0&&e(this.currentTopology,0),()=>{this.listeners.delete(e)}}getTopology(){return this.currentTopology}isWorking(){return this.isComputing}terminate(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.worker&&(this.worker.terminate(),this.worker=null),this.listeners.clear()}},go=new class{constructor(){t(this,"worker",null),t(this,"listeners",new Set),t(this,"sparklines",new Map),t(this,"isComputing",!1),t(this,"lastComputeTimeMs",0),t(this,"pendingRequest",null),t(this,"debounceTimer",null),t(this,"debounceMs",150),this.initWorker()}initWorker(){if("undefined"!=typeof window)try{this.worker=new Worker(new URL("/assets/sparkline.worker-CmKhBAy5.js",import.meta.url),{type:"module"}),this.worker.onmessage=e=>{this.handleWorkerMessage(e.data)},this.worker.onerror=e=>{this.isComputing=!1,this.notifyListeners()}}catch(e){}}handleWorkerMessage(e){if(this.isComputing=!1,"error"!==e.type){if(this.sparklines=new Map(e.payload.sparklineEntries),this.lastComputeTimeMs=e.computeTimeMs,this.notifyListeners(),this.pendingRequest){const e=this.pendingRequest;this.pendingRequest=null,this.computeInternal(e.packets,e.nodeHashes)}}else this.notifyListeners()}computeInternal(e,t){if(!this.worker)return;if(0===t.length)return this.isComputing=!1,void this.notifyListeners();this.isComputing=!0,this.notifyListeners();const s={type:"compute",payload:{packets:e,nodeHashes:t}};this.worker.postMessage(s)}notifyListeners(){for(const t of this.listeners)try{t(this.sparklines,this.isComputing)}catch(e){}}compute(e,t){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.debounceTimer=null,this.isComputing?this.pendingRequest={packets:e,nodeHashes:t}:this.computeInternal(e,t)},this.debounceMs)}getSparkline(e){return this.sparklines.get(e)??[]}getAllSparklines(){return this.sparklines}hasSparkline(e){return this.sparklines.has(e)}isWorking(){return this.isComputing}getLastComputeTime(){return this.lastComputeTimeMs}subscribe(e){return this.listeners.add(e),e(this.sparklines,this.isComputing),()=>{this.listeners.delete(e)}}clear(){this.sparklines.clear(),this.notifyListeners()}terminate(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.worker&&(this.worker.terminate(),this.worker=null),this.listeners.clear()}},yo=new class{constructor(){t(this,"worker",null),t(this,"isInitialized",!1),t(this,"statsListeners",new Set),t(this,"packetsListeners",new Set),t(this,"errorListeners",new Set),t(this,"readyResolve",null),t(this,"readyPromise",null)}async init(e){if(!this.isInitialized&&"undefined"!=typeof window){this.readyPromise=new Promise(e=>{this.readyResolve=e});try{this.worker=new Worker(new URL("/assets/polling.worker-DFp1Qyu0.js",import.meta.url),{type:"module"}),this.worker.onmessage=this.handleMessage.bind(this),this.worker.onerror=e=>{};const t={type:"init",config:{apiBaseUrl:e.apiBaseUrl,authToken:e.authToken,statsIntervalMs:e.statsIntervalMs??3e3,packetsIntervalMs:e.packetsIntervalMs??3e3}};this.worker.postMessage(t),this.isInitialized=!0,await this.readyPromise}catch(t){throw t}}}handleMessage(e){var t;const s=e.data;switch(s.type){case"ready":null==(t=this.readyResolve)||t.call(this);break;case"stats":for(const e of this.statsListeners)try{e(s.data,s.timestamp)}catch(n){}break;case"packets":for(const e of this.packetsListeners)try{e(s.newPackets,s.totalCount,s.newestTimestamp)}catch(n){}break;case"packetsReset":for(const e of this.packetsListeners)try{e([],0,s.newestTimestamp)}catch(n){}break;case"error":for(const e of this.errorListeners)try{e(s.source,s.error)}catch(n){}}}onStats(e){return this.statsListeners.add(e),()=>this.statsListeners.delete(e)}onPackets(e){return this.packetsListeners.add(e),()=>this.packetsListeners.delete(e)}onError(e){return this.errorListeners.add(e),()=>this.errorListeners.delete(e)}setAuthToken(e){if(!this.worker)return;const t={type:"setAuth",token:e};this.worker.postMessage(t)}setLiveMode(e){if(!this.worker)return;const t={type:"setLiveMode",enabled:e};this.worker.postMessage(t)}forceRefresh(){this.worker&&this.worker.postMessage({type:"forceRefresh"})}clearCache(){this.worker&&this.worker.postMessage({type:"clearCache"})}terminate(){if(this.worker){const e={type:"stop"};this.worker.postMessage(e),this.worker.terminate(),this.worker=null}this.isInitialized=!1,this.statsListeners.clear(),this.packetsListeners.clear(),this.errorListeners.clear()}isReady(){return this.isInitialized}},xo=.05,wo=1e3,bo="terrarium";function ko(e,t,s){try{return e.queryTerrainElevation({lng:t,lat:s})??0}catch{return 0}}const vo=a((e,t)=>({terrainGrid:null,isLoading:!1,error:null,lastLoadedAt:null,cachedBounds:null,terrainDisambiguationEnabled:!0,loadTerrain:async(s,n)=>{const a=t();if(!(a.isLoading||(o=a.cachedBounds,i=s,o&&o.minLat<=i.minLat&&o.maxLat>=i.maxLat&&o.minLng<=i.minLng&&o.maxLng>=i.maxLng))){var o,i;e({isLoading:!0,error:null});try{n.getTerrain()||(n.getSource(bo)||(n.addSource(bo,{type:"raster-dem",tiles:["https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png"],encoding:"terrarium",tileSize:256}),await new Promise((e,t)=>{const s=setTimeout(()=>t(new Error("Terrain source load timeout")),1e4),a=t=>{t.sourceId===bo&&t.isSourceLoaded&&(clearTimeout(s),n.off("sourcedata",a),e())};n.on("sourcedata",a)})),n.setTerrain({source:bo}),await new Promise(e=>setTimeout(e,500)));const t=await async function(e,t){const{minLat:s,maxLat:n,minLng:a,maxLng:o}=t;let i=Math.ceil((o-a)/.001),l=Math.ceil((n-s)/.001);i>wo&&(i=wo),l>wo&&(l=wo);const r=(o-a)/i,c=(n-s)/l,u=Math.max(r,c),d=new Float32Array(i*l);let h=0;for(let f=0;f<l;f++){const t=s+(f+.5)*c;for(let s=0;s<i;s++){const n=a+(s+.5)*r;d[h]=ko(e,n,t),h++,h%100==0&&await new Promise(e=>setTimeout(e,0))}}return{origin:[s,a],cellSize:u,width:i,height:l,elevations:d}}(n,s);e({terrainGrid:t,isLoading:!1,lastLoadedAt:Date.now(),cachedBounds:s})}catch(l){const t=l instanceof Error?l.message:"Unknown error loading terrain";e({isLoading:!1,error:t})}}},preloadFromNodes:async(e,s)=>{const n=function(e){const t=e.filter(e=>void 0!==e.latitude&&void 0!==e.longitude&&(0!==e.latitude||0!==e.longitude));if(0===t.length)return null;let s=1/0,n=-1/0,a=1/0,o=-1/0;for(const i of t)s=Math.min(s,i.latitude),n=Math.max(n,i.latitude),a=Math.min(a,i.longitude),o=Math.max(o,i.longitude);return{minLat:s-xo,maxLat:n+xo,minLng:a-xo,maxLng:o+xo}}(e);n&&await t().loadTerrain(n,s)},clearTerrain:()=>{e({terrainGrid:null,cachedBounds:null,lastLoadedAt:null,error:null})},setTerrainDisambiguationEnabled:t=>{e({terrainDisambiguationEnabled:t})},getTerrainGridForDisambiguation:()=>{const e=t();return e.terrainDisambiguationEnabled?e.terrainGrid:null}}));function So(e){return e.startsWith("0x")||e.startsWith("0X")?e.slice(2,4).toUpperCase():e.slice(0,2).toUpperCase()}function _o(e,t){let s=e.forwarded_path??e.original_path;if("string"==typeof s)try{s=JSON.parse(s)}catch{return null}if(!s||!Array.isArray(s)||0===s.length)return null;const n=s.map(e=>String(e).toUpperCase()),a=t?So(t):null,o=n[n.length-1],i=null!==a&&o===a,l=i?n.slice(0,-1):[...n];return{effective:l,original:n,hadLocal:i,effectiveLength:l.length}}function Mo(e,t){const s=e.toUpperCase();return t.startsWith("0x")||t.startsWith("0X")?t.slice(2).toUpperCase().startsWith(s):t.toUpperCase().startsWith(s)}const jo=[{label:"20m",minutes:20,buckets:40},{label:"1h",minutes:60,buckets:60},{label:"3h",minutes:180,buckets:90},{label:"12h",minutes:720,buckets:72},{label:"24h",minutes:1440,buckets:96},{label:"3d",minutes:4320,buckets:72},{label:"7d",minutes:10080,buckets:84}],Co=[{label:"1h",hours:1},{label:"3h",hours:3},{label:"12h",hours:12},{label:"24h",hours:24},{label:"3d",hours:72},{label:"7d",hours:168}];function To(e){switch(e){case 1:return 3600;case 3:case 12:return 5400;case 24:return 8640;case 72:case 168:return 720;default:{const t=3600*e,s=Math.round(t/10);return Math.min(Math.max(360,s),720)}}}const No={stats:3e3,packets:3e3,charts:3e4,logs:2e3,system:3e3},Lo={DEBUG:"text-[var(--log-debug)]",INFO:"text-[var(--log-info)]",WARNING:"text-[var(--log-warning)]",ERROR:"text-[var(--log-error)]",CRITICAL:"text-[var(--log-critical)]"};function Po(e){return Lo[e]||"text-text-muted border-border-subtle"}const Eo="pymc-resource-history",Ao="pymc-resource-last-fetch",Io="pymc-hidden-contacts",Do="pymc-quick-neighbors",Ro="pymc-local-hash";let zo=null,Fo=null;function Oo(e,t){const s=t-1e3*e;return s<=6048e5?"active":s<=12096e5?"stale":"expired"}function $o(e){return 4===(e.type??e.payload_type)&&!0!==e.transmitted&&function(e){const t=function(e){if(Array.isArray(e))return e;if("string"==typeof e&&e.startsWith("["))try{const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}return[]}(e.original_path),s=e.route??e.route_type;return 2===(n=s)||3===n?0===t.length:da(s)?t.length<=1:0===t.length;var n}(e)}function Wo(e,t,s,n,a){if(!e)return null;let o=e;if(e.length<=4){const n=e.replace(/^0x/i,"").toUpperCase();if(n===t)return null;const a=s.get(n);if(!a)return null;o=a}return n.has(o)?o===a?null:o:null}function Ho(e,t){e.count++,void 0!==t.rssi&&null!==t.rssi&&(e.rssiSum+=t.rssi,e.rssiCount++),void 0!==t.snr&&null!==t.snr&&(e.snrSum+=t.snr,e.snrCount++);const s=t.timestamp??0;s>e.lastSeen&&(e.lastSeen=s)}function Bo(e){return{hash:e,count:0,rssiSum:0,rssiCount:0,snrSum:0,snrCount:0,lastSeen:0}}function Uo(e,t){const s=Oo(e.lastSeen,t);return"expired"===s?null:{hash:e.hash,prefix:So(e.hash),count:e.count,avgRssi:e.rssiCount>0?e.rssiSum/e.rssiCount:null,avgSnr:e.snrCount>0?e.snrSum/e.snrCount:null,lastSeen:e.lastSeen,status:s}}function qo(){if("undefined"==typeof window)return[];try{const e=localStorage.getItem(Do);if(e)return JSON.parse(e)}catch{}return[]}function Go(e){"undefined"!=typeof window&&(Fo&&clearTimeout(Fo),Fo=setTimeout(()=>{try{localStorage.setItem(Do,JSON.stringify(e))}catch{}Fo=null},1e3))}function Jo(){if("undefined"!=typeof window)try{const e=localStorage.getItem(Ro);if(e)return e}catch{}}function Vo(e){if("undefined"!=typeof window)try{localStorage.setItem(Ro,e)}catch{}}function Yo(){if("undefined"==typeof window)return[];try{const e=localStorage.getItem(Eo);if(e)return JSON.parse(e)}catch{}return[]}function Ko(){if("undefined"==typeof window)return new Set;try{const e=localStorage.getItem(Io);if(e)return new Set(JSON.parse(e))}catch{}return new Set}function Xo(){if("undefined"==typeof window)return 0;try{const e=localStorage.getItem(Ao);if(e)return parseInt(e,10)||0}catch{}return 0}const Qo=a((e,t)=>({stats:null,statsLoading:!1,statsError:null,packets:[],packetsLoading:!1,packetsError:null,lastPacketTimestamp:0,logs:[],logsLoading:!1,liveMode:!0,flashReceived:0,flashAdvert:0,resourceHistory:Yo(),lastResourceFetch:Xo(),hiddenContacts:Ko(),quickNeighbors:qo(),cachedLocalHash:Jo(),initialized:!1,packetCacheState:ho.getState(),mutationsInFlight:new Set,initializeApp:async()=>{const{initialized:s}=t();if(!s){e({initialized:!0,statsLoading:!0,packetsLoading:!0}),ho.subscribe(t=>{e({packetCacheState:t})});try{const{hiddenContacts:s}=t(),n=await Ia(),a=n.neighbors??{},o=Date.now(),i=[];for(const[e,t]of Object.entries(a)){if(s.has(e))continue;if(!t.zero_hop)continue;const n=Oo(t.last_seen??0,o);"expired"!==n&&i.push({hash:e,prefix:So(e),count:t.advert_count??0,avgRssi:t.rssi??null,avgSnr:t.snr??null,lastSeen:t.last_seen??0,status:n})}i.sort((e,t)=>t.count!==e.count?t.count-e.count:t.lastSeen-e.lastSeen);const l=n.local_hash;e({stats:n,statsLoading:!1,quickNeighbors:i,cachedLocalHash:l}),Go(i),l&&Vo(l);const r=()=>{const s=ho.getPackets();if(s.length>0){const n=s.reduce((e,t)=>{const s=t.timestamp??0;return s>e?s:e},0);e({packets:[...s],lastPacketTimestamp:n}),t().triggerTopologyCompute(),t().triggerSparklineCompute()}},c=await ho.initialLoad(r);if(c.length>0){const s=c.reduce((e,t)=>{const s=t.timestamp??0;return s>e?s:e},0);e({packets:[...c],packetsLoading:!1,lastPacketTimestamp:s}),t().triggerTopologyCompute(),t().triggerSparklineCompute()}else e({packetsLoading:!1})}catch(n){e({statsError:n instanceof Error?n.message:"Failed to initialize",statsLoading:!1,packetsLoading:!1})}try{await yo.init({apiBaseUrl:"",authToken:localStorage.getItem("pymc_jwt_token")??void 0,statsIntervalMs:No.stats,packetsIntervalMs:No.packets}),yo.onStats((s,n)=>{const{mutationsInFlight:a,hiddenContacts:o}=t();if(a.size>0)return;const i=s.neighbors??{},l=Date.now(),r=[];for(const[e,t]of Object.entries(i)){if(o.has(e))continue;if(!t.zero_hop)continue;const s=Oo(t.last_seen??0,l);"expired"!==s&&r.push({hash:e,prefix:So(e),count:t.advert_count??0,avgRssi:t.rssi??null,avgSnr:t.snr??null,lastSeen:t.last_seen??0,status:s})}r.sort((e,t)=>t.count!==e.count?t.count-e.count:t.lastSeen-e.lastSeen);const c=s.local_hash;e({stats:s,statsLoading:!1,quickNeighbors:r,cachedLocalHash:c}),Go(r),c&&Vo(c)}),yo.onPackets((s,n,a)=>{if(0===s.length)return;const{lastPacketTimestamp:o}=t();for(const e of s)if(e.packet_hash){ho.mergePacketsDirectly(s);break}const i=a>o;i&&(e({flashReceived:t().flashReceived+1}),Ha());const l=ho.getPackets();e({packets:l,packetsLoading:!1,lastPacketTimestamp:a}),i&&t().triggerTopologyCompute()}),yo.onError((t,s)=>{e("stats"===t?{statsError:s}:{packetsError:s})}),"undefined"!=typeof document&&document.addEventListener("visibilitychange",()=>{document.hidden||yo.forceRefresh()})}catch(n){!function(e){setInterval(()=>{e().fetchStats()},No.stats),setInterval(()=>{e().liveMode&&!ho.isHeavyLoadInProgress()&&e().fetchPackets()},No.packets)}(t)}}},prefetchForRoute:e=>{switch(e){case"/logs":Da().catch(()=>{});break;case"/system":za().catch(()=>{});break;case"/statistics":(async function(e=24){return Ea(`/api/packet_type_graph_data?hours=${e}`)})(3).catch(()=>{}),Ra(3).catch(()=>{});break;case"/settings":(async function(){return Ea("/api/radio_presets")})().catch(()=>{})}},fetchStats:async s=>{const{stats:n,mutationsInFlight:a,hiddenContacts:o}=t();if(!(a.size>0)||(null==s?void 0:s.force)){n||e({statsLoading:!0}),e({statsError:null});try{const t=await Ia(),s=t.neighbors??{},n=Date.now(),a=[];for(const[e,l]of Object.entries(s)){if(o.has(e))continue;if(!l.zero_hop)continue;const t=Oo(l.last_seen??0,n);"expired"!==t&&a.push({hash:e,prefix:So(e),count:l.advert_count??0,avgRssi:l.rssi??null,avgSnr:l.snr??null,lastSeen:l.last_seen??0,status:t})}a.sort((e,t)=>t.count!==e.count?t.count-e.count:t.lastSeen-e.lastSeen);const i=t.local_hash;e({stats:t,statsLoading:!1,quickNeighbors:a,cachedLocalHash:i}),Go(a),i&&Vo(i)}catch(i){e({statsError:i instanceof Error?i.message:"Failed to fetch stats",statsLoading:!1})}}},fetchPackets:async s=>{const{packets:n,lastPacketTimestamp:a}=t();0===n.length&&e({packetsLoading:!0}),e({packetsError:null});try{const s=await ho.poll(),o=s.length>0?s.reduce((e,t)=>Math.max(e,t.timestamp??0),0):0,i=o>a&&a>0,l=s.length!==n.length||i;i&&(e({flashReceived:t().flashReceived+1}),Ha()),e(l?{packets:s,packetsLoading:!1,lastPacketTimestamp:o||a}:{packetsLoading:!1}),i&&t().triggerTopologyCompute()}catch(o){e({packetsError:o instanceof Error?o.message:"Failed to fetch packets",packetsLoading:!1})}},fetchLogs:async()=>{const{logs:s}=t();0===s.length&&e({logsLoading:!0});try{const t=await Da();e({logs:t.logs,logsLoading:!1})}catch{e({logsLoading:!1})}},setLiveMode:t=>{e({liveMode:t}),yo.isReady()&&yo.setLiveMode(t)},setMode:async s=>{const n="setMode",{mutationsInFlight:a}=t(),o=new Set(a);o.add(n),e({mutationsInFlight:o});try{if(!(await Oa(s)).success)throw new Error("Backend returned unsuccessful response");await t().fetchStats({force:!0})}catch(i){const{mutationsInFlight:s}=t(),a=new Set(s);throw a.delete(n),e({mutationsInFlight:a}),i}},clearModeMutation:()=>{const{mutationsInFlight:s}=t(),n=new Set(s);n.delete("setMode"),e({mutationsInFlight:n})},setDutyCycle:async s=>{const n="setDutyCycle",{mutationsInFlight:a}=t(),o=new Set(a);o.add(n),e({mutationsInFlight:o});try{if(!(await $a(s)).success)throw new Error("Backend returned unsuccessful response");await t().fetchStats({force:!0})}finally{const{mutationsInFlight:s}=t(),a=new Set(s);a.delete(n),e({mutationsInFlight:a})}},setDutyCycleConfig:async s=>{var n;const a="setDutyCycleConfig",{mutationsInFlight:o}=t(),i=new Set(o);i.add(a),e({mutationsInFlight:i});try{const e=await async function(e){return Ea("/api/update_duty_cycle_config",{method:"POST",body:JSON.stringify(e)})}(s);if(!e.success&&!(null==(n=e.data)?void 0:n.persisted))throw new Error("Backend returned unsuccessful response");await t().fetchStats({force:!0})}catch(l){const{mutationsInFlight:s}=t(),n=new Set(s);throw n.delete(a),e({mutationsInFlight:n}),l}},clearDutyCycleMutation:()=>{const{mutationsInFlight:s}=t(),n=new Set(s);n.delete("setDutyCycleConfig"),e({mutationsInFlight:n})},sendAdvert:async()=>{try{const s=await Fa();return s.success&&e({flashAdvert:t().flashAdvert+1}),s.success}catch(s){return!1}},triggerFlashReceived:()=>{e({flashReceived:t().flashReceived+1})},triggerFlashAdvert:()=>{e({flashAdvert:t().flashAdvert+1})},addResourceDataPoint:(s,n,a)=>{const o=Date.now(),{lastResourceFetch:i,resourceHistory:l}=t();if(o-i<1e3)return;const r=[...l,{timestamp:o,time:new Date(o).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),cpu:s,memory:n}],c=r.length>a?r.slice(-a):r;var u,d;e({resourceHistory:c,lastResourceFetch:o}),u=c,d=o,"undefined"!=typeof window&&(zo&&clearTimeout(zo),zo=setTimeout(()=>{try{localStorage.setItem(Eo,JSON.stringify(u)),localStorage.setItem(Ao,d.toString())}catch{}zo=null},1e3))},hideContact:s=>{const{hiddenContacts:n}=t(),a=new Set(n);a.add(s),e({hiddenContacts:a}),function(e){if("undefined"!=typeof window)try{localStorage.setItem(Io,JSON.stringify([...e]))}catch{}}(a)},clearPacketCache:()=>{ho.clear(),e({packets:[],lastPacketTimestamp:0}),ho.quickLoad().then(s=>{if(s.length>0){const n=s.reduce((e,t)=>Math.max(e,t.timestamp??0),0);e({packets:s,lastPacketTimestamp:n}),t().triggerTopologyCompute()}})},triggerTopologyCompute:()=>{var e,s,n,a;const{packets:o,stats:i,hiddenContacts:l}=t();if(0===o.length||!i)return;const r=i.neighbors??{},c=Object.fromEntries(Object.entries(r).filter(([e])=>!l.has(e))),u=i.local_hash,d=null==(s=null==(e=i.config)?void 0:e.repeater)?void 0:s.latitude,h=null==(a=null==(n=i.config)?void 0:n.repeater)?void 0:a.longitude,f=[];for(const[t,m]of Object.entries(c))m.zero_hop&&f.push({hash:t,advertCount:m.advert_count??1,avgRssi:m.rssi??null,avgSnr:m.snr??null,lastSeen:m.last_seen??0,latitude:m.latitude,longitude:m.longitude});const p=vo.getState().getTerrainGridForDisambiguation();mo.compute(o,c,u,d,h,void 0,f,p??void 0)},triggerDeepAnalysis:async()=>{await ho.forceDeepLoad();const s=ho.getPackets();if(s.length>0){const n=s.reduce((e,t)=>Math.max(e,t.timestamp??0),0);e({packets:s,lastPacketTimestamp:n}),t().triggerTopologyCompute(),t().triggerSparklineCompute()}},updateQuickNeighbors:()=>{const{packets:s,stats:n,hiddenContacts:a}=t();if(0===s.length||!n)return;const o=n.neighbors??{},i=function(e,t,s){if(!s||0===e.length||0===Object.keys(t).length)return[];const n=Date.now(),a=So(s),o=new Set(Object.keys(t)),i=function(e){var t,s;const n=new Map;for(const a of Object.keys(e)){const o=So(a),i=n.get(o);if(i){const l=null==(t=e[i])?void 0:t.zero_hop;(null==(s=e[a])?void 0:s.zero_hop)&&!l&&n.set(o,a)}else n.set(o,a)}return n}(t),l=new Map;for(const c of e){if(!$o(c))continue;const e=Wo(c.src_hash,a,i,o,s);if(!e)continue;let t=l.get(e);t||(t=Bo(e),l.set(e,t)),Ho(t,c)}for(const[c,u]of Object.entries(t))u.zero_hop&&!l.has(c)&&l.set(c,{hash:c,count:u.advert_count??0,rssiSum:u.rssi??0,rssiCount:void 0!==u.rssi?1:0,snrSum:u.snr??0,snrCount:void 0!==u.snr?1:0,lastSeen:u.last_seen??0});const r=[];for(const c of l.values()){const e=Uo(c,n);e&&r.push(e)}return r.sort((e,t)=>t.count!==e.count?t.count-e.count:t.lastSeen-e.lastSeen),r}(s,Object.fromEntries(Object.entries(o).filter(([e])=>!a.has(e))),n.local_hash),l=t().quickNeighbors;(i.length!==l.length||i.some((e,t)=>{var s,n;return e.hash!==(null==(s=l[t])?void 0:s.hash)||e.count!==(null==(n=l[t])?void 0:n.count)}))&&(e({quickNeighbors:i}),Go(i))},triggerSparklineCompute:()=>{const{packets:e,stats:s,hiddenContacts:n}=t();if(0===e.length||!s)return;const a=s.neighbors??{},o=Object.keys(a).filter(e=>!n.has(e));0!==o.length&&go.compute(e,o)}})),Zo=Qo,ei=()=>Qo(e=>e.stats),ti=()=>Qo(e=>e.statsError),si=()=>Qo(e=>e.packets),ni=()=>Qo(e=>e.packetsLoading),ai=()=>Qo(e=>e.logs),oi=()=>Qo(e=>e.logsLoading),ii=()=>Qo(e=>e.liveMode),li=()=>Qo(e=>e.flashAdvert),ri=()=>Qo(e=>e.fetchLogs),ci=()=>Qo(e=>e.setLiveMode),ui=()=>Qo(e=>e.resourceHistory),di=()=>Qo(e=>e.addResourceDataPoint),hi=()=>Qo(e=>e.hiddenContacts),fi=()=>Qo(e=>e.hideContact),pi=()=>Qo(e=>e.packetCacheState),mi=()=>Qo(e=>e.triggerDeepAnalysis),gi=()=>Qo(e=>e.quickNeighbors),yi=()=>Qo(e=>e.cachedLocalHash),xi=()=>Qo(e=>e.lastPacketTimestamp),wi=()=>Qo(e=>e.packetCacheState.backgroundLoadComplete);function bi({showLabel:e=!1,className:t}){const a=Qo(e=>e.flashReceived),o=li(),[i,l]=s.useState("idle");return s.useEffect(()=>{if(a>0){l("received");const e=setTimeout(()=>l("idle"),300);return()=>clearTimeout(e)}},[a]),s.useEffect(()=>{if(o>0){l("transmitted");const e=setTimeout(()=>l("idle"),300);return()=>clearTimeout(e)}},[o]),n.jsxs("span",{className:E("inline-flex items-center gap-2",t),children:[n.jsx("span",{className:E("inline-flex rounded-full h-2 w-2 transition-all duration-150","received"===i&&"bg-accent-danger scale-150","transmitted"===i&&"bg-white scale-150","idle"===i&&"bg-accent-success")}),e&&n.jsx("span",{className:"type-data-xs text-text-muted uppercase tracking-wide",children:"Live"})]})}const ki=a(e=>({sparklines:new Map,isComputing:!1,lastUpdated:0,nodeCount:0,setSparklines:t=>e({sparklines:t,lastUpdated:Date.now(),nodeCount:t.size,isComputing:!1}),setComputing:t=>e({isComputing:t})}));"undefined"!=typeof window&&setTimeout(()=>{go.subscribe((e,t)=>{const s=ki.getState();t&&!s.isComputing?s.setComputing(!0):!t&&e.size>0?s.setSparklines(e):!t&&s.isComputing&&s.setComputing(!1)})},0);const vi=()=>ki(e=>e.isComputing),Si=[],_i=new Map;function Mi(e){return ki(t=>{const s=t.sparklines.get(e);if(!s||0===s.length)return Si;const n=_i.get(e);return n===s?n:(_i.set(e,s),s)})}const ji=a(e=>({topology:{edges:[],validatedEdges:[],weakEdges:[],certainEdges:[],uncertainEdges:[],edgeMap:new Map,maxPacketCount:0,maxCertainCount:0,neighborAffinity:new Map,fullAffinity:new Map,localPrefix:null,centrality:new Map,hubNodes:[],gatewayNodes:[],loops:[],loopEdgeKeys:new Set,txDelayRecommendations:new Map,pathRegistry:po(),edgeBetweenness:new Map,backboneEdges:[],nodeMobility:new Map,mobileNodes:[],pathHealth:[],lastHopNeighbors:[],disambiguationStats:{totalPrefixes:0,unambiguousPrefixes:0,collisionPrefixes:0,collisionRate:0,avgConfidence:0,lowConfidencePrefixes:[],highCollisionPrefixes:[],totalResolutions:0},discoveredNodes:[],viterbiStats:{totalPaths:0,pathsWithGhosts:0,avgPathCost:0,avgPathConfidence:0,observationOverrideCount:0,tracePacketsProcessed:0,pathPacketsProcessed:0,distantEdgesDiscovered:0,duplicateGroupsFound:0,duplicatePathsUnique:0,echolocationEdgesInferred:0}},isComputing:!1,lastComputeTimeMs:0,lastUpdated:0,setTopology:(t,s)=>e({topology:t,lastComputeTimeMs:s,lastUpdated:Date.now(),isComputing:!1}),setComputing:t=>e({isComputing:t})}));"undefined"!=typeof window&&mo.subscribe((e,t)=>{ji.getState().setTopology(e,t)});const Ci=()=>ji(e=>e.topology),Ti=()=>ji(e=>e.topology.hubNodes),Ni=()=>ji(e=>e.topology.centrality),Li=()=>ji(e=>e.topology.fullAffinity);let Pi=null,Ei=null,Ai=null,Ii=null;const Di=()=>ji(e=>(e.topology.hubNodes!==Ei&&(Ei=e.topology.hubNodes,Pi=new Set(e.topology.hubNodes)),Pi)),Ri=()=>ji(e=>e.topology.pathHealth),zi=()=>ji(e=>e.topology.disambiguationStats),Fi=()=>ji(e=>e.topology.disambiguationStats.highCollisionPrefixes),Oi=()=>ji(e=>e.topology.disambiguationStats.totalPrefixes>0),$i=()=>ji(e=>e.topology.discoveredNodes),Wi=()=>ji(e=>e.topology.viterbiStats),Hi=()=>ji(e=>(e.topology.discoveredNodes!==Ii&&(Ii=e.topology.discoveredNodes,Ai=e.topology.discoveredNodes.filter(e=>e.isLikelyReal)),Ai));function Bi(e){if(e<60)return`${Math.floor(e)}s`;const t=Math.floor(e/86400),s=Math.floor(e%86400/3600),n=Math.floor(e%3600/60),a=[];return t>0&&a.push(`${t}d`),s>0&&a.push(`${s}h`),(n>0||0===a.length)&&a.push(`${n}m`),a.join(" ")}function Ui(e){const t=Date.now()/1e3-e;return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:`${Math.floor(t/86400)}d ago`}function qi(e){const t=Date.now()/1e3-e;return t<60?`${Math.floor(t)}s`:t<3600?`${Math.floor(t/60)}m`:t<86400?`${Math.floor(t/3600)}h`:`${Math.floor(t/86400)}d`}function Gi(e){return new Date(1e3*e).toLocaleString()}function Ji(e){const t=new Date(1e3*e);return`${t.toLocaleString("en-US",{month:"short"})} ${t.getDate()}, ${t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}`}function Vi(e){return`${(e/1e6).toFixed(3)} MHz`}function Yi(e){return`${(e/1e3).toFixed(1)} kHz`}function Ki(e){const t=e>1e12?e:1e3*e,s=Date.now(),n=Math.abs(s-t),a=Math.floor(n/1e3),o=Math.floor(a/60),i=Math.floor(o/60),l=Math.floor(i/24);return l>0?`${l} day${1!==l?"s":""}`:i>0?`${i} hour${1!==i?"s":""}`:o>0?`${o} minute${1!==o?"s":""}`:`${a} second${1!==a?"s":""}`}const Xi=[{name:"Dashboard",to:"/",icon:r},{name:"Contacts",to:"/contacts",icon:c},{name:"Packets",to:"/packets",icon:u},{name:"Statistics",to:"/statistics",icon:d},{name:"System",to:"/system",icon:h},{name:"Logs",to:"/logs",icon:f},{name:"Terminal",to:"/terminal",icon:p},{name:"Configuration",to:"/configuration",icon:m}],Qi="pymc-controls-expanded";function Zi(){var e,t,a,r;const{pathname:c}=o(),{stats:u,setMode:d,setDutyCycle:f,sendAdvert:p}=Zo(),m=Ma(),j=Qo(e=>e.prefetchForRoute),C=pi(),T=vi(),N=ji(e=>e.isComputing),L=Hi(),[P,A]=s.useState(!1),[I,D]=s.useState(!0),[R,z]=s.useState(!1),F=s.useRef(null),O=s.useCallback(e=>{e!==c&&(F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{j(e)},100))},[c,j]),$=s.useCallback(()=>{F.current&&(clearTimeout(F.current),F.current=null)},[]);s.useEffect(()=>{const e=localStorage.getItem(Qi);null!==e&&queueMicrotask(()=>D("true"===e))},[]);const W=()=>{const e=!I;D(e),localStorage.setItem(Qi,String(e))};s.useEffect(()=>{queueMicrotask(()=>A(!1))},[c]),s.useEffect(()=>(document.body.style.overflow=P?"hidden":"",()=>{document.body.style.overflow=""}),[P]);const H=null==u?void 0:u.noise_floor_dbm,B=(null==(t=null==(e=null==u?void 0:u.config)?void 0:e.repeater)?void 0:t.mode)??"forward",U=(null==(r=null==(a=null==u?void 0:u.config)?void 0:a.duty_cycle)?void 0:r.enforcement_enabled)??!1,q=async()=>{z(!0),await p(),setTimeout(()=>z(!1),1e3)},G=()=>{d("forward"===B?"monitor":"forward")},J=()=>{f(!U)},V=()=>{Ta(),window.location.href="/login"},Y=C.isLoading||C.isTopologyLoading,K=Y||T||N,X=C.loadProgress,Q=()=>{if(!K)return null;let e="Analyzing database";Y&&X?e=`Loading ${X.loaded.toLocaleString()} packets`:T?e="Computing sparklines":N&&(e="Building topology");const t=(null==X?void 0:X.percent)??null,s=null!==t&&Y;return n.jsxs("div",{className:"px-3 pb-2",children:[n.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5",children:[n.jsxs("div",{className:"relative flex h-2 w-2",children:[n.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-accent-primary opacity-75"}),n.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-accent-primary"})]}),n.jsx("span",{className:"type-data-xs text-text-muted",children:e}),s&&n.jsxs("span",{className:"type-data-xs text-text-muted ml-auto",children:[t,"%"]})]}),n.jsx("div",{className:"mx-2 h-0.5 bg-white/5 rounded-full overflow-hidden",children:s?n.jsx("div",{className:"h-full bg-accent-primary/60 rounded-full transition-all duration-300 ease-out",style:{width:`${t}%`}}):n.jsx("div",{className:"h-full bg-accent-primary/60 rounded-full animate-pulse",style:{width:"100%",animation:"shimmer 1.5s ease-in-out infinite"}})})]})},Z=()=>n.jsx("nav",{className:"flex-1 px-3 py-4 space-y-1 overflow-y-auto",children:Xi.map(e=>{const t=c===e.to;return n.jsxs(g,{to:e.to,onClick:()=>A(!1),onMouseEnter:()=>O(e.to),onMouseLeave:$,className:E("flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-150 min-h-[44px]",t?"bg-accent-primary/15 text-accent-primary":"text-text-muted hover:text-text-primary hover:bg-white/5"),children:[n.jsx(e.icon,{className:E("w-5 h-5 flex-shrink-0",t&&"text-accent-primary")}),n.jsx("span",{className:"type-body-sm font-medium",children:e.name}),"/contacts"===e.to&&L.length>0&&n.jsxs("span",{className:"ml-auto flex items-center gap-1 px-1.5 py-0.5 rounded-full bg-accent-tertiary/20 text-accent-tertiary",children:[n.jsx(y,{className:"w-3 h-3"}),n.jsx("span",{className:"type-data-xs font-medium",children:L.length})]})]},e.name)})}),ee=()=>n.jsxs("div",{className:"px-3 py-3",children:[n.jsxs("button",{onClick:W,className:"w-full flex items-center justify-between px-2 py-1.5 mb-2 rounded-lg hover:bg-white/5 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(x,{className:"w-4 h-4 text-accent-primary"}),n.jsx("span",{className:"type-data-xs text-text-muted uppercase tracking-wide",children:"Controls"})]}),n.jsx(w,{className:E("w-4 h-4 text-text-muted transition-transform duration-200",I?"rotate-0":"-rotate-90")})]}),n.jsx("div",{className:E("overflow-hidden transition-all duration-300 ease-out",I?"max-h-96 opacity-100":"max-h-0 opacity-0"),children:n.jsxs("div",{className:"control-panel-skeuo",children:[n.jsxs("button",{onClick:q,disabled:R,className:E("control-btn control-btn-primary w-full",R&&"opacity-70"),children:[n.jsx(b,{className:E("w-4 h-4",R&&"animate-pulse")}),n.jsx("span",{children:R?"Sending...":"Send Advert"})]}),n.jsxs("div",{className:"control-toggle-group",children:[n.jsxs("div",{className:"control-toggle-label",children:[n.jsx("span",{children:"Mode"}),n.jsx("span",{className:E("control-toggle-status","forward"===B?"text-accent-success":"text-accent-secondary"),children:"forward"===B?"FWD":"MON"})]}),n.jsx("button",{onClick:G,className:E("control-btn w-full","forward"===B?"control-btn-success":"control-btn-warning"),children:"forward"===B?n.jsxs(n.Fragment,{children:[n.jsx(k,{className:"w-4 h-4"}),n.jsx("span",{children:"Forward"})]}):n.jsxs(n.Fragment,{children:[n.jsx(v,{className:"w-4 h-4"}),n.jsx("span",{children:"Monitor"})]})})]}),n.jsxs("div",{className:"control-toggle-group",children:[n.jsxs("div",{className:"control-toggle-label",children:[n.jsx("span",{children:"Duty Cycle"}),n.jsx("span",{className:E("control-toggle-status",U?"text-accent-success":"text-text-muted"),children:U?"ON":"OFF"})]}),n.jsxs("button",{onClick:J,className:E("control-btn w-full",U?"control-btn-success":"control-btn-neutral"),children:[n.jsx(h,{className:"w-4 h-4"}),n.jsx("span",{children:U?"Enabled":"Disabled"})]})]})]})})]}),te=()=>n.jsxs("div",{className:"mt-auto border-t border-white/5",children:[void 0!==(null==u?void 0:u.uptime_seconds)&&n.jsxs("div",{className:"px-4 py-3 flex items-center gap-2",children:[n.jsx(S,{className:"w-3.5 h-3.5 text-text-muted"}),n.jsxs("span",{className:"type-data-xs text-text-secondary tabular-nums",children:[Bi(u.uptime_seconds)," uptime"]})]}),n.jsx("div",{className:"px-3 pb-3",children:n.jsx("div",{className:"bg-white/[0.03] rounded-xl p-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(_,{className:"w-4 h-4 text-accent-primary"}),n.jsx("span",{className:"type-data-xs text-text-muted",children:"Noise Floor"})]}),n.jsx("span",{className:"type-data text-text-primary tabular-nums",children:null!=H?`${H.toFixed(0)} dBm`:""})]})})}),n.jsxs("div",{className:"px-4 py-3 flex items-center justify-between border-t border-white/5",children:[n.jsx(bi,{showLabel:!0}),(null==u?void 0:u.version)&&n.jsxs("span",{className:"type-data-xs text-text-muted",children:["v",u.version]})]}),n.jsx("div",{className:"px-3 pb-3",children:n.jsxs("button",{onClick:V,className:"w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-text-muted hover:text-accent-danger hover:bg-accent-danger/10 transition-all duration-150",children:[n.jsx(M,{className:"w-4 h-4"}),n.jsx("span",{className:"type-body-sm",children:"Sign Out"}),m&&n.jsxs("span",{className:"ml-auto type-data-xs text-text-muted",children:["(",m,")"]})]})})]});return n.jsxs(n.Fragment,{children:[n.jsx("header",{className:"lg:hidden fixed top-0 inset-x-0 z-[10001] h-14 bg-bg-body/70 backdrop-blur-xl border-b border-white/10",children:n.jsxs("div",{className:"flex items-center justify-between h-full px-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("a",{href:"https://wcmesh.com",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 rounded-xl overflow-hidden border border-white/10 shadow-lg shadow-black/20 hover:border-white/20 hover:shadow-xl transition-all flex-shrink-0",title:"West Coast Mesh",children:n.jsx("img",{src:ia,alt:"West Coast Mesh",className:"w-full h-full object-cover"})}),n.jsx("h1",{className:"sr-only",children:"pyMC Console"}),n.jsx(la,{height:20,className:"block"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("p",{className:"type-data-xs text-text-muted",children:["v",oa]}),n.jsx(bi,{}),n.jsx("button",{onClick:()=>A(!P),className:"w-10 h-10 flex items-center justify-center rounded-xl hover:bg-white/5 active:bg-white/10 transition-colors","aria-label":P?"Close menu":"Open menu",children:P?n.jsx(i,{className:"w-5 h-5 text-text-primary"}):n.jsx(l,{className:"w-5 h-5 text-text-primary"})})]})]})}),n.jsx("div",{className:E("lg:hidden fixed inset-0 z-[10002] bg-black/60 backdrop-blur-sm transition-opacity duration-300",P?"opacity-100":"opacity-0 pointer-events-none"),onClick:()=>A(!1),"aria-hidden":"true"}),n.jsxs("aside",{className:E("lg:hidden fixed top-0 left-0 z-[10003] w-72 max-w-[85vw] h-full","glass-sidebar","flex flex-col","transform transition-transform duration-300 ease-out",P?"translate-x-0":"-translate-x-full pointer-events-none"),children:[n.jsxs("div",{className:"flex items-center gap-3 px-4 py-5 border-b border-white/5",children:[n.jsx("a",{href:"https://wcmesh.com",target:"_blank",rel:"noopener noreferrer",className:"w-11 h-11 rounded-xl overflow-hidden border border-white/10 shadow-lg shadow-black/20 hover:border-white/20 hover:shadow-xl transition-all flex-shrink-0",title:"West Coast Mesh",children:n.jsx("img",{src:ia,alt:"West Coast Mesh",className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h1",{className:"sr-only",children:"pyMC Console"}),n.jsx(la,{height:18,className:"block"}),n.jsxs("p",{className:"type-data-xs text-text-muted mt-0.5",children:["v",oa]})]})]}),Z(),Q(),ee(),te()]}),n.jsxs("aside",{className:"hidden lg:flex flex-col w-64 flex-shrink-0 h-full relative glass-sidebar",children:[n.jsxs("div",{className:"flex items-center gap-3 px-5 py-6 border-b border-white/5",children:[n.jsx("a",{href:"https://wcmesh.com",target:"_blank",rel:"noopener noreferrer",className:"w-11 h-11 rounded-xl overflow-hidden border border-white/10 shadow-lg shadow-black/20 hover:border-white/20 hover:shadow-xl transition-all flex-shrink-0",title:"West Coast Mesh",children:n.jsx("img",{src:ia,alt:"West Coast Mesh",className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h1",{className:"sr-only",children:"pyMC Console"}),n.jsx(la,{height:18,className:"block"}),n.jsxs("p",{className:"type-data-xs text-text-muted mt-0.5",children:["v",oa]})]})]}),Z(),Q(),ee(),te()]})]})}const el=s.memo(function(){const{theme:e}=aa(),{backgroundImage:t,brightness:a}=e,[o,i]=s.useState(t),[l,r]=s.useState(!1);s.useEffect(()=>{if(t===o)return;const e=new Image;e.onload=()=>{r(!0),requestAnimationFrame(()=>{i(t),setTimeout(()=>r(!1),300)})},e.onerror=()=>{i(t)},e.src=t},[t,o]);const c=(100-a)/100;return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 -z-20",style:{contain:"paint",willChange:l?"opacity":"auto"},"aria-hidden":"true",children:n.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat transition-opacity duration-300 ease-out",style:{backgroundImage:`url(${o})`,opacity:l?.7:1}})}),n.jsx("div",{className:"fixed inset-0 -z-10 bg-black pointer-events-none transition-opacity duration-200 ease-out",style:{opacity:c,contain:"paint"},"aria-hidden":"true"})]})});function tl({className:e=""}){return n.jsx("div",{className:`bg-white/5 animate-pulse rounded-lg ${e}`,"aria-hidden":"true"})}function sl(){return n.jsxs("div",{className:"section-gap","aria-label":"Loading dashboard",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(tl,{className:"h-8 w-48"}),n.jsx(tl,{className:"h-8 w-32"})]}),n.jsx(tl,{className:"h-72"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3",children:Array.from({length:8}).map((e,t)=>n.jsx(tl,{className:"h-24"},t))}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Array.from({length:4}).map((e,t)=>n.jsx(tl,{className:"h-44"},t))}),n.jsx(tl,{className:"h-96"})]})}function nl(){return n.jsxs("div",{className:"section-gap","aria-label":"Loading list",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(tl,{className:"h-8 w-40"}),n.jsx(tl,{className:"h-8 w-24"})]}),n.jsx(tl,{className:"h-20"}),n.jsxs("div",{className:"glass-card overflow-hidden",children:[n.jsx(tl,{className:"h-10 rounded-none"}),n.jsx("div",{className:"divide-y divide-border-subtle/30",children:Array.from({length:10}).map((e,t)=>n.jsx("div",{className:"px-4 py-3",children:n.jsx(tl,{className:"h-6"})},t))})]})]})}function al(){return n.jsxs("div",{className:"section-gap","aria-label":"Loading map",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(tl,{className:"h-8 w-32"}),n.jsx(tl,{className:"h-6 w-48"})]}),n.jsx(tl,{className:"h-[500px]"}),n.jsx(tl,{className:"h-64"})]})}function ol(){return n.jsxs("div",{className:"section-gap","aria-label":"Loading charts",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(tl,{className:"h-8 w-36"}),n.jsx(tl,{className:"h-8 w-40"})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[n.jsx(tl,{className:"h-80"}),n.jsx(tl,{className:"h-80"})]}),n.jsx(tl,{className:"h-64"})]})}function il(){return n.jsxs("div",{className:"section-gap","aria-label":"Loading settings",children:[n.jsx(tl,{className:"h-8 w-32"}),n.jsxs("div",{className:"space-y-6",children:[n.jsx(tl,{className:"h-48"}),n.jsx(tl,{className:"h-64"}),n.jsx(tl,{className:"h-32"})]})]})}function ll(){return n.jsxs("div",{className:"section-gap","aria-label":"Loading system info",children:[n.jsx(tl,{className:"h-8 w-28"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Array.from({length:4}).map((e,t)=>n.jsx(tl,{className:"h-28"},t))}),n.jsx(tl,{className:"h-64"}),n.jsx(tl,{className:"h-48"})]})}const rl=s.lazy(()=>P(()=>import("./Login-BRMJGCre.js"),__vite__mapDeps([0,1,2]))),cl=s.lazy(()=>P(()=>import("./Dashboard-CxSB01mj.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10]))),ul=s.lazy(()=>P(()=>import("./Packets-BPJDPk-y.js"),__vite__mapDeps([11,1,2,6,7,8,5]))),dl=s.lazy(()=>P(()=>import("./Contacts-COOTfp9A.js").then(e=>e.C),__vite__mapDeps([12,1,2,7,8,13,14,5,15]))),hl=s.lazy(()=>P(()=>import("./Statistics-DHAWemnd.js"),__vite__mapDeps([16,1,2,9,17,4,5,14,10,15]))),fl=s.lazy(()=>P(()=>import("./System-CrqEvWlQ.js"),__vite__mapDeps([18,1,2,5,4,10]))),pl=s.lazy(()=>P(()=>import("./Logs-EmlcQX3b.js"),__vite__mapDeps([19,1,2,17,5]))),ml=s.lazy(()=>P(()=>import("./Terminal-BR-c97NN.js"),__vite__mapDeps([20,1,2,5]))),gl=s.lazy(()=>P(()=>import("./Configuration-B6ZMct7J.js"),__vite__mapDeps([21,1,2,8,13,5,10])));function yl({children:e}){const t=o();return ka()?n.jsx(n.Fragment,{children:e}):n.jsx(T,{to:"/login",state:{from:t},replace:!0})}class xl extends s.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}render(){var e;return this.state.hasError?n.jsxs("div",{className:"glass-card p-8 text-center",children:[n.jsx("p",{className:"type-subheading text-accent-red mb-2",children:"Page failed to render"}),n.jsx("p",{className:"type-body text-white/50 mb-4",children:(null==(e=this.state.error)?void 0:e.message)||"Unknown error"}),n.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-4 py-2 bg-accent-primary/20 text-accent-primary rounded-lg hover:bg-accent-primary/30 transition-colors",children:"Try Again"})]}):this.props.children}}function wl(){const e=Qo(e=>e.initializeApp),t=ka();return s.useEffect(()=>{t&&e()},[e,t]),n.jsxs(n.Fragment,{children:[n.jsx(el,{}),n.jsxs(j,{children:[n.jsx(C,{path:"/login",element:n.jsx(s.Suspense,{fallback:n.jsx("div",{className:"min-h-screen bg-bg-body"}),children:n.jsx(rl,{})})}),n.jsx(C,{path:"/*",element:n.jsx(yl,{children:n.jsxs("div",{className:"flex h-screen overflow-hidden",children:[n.jsx(Zi,{}),n.jsx("main",{className:"flex-1 w-full min-w-0 pt-14 lg:pt-0 overflow-y-auto",children:n.jsx("div",{className:"p-4 sm:p-6 lg:p-8 max-w-7xl mx-auto",children:n.jsx(xl,{children:n.jsxs(j,{children:[n.jsx(C,{path:"/",element:n.jsx(s.Suspense,{fallback:n.jsx(sl,{}),children:n.jsx(cl,{})})}),n.jsx(C,{path:"/packets",element:n.jsx(s.Suspense,{fallback:n.jsx(nl,{}),children:n.jsx(ul,{})})}),n.jsx(C,{path:"/contacts",element:n.jsx(s.Suspense,{fallback:n.jsx(al,{}),children:n.jsx(dl,{})})}),n.jsx(C,{path:"/statistics",element:n.jsx(s.Suspense,{fallback:n.jsx(ol,{}),children:n.jsx(hl,{})})}),n.jsx(C,{path:"/system",element:n.jsx(s.Suspense,{fallback:n.jsx(ll,{}),children:n.jsx(fl,{})})}),n.jsx(C,{path:"/logs",element:n.jsx(s.Suspense,{fallback:n.jsx(nl,{}),children:n.jsx(pl,{})})}),n.jsx(C,{path:"/terminal",element:n.jsx(s.Suspense,{fallback:n.jsx(nl,{}),children:n.jsx(ml,{})})}),n.jsx(C,{path:"/configuration",element:n.jsx(s.Suspense,{fallback:n.jsx(il,{}),children:n.jsx(gl,{})})})]})})})})]})})})]})]})}const bl=console.warn;console.warn=(...e)=>{const t=e[0];"string"==typeof t&&t.includes("width")&&t.includes("height")&&t.includes("chart should be greater than 0")||bl.apply(console,e)},N.createRoot(document.getElementById("root")).render(n.jsx(s.StrictMode,{children:n.jsx(na,{children:n.jsx(L,{children:n.jsx(wl,{})})})}));export{No as $,Ki as A,Mi as B,vi as C,jo as D,Fi as E,Zo as F,fi as G,Ti as H,Ni as I,Xa as J,Ui as K,fa as L,pa as M,Qn as N,ua as O,la as P,zi as Q,ca as R,Oi as S,Hi as T,ta as U,Co as V,ia as W,To as X,ui as Y,di as Z,za as _,ni as a,ai as a0,oi as a1,ri as a2,qa as a3,Po as a4,Ia as a5,Fa as a6,Oa as a7,$a as a8,Ua as a9,aa,D as ab,W as ac,to as ad,Ga as ae,Vi as af,Yi as ag,Qa as ah,Za as ai,eo as aj,so as ak,no as al,Ka as am,Ja as an,Va as ao,Ya as ap,xi as aq,ho as ar,_o as as,da as at,Ci as au,mi as av,pi as aw,yi as ax,vo as ay,ii as b,li as c,ei as d,gi as e,hi as f,So as g,Ra as h,ka as i,ti as j,wi as k,ja as l,Ba as m,Bi as n,ci as o,ra as p,qi as q,Ji as r,Mo as s,Di as t,si as u,Li as v,$i as w,Gi as x,Ri as y,Wi as z};
