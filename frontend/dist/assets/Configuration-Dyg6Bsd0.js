import{r as e,j as t,f as s,i as a,X as r,at as n,aa as l,aX as c,aY as i,k as d,p as o,aZ as u,af as m,a_ as x,a$ as p,b0 as h,aP as b,av as y,b1 as g,aj as f,b2 as j,a7 as v,a2 as N,$ as w,a9 as k,b3 as C}from"./vendor-react-2ZfjuUA7.js";import{ab as _,ac as S,ad as T,F,ae as E,af as L,ag as P,ah as R,aa as A,ai as M,aj as I,ak as D,al as z,am as O,an as q,ao as H,ap as K,aq as $}from"./index-KnCOc2qS.js";import{H as Y}from"./HashBadge-dI-tTEHS.js";import{C as V}from"./ConfirmModal-BeWQ-k5r.js";import{c as X}from"./recharts-C3mWud9g.js";import{P as B,b as U,a as G,c as W}from"./PageLayout-ngVnQCYp.js";import{R as Z,C as J}from"./Grid-Bnjce2EG.js";import"./vendor-core-BY0i4DpV.js";import"./deckgl-DTsmDcfs.js";const Q=e.memo(function({showLogoOnly:s=!1,showThumbnailsOnly:a=!1}){const{theme:r,setThemePreset:n,setBrightness:l}=_(),{backgroundImage:c,brightness:i}=r,[d,o]=e.useState(!1),[u,m]=e.useState(!1),x=e.useRef(null),p=e.useRef(null),h=S.find(e=>e.backgroundImage===c)??S[0],b=h.id,y=e.useCallback((e,t)=>{if(!p.current)return i;const s=(p.current.y-e)/(t?200:80)*100;return Math.round(Math.max(0,Math.min(100,p.current.brightness+s)))},[i]),g=e.useCallback(e=>{n(e),o(!0)},[n]),f=e.useCallback(e=>{l(e)},[l]),j=e.useCallback(e=>{const t=S.find(t=>t.id===e);t&&T(t.backgroundImage)},[]);if(s){const e=h.displaySize,s=`clamp(${.8*e}rem, ${.6*e}rem + 1.5vw, ${1.4*e}rem)`;return t.jsx("span",{className:"font-medium transition-all duration-300 leading-none",style:{fontFamily:h.displayFont,color:h.displayColor,fontSize:s,fontOpticalSizing:"auto",letterSpacing:"-0.03em"},children:h.displayName})}return t.jsx("div",{className:"flex gap-2 items-start flex-shrink-0",children:S.map(e=>{const s=b===e.id,a=s&&(d||u);return t.jsxs("div",{ref:s?x:void 0,title:e.displayName,className:X("flex flex-col items-center gap-1 p-0.5 rounded-sm transition-all duration-300 ease-out",s?"ring-2 ring-accent-primary scale-105 cursor-ns-resize":"cursor-pointer"),onMouseEnter:()=>{s?o(!0):j(e.id)},onMouseLeave:()=>!u&&o(!1),onClick:()=>!s&&g(e.id),onTouchStart:e=>{if(!s)return;e.preventDefault();const t=e.touches[0];p.current={y:t.clientY,brightness:i},m(!0),o(!0);const a=e=>{e.preventDefault();const t=e.touches[0];f(y(t.clientY,!0))},r=()=>{document.removeEventListener("touchmove",a),document.removeEventListener("touchend",r),p.current=null,m(!1),setTimeout(()=>o(!1),1500)};document.addEventListener("touchmove",a,{passive:!1}),document.addEventListener("touchend",r)},onMouseDown:e=>{if(!s)return;e.preventDefault(),p.current={y:e.clientY,brightness:i},m(!0),o(!0);const t=e=>{f(y(e.clientY,!1))},a=()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",a),p.current=null,m(!1)};document.addEventListener("mousemove",t),document.addEventListener("mouseup",a)},children:[t.jsxs("div",{className:"glass-thumbnail w-10 h-10",children:[t.jsx("div",{className:"absolute bg-cover bg-center transition-opacity duration-200",style:{inset:0,backgroundImage:`url(${e.backgroundImage})`,opacity:a?.4:1}}),s&&t.jsxs("div",{className:X("absolute inset-0 transition-opacity duration-200",a?"opacity-100":"opacity-0"),children:[t.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 transition-all duration-100 ease-out",style:{height:100-i+"%"}}),t.jsx("div",{className:"absolute inset-x-1 h-0.5 bg-white rounded-full shadow-lg transition-all duration-100 ease-out",style:{top:100-i+"%"}}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsxs("span",{className:"text-[10px] font-mono font-bold text-white drop-shadow-lg",children:[i,"%"]})})]})]}),t.jsx("div",{className:"flex flex-col gap-0.5",children:e.paletteColors.map((e,s)=>t.jsx("div",{className:"flex gap-0.5 justify-center",children:e.map((e,s)=>t.jsx("div",{className:"w-1.5 h-1.5 rounded-xs",style:{backgroundColor:e}},s))},s))})]},e.id)})})}),ee=[{value:7.8,label:"7.8 kHz"},{value:10.4,label:"10.4 kHz"},{value:15.6,label:"15.6 kHz"},{value:20.8,label:"20.8 kHz"},{value:31.25,label:"31.25 kHz"},{value:41.7,label:"41.7 kHz"},{value:62.5,label:"62.5 kHz"},{value:125,label:"125 kHz"},{value:250,label:"250 kHz"},{value:500,label:"500 kHz"}],te=[5,6,7,8,9,10,11,12],se=[{value:5,label:"4/5"},{value:6,label:"4/6"},{value:7,label:"4/7"},{value:8,label:"4/8"}],ae="radioConfig",re="repeaterSettings",ne="operatingMode";function le(){var _,S,T,le,ce,ie;const{stats:de,setMode:oe,clearModeMutation:ue,setDutyCycleConfig:me,clearDutyCycleMutation:xe,fetchStats:pe,startMutation:he,clearMutation:be}=F(),ye=null==(_=null==de?void 0:de.config)?void 0:_.radio,ge=null==(S=null==de?void 0:de.config)?void 0:S.repeater,fe=null==(T=null==de?void 0:de.config)?void 0:T.duty_cycle,je=(null==de?void 0:de.node_name)||(null==(le=null==de?void 0:de.config)?void 0:le.node_name)||"Unknown Node",ve=(null==ge?void 0:ge.mode)??"forward",Ne=(null==fe?void 0:fe.enforcement_enabled)??!1,we=null==(ce=null==de?void 0:de.config)?void 0:ce.delays,[ke,Ce]=e.useState(!1),[_e,Se]=e.useState(""),[Te,Fe]=e.useState(62.5),[Ee,Le]=e.useState(7),[Pe,Re]=e.useState(5),[Ae,Me]=e.useState(""),[Ie,De]=e.useState("idle"),[ze,Oe]=e.useState(null),qe=e.useRef(null),He=e.useRef(null),[Ke,$e]=e.useState(!1),[Ye,Ve]=e.useState(""),[Xe,Be]=e.useState(""),[Ue,Ge]=e.useState(""),[We,Ze]=e.useState("idle"),Je=e.useRef(null),Qe=e.useRef(null),[et,tt]=e.useState(!1),[st,at]=e.useState(""),[rt,nt]=e.useState(""),[lt,ct]=e.useState(""),[it,dt]=e.useState(""),[ot,ut]=e.useState("idle"),[mt,xt]=e.useState(null),pt=e.useRef(null),ht=e.useRef(null),[bt,yt]=e.useState("idle"),[gt,ft]=e.useState("idle"),[jt,vt]=e.useState(null),[Nt,wt]=e.useState(null),kt=e.useRef(!0),Ct=e.useRef(null),_t=e.useRef(null),St=e.useRef(null),Tt=e.useRef(null),Ft=e.useRef(!1),Et=e.useRef(!1);e.useEffect(()=>(kt.current=!0,()=>{kt.current=!1,Ct.current&&clearTimeout(Ct.current),_t.current&&clearTimeout(_t.current),St.current&&clearTimeout(St.current),Tt.current&&clearTimeout(Tt.current),It.current&&clearTimeout(It.current),Dt.current&&clearTimeout(Dt.current),He.current&&clearTimeout(He.current),Je.current&&clearTimeout(Je.current),ht.current&&clearTimeout(ht.current)}),[]),e.useEffect(()=>{const e=e=>{if(ke||et||Ke)return e.preventDefault(),e.returnValue="You have unsaved changes. Are you sure you want to leave?",e.returnValue};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[ke,et,Ke]);const Lt=null==(ie=null==de?void 0:de.config)?void 0:ie.web,[Pt,Rt]=e.useState("idle"),[At,Mt]=e.useState(null),It=e.useRef(null),Dt=e.useRef(null),zt=e.useRef(!1),[Ot,qt]=e.useState([]),[Ht,Kt]=e.useState(!1),[$t,Yt]=e.useState(null),[Vt,Xt]=e.useState(!1),[Bt,Ut]=e.useState(""),[Gt,Wt]=e.useState(null),[Zt,Jt]=e.useState(!1),[Qt,es]=e.useState(null),[ts,ss]=e.useState(!1),[as,rs]=e.useState(!1),[ns,ls]=e.useState(!1),[cs,is]=e.useState([]),[ds,os]=e.useState(!1),[us,ms]=e.useState(null),[xs,ps]=e.useState("deny"),[hs,bs]=e.useState(!1),[ys,gs]=e.useState(null),[fs,js]=e.useState(new Set),[vs,Ns]=e.useState(!1),[ws,ks]=e.useState(!1),[Cs,_s]=e.useState(!1),[Ss,Ts]=e.useState(null),[Fs,Es]=e.useState(null),[Ls,Ps]=e.useState(""),[Rs,As]=e.useState("deny"),[Ms,Is]=e.useState(!1),[Ds,zs]=e.useState(!0),[Os,qs]=e.useState(!1),[Hs,Ks]=e.useState(!0),[$s,Ys]=e.useState("idle"),[Vs,Xs]=e.useState(!1),[Bs,Us]=e.useState(!1),Gs=e.useRef(!1);e.useEffect(()=>{const e=ke&&!Gs.current;Gs.current=ke,ye&&e&&(Se((ye.frequency/1e6).toFixed(3)),Fe(ye.bandwidth/1e3),Le(ye.spreading_factor),Re(ye.coding_rate),Me(String(ye.tx_power)))},[ye,ke]);const Ws=e.useMemo(()=>{if(!ye||!ke)return!1;const e=ye.frequency/1e6,t=ye.bandwidth/1e3,s=parseFloat(_e)||0;return Math.abs(s-e)>1e-4||Te!==t||Ee!==ye.spreading_factor||Pe!==ye.coding_rate||parseInt(Ae)!==ye.tx_power},[ye,ke,_e,Te,Ee,Pe,Ae]),Zs=e.useCallback(()=>{Ce(!1),Oe(null),ye&&(Se((ye.frequency/1e6).toFixed(3)),Fe(ye.bandwidth/1e3),Le(ye.spreading_factor),Re(ye.coding_rate),Me(String(ye.tx_power)))},[ye]);e.useEffect(()=>{if(!ke)return;const e=e=>{"loading"!==Ie&&qe.current&&!qe.current.contains(e.target)&&Zs()};return document.addEventListener("mouseup",e),()=>{document.removeEventListener("mouseup",e)}},[ke,Zs,Ie]);const Js=e.useCallback(()=>{const e=null==we?void 0:we.tx_delay_factor;return e&&"object"==typeof e&&"parsedValue"in e?e.parsedValue??1:"number"==typeof e?e:1},[we]),Qs=e.useCallback(()=>{const e=null==we?void 0:we.direct_tx_delay_factor;return"number"==typeof e?e:.5},[we]),ea=e.useCallback(()=>{const e=null==fe?void 0:fe.max_airtime_percent;return"number"==typeof e?e:e&&"object"==typeof e&&"parsedValue"in e?e.parsedValue??6:6},[fe]),ta=e.useCallback(()=>{Ve(Js().toFixed(2)),Be(Qs().toFixed(2)),Ge(ea().toFixed(1)),$e(!0)},[Js,Qs,ea]),sa=e.useCallback(()=>{$e(!1)},[]);e.useEffect(()=>{if(!Ke)return;const e=e=>{"loading"!==We&&Qe.current&&!Qe.current.contains(e.target)&&sa()};return document.addEventListener("mouseup",e),()=>document.removeEventListener("mouseup",e)},[Ke,sa,We]);const aa=e.useCallback(()=>{var e,t,s;at(je),nt((null==(e=null==ge?void 0:ge.latitude)?void 0:e.toString())||"0"),ct((null==(t=null==ge?void 0:ge.longitude)?void 0:t.toString())||"0"),dt((null==(s=null==ge?void 0:ge.send_advert_interval_hours)?void 0:s.toString())||"0"),xt(null),tt(!0)},[je,ge]),ra=e.useCallback(()=>{tt(!1),xt(null)},[]);e.useEffect(()=>{if(!et)return;const e=e=>{"loading"!==ot&&pt.current&&!pt.current.contains(e.target)&&ra()};return document.addEventListener("mouseup",e),()=>document.removeEventListener("mouseup",e)},[et,ra,ot]);const na=async()=>{var e;if("loading"===Pt)return;const t=(null==Lt?void 0:Lt.cors_enabled)??!1,s=!t,a=t;It.current&&clearTimeout(It.current),Dt.current&&clearTimeout(Dt.current),zt.current=!1,Mt(s),Rt("loading"),It.current=setTimeout(()=>{zt.current||kt.current&&(Mt(a),Rt("error"),Dt.current=setTimeout(()=>{kt.current&&(Rt("idle"),Mt(null))},2e3))},1e4);try{const t=await M({web:{cors_enabled:s}});if(zt.current=!0,It.current&&clearTimeout(It.current),!kt.current)return;t.success||(null==(e=t.data)?void 0:e.persisted)?(await pe(),Rt("success"),Dt.current=setTimeout(()=>{kt.current&&(Rt("idle"),Mt(null))},2e3)):(Mt(a),Rt("error"),Dt.current=setTimeout(()=>{kt.current&&(Rt("idle"),Mt(null))},2e3))}catch{if(zt.current=!0,It.current&&clearTimeout(It.current),!kt.current)return;Mt(a),Rt("error"),Dt.current=setTimeout(()=>{kt.current&&(Rt("idle"),Mt(null))},2e3)}};e.useEffect(()=>{(async()=>{Ks(!0);try{const e=await I();e.success&&e.data?qs(e.data.exists):qs(!1);const t=null==Lt?void 0:Lt.web_path;zs(!t||""===t)}catch{qs(!1)}finally{Ks(!1)}})()},[null==Lt?void 0:Lt.web_path]);const la=async e=>{var t;if("loading"!==$s){Ys("loading");try{const s=await M({web:{web_path:e?null:"/opt/pymc_console/web/html"}});if(!kt.current)return;s.success||(null==(t=s.data)?void 0:t.persisted)?(zs(e),Ys("success"),Xs(!0),setTimeout(()=>{kt.current&&Ys("idle")},2e3)):(Ys("error"),setTimeout(()=>{kt.current&&Ys("idle")},2e3))}catch{if(!kt.current)return;Ys("error"),setTimeout(()=>{kt.current&&Ys("idle")},2e3)}}},ca=e.useCallback(async()=>{Kt(!0),Yt(null);try{const e=await E();qt(e.tokens||[])}catch(e){Yt(e instanceof Error?e.message:"Failed to fetch tokens")}finally{Kt(!1)}},[]);e.useEffect(()=>{ca()},[ca]);const ia=async()=>{if(Bt.trim()){ss(!0),Yt(null);try{const e=await z(Bt.trim());Wt(e.token||null),Xt(!1),Jt(!0),Ut(""),await ca()}catch(e){Yt(e instanceof Error?e.message:"Failed to create token")}finally{ss(!1)}}else Yt("Token name is required")},da=e=>e?new Date(1e3*e).toLocaleString():"Never",oa=e.useCallback(e=>{const t=new Map,s=[];return e.forEach(e=>{const s={id:e.id,name:e.name,floodPolicy:e.flood_policy,transport_key:e.transport_key,last_used:e.last_used,parent_id:e.parent_id,children:[]};t.set(e.id,s)}),t.forEach(e=>{e.parent_id&&t.has(e.parent_id)?t.get(e.parent_id).children.push(e):s.push(e)}),s},[]),ua=e.useCallback(async()=>{os(!0),ms(null);try{const e=await L();e.success&&e.data?is(oa(e.data)):ms(e.error||"Failed to load transport keys")}catch(e){ms(e instanceof Error?e.message:"Unknown error occurred")}finally{os(!1)}},[oa]);e.useEffect(()=>{ua()},[ua]);const ma=e.useCallback((e,t)=>{for(const s of e){if(s.id===t)return s;if(s.children){const e=ma(s.children,t);if(e)return e}}return null},[]),xa=e.useCallback(()=>{if(!ys)return;const e=ma(cs,ys);return null==e?void 0:e.name},[ys,cs,ma]),pa=e.useCallback(e=>{js(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),ha=async e=>{bs(!0),ms(null);try{const t=await q("allow"===e);t.success?ps(e):ms(t.error||"Failed to update global flood policy")}catch(t){ms(t instanceof Error?t.message:"Failed to update global flood policy")}finally{bs(!1)}},ba=async()=>{if(Ls.trim()){Is(!0),ms(null);try{const e=await H({name:Ls.trim(),flood_policy:Rs,parent_id:ys??void 0});e.success?(await ua(),Ns(!1),Ps(""),As("deny")):ms(e.error||"Failed to add transport key")}catch(e){ms(e instanceof Error?e.message:"Failed to add transport key")}finally{Is(!1)}}else ms("Key name is required")},ya=e.useCallback(()=>{if(!ys)return;const e=ma(cs,ys);e&&(Ts({...e}),ks(!0))},[ys,cs,ma]);e.useEffect(()=>{const e=e=>{"Escape"===e.key&&(vs&&(Ns(!1),Ps(""),As("deny")),ws&&(ks(!1),Ts(null)),Cs&&(_s(!1),Es(null)),Vt&&(Xt(!1),Ut("")),Zt&&(Jt(!1),Wt(null)))};if(vs||ws||Cs||Vt||Zt)return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[vs,ws,Cs,Vt,Zt]);const ga=e.useCallback(()=>{if(!ys)return;const e=ma(cs,ys);e&&(Es(e),_s(!0))},[ys,cs,ma]),fa=({node:e,level:s})=>{const a=fs.has(e.id),r=ys===e.id,n=e.children&&e.children.length>0,l="allow"===xs;return t.jsxs("div",{children:[t.jsxs("div",{className:X("flex items-center gap-2 h-[36px] px-3 rounded-full cursor-pointer transition-colors",r?"bg-accent-primary/15":"hover:bg-white/[0.02]",l&&"opacity-50 cursor-not-allowed"),style:{marginLeft:16*s+"px"},onClick:()=>!l&&gs(e.id),children:[n?t.jsx("button",{onClick:t=>{t.stopPropagation(),pa(e.id)},className:"p-1 hover:bg-white/[0.05] rounded-full transition-colors",children:t.jsx(k,{className:X("w-3.5 h-3.5 text-text-muted transition-transform",a&&"rotate-90")})}):t.jsx("span",{className:"w-5"}),t.jsx(C,{className:"w-4 h-4 text-accent-primary flex-shrink-0"}),t.jsx("span",{className:"type-data text-text-primary flex-1 truncate",children:e.name}),t.jsx("span",{className:X("type-data-xs px-2 py-0.5 rounded-full","allow"===e.floodPolicy?"bg-accent-success/15 text-accent-success":"bg-accent-danger/15 text-accent-danger"),children:"allow"===e.floodPolicy?"Allow":"Deny"})]}),n&&a&&t.jsx("div",{children:e.children.map(e=>t.jsx(fa,{node:e,level:s+1},e.id))})]})};return t.jsxs(B,{children:[t.jsx(U,{title:"Configuration",icon:t.jsx(s,{})}),t.jsxs(Z,{template:"standard",children:[t.jsx(J,{span:12,md:6,children:t.jsx(G,{children:t.jsxs("div",{ref:pt,children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h2",{className:"type-subheading text-text-primary flex items-center gap-2",children:[t.jsx(a,{className:"icon-md text-accent-primary"}),"Repeater Settings"]}),t.jsx("div",{className:"flex items-center gap-1",children:ge&&(et?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:ra,disabled:"loading"===ot,className:X("p-2 rounded-lg transition-colors","loading"===ot?"text-text-muted cursor-not-allowed":"text-text-muted hover:text-accent-danger hover:bg-accent-danger/10"),title:"Cancel",children:t.jsx(r,{className:"w-4 h-4"})}),t.jsx("button",{onClick:async()=>{if("loading"!==ot){ht.current&&clearTimeout(ht.current),he(re),ut("loading"),xt(null);try{const e={};st&&st!==je&&(e.node_name=st);const t=parseFloat(rt);isNaN(t)||t===(null==ge?void 0:ge.latitude)||(e.latitude=t);const s=parseFloat(lt);isNaN(s)||s===(null==ge?void 0:ge.longitude)||(e.longitude=s);const a=parseInt(it);if(isNaN(a)||a===(null==ge?void 0:ge.send_advert_interval_hours)||(e.flood_advert_interval_hours=a),0===Object.keys(e).length)return xt({success:!0,message:"No changes to save"}),ut("idle"),void be(re);const r=await A(e);if(!kt.current)return void be(re);if(r.success&&r.data){const e=r.data.applied.join(", ");xt({success:!0,message:`Updated: ${e}`}),await pe({force:!0}),ut("success"),ht.current=setTimeout(()=>{kt.current&&(ut("idle"),tt(!1),xt(null),be(re))},1500)}else xt({success:!1,message:r.error||"Failed to save"}),ut("error"),be(re),ht.current=setTimeout(()=>{kt.current&&ut("idle")},2e3)}catch(e){if(!kt.current)return void be(re);xt({success:!1,message:String(e)}),ut("error"),be(re),ht.current=setTimeout(()=>{kt.current&&ut("idle")},2e3)}}},disabled:"loading"===ot,className:X("p-2 rounded-lg transition-colors","loading"===ot?"text-accent-primary cursor-wait":"success"===ot?"text-accent-success":"error"===ot?"text-accent-danger":"text-accent-success hover:bg-accent-success/10"),title:"Save changes",children:"loading"===ot?t.jsx(n,{className:"w-4 h-4 animate-spin"}):"success"===ot?t.jsx(l,{className:"w-4 h-4"}):"error"===ot?t.jsx(r,{className:"w-4 h-4"}):t.jsx(l,{className:"w-4 h-4"})})]}):t.jsx("button",{onClick:aa,className:"p-2 rounded-lg transition-colors text-text-muted hover:text-text-primary hover:bg-bg-subtle",title:"Edit repeater settings",children:t.jsx(c,{className:"w-4 h-4"})}))})]}),mt&&t.jsx("div",{className:X("text-xs mb-3 px-2 py-1.5 rounded-md",mt.success?"text-accent-success bg-accent-success/10":"text-accent-danger bg-accent-danger/10"),children:mt.message}),ge?t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:"Node Name"}),t.jsx("div",{className:X("h-[38px] rounded-full px-4 flex items-center transition-colors",et?"bg-white/5":"bg-white/[0.02]"),children:et?t.jsx("input",{type:"text",value:st,onChange:e=>at(e.target.value),maxLength:50,className:"w-full bg-transparent text-text-primary focus:outline-none type-data",placeholder:"Enter node name"}):t.jsx("span",{className:"type-data text-text-primary",children:je})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:et?"Latitude (°)":"Latitude"}),t.jsx("div",{className:X("h-[38px] rounded-full px-4 flex items-center transition-colors",et?"bg-white/5":"bg-white/[0.02]"),children:et?t.jsx("input",{type:"number",value:rt,onChange:e=>nt(e.target.value),step:"0.000001",min:"-90",max:"90",className:"w-full bg-transparent text-text-primary focus:outline-none type-data"}):t.jsx("span",{className:"type-data text-text-primary",children:0!==ge.latitude?ge.latitude.toFixed(6):"Not set"})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:et?"Longitude (°)":"Longitude"}),t.jsx("div",{className:X("h-[38px] rounded-full px-4 flex items-center transition-colors",et?"bg-white/5":"bg-white/[0.02]"),children:et?t.jsx("input",{type:"number",value:lt,onChange:e=>ct(e.target.value),step:"0.000001",min:"-180",max:"180",className:"w-full bg-transparent text-text-primary focus:outline-none type-data"}):t.jsx("span",{className:"type-data text-text-primary",children:0!==ge.longitude?ge.longitude.toFixed(6):"Not set"})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:et?"Advert Interval (hours)":"Advert Interval"}),t.jsx("div",{className:X("h-[38px] rounded-full px-4 flex items-center transition-colors",et?"bg-white/5":"bg-white/[0.02]"),children:et?t.jsx("input",{type:"number",value:it,onChange:e=>dt(e.target.value),min:"0",max:"48",className:"w-full bg-transparent text-text-primary focus:outline-none type-data"}):t.jsx("span",{className:"type-data text-text-primary",children:ge.send_advert_interval_hours>0?`${ge.send_advert_interval_hours}h`:"Disabled"})}),et&&t.jsx("p",{className:"type-data-xs text-text-muted mt-1 ml-4",children:"0 = disabled, 3-48 hours"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:"Score-based TX"}),t.jsx("div",{className:"h-[38px] rounded-full px-4 flex items-center bg-white/[0.02]",children:t.jsx("span",{className:"type-data text-text-primary",children:ge.use_score_for_tx?"Enabled":"Disabled"})})]})]}):t.jsx("p",{className:"text-text-muted",children:"Loading repeater settings..."})]})})}),t.jsx(J,{span:12,md:6,children:t.jsx(G,{children:t.jsxs("div",{ref:qe,children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h2",{className:"type-subheading text-text-primary flex items-center gap-2",children:[t.jsx(i,{className:"icon-md text-accent-primary"}),"Radio Configuration"]}),t.jsx("div",{className:"flex items-center gap-1",children:ye&&(ke?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:Zs,disabled:"loading"===Ie,className:X("p-2 rounded-lg transition-colors","loading"===Ie?"text-text-muted cursor-not-allowed":"text-text-muted hover:text-accent-danger hover:bg-accent-danger/10"),title:"Cancel",children:t.jsx(r,{className:"w-4 h-4"})}),t.jsx("button",{onClick:async()=>{if("loading"!==Ie){He.current&&clearTimeout(He.current),he(ae),De("loading"),Oe(null);try{const e={},t=parseFloat(_e),s=ye?ye.frequency/1e6:0;Math.abs(t-s)>1e-4&&(e.frequency_mhz=t);const a=ye?ye.bandwidth/1e3:0;Te!==a&&(e.bandwidth_khz=Te),Ee!==(null==ye?void 0:ye.spreading_factor)&&(e.spreading_factor=Ee),Pe!==(null==ye?void 0:ye.coding_rate)&&(e.coding_rate=Pe);const r=parseInt(Ae);if(r!==(null==ye?void 0:ye.tx_power)&&(e.tx_power=r),0===Object.keys(e).length)return Oe({success:!0,message:"No changes to save"}),De("idle"),void be(ae);const n=await A(e);if(!kt.current)return void be(ae);if(n.success&&n.data){const e=n.data.applied.join(", "),t=n.data.live_update?" (applied live)":" (restart required)";Oe({success:!0,message:`Updated: ${e}${t}`}),await pe({force:!0}),De("success"),He.current=setTimeout(()=>{kt.current&&(De("idle"),Ce(!1),Oe(null),be(ae))},1500)}else Oe({success:!1,message:n.error||"Failed to save"}),De("error"),be(ae),He.current=setTimeout(()=>{kt.current&&De("idle")},2e3)}catch(e){if(!kt.current)return void be(ae);Oe({success:!1,message:String(e)}),De("error"),be(ae),He.current=setTimeout(()=>{kt.current&&De("idle")},2e3)}}},disabled:"loading"===Ie||!Ws,className:X("p-2 rounded-lg transition-colors","loading"===Ie?"text-accent-primary cursor-wait":"success"===Ie?"text-accent-success":"error"===Ie?"text-accent-danger":Ws?"text-accent-success hover:bg-accent-success/10":"text-text-muted cursor-not-allowed"),title:Ws?"Save changes":"No changes to save",children:"loading"===Ie?t.jsx(n,{className:"w-4 h-4 animate-spin"}):"success"===Ie?t.jsx(l,{className:"w-4 h-4"}):"error"===Ie?t.jsx(r,{className:"w-4 h-4"}):t.jsx(l,{className:"w-4 h-4"})})]}):t.jsx("button",{onClick:()=>{ye&&(Se((ye.frequency/1e6).toFixed(3)),Fe(ye.bandwidth/1e3),Le(ye.spreading_factor),Re(ye.coding_rate),Me(String(ye.tx_power))),Oe(null),Ce(!0)},className:"p-2 rounded-lg transition-colors text-text-muted hover:text-text-primary hover:bg-bg-subtle",title:"Edit radio settings",children:t.jsx(c,{className:"w-4 h-4"})}))})]}),ze&&t.jsx("div",{className:X("text-xs mb-3 px-2 py-1.5 rounded-md",ze.success?"text-accent-success bg-accent-success/10":"text-accent-danger bg-accent-danger/10"),children:ze.message}),ye?t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:ke?"Frequency (MHz)":"Frequency"}),t.jsx("div",{className:X("h-[38px] rounded-full px-4 flex items-center transition-colors",ke?"bg-white/5":"bg-white/[0.02]"),children:ke?t.jsx("input",{type:"number",value:_e,onChange:e=>Se(e.target.value),step:"0.001",min:"400",max:"930",className:"w-full bg-transparent text-text-primary focus:outline-none type-data"}):t.jsx("span",{className:"type-data text-text-primary",children:P(ye.frequency)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:ke?"TX Power (dBm)":"TX Power"}),t.jsx("div",{className:X("h-[38px] rounded-full px-4 flex items-center transition-colors",ke?"bg-white/5":"bg-white/[0.02]"),children:ke?t.jsx("input",{type:"number",value:Ae,onChange:e=>Me(e.target.value),min:"-9",max:"22",className:"w-full bg-transparent text-text-primary focus:outline-none type-data"}):t.jsxs("span",{className:"type-data text-text-primary",children:[ye.tx_power," dBm"]})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:"Bandwidth"}),t.jsx("div",{className:X("h-[38px] rounded-full px-4 flex items-center transition-colors relative",ke?"bg-white/5":"bg-white/[0.02]"),children:ke?t.jsxs(t.Fragment,{children:[t.jsx("select",{value:Te,onChange:e=>Fe(parseFloat(e.target.value)),className:"w-full bg-transparent text-text-primary focus:outline-none appearance-none cursor-pointer type-data pr-6",children:ee.map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))}),t.jsx(d,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]}):t.jsx("span",{className:"type-data text-text-primary",children:R(ye.bandwidth)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:"Spreading Factor"}),t.jsx("div",{className:X("h-[38px] rounded-full px-4 flex items-center transition-colors relative",ke?"bg-white/5":"bg-white/[0.02]"),children:ke?t.jsxs(t.Fragment,{children:[t.jsx("select",{value:Ee,onChange:e=>Le(parseInt(e.target.value)),className:"w-full bg-transparent text-text-primary focus:outline-none appearance-none cursor-pointer type-data pr-6",children:te.map(e=>t.jsxs("option",{value:e,children:["SF",e]},e))}),t.jsx(d,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]}):t.jsxs("span",{className:"type-data text-text-primary",children:["SF",ye.spreading_factor]})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:"Coding Rate"}),t.jsx("div",{className:X("h-[38px] rounded-full px-4 flex items-center transition-colors relative",ke?"bg-white/5":"bg-white/[0.02]"),children:ke?t.jsxs(t.Fragment,{children:[t.jsx("select",{value:Pe,onChange:e=>Re(parseInt(e.target.value)),className:"w-full bg-transparent text-text-primary focus:outline-none appearance-none cursor-pointer type-data pr-6",children:se.map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))}),t.jsx(d,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]}):t.jsxs("span",{className:"type-data text-text-primary",children:["4/",ye.coding_rate]})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:"Preamble"}),t.jsx("div",{className:"h-[38px] rounded-full px-4 flex items-center bg-white/[0.02]",children:t.jsxs("span",{className:"type-data text-text-primary",children:[ye.preamble_length," symbols"]})})]})]}):t.jsx("p",{className:"text-text-muted",children:"Loading radio configuration..."})]})})})]}),t.jsxs(Z,{template:"standard",children:[t.jsx(J,{span:12,md:6,children:t.jsx(G,{children:t.jsxs("div",{ref:Qe,children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h2",{className:"type-subheading text-text-primary flex items-center gap-3",children:[t.jsx(o,{className:"icon-md text-icon-card-title"}),"Operating Mode"]}),t.jsx("div",{className:"flex items-center gap-1",children:Ke?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:async()=>{if("loading"!==We){Je.current&&clearTimeout(Je.current),he(ne),Ze("loading");try{const e=await A({tx_delay_factor:parseFloat(Ye),direct_tx_delay_factor:parseFloat(Xe)});if(await me({max_airtime_percent:parseFloat(Ue),enforcement_enabled:Ne}),!kt.current)return void be(ne);e.success&&e.data?(await pe({force:!0}),Ze("success"),Je.current=setTimeout(()=>{kt.current&&(Ze("idle"),$e(!1),be(ne))},1500)):(Ze("error"),be(ne),Je.current=setTimeout(()=>{kt.current&&Ze("idle")},2e3))}catch{if(!kt.current)return void be(ne);Ze("error"),be(ne),Je.current=setTimeout(()=>{kt.current&&Ze("idle")},2e3)}}},disabled:"loading"===We,className:X("p-2 rounded-lg transition-colors","loading"===We?"text-accent-primary cursor-wait":"success"===We?"text-accent-success":"error"===We?"text-accent-danger":"text-accent-success hover:bg-accent-success/10"),title:"Save",children:"loading"===We?t.jsx(n,{className:"w-4 h-4 animate-spin"}):"success"===We?t.jsx(l,{className:"w-4 h-4"}):"error"===We?t.jsx(r,{className:"w-4 h-4"}):t.jsx(l,{className:"w-4 h-4"})}),t.jsx("button",{onClick:sa,className:"p-2 rounded-lg text-text-muted hover:text-accent-danger hover:bg-accent-danger/10",title:"Cancel",children:t.jsx(r,{className:"w-4 h-4"})})]}):t.jsx("button",{onClick:ta,className:"p-2 rounded-lg transition-colors text-text-muted hover:text-text-primary hover:bg-bg-subtle",title:"Edit settings",children:t.jsx(c,{className:"w-4 h-4"})})})]}),t.jsx("p",{className:"type-label text-text-muted mb-3",children:"Control how the repeater handles packets"}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[t.jsxs("div",{className:"flex-1 space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("label",{className:"type-label text-text-muted",children:"Repeat"}),t.jsx("div",{className:"flex items-center gap-2",children:(()=>{const e=null!==jt?jt:"forward"===ve;return t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:async()=>{if("loading"===bt)return;const t=!e,s="forward"===ve;Ct.current&&clearTimeout(Ct.current),_t.current&&clearTimeout(_t.current),Ft.current=!1,vt(t),yt("loading"),Ct.current=setTimeout(()=>{Ft.current||kt.current&&(vt(s),yt("error"),_t.current=setTimeout(()=>{kt.current&&(yt("idle"),vt(null))},2e3))},1e4);try{if(await oe(t?"forward":"monitor"),Ft.current=!0,Ct.current&&clearTimeout(Ct.current),!kt.current)return;yt("success"),_t.current=setTimeout(()=>{kt.current&&(yt("idle"),vt(null),ue())},2e3)}catch{if(Ft.current=!0,Ct.current&&clearTimeout(Ct.current),!kt.current)return;vt(s),yt("error"),_t.current=setTimeout(()=>{kt.current&&(yt("idle"),vt(null))},2e3)}},disabled:"loading"===bt,className:X("relative inline-flex h-6 w-11 items-center rounded-full transition-colors border-2",e?"bg-toggle-on border-toggle-on":"bg-toggle-off border-border-subtle","loading"===bt&&"opacity-70"),"aria-label":"Toggle forward mode",children:t.jsx("span",{className:X("inline-block h-4 w-4 transform rounded-full bg-white transition-transform shadow-lg",e?"translate-x-5":"translate-x-0.5")})}),t.jsx("span",{className:X("type-data text-sm w-7",e?"text-accent-success":"text-text-muted"),children:e?"On":"Off"}),"loading"===bt&&t.jsx(n,{className:"w-4 h-4 text-text-muted animate-spin"}),"success"===bt&&t.jsx(l,{className:"w-4 h-4 text-accent-success"}),"error"===bt&&t.jsx(r,{className:"w-4 h-4 text-accent-danger"})]})})()})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("label",{className:"type-label text-text-muted",children:"Duty Cycle"}),t.jsx("div",{className:"flex items-center gap-2",children:(()=>{const e=null!==Nt?Nt:Ne;return t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:async()=>{if("loading"===gt)return;const t=!e,s=Ne;St.current&&clearTimeout(St.current),Tt.current&&clearTimeout(Tt.current),Et.current=!1,wt(t),ft("loading"),St.current=setTimeout(()=>{Et.current||kt.current&&(wt(s),ft("error"),Tt.current=setTimeout(()=>{kt.current&&(ft("idle"),wt(null))},2e3))},1e4);try{if(await me({max_airtime_percent:ea(),enforcement_enabled:t}),Et.current=!0,St.current&&clearTimeout(St.current),!kt.current)return;ft("success"),Tt.current=setTimeout(()=>{kt.current&&(ft("idle"),wt(null),xe())},2e3)}catch{if(Et.current=!0,St.current&&clearTimeout(St.current),!kt.current)return;wt(s),ft("error"),Tt.current=setTimeout(()=>{kt.current&&(ft("idle"),wt(null))},2e3)}},disabled:"loading"===gt,className:X("relative inline-flex h-6 w-11 items-center rounded-full transition-colors border-2",e?"bg-toggle-on border-toggle-on":"bg-toggle-off border-border-subtle","loading"===gt&&"opacity-70"),"aria-label":"Toggle duty cycle",children:t.jsx("span",{className:X("inline-block h-4 w-4 transform rounded-full bg-white transition-transform shadow-lg",e?"translate-x-5":"translate-x-0.5")})}),t.jsx("span",{className:X("type-data text-sm w-7",e?"text-accent-success":"text-text-muted"),children:e?"On":"Off"}),"loading"===gt&&t.jsx(n,{className:"w-4 h-4 text-text-muted animate-spin"}),"success"===gt&&t.jsx(l,{className:"w-4 h-4 text-accent-success"}),"error"===gt&&t.jsx(r,{className:"w-4 h-4 text-accent-danger"})]})})()})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("label",{className:"type-label text-text-muted",children:"Max Airtime"}),t.jsx("div",{className:X("h-[32px] rounded-full px-3 flex items-center justify-end transition-colors min-w-[80px]",Ke?"bg-white/5":"bg-white/[0.02]"),children:Ke?t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"number",value:Ue,onChange:e=>Ge(e.target.value),step:"0.5",min:"0.1",max:"100",className:"w-12 bg-transparent text-text-primary text-right focus:outline-none type-data"}),t.jsx("span",{className:"text-text-muted type-data",children:"%"})]}):t.jsxs("span",{className:"type-data text-text-primary",children:[ea().toFixed(1),"%"]})})]})]}),t.jsx("div",{className:"hidden sm:block w-px bg-border-subtle"}),t.jsxs("div",{className:"flex-1 pt-4 sm:pt-0 border-t sm:border-t-0 border-border-subtle",children:[t.jsx("label",{className:"type-label text-text-muted block mb-3",children:"TX Delays"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"type-label text-text-muted",children:"Flood"}),t.jsx("div",{className:X("h-[32px] rounded-full px-3 flex items-center justify-end transition-colors min-w-[80px]",Ke?"bg-white/5":"bg-white/[0.02]"),children:Ke?t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"number",value:Ye,onChange:e=>Ve(e.target.value),step:"0.1",min:"0",max:"5",className:"w-12 bg-transparent text-text-primary text-right focus:outline-none type-data"}),t.jsx("span",{className:"text-text-muted type-data",children:"x"})]}):t.jsxs("span",{className:"type-data text-text-primary",children:[Js().toFixed(2),"x"]})})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"type-label text-text-muted",children:"Direct"}),t.jsx("div",{className:X("h-[32px] rounded-full px-3 flex items-center justify-end transition-colors min-w-[80px]",Ke?"bg-white/5":"bg-white/[0.02]"),children:Ke?t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"number",value:Xe,onChange:e=>Be(e.target.value),step:"0.1",min:"0",max:"5",className:"w-12 bg-transparent text-text-primary text-right focus:outline-none type-data"}),t.jsx("span",{className:"text-text-muted type-data",children:"s"})]}):t.jsxs("span",{className:"type-data text-text-primary",children:[Qs().toFixed(2),"s"]})})]})]})]})]})]})})}),t.jsx(J,{span:12,md:6,children:t.jsxs(G,{children:[t.jsx(W,{icon:t.jsx(s,{}),title:"App Settings",largeTitle:!0}),t.jsx("p",{className:"type-body-sm text-text-muted mb-4",children:"Appearance and web server options."}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("span",{className:"type-body text-text-primary font-medium block",children:"Enable CORS"}),t.jsx("span",{className:"type-body-sm text-text-muted",children:"Allow cross-origin API access"})]}),t.jsx("div",{className:"flex items-center gap-2",children:(()=>{const e=null!==At?At:(null==Lt?void 0:Lt.cors_enabled)??!1;return t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:na,disabled:"loading"===Pt,className:X("relative inline-flex h-6 w-11 items-center rounded-full transition-colors border-2",e?"bg-toggle-on border-toggle-on":"bg-toggle-off border-border-subtle","loading"===Pt&&"opacity-70"),title:e?"Disable CORS":"Enable CORS",children:t.jsx("span",{className:X("inline-block h-4 w-4 transform rounded-full bg-white transition-transform shadow-lg",e?"translate-x-5":"translate-x-0.5")})}),"loading"===Pt&&t.jsx(n,{className:"w-4 h-4 text-text-muted animate-spin"}),"success"===Pt&&t.jsx(l,{className:"w-4 h-4 text-accent-success"}),"error"===Pt&&t.jsx(r,{className:"w-4 h-4 text-accent-danger"})]})})()})]}),t.jsxs("div",{children:[t.jsx("span",{className:"type-body text-text-primary font-medium block mb-2",children:"Theme"}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex-1 flex items-center justify-center",children:t.jsx(Q,{showLogoOnly:!0})}),t.jsx("div",{className:"flex-shrink-0",children:t.jsx(Q,{showThumbnailsOnly:!0})})]})]})]})]})})]}),t.jsx(Z,{template:"auto",children:t.jsxs(G,{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"type-heading text-text-primary flex items-center gap-2",children:[t.jsx(u,{className:"icon-md text-accent-primary"}),"Regions / Transport Keys"]}),t.jsx("p",{className:"type-body-sm text-text-muted mt-1",children:"Manage regional key hierarchy for flood control"})]}),t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.jsxs("button",{onClick:()=>Ns(!0),disabled:"allow"===xs,className:X("flex items-center gap-1.5 h-[32px] px-3 rounded-full transition-colors type-body-sm font-medium","allow"===xs?"bg-white/[0.02] text-text-muted cursor-not-allowed":"bg-accent-success/10 hover:bg-accent-success/20 text-accent-success"),children:[t.jsx(m,{className:"w-3.5 h-3.5"}),"Add"]}),t.jsx("button",{onClick:ya,disabled:!ys||"allow"===xs,className:X("h-[32px] px-3 rounded-full transition-colors type-body-sm font-medium",ys&&"allow"!==xs?"bg-accent-primary/10 hover:bg-accent-primary/20 text-accent-primary":"bg-white/[0.02] text-text-muted cursor-not-allowed"),children:"Edit"}),t.jsx("button",{onClick:ga,disabled:!ys||"allow"===xs,className:X("h-[32px] px-3 rounded-full transition-colors type-body-sm font-medium",ys&&"allow"!==xs?"bg-accent-danger/10 hover:bg-accent-danger/20 text-accent-danger":"bg-white/[0.02] text-text-muted cursor-not-allowed"),children:"Delete"})]})]}),t.jsx("div",{className:"bg-white/[0.02] rounded-2xl p-4 mb-4",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:X("w-10 h-10 rounded-full flex items-center justify-center","allow"===xs?"bg-accent-success/20":"bg-accent-danger/20"),children:"allow"===xs?t.jsx(x,{className:"w-5 h-5 text-accent-success"}):t.jsx(p,{className:"w-5 h-5 text-accent-danger"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"type-body text-text-primary font-medium",children:"Global Flood Policy"}),t.jsx("p",{className:"type-body-sm text-text-muted",children:"Master control for repeater flooding"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"flex bg-white/[0.02] rounded-full p-1",children:[t.jsx("button",{onClick:()=>ha("deny"),disabled:hs,className:X("px-4 py-1.5 rounded-full transition-colors type-body-sm font-medium","deny"===xs?"bg-accent-danger/20 text-accent-danger":"text-text-muted hover:text-text-secondary",hs&&"opacity-50"),children:"Deny"}),t.jsx("button",{onClick:()=>ha("allow"),disabled:hs,className:X("px-4 py-1.5 rounded-full transition-colors type-body-sm font-medium","allow"===xs?"bg-accent-success/20 text-accent-success":"text-text-muted hover:text-text-secondary",hs&&"opacity-50"),children:"Allow"})]}),hs&&t.jsx(n,{className:"w-4 h-4 animate-spin text-text-muted"})]})]})}),us&&t.jsx("div",{className:"type-body-sm mb-3 px-3 py-2 rounded-full text-accent-danger bg-accent-danger/10",children:us}),t.jsx("div",{className:"bg-white/[0.02] rounded-2xl p-4 min-h-[120px]",children:ds?t.jsxs("div",{className:"flex items-center justify-center py-6",children:[t.jsx(n,{className:"w-5 h-5 animate-spin text-accent-primary mr-2"}),t.jsx("span",{className:"type-body-sm text-text-muted",children:"Loading transport keys..."})]}):0===cs.length?t.jsxs("div",{className:"text-center py-6",children:[t.jsx("div",{className:"w-12 h-12 rounded-full bg-white/[0.02] mx-auto mb-3 flex items-center justify-center",children:t.jsx(u,{className:"w-6 h-6 text-text-muted/50"})}),t.jsx("p",{className:"type-body text-text-muted",children:"No transport keys found"}),t.jsx("p",{className:"type-body-sm text-text-muted/70 mt-1",children:"Add your first transport key to get started"})]}):t.jsx("div",{className:"space-y-1",children:cs.map(e=>t.jsx(fa,{node:e,level:0},e.id))})})]})}),t.jsx(Z,{template:"auto",children:t.jsxs(G,{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"type-heading text-text-primary flex items-center gap-2",children:[t.jsx(h,{className:"icon-md text-accent-primary"}),"API Tokens"]}),t.jsx("p",{className:"type-body-sm text-text-muted mt-1",children:"Manage API tokens for machine-to-machine authentication"})]}),t.jsxs("button",{onClick:()=>Xt(!0),className:"flex items-center justify-center gap-2 h-[32px] px-4 bg-accent-primary/10 hover:bg-accent-primary/20 text-accent-primary rounded-full transition-colors type-body-sm font-medium",children:[t.jsx(m,{className:"w-4 h-4"}),"Create Token"]})]}),t.jsx("div",{className:"bg-accent-tertiary/5 rounded-2xl p-4 mb-4",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-tertiary/20 flex items-center justify-center flex-shrink-0",children:t.jsx(b,{className:"w-4 h-4 text-accent-tertiary"})}),t.jsxs("div",{className:"type-body-sm text-text-muted",children:[t.jsxs("p",{children:[t.jsx("span",{className:"text-text-secondary",children:"API tokens"})," are used for machine-to-machine authentication. Include the token in the ",t.jsx("code",{className:"type-code bg-accent-tertiary/20 px-1.5 py-0.5 rounded-full text-accent-tertiary",children:"X-API-Key"})," header when making API requests."]}),t.jsx("p",{className:"mt-1 text-text-muted/70",children:"Tokens are only shown once at creation. Store them securely."})]})]})}),$t&&t.jsx("div",{className:"type-body-sm mb-3 px-3 py-2 rounded-full text-accent-danger bg-accent-danger/10",children:$t}),Ht&&0===Ot.length?t.jsxs("div",{className:"flex items-center justify-center py-6",children:[t.jsx(n,{className:"w-5 h-5 animate-spin text-accent-primary mr-2"}),t.jsx("span",{className:"type-body-sm text-text-muted",children:"Loading tokens..."})]}):Ot.length>0?t.jsx("div",{className:"space-y-2",children:Ot.map(e=>t.jsx("div",{className:"bg-white/[0.02] hover:bg-white/[0.04] rounded-2xl p-4 transition-colors",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-accent-primary/10 flex items-center justify-center flex-shrink-0",children:t.jsx(h,{className:"w-5 h-5 text-accent-primary"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("h3",{className:"type-body text-text-primary font-medium truncate",children:e.name}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:gap-4 mt-0.5",children:[t.jsxs("span",{className:"type-data-sm text-text-muted truncate",children:["Created: ",da(e.created_at)]}),t.jsxs("span",{className:"type-data-sm text-text-muted truncate",children:["Last used: ",da(e.last_used)]})]})]})]}),t.jsxs("button",{onClick:()=>es({id:e.id,name:e.name}),disabled:as,className:"h-[32px] px-4 bg-accent-danger/10 hover:bg-accent-danger/20 text-accent-danger rounded-full transition-colors disabled:opacity-50 type-body-sm font-medium flex items-center justify-center gap-1.5",children:[t.jsx(y,{className:"w-3.5 h-3.5"}),"Revoke"]})]})},e.id))}):t.jsxs("div",{className:"bg-white/[0.02] rounded-2xl p-6 text-center",children:[t.jsx("div",{className:"w-14 h-14 rounded-full bg-white/[0.02] mx-auto mb-4 flex items-center justify-center",children:t.jsx(h,{className:"w-7 h-7 text-text-muted/50"})}),t.jsx("h3",{className:"type-body text-text-primary font-medium mb-1",children:"No API Tokens"}),t.jsx("p",{className:"type-body-sm text-text-muted mb-4",children:"Create a token to enable API access"}),t.jsx("button",{onClick:()=>Xt(!0),className:"h-[32px] px-4 bg-accent-primary/10 hover:bg-accent-primary/20 text-accent-primary rounded-full transition-colors type-body-sm font-medium",children:"Create Your First Token"})]})]})}),t.jsx(Z,{template:"auto",children:t.jsxs(G,{children:[t.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:t.jsxs("div",{children:[t.jsxs("h2",{className:"type-heading text-text-primary flex items-center gap-2",children:[t.jsx(g,{className:"icon-md text-accent-primary"}),"Web Frontend"]}),t.jsx("p",{className:"type-body-sm text-text-muted mt-1",children:"Choose which web interface to use"})]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:X("flex items-start gap-3 p-4 bg-white/[0.02] rounded-2xl border-2 cursor-pointer transition-all",Ds?"border-accent-primary bg-accent-primary/5":"border-transparent hover:border-accent-primary/30","loading"===$s&&"opacity-50 pointer-events-none"),children:[t.jsx("input",{type:"radio",name:"frontend",checked:Ds,onChange:()=>la(!0),disabled:"loading"===$s,className:"mt-1 h-4 w-4 text-accent-primary focus:ring-accent-primary focus:ring-offset-bg-elevated"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"type-body text-text-primary font-medium",children:"Default Frontend"}),t.jsx("a",{href:"https://github.com/rightup/pyMC_Repeater",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"type-data-xs bg-accent-tertiary/15 text-accent-tertiary px-2.5 py-0.5 rounded-full font-medium hover:bg-accent-tertiary/25 transition-colors",children:"@RightUp"})]}),t.jsx("div",{className:"type-body-sm text-text-muted mt-1",children:"Built-in pyMC Repeater web interface"}),t.jsx("div",{className:"type-data-xs text-text-muted/60 mt-1 font-mono",children:"/opt/pymc_repeater/repeater/web/html"})]})]}),t.jsxs("label",{className:X("flex items-start gap-3 p-4 bg-white/[0.02] rounded-2xl border-2 cursor-pointer transition-all",Ds?"border-transparent hover:border-accent-primary/30":"border-accent-primary bg-accent-primary/5","loading"===$s&&"opacity-50 pointer-events-none"),children:[t.jsx("input",{type:"radio",name:"frontend",checked:!Ds,onChange:()=>la(!1),disabled:"loading"===$s,className:"mt-1 h-4 w-4 text-accent-primary focus:ring-accent-primary focus:ring-offset-bg-elevated"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"type-body text-text-primary font-medium",children:"PyMC Console"}),t.jsx("span",{className:"type-data-xs bg-accent-secondary/15 text-accent-secondary px-2.5 py-0.5 rounded-full font-medium",children:"@Treehouse ⚡"})]}),t.jsx("div",{className:"type-body-sm text-text-muted mt-1",children:"Alternative web interface for pyMC Repeater"}),t.jsx("div",{className:"type-data-xs text-text-muted/60 mt-1 font-mono",children:"/opt/pymc_console/web/html"})]})]})]}),!Hs&&t.jsx("div",{className:X("bg-white/[0.02] rounded-2xl p-4",Os?"border border-accent-success/20":"border border-accent-tertiary/20"),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:X("w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",Os?"bg-accent-success/20":"bg-accent-tertiary/20"),children:Os?t.jsx(f,{className:"w-4 h-4 text-accent-success"}):t.jsx(b,{className:"w-4 h-4 text-accent-tertiary"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"type-body text-text-primary font-medium",children:Os?"PyMC Console has been detected":"PyMC Console Not Installed"}),Os?t.jsxs("p",{className:"type-body-sm text-text-muted mt-1",children:["PyMC Console is installed at ",t.jsx("code",{className:"type-code bg-accent-success/10 px-1.5 py-0.5 rounded-full text-accent-success",children:"/opt/pymc_console/web/html"})]}):t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"type-body-sm text-text-muted mt-1 mb-3",children:["PyMC Console must be installed at ",t.jsx("code",{className:"type-code bg-accent-tertiary/10 px-1.5 py-0.5 rounded-full text-accent-tertiary",children:"/opt/pymc_console/web/html"})," before selecting this option."]}),t.jsxs("a",{href:"https://github.com/dmduran12/pymc_console-dist",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 h-[32px] px-4 bg-accent-tertiary/10 hover:bg-accent-tertiary/20 text-accent-tertiary rounded-full type-body-sm font-medium transition-colors",children:[t.jsx(j,{className:"w-4 h-4"}),"PyMC Console Install Instructions"]})]})]})]})}),Vs&&t.jsx("div",{className:"bg-white/[0.02] rounded-2xl p-4 border border-accent-secondary/30",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-secondary/20 flex items-center justify-center flex-shrink-0",children:t.jsx(v,{className:"w-4 h-4 text-accent-secondary"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"type-body text-text-primary font-medium",children:"Service restart required"}),t.jsx("p",{className:"type-body-sm text-text-muted mt-1",children:"Web frontend changes will take effect after restarting the pymc-repeater service."})]})]}),t.jsx("button",{onClick:async()=>{if(!Bs){Us(!0);try{await D(),Xs(!1),setTimeout(()=>{window.location.reload()},2e3)}catch{Xs(!1),setTimeout(()=>{window.location.reload()},3e3)}}},disabled:Bs,className:"h-[32px] px-4 bg-accent-secondary/10 hover:bg-accent-secondary/20 text-accent-secondary rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 whitespace-nowrap type-body-sm font-medium",children:Bs?t.jsxs(t.Fragment,{children:[t.jsx(n,{className:"w-4 h-4 animate-spin"}),"Restarting..."]}):t.jsxs(t.Fragment,{children:[t.jsx(N,{className:"w-4 h-4"}),"Restart Now"]})})]})})]})]})}),t.jsx(Z,{template:"auto",children:t.jsxs(G,{children:[t.jsx(W,{icon:t.jsx(o,{}),title:"Node Information",largeTitle:!0}),de?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"type-label text-text-muted",children:"Node Name"}),t.jsx("p",{className:"type-body text-text-primary mt-1",children:je})]}),t.jsxs("div",{children:[t.jsx("span",{className:"type-label text-text-muted",children:"Version"}),t.jsxs("p",{className:"type-data text-text-primary mt-1",children:["v",de.version]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"type-label text-text-muted",children:"Core Version"}),t.jsxs("p",{className:"type-data text-text-primary mt-1",children:["v",de.core_version]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"type-label text-text-muted",children:"Local Hash"}),t.jsx("div",{className:"mt-1",children:de.local_hash?t.jsx(Y,{hash:de.local_hash,size:"sm"}):t.jsx("span",{className:"type-data-sm text-text-muted",children:"N/A"})})]})]}),de.public_key&&t.jsxs("div",{className:"mt-4 pt-4 border-t border-border-subtle",children:[t.jsx("span",{className:"type-label text-text-muted",children:"Public Key"}),t.jsx("div",{className:"mt-1",children:t.jsx(Y,{hash:de.public_key,prefixLength:12,suffixLength:8})})]})]}):t.jsx("p",{className:"text-text-muted",children:"Loading node information..."})]})}),Vt&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&Xt(!1),role:"dialog","aria-modal":"true","aria-labelledby":"create-token-modal-title",children:t.jsxs("div",{className:"bg-bg-elevated border border-border-subtle rounded-xl p-6 max-w-md w-full shadow-2xl",children:[t.jsx("h3",{id:"create-token-modal-title",className:"type-subheading text-text-primary mb-4",children:"Create API Token"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Token Name"}),t.jsx("input",{type:"text",value:Bt,onChange:e=>Ut(e.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",className:"w-full px-4 py-2 bg-bg-subtle border border-border-subtle rounded-lg text-text-primary placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-primary/50 transition-colors",onKeyDown:e=>"Enter"===e.key&&ia(),autoFocus:!0}),t.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Give your token a descriptive name to identify its purpose"})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{Xt(!1),Ut(""),Yt(null)},disabled:ts,className:"px-4 py-2 bg-bg-subtle hover:bg-bg-elevated text-text-secondary rounded-lg border border-border-subtle transition-colors disabled:opacity-50",children:"Cancel"}),t.jsx("button",{onClick:ia,disabled:ts||!Bt.trim(),className:"px-4 py-2 bg-accent-primary/20 hover:bg-accent-primary/30 text-text-primary rounded-lg border border-accent-primary/50 transition-colors disabled:opacity-50 flex items-center gap-2",children:ts?t.jsxs(t.Fragment,{children:[t.jsx(n,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):"Create Token"})]})]})]})}),Zt&&Gt&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&Jt(!1),role:"dialog","aria-modal":"true","aria-labelledby":"show-token-modal-title",children:t.jsxs("div",{className:"bg-bg-elevated border border-border-subtle rounded-xl p-6 max-w-lg w-full shadow-2xl",children:[t.jsx("h3",{id:"show-token-modal-title",className:"type-subheading text-text-primary mb-4",children:"Token Created Successfully"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-accent-secondary/10 border border-accent-secondary/30 rounded-lg p-3",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(v,{className:"w-4 h-4 text-accent-secondary flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-text-secondary",children:[t.jsx("strong",{children:"Save this token now!"})," For security reasons, it will not be shown again."]})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Your API Token"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{value:Gt,readOnly:!0,className:"flex-1 px-4 py-2 bg-bg-subtle border border-border-subtle rounded-lg text-text-primary font-mono text-sm"}),t.jsxs("button",{onClick:()=>{Gt&&(navigator.clipboard.writeText(Gt),ls(!0),setTimeout(()=>ls(!1),2e3))},className:"px-4 py-2 bg-accent-primary/20 hover:bg-accent-primary/30 text-text-primary rounded-lg border border-accent-primary/50 transition-colors flex items-center gap-2",title:"Copy to clipboard",children:[ns?t.jsx(l,{className:"w-4 h-4 text-accent-success"}):t.jsx(w,{className:"w-4 h-4"}),ns?"Copied!":"Copy"]})]})]}),t.jsxs("div",{className:"bg-accent-tertiary/10 border border-accent-tertiary/30 rounded-lg p-3",children:[t.jsx("p",{className:"text-sm text-text-secondary mb-2",children:t.jsx("strong",{children:"Usage Example:"})}),t.jsxs("code",{className:"block bg-accent-tertiary/20 px-3 py-2 rounded text-xs text-accent-tertiary font-mono overflow-x-auto",children:['curl -H "X-API-Key: ',Gt.slice(0,12),'..." ',window.location.origin,"/api/stats"]})]}),t.jsx("div",{className:"flex justify-end mt-6",children:t.jsx("button",{onClick:()=>{Jt(!1),Wt(null)},className:"px-4 py-2 bg-accent-primary/20 hover:bg-accent-primary/30 text-text-primary rounded-lg border border-accent-primary/50 transition-colors",children:"Done"})})]})]})}),t.jsx(V,{isOpen:!!Qt,title:"Revoke API Token",message:`Are you sure you want to revoke the token '${null==Qt?void 0:Qt.name}'? This action cannot be undone.`,confirmLabel:as?"Revoking...":"Revoke",cancelLabel:"Cancel",variant:"danger",onConfirm:async()=>{if(Qt){rs(!0),Yt(null);try{await O(Qt.id),await ca(),es(null)}catch(e){Yt(e instanceof Error?e.message:"Failed to revoke token")}finally{rs(!1)}}},onCancel:()=>es(null)}),vs&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&Ns(!1),role:"dialog","aria-modal":"true","aria-labelledby":"add-key-modal-title",children:t.jsxs("div",{className:"bg-bg-elevated border border-border-subtle rounded-xl p-6 max-w-md w-full shadow-2xl",children:[t.jsx("h3",{id:"add-key-modal-title",className:"type-subheading text-text-primary mb-4",children:"Add Transport Key"}),t.jsxs("div",{className:"space-y-4",children:[ys&&t.jsxs("div",{className:"bg-accent-tertiary/10 border border-accent-tertiary/30 rounded-lg p-3 text-sm text-text-secondary",children:["Adding as child of: ",t.jsx("strong",{className:"text-text-primary",children:xa()})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Key Name"}),t.jsx("input",{type:"text",value:Ls,onChange:e=>Ps(e.target.value),placeholder:"e.g., Region Name, Group Key",className:"w-full px-4 py-2 bg-bg-subtle border border-border-subtle rounded-lg text-text-primary placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-primary/50 transition-colors",onKeyDown:e=>"Enter"===e.key&&ba(),autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Flood Policy"}),t.jsxs("div",{className:"flex bg-bg-subtle rounded-lg border border-border-subtle p-1",children:[t.jsx("button",{onClick:()=>As("deny"),className:X("flex-1 px-3 py-2 text-sm font-medium rounded transition-colors","deny"===Rs?"bg-accent-danger/20 text-accent-danger border border-accent-danger/50":"text-text-muted hover:text-text-secondary"),children:"DENY"}),t.jsx("button",{onClick:()=>As("allow"),className:X("flex-1 px-3 py-2 text-sm font-medium rounded transition-colors","allow"===Rs?"bg-accent-success/20 text-accent-success border border-accent-success/50":"text-text-muted hover:text-text-secondary"),children:"ALLOW"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{Ns(!1),Ps(""),As("deny")},disabled:Ms,className:"px-4 py-2 bg-bg-subtle hover:bg-bg-elevated text-text-secondary rounded-lg border border-border-subtle transition-colors disabled:opacity-50",children:"Cancel"}),t.jsx("button",{onClick:ba,disabled:Ms||!Ls.trim(),className:"px-4 py-2 bg-accent-primary/20 hover:bg-accent-primary/30 text-text-primary rounded-lg border border-accent-primary/50 transition-colors disabled:opacity-50 flex items-center gap-2",children:Ms?t.jsxs(t.Fragment,{children:[t.jsx(n,{className:"w-4 h-4 animate-spin"}),"Adding..."]}):"Add Key"})]})]})]})}),ws&&Ss&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&ks(!1),role:"dialog","aria-modal":"true","aria-labelledby":"edit-key-modal-title",children:t.jsxs("div",{className:"bg-bg-elevated border border-border-subtle rounded-xl p-6 max-w-md w-full shadow-2xl",children:[t.jsx("h3",{id:"edit-key-modal-title",className:"type-subheading text-text-primary mb-4",children:"Edit Transport Key"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Key Name"}),t.jsx("input",{type:"text",value:Ss.name,onChange:e=>Ts({...Ss,name:e.target.value}),className:"w-full px-4 py-2 bg-bg-subtle border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/50 transition-colors",autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Flood Policy"}),t.jsxs("div",{className:"flex bg-bg-subtle rounded-lg border border-border-subtle p-1",children:[t.jsx("button",{onClick:()=>Ts({...Ss,floodPolicy:"deny"}),className:X("flex-1 px-3 py-2 text-sm font-medium rounded transition-colors","deny"===Ss.floodPolicy?"bg-accent-danger/20 text-accent-danger border border-accent-danger/50":"text-text-muted hover:text-text-secondary"),children:"DENY"}),t.jsx("button",{onClick:()=>Ts({...Ss,floodPolicy:"allow"}),className:X("flex-1 px-3 py-2 text-sm font-medium rounded transition-colors","allow"===Ss.floodPolicy?"bg-accent-success/20 text-accent-success border border-accent-success/50":"text-text-muted hover:text-text-secondary"),children:"ALLOW"})]})]}),Ss.transport_key&&t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Transport Key"}),t.jsx("code",{className:"block bg-bg-subtle px-3 py-2 rounded-lg text-xs text-text-muted font-mono overflow-x-auto",children:Ss.transport_key})]}),t.jsxs("div",{className:"flex justify-between gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{ks(!1),Es(Ss),_s(!0),Ts(null)},disabled:Ms,className:"px-4 py-2 bg-accent-danger/20 hover:bg-accent-danger/30 text-accent-danger rounded-lg border border-accent-danger/50 transition-colors disabled:opacity-50",children:"Delete"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>{ks(!1),Ts(null)},disabled:Ms,className:"px-4 py-2 bg-bg-subtle hover:bg-bg-elevated text-text-secondary rounded-lg border border-border-subtle transition-colors disabled:opacity-50",children:"Cancel"}),t.jsx("button",{onClick:async()=>{if(Ss){Is(!0),ms(null);try{const e=await K(Ss.id,{name:Ss.name,flood_policy:Ss.floodPolicy});e.success?(await ua(),ks(!1),Ts(null)):ms(e.error||"Failed to update transport key")}catch(e){ms(e instanceof Error?e.message:"Failed to update transport key")}finally{Is(!1)}}},disabled:Ms||!Ss.name.trim(),className:"px-4 py-2 bg-accent-primary/20 hover:bg-accent-primary/30 text-text-primary rounded-lg border border-accent-primary/50 transition-colors disabled:opacity-50 flex items-center gap-2",children:Ms?t.jsxs(t.Fragment,{children:[t.jsx(n,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):"Save"})]})]})]})]})}),Cs&&Fs&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&_s(!1),role:"dialog","aria-modal":"true","aria-labelledby":"delete-key-modal-title",children:t.jsxs("div",{className:"bg-bg-elevated border border-border-subtle rounded-xl p-6 max-w-md w-full shadow-2xl",children:[t.jsx("h3",{id:"delete-key-modal-title",className:"type-subheading text-text-primary mb-4",children:"Delete Transport Key"}),t.jsxs("p",{className:"text-text-secondary mb-4",children:["Are you sure you want to delete ",t.jsxs("strong",{className:"text-text-primary",children:["'",Fs.name,"'"]}),"?"]}),Fs.children&&Fs.children.length>0&&t.jsx("div",{className:"bg-accent-secondary/10 border border-accent-secondary/30 rounded-lg p-3 mb-4",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(v,{className:"w-4 h-4 text-accent-secondary flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-text-secondary",children:["This key has ",Fs.children.length," child key(s). Deleting will also remove all children."]})]})}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{_s(!1),Es(null)},disabled:Ms,className:"px-4 py-2 bg-bg-subtle hover:bg-bg-elevated text-text-secondary rounded-lg border border-border-subtle transition-colors disabled:opacity-50",children:"Cancel"}),t.jsx("button",{onClick:async()=>{if(Fs){Is(!0),ms(null);try{const e=await $(Fs.id);e.success?(await ua(),_s(!1),Es(null),gs(null)):ms(e.error||"Failed to delete transport key")}catch(e){ms(e instanceof Error?e.message:"Failed to delete transport key")}finally{Is(!1)}}},disabled:Ms,className:"px-4 py-2 bg-accent-danger/20 hover:bg-accent-danger/30 text-accent-danger rounded-lg border border-accent-danger/50 transition-colors disabled:opacity-50 flex items-center gap-2",children:Ms?t.jsxs(t.Fragment,{children:[t.jsx(n,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})}export{le as default};
