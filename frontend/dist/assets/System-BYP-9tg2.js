import{c as e,O as t,Q as a,T as r,P as s,j as n}from"./index-B6-Tf7Us.js";import{b as c,c as l,d as i,A as o,C as d,X as m,Y as u,T as h,j as p,f as y}from"./recharts-CGff6_7g.js";import{P as x,a as f,C as b,G as g,c as v,b as N}from"./PageLayout-7JDu0Wyr.js";import{R as k}from"./refresh-cw-CVIyJuD4.js";import{A as w}from"./activity-BXwm1AwF.js";import"./maplibre-gl-DsiI67my.js";const M=e("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]]),j=e("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),C=e("thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]),$={primary:"bg-accent-tertiary",secondary:"bg-accent-secondary",green:"bg-accent-success",red:"bg-accent-danger",yellow:"bg-accent-secondary"},A=c.memo(function({value:e,max:t=100,color:a="primary"}){const r=Math.min(e/t*100,100),s=r>90?"bg-accent-danger":r>70?"bg-accent-secondary":$[a];return n.jsx("div",{className:"h-2.5 bg-white/10 rounded-full overflow-hidden",children:n.jsx("div",{className:l("h-full rounded-full",s),style:{width:`${r}%`}})})}),G={cold:30,normal:50,warm:65,hot:80},z=c.memo(function({value:e,label:t,min:a=20,max:r=100}){const s=Math.min(Math.max((e-a)/(r-a)*100,0),100),c=e<G.cold?{text:"Cool",bg:"bg-accent-tertiary/20",text_color:"text-accent-tertiary",border:"border-accent-tertiary/30"}:e<G.normal?{text:"Normal",bg:"bg-accent-success/20",text_color:"text-accent-success",border:"border-accent-success/30"}:e<G.warm?{text:"Warm",bg:"bg-accent-secondary/20",text_color:"text-accent-secondary",border:"border-accent-secondary/30"}:e<G.hot?{text:"Hot",bg:"bg-signal-poor/20",text_color:"text-signal-poor",border:"border-signal-poor/30"}:{text:"DANGER",bg:"bg-accent-danger/20",text_color:"text-accent-danger",border:"border-accent-danger/30"},i=r-a,o={cold:(G.cold-a)/i*100,normal:(G.normal-a)/i*100,warm:(G.warm-a)/i*100,hot:(G.hot-a)/i*100},d=`linear-gradient(to right,\n    var(--accent-tertiary) 0%,\n    var(--accent-tertiary) ${o.cold}%,\n    var(--accent-success) ${o.cold}%,\n    var(--accent-success) ${o.normal}%,\n    var(--accent-secondary) ${o.normal}%,\n    var(--accent-secondary) ${o.warm}%,\n    #f97316 ${o.warm}%,\n    #f97316 ${o.hot}%,\n    var(--accent-danger) ${o.hot}%,\n    var(--accent-danger) 100%\n  )`;return n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-xs text-text-muted uppercase tracking-wide",children:t}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("span",{className:l("px-1.5 text-[9px] font-semibold rounded-full border leading-[14px]",c.bg,c.text_color,c.border),children:c.text}),n.jsxs("span",{className:"text-sm font-semibold tabular-nums text-text-primary",children:[e.toFixed(1),"Â°"]})]})]}),n.jsxs("div",{className:"relative h-2.5 bg-white/5 rounded-full overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 opacity-15 rounded-full",style:{background:d}}),n.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full transition-all duration-300 ease-out",style:{background:`linear-gradient(to right, ${[{pos:0,color:"var(--accent-tertiary)"},{pos:o.cold,color:"var(--accent-tertiary)"},{pos:o.cold,color:"var(--accent-success)"},{pos:o.normal,color:"var(--accent-success)"},{pos:o.normal,color:"var(--accent-secondary)"},{pos:o.warm,color:"var(--accent-secondary)"},{pos:o.warm,color:"#f97316"},{pos:o.hot,color:"#f97316"},{pos:o.hot,color:"var(--accent-danger)"},{pos:100,color:"var(--accent-danger)"}].map(e=>{const t=s>0?e.pos/s*100:0;return`${e.color} ${Math.min(t,100)}%`}).join(", ")})`,width:`${s}%`}}),n.jsx("div",{className:"absolute inset-0 flex items-center pointer-events-none",children:[G.normal,G.warm,G.hot].map(e=>{const t=(e-a)/(r-a)*100;return t<0||t>100?null:n.jsx("div",{className:"absolute w-px h-1.5 bg-white/20",style:{left:`${t}%`}},e)})})]})]})}),O="#60A5FA",L="#F9D26F",F=Math.floor(12e5/s.system);function P({payload:e}){return e?n.jsx("div",{className:"flex items-center gap-4 justify-center text-xs font-mono",children:e.map((e,t)=>n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),n.jsx("span",{className:"text-text-muted",children:e.value})]},t))}):null}function S({active:e,payload:t,label:a}){return e&&t&&0!==t.length?n.jsxs("div",{className:"bg-bg-surface/95 backdrop-blur-sm border border-border-subtle rounded-lg px-3 py-2 text-sm",children:[n.jsx("div",{className:"font-medium text-text-primary mb-1",children:a}),t.map((e,t)=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),n.jsxs("span",{className:"text-text-muted",children:[e.name,":"]}),n.jsxs("span",{className:"text-text-primary tabular-nums",children:[e.value.toFixed(1),"%"]})]},t))]}):null}const U=c.memo(function({data:e}){const t=function(e){const t=[],a=Math.max(0,F-e.length),r=Date.now(),n=s.system;for(let s=0;s<a;s++){const e=new Date(r-(F-s)*n).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1});t.push({slot:s,time:e,cpu:null,memory:null})}const c=e.slice(-F);for(let s=0;s<c.length;s++){const e=c[s];t.push({slot:a+s,time:e.time.slice(0,5),cpu:e.cpu,memory:e.memory})}return t}(e),a=Math.floor(F/4);return 0===e.length?n.jsx("div",{className:"h-48 flex items-center justify-center text-text-muted",children:"Collecting data..."}):n.jsx("div",{className:"h-48",children:n.jsx(i,{width:"100%",height:"100%",children:n.jsxs(o,{data:t,children:[n.jsxs("defs",{children:[n.jsxs("linearGradient",{id:"cpuGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[n.jsx("stop",{offset:"5%",stopColor:O,stopOpacity:.4}),n.jsx("stop",{offset:"95%",stopColor:O,stopOpacity:.05})]}),n.jsxs("linearGradient",{id:"memoryGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[n.jsx("stop",{offset:"5%",stopColor:L,stopOpacity:.4}),n.jsx("stop",{offset:"95%",stopColor:L,stopOpacity:.05})]})]}),n.jsx(d,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.06)",vertical:!1}),n.jsx(m,{dataKey:"time",axisLine:!1,tickLine:!1,tick:{fill:"rgba(255,255,255,0.4)",fontSize:10,fontFamily:"'JetBrains Mono', monospace"},dy:8,interval:a}),n.jsx(u,{domain:[0,100],axisLine:!1,tickLine:!1,tick:{fill:"rgba(255,255,255,0.4)",fontSize:10},dx:-4,width:40,tickFormatter:e=>`${e}%`}),n.jsx(h,{content:n.jsx(S,{})}),n.jsx(p,{content:n.jsx(P,{})}),n.jsx(y,{type:"stepAfter",dataKey:"cpu",name:"CPU",stroke:O,strokeWidth:2,fill:"url(#cpuGradient)",fillOpacity:.85,isAnimationActive:!1,connectNulls:!1}),n.jsx(y,{type:"stepAfter",dataKey:"memory",name:"Memory",stroke:L,strokeWidth:2,fill:"url(#memoryGradient)",fillOpacity:.85,isAnimationActive:!1,connectNulls:!1})]})})})});function _(){const[e,i]=c.useState(null),[o,d]=c.useState(!0),[m,u]=c.useState(null),[h,p]=c.useState(!1),y=t(),$=a(),G=c.useCallback(async()=>{try{const e=await r();e.success&&e.data?(i(e.data),u(null),$(e.data.cpu.usage_percent,e.data.memory.usage_percent,F)):u(e.error||"Failed to fetch hardware stats")}catch(e){u(e instanceof Error?e.message:"Failed to fetch hardware stats")}},[$]);return c.useEffect(()=>{let e=!0,t=null;if((async()=>{e&&(await G(),e&&d(!1))})(),"undefined"==typeof Worker){const t=setInterval(G,s.system);return()=>{e=!1,clearInterval(t)}}{const a=`\n        const interval = ${s.system};\n        setInterval(() => postMessage('tick'), interval);\n      `,r=new Blob([a],{type:"application/javascript"});t=new Worker(URL.createObjectURL(r)),t.onmessage=()=>{e&&G()}}return()=>{e=!1,t&&t.terminate()}},[G]),n.jsxs(x,{children:[n.jsx(f,{title:"System Stats",icon:n.jsx(M,{}),controls:n.jsxs("button",{onClick:async()=>{p(!0),await G(),p(!1)},disabled:h,className:"flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-bg-subtle hover:bg-bg-elevated rounded-lg transition-colors text-sm text-text-muted hover:text-text-primary self-start sm:self-auto",children:[n.jsx(k,{className:l("w-4 h-4",h&&"animate-spin")}),"Refresh"]})}),m&&n.jsx(b,{className:"border border-accent-danger/50 bg-accent-danger/10",children:n.jsx("p",{className:"text-accent-danger",children:m})}),o?n.jsx(b,{className:"p-12 text-center",children:n.jsx("div",{className:"animate-pulse text-text-muted",children:"Loading system stats..."})}):e?n.jsxs(g,{children:[n.jsx(v,{children:n.jsxs(b,{size:"lg",children:[n.jsx(N,{icon:n.jsx(w,{}),title:"System Resources",subtitle:"20 minute rolling window",iconColor:"text-accent-tertiary",largeTitle:!0,actions:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"type-micro",children:"CPU"}),n.jsxs("span",{className:"type-data font-semibold tabular-nums",style:{color:O},children:[e.cpu.usage_percent.toFixed(0),"%"]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"type-micro",children:"MEM"}),n.jsxs("span",{className:"type-data font-semibold tabular-nums",style:{color:L},children:[e.memory.usage_percent.toFixed(0),"%"]})]})]})}),n.jsx(U,{data:y}),n.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-border-subtle text-xs text-text-muted",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("span",{children:[e.cpu.count," CPU cores"]}),e.cpu.load_avg&&n.jsxs("span",{className:"tabular-nums",children:["Load: ",e.cpu.load_avg["1min"].toFixed(2)," / ",e.cpu.load_avg["5min"].toFixed(2)," / ",e.cpu.load_avg["15min"].toFixed(2)]})]}),n.jsxs("span",{className:"tabular-nums",children:[(e.memory.used/1048576).toFixed(0)," / ",(e.memory.total/1048576).toFixed(0)," MB"]})]})]})}),n.jsx(v,{md:6,children:n.jsxs(b,{size:"md",children:[n.jsx(N,{icon:n.jsx(j,{}),title:"Disk Usage",subtitle:"Storage utilization",iconColor:"text-accent-success",largeTitle:!0}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-text-muted",children:"Usage"}),n.jsxs("span",{className:"text-text-primary font-medium",children:[e.disk.usage_percent.toFixed(1),"%"]})]}),n.jsx(A,{value:e.disk.usage_percent,color:"green"}),n.jsxs("div",{className:"flex justify-between text-sm mt-2",children:[n.jsxs("span",{className:"text-text-muted",children:[(e.disk.used/1073741824).toFixed(1)," GB used"]}),n.jsxs("span",{className:"text-text-muted",children:[(e.disk.total/1073741824).toFixed(1)," GB total"]})]})]})]})}),n.jsx(v,{md:6,children:n.jsxs(b,{size:"md",children:[n.jsx(N,{icon:n.jsx(C,{}),title:"Temperature",subtitle:"System sensors",iconColor:"text-accent-secondary",largeTitle:!0}),e.temperatures&&Object.keys(e.temperatures).length>0?n.jsxs("div",{className:"space-y-2.5",children:[void 0!==e.temperatures.cpu_thermal&&n.jsx(z,{value:e.temperatures.cpu_thermal,label:"CPU",min:20,max:100}),Object.entries(e.temperatures).filter(([e])=>"cpu_thermal"!==e).slice(0,3).map(([e,t])=>n.jsx(z,{value:t,label:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),min:20,max:100},e))]}):n.jsxs("div",{className:"flex items-center justify-center h-20 text-text-muted text-sm",children:[n.jsx(w,{className:"w-4 h-4 mr-2"}),"No sensors available"]})]})})]}):null]})}export{_ as default};
