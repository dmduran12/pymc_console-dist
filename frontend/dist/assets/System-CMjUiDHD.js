import{r as e,j as t,a2 as s,aT as a,ae as r,aU as l,aV as n}from"./vendor-react-O8XH9yVn.js";import{c,R as o,A as i,C as d,X as m,Y as x,T as u,e as p,b as h}from"./recharts-BU7auunF.js";import{$ as j,a0 as y,a1 as f,a2 as g}from"./index-Dp0UlTio.js";import{e as v,a as b}from"./useThemeColors-CD0TSU03.js";import{P as N,b as w,a as k,c as C}from"./PageLayout-DE5PEtD2.js";import{R as F,C as _}from"./Grid-CIZAny_R.js";import"./vendor-core-WoOfkQwm.js";import"./deckgl-DTsmDcfs.js";const M=Math.floor(12e5/g.system),S={primary:"bg-accent-tertiary",secondary:"bg-accent-secondary",green:"bg-accent-success",red:"bg-accent-danger",yellow:"bg-accent-secondary"},G=[{threshold:30,color:"var(--accent-tertiary)",next:"var(--accent-success)"},{threshold:50,color:"var(--accent-success)",next:"var(--accent-secondary)"},{threshold:65,color:"var(--accent-secondary)",next:"var(--signal-poor)"},{threshold:80,color:"var(--signal-poor)",next:"var(--accent-danger)"}];function L(e,t,s){const a=s-t,r={cold:(30-t)/a*100,normal:(50-t)/a*100,warm:(65-t)/a*100,hot:(80-t)/a*100};return`linear-gradient(to right, ${[{pos:0,color:"var(--accent-tertiary)"},{pos:r.cold,color:"var(--accent-tertiary)"},{pos:r.cold,color:"var(--accent-success)"},{pos:r.normal,color:"var(--accent-success)"},{pos:r.normal,color:"var(--accent-secondary)"},{pos:r.warm,color:"var(--accent-secondary)"},{pos:r.warm,color:"var(--signal-poor)"},{pos:r.hot,color:"var(--signal-poor)"},{pos:r.hot,color:"var(--accent-danger)"},{pos:100,color:"var(--accent-danger)"}].map(t=>{const s=e>0?t.pos/e*100:0;return`${t.color} ${Math.min(s,100)}%`}).join(", ")})`}const T=e.memo(function({value:e,max:s=100,color:a="primary"}){const r=Math.min(e/s*100,100),l=r>90?"bg-accent-danger":r>70?"bg-accent-secondary":S[a];return t.jsx("div",{className:"h-2.5 bg-white/[0.02] rounded-full overflow-hidden",children:t.jsx("div",{className:c("h-full rounded-full",l),style:{width:`${r}%`}})})}),U=e.memo(function({value:e,label:s,min:a=20,max:r=100}){const l=Math.min(Math.max((e-a)/(r-a)*100,0),100),n=function(e){return e<30?{text:"Cool",color:"text-accent-tertiary"}:e<50?{text:"Normal",color:"text-accent-success"}:e<65?{text:"Warm",color:"text-accent-secondary"}:e<80?{text:"Hot",color:"text-signal-poor"}:{text:"Danger",color:"text-accent-danger"}}(e),c=r-a;return t.jsxs("div",{className:"space-y-1.5",children:[t.jsxs("div",{className:"flex justify-between items-baseline",children:[t.jsx("span",{className:"text-sm text-text-muted",children:s}),t.jsxs("div",{className:"flex items-baseline gap-2",children:[t.jsx("span",{className:"text-xs text-text-muted",children:n.text}),t.jsxs("span",{className:"text-sm font-mono tabular-nums",children:[t.jsx("span",{className:n.color,children:e.toFixed(1)}),t.jsx("span",{className:"text-text-primary",children:"Â°"})]})]})]}),t.jsxs("div",{className:"relative h-2 bg-white/[0.02] rounded-full overflow-hidden",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full transition-all duration-300 ease-out",style:{background:L(l,a,r),width:`${l}%`}}),t.jsx("div",{className:"absolute inset-0 flex items-center pointer-events-none",children:G.map(({threshold:e,color:s})=>{const r=(e-a)/c*100;return r<0||r>100?null:t.jsx("div",{className:"absolute w-px h-full",style:{left:`${r}%`,backgroundColor:s}},e)})})]})]})});function O({payload:e}){return e?t.jsx("div",{className:"flex items-center gap-4 justify-center text-xs font-mono",children:e.map((e,s)=>t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),t.jsx("span",{className:"text-text-muted",children:e.value})]},s))}):null}function $({active:e,payload:s,label:a}){return e&&(null==s?void 0:s.length)?t.jsxs("div",{className:"bg-tooltip-bg border border-border-subtle rounded-lg px-3 py-2 text-sm shadow-xl",children:[t.jsx("div",{className:"font-medium text-text-primary mb-1",children:a}),s.map((e,s)=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),t.jsxs("span",{className:"text-text-muted",children:[e.name,":"]}),t.jsxs("span",{className:"text-text-primary tabular-nums",children:[e.value.toFixed(1),"%"]})]},s))]}):null}const A=e.memo(function({data:e,cpuColor:s,memoryColor:a,chartGridColors:r}){const l=function(e){const t=[],s=Math.max(0,M-e.length),a=Date.now(),r=g.system;for(let n=0;n<s;n++){const e=new Date(a-(M-n)*r).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1});t.push({slot:n,time:e,cpu:null,memory:null})}const l=e.slice(-M);for(let n=0;n<l.length;n++){const e=l[n];t.push({slot:s+n,time:e.time.slice(0,5),cpu:e.cpu,memory:e.memory})}return t}(e),n=Math.floor(M/4);return 0===e.length?t.jsx("div",{className:"flex items-center justify-center text-text-muted",style:{height:192},children:"Collecting data..."}):t.jsx("div",{style:{height:192},children:t.jsx(o,{width:"100%",height:192,minWidth:1,minHeight:1,children:t.jsxs(i,{data:l,children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"cpuGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:s,stopOpacity:.4}),t.jsx("stop",{offset:"95%",stopColor:s,stopOpacity:.05})]}),t.jsxs("linearGradient",{id:"memoryGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:a,stopOpacity:.4}),t.jsx("stop",{offset:"95%",stopColor:a,stopOpacity:.05})]})]}),t.jsx(d,{strokeDasharray:"3 3",stroke:r.grid,vertical:!1}),t.jsx(m,{dataKey:"time",axisLine:!1,tickLine:!1,tick:{fill:r.axisTick,fontSize:10,fontFamily:"'JetBrains Mono', monospace"},dy:8,interval:n}),t.jsx(x,{domain:[0,100],axisLine:!1,tickLine:!1,tick:{fill:r.axisTick,fontSize:10},dx:-4,width:40,tickFormatter:e=>`${e}%`}),t.jsx(u,{content:t.jsx($,{})}),t.jsx(p,{content:t.jsx(O,{})}),t.jsx(h,{type:"stepAfter",dataKey:"cpu",name:"CPU",stroke:s,strokeWidth:2,fill:"url(#cpuGradient)",fillOpacity:.85,isAnimationActive:!1,connectNulls:!1}),t.jsx(h,{type:"stepAfter",dataKey:"memory",name:"Memory",stroke:a,strokeWidth:2,fill:"url(#memoryGradient)",fillOpacity:.85,isAnimationActive:!1,connectNulls:!1})]})})})});function P(){const[o,i]=e.useState(null),[d,m]=e.useState(!0),[x,u]=e.useState(null),[p,h]=e.useState(!1),S=j(),G=y(),L=v(),O=b(),$=L.chart3,P=L.chart4,R=e.useCallback(async()=>{try{const e=await f();e.success&&e.data?(i(e.data),u(null),G(e.data.cpu.usage_percent,e.data.memory.usage_percent,M)):u(e.error??"Failed to fetch hardware stats")}catch(e){u(e instanceof Error?e.message:"Failed to fetch hardware stats")}},[G]);return e.useEffect(()=>{let e=!0,t=null;if((async()=>{e&&(await R(),e&&m(!1))})(),"undefined"==typeof Worker){const t=setInterval(R,g.system);return()=>{e=!1,clearInterval(t)}}{const s=`setInterval(() => postMessage('tick'), ${g.system});`,a=new Blob([s],{type:"application/javascript"});t=new Worker(URL.createObjectURL(a)),t.onmessage=()=>{e&&R()}}return()=>{e=!1,null==t||t.terminate()}},[R]),t.jsxs(N,{children:[t.jsx(w,{title:"System Stats",icon:t.jsx(a,{}),controls:t.jsxs("button",{onClick:async()=>{h(!0),await R(),h(!1)},disabled:p,className:"flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-bg-subtle hover:bg-bg-elevated rounded-lg transition-colors text-sm text-text-muted hover:text-text-primary self-start sm:self-auto",children:[t.jsx(s,{className:c("w-4 h-4",p&&"animate-spin")}),"Refresh"]})}),x&&t.jsx(k,{className:"border border-accent-danger/50 bg-accent-danger/10",children:t.jsx("p",{className:"text-accent-danger",children:x})}),d?t.jsx(k,{className:"p-12 text-center",children:t.jsx("div",{className:"animate-pulse text-text-muted",children:"Loading system stats..."})}):o?t.jsxs(t.Fragment,{children:[t.jsx(F,{template:"hero",children:t.jsxs(k,{children:[t.jsx(C,{icon:t.jsx(r,{}),title:"System Resources",subtitle:"20 minute rolling window",largeTitle:!0,actions:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"type-micro",children:"CPU"}),t.jsxs("span",{className:"type-data font-semibold tabular-nums",style:{color:$},children:[o.cpu.usage_percent.toFixed(0),"%"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"type-micro",children:"MEM"}),t.jsxs("span",{className:"type-data font-semibold tabular-nums",style:{color:P},children:[o.memory.usage_percent.toFixed(0),"%"]})]})]})}),t.jsx("div",{className:"flex-1 min-h-0",children:t.jsx(A,{data:S,cpuColor:$,memoryColor:P,chartGridColors:O})}),t.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-border-subtle text-xs text-text-muted flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("span",{children:[o.cpu.count," CPU cores"]}),o.cpu.load_avg&&t.jsxs("span",{className:"tabular-nums",children:["Load: ",o.cpu.load_avg["1min"].toFixed(2)," / ",o.cpu.load_avg["5min"].toFixed(2)," / ",o.cpu.load_avg["15min"].toFixed(2)]})]}),t.jsxs("span",{className:"tabular-nums",children:[(o.memory.used/1048576).toFixed(0)," / ",(o.memory.total/1048576).toFixed(0)," MB"]})]})]})}),t.jsxs(F,{template:"compact",children:[t.jsx(_,{span:12,md:6,children:t.jsxs(k,{children:[t.jsx(C,{icon:t.jsx(l,{}),title:"Disk Usage",subtitle:"Storage utilization",largeTitle:!0}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-text-muted",children:"Usage"}),t.jsxs("span",{className:"text-text-primary font-medium",children:[o.disk.usage_percent.toFixed(1),"%"]})]}),t.jsx(T,{value:o.disk.usage_percent,color:"green"}),t.jsxs("div",{className:"flex justify-between text-sm mt-2",children:[t.jsxs("span",{className:"text-text-muted",children:[(o.disk.used/1073741824).toFixed(1)," GB used"]}),t.jsxs("span",{className:"text-text-muted",children:[(o.disk.total/1073741824).toFixed(1)," GB total"]})]})]})]})}),t.jsx(_,{span:12,md:6,children:t.jsxs(k,{children:[t.jsx(C,{icon:t.jsx(n,{}),title:"Temperature",subtitle:"System sensors",largeTitle:!0}),o.temperatures&&Object.keys(o.temperatures).length>0?t.jsxs("div",{className:"space-y-2.5",children:[void 0!==o.temperatures.cpu_thermal&&t.jsx(U,{value:o.temperatures.cpu_thermal,label:"CPU",min:20,max:100}),Object.entries(o.temperatures).filter(([e])=>"cpu_thermal"!==e).slice(0,3).map(([e,s])=>t.jsx(U,{value:s,label:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),min:20,max:100},e))]}):t.jsxs("div",{className:"flex items-center justify-center h-20 text-text-muted text-sm",children:[t.jsx(r,{className:"w-4 h-4 mr-2"}),"No sensors available"]})]})})]})]}):null]})}export{P as default};
