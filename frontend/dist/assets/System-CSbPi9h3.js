import{c as e,Y as t,Z as s,$ as a,o as r,j as l}from"./index-BA-LoFOy.js";import{b as c,c as o,d as n,A as i,C as d,X as m,Y as x,T as p,j as h,f as u}from"./recharts-bmHCCfxU.js";import{P as y,a as j,C as f,b as g}from"./PageLayout-BVrxHani.js";import{c as v}from"./useThemeColors-CMkWsRmX.js";import{R as b}from"./refresh-cw-Di1wuK5R.js";import{R as N,C as k}from"./Grid-BKQGLyxW.js";import{A as w}from"./activity-DpDSl4Cm.js";import"./maplibre-gl-CFO9X1Ek.js";const C=e("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]]),M=e("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),F=e("thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]),_={primary:"bg-accent-tertiary",secondary:"bg-accent-secondary",green:"bg-accent-success",red:"bg-accent-danger",yellow:"bg-accent-secondary"},S=c.memo(function({value:e,max:t=100,color:s="primary"}){const a=Math.min(e/t*100,100),r=a>90?"bg-accent-danger":a>70?"bg-accent-secondary":_[s];return l.jsx("div",{className:"h-2.5 bg-white/[0.02] rounded-full overflow-hidden",children:l.jsx("div",{className:o("h-full rounded-full",r),style:{width:`${a}%`}})})}),L={cold:30,normal:50,warm:65,hot:80},A=c.memo(function({value:e,label:t,min:s=20,max:a=100}){const r=Math.min(Math.max((e-s)/(a-s)*100,0),100),c=e<L.cold?{text:"Cool",color:"text-accent-tertiary"}:e<L.normal?{text:"Normal",color:"text-accent-success"}:e<L.warm?{text:"Warm",color:"text-accent-secondary"}:e<L.hot?{text:"Hot",color:"text-signal-poor"}:{text:"Danger",color:"text-accent-danger"},o=a-s,n={cold:(L.cold-s)/o*100,normal:(L.normal-s)/o*100,warm:(L.warm-s)/o*100,hot:(L.hot-s)/o*100};return l.jsxs("div",{className:"space-y-1.5",children:[l.jsxs("div",{className:"flex justify-between items-baseline",children:[l.jsx("span",{className:"text-sm text-text-muted",children:t}),l.jsxs("div",{className:"flex items-baseline gap-2",children:[l.jsx("span",{className:"text-xs text-text-muted",children:c.text}),l.jsxs("span",{className:"text-sm font-mono tabular-nums",children:[l.jsx("span",{className:c.color,children:e.toFixed(1)}),l.jsx("span",{className:"text-text-primary",children:"Â°"})]})]})]}),l.jsxs("div",{className:"relative h-2 bg-white/[0.02] rounded-full overflow-hidden",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full transition-all duration-300 ease-out",style:{background:`linear-gradient(to right, ${[{pos:0,color:"var(--accent-tertiary)"},{pos:n.cold,color:"var(--accent-tertiary)"},{pos:n.cold,color:"var(--accent-success)"},{pos:n.normal,color:"var(--accent-success)"},{pos:n.normal,color:"var(--accent-secondary)"},{pos:n.warm,color:"var(--accent-secondary)"},{pos:n.warm,color:"var(--signal-poor)"},{pos:n.hot,color:"var(--signal-poor)"},{pos:n.hot,color:"var(--accent-danger)"},{pos:100,color:"var(--accent-danger)"}].map(e=>{const t=r>0?e.pos/r*100:0;return`${e.color} ${Math.min(t,100)}%`}).join(", ")})`,width:`${r}%`}}),l.jsx("div",{className:"absolute inset-0 flex items-center pointer-events-none",children:[{threshold:L.cold,color:"var(--accent-tertiary)"},{threshold:L.normal,color:"var(--accent-success)"},{threshold:L.warm,color:"var(--accent-secondary)"},{threshold:L.hot,color:"var(--signal-poor)"}].map(({threshold:e,color:t})=>{const r=(e-s)/(a-s)*100;return r<0||r>100?null:l.jsx("div",{className:"absolute w-px h-full",style:{left:`${r}%`,backgroundColor:t}},e)})})]})]})}),G=Math.floor(12e5/r.system);function O({payload:e}){return e?l.jsx("div",{className:"flex items-center gap-4 justify-center text-xs font-mono",children:e.map((e,t)=>l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),l.jsx("span",{className:"text-text-muted",children:e.value})]},t))}):null}function U({active:e,payload:t,label:s}){return e&&t&&0!==t.length?l.jsxs("div",{className:"bg-tooltip-bg border border-border-subtle rounded-lg px-3 py-2 text-sm shadow-xl",children:[l.jsx("div",{className:"font-medium text-text-primary mb-1",children:s}),t.map((e,t)=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),l.jsxs("span",{className:"text-text-muted",children:[e.name,":"]}),l.jsxs("span",{className:"text-text-primary tabular-nums",children:[e.value.toFixed(1),"%"]})]},t))]}):null}const $=c.memo(function({data:e,cpuColor:t,memoryColor:s}){const a=function(e){const t=[],s=Math.max(0,G-e.length),a=Date.now(),l=r.system;for(let r=0;r<s;r++){const e=new Date(a-(G-r)*l).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1});t.push({slot:r,time:e,cpu:null,memory:null})}const c=e.slice(-G);for(let r=0;r<c.length;r++){const e=c[r];t.push({slot:s+r,time:e.time.slice(0,5),cpu:e.cpu,memory:e.memory})}return t}(e),c=Math.floor(G/4),o=t,y=s;return 0===e.length?l.jsx("div",{className:"h-48 flex items-center justify-center text-text-muted",children:"Collecting data..."}):l.jsx("div",{className:"h-48",children:l.jsx(n,{width:"100%",height:"100%",children:l.jsxs(i,{data:a,children:[l.jsxs("defs",{children:[l.jsxs("linearGradient",{id:"cpuGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[l.jsx("stop",{offset:"5%",stopColor:o,stopOpacity:.4}),l.jsx("stop",{offset:"95%",stopColor:o,stopOpacity:.05})]}),l.jsxs("linearGradient",{id:"memoryGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[l.jsx("stop",{offset:"5%",stopColor:y,stopOpacity:.4}),l.jsx("stop",{offset:"95%",stopColor:y,stopOpacity:.05})]})]}),l.jsx(d,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.06)",vertical:!1}),l.jsx(m,{dataKey:"time",axisLine:!1,tickLine:!1,tick:{fill:"rgba(255,255,255,0.4)",fontSize:10,fontFamily:"'JetBrains Mono', monospace"},dy:8,interval:c}),l.jsx(x,{domain:[0,100],axisLine:!1,tickLine:!1,tick:{fill:"rgba(255,255,255,0.4)",fontSize:10},dx:-4,width:40,tickFormatter:e=>`${e}%`}),l.jsx(p,{content:l.jsx(U,{})}),l.jsx(h,{content:l.jsx(O,{})}),l.jsx(u,{type:"stepAfter",dataKey:"cpu",name:"CPU",stroke:o,strokeWidth:2,fill:"url(#cpuGradient)",fillOpacity:.85,isAnimationActive:!1,connectNulls:!1}),l.jsx(u,{type:"stepAfter",dataKey:"memory",name:"Memory",stroke:y,strokeWidth:2,fill:"url(#memoryGradient)",fillOpacity:.85,isAnimationActive:!1,connectNulls:!1})]})})})});function T(){const[e,n]=c.useState(null),[i,d]=c.useState(!0),[m,x]=c.useState(null),[p,h]=c.useState(!1),u=t(),_=s(),L=v(),O=L.chart3,U=L.chart4,T=c.useCallback(async()=>{try{const e=await a();e.success&&e.data?(n(e.data),x(null),_(e.data.cpu.usage_percent,e.data.memory.usage_percent,G)):x(e.error||"Failed to fetch hardware stats")}catch(e){x(e instanceof Error?e.message:"Failed to fetch hardware stats")}},[_]);return c.useEffect(()=>{let e=!0,t=null;if((async()=>{e&&(await T(),e&&d(!1))})(),"undefined"==typeof Worker){const t=setInterval(T,r.system);return()=>{e=!1,clearInterval(t)}}{const s=`\n        const interval = ${r.system};\n        setInterval(() => postMessage('tick'), interval);\n      `,a=new Blob([s],{type:"application/javascript"});t=new Worker(URL.createObjectURL(a)),t.onmessage=()=>{e&&T()}}return()=>{e=!1,t&&t.terminate()}},[T]),l.jsxs(y,{children:[l.jsx(j,{title:"System Stats",icon:l.jsx(C,{}),controls:l.jsxs("button",{onClick:async()=>{h(!0),await T(),h(!1)},disabled:p,className:"flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-bg-subtle hover:bg-bg-elevated rounded-lg transition-colors text-sm text-text-muted hover:text-text-primary self-start sm:self-auto",children:[l.jsx(b,{className:o("w-4 h-4",p&&"animate-spin")}),"Refresh"]})}),m&&l.jsx(f,{className:"border border-accent-danger/50 bg-accent-danger/10",children:l.jsx("p",{className:"text-accent-danger",children:m})}),i?l.jsx(f,{className:"p-12 text-center",children:l.jsx("div",{className:"animate-pulse text-text-muted",children:"Loading system stats..."})}):e?l.jsxs(l.Fragment,{children:[l.jsx(N,{template:"hero",children:l.jsxs(f,{children:[l.jsx(g,{icon:l.jsx(w,{}),title:"System Resources",subtitle:"20 minute rolling window",iconColor:"text-accent-tertiary",largeTitle:!0,actions:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"type-micro",children:"CPU"}),l.jsxs("span",{className:"type-data font-semibold tabular-nums",style:{color:O},children:[e.cpu.usage_percent.toFixed(0),"%"]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"type-micro",children:"MEM"}),l.jsxs("span",{className:"type-data font-semibold tabular-nums",style:{color:U},children:[e.memory.usage_percent.toFixed(0),"%"]})]})]})}),l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx($,{data:u,cpuColor:O,memoryColor:U})}),l.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-border-subtle text-xs text-text-muted flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{children:[e.cpu.count," CPU cores"]}),e.cpu.load_avg&&l.jsxs("span",{className:"tabular-nums",children:["Load: ",e.cpu.load_avg["1min"].toFixed(2)," / ",e.cpu.load_avg["5min"].toFixed(2)," / ",e.cpu.load_avg["15min"].toFixed(2)]})]}),l.jsxs("span",{className:"tabular-nums",children:[(e.memory.used/1048576).toFixed(0)," / ",(e.memory.total/1048576).toFixed(0)," MB"]})]})]})}),l.jsxs(N,{template:"compact",children:[l.jsx(k,{span:12,md:6,children:l.jsxs(f,{children:[l.jsx(g,{icon:l.jsx(M,{}),title:"Disk Usage",subtitle:"Storage utilization",iconColor:"text-accent-success",largeTitle:!0}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-text-muted",children:"Usage"}),l.jsxs("span",{className:"text-text-primary font-medium",children:[e.disk.usage_percent.toFixed(1),"%"]})]}),l.jsx(S,{value:e.disk.usage_percent,color:"green"}),l.jsxs("div",{className:"flex justify-between text-sm mt-2",children:[l.jsxs("span",{className:"text-text-muted",children:[(e.disk.used/1073741824).toFixed(1)," GB used"]}),l.jsxs("span",{className:"text-text-muted",children:[(e.disk.total/1073741824).toFixed(1)," GB total"]})]})]})]})}),l.jsx(k,{span:12,md:6,children:l.jsxs(f,{children:[l.jsx(g,{icon:l.jsx(F,{}),title:"Temperature",subtitle:"System sensors",iconColor:"text-accent-secondary",largeTitle:!0}),e.temperatures&&Object.keys(e.temperatures).length>0?l.jsxs("div",{className:"space-y-2.5",children:[void 0!==e.temperatures.cpu_thermal&&l.jsx(A,{value:e.temperatures.cpu_thermal,label:"CPU",min:20,max:100}),Object.entries(e.temperatures).filter(([e])=>"cpu_thermal"!==e).slice(0,3).map(([e,t])=>l.jsx(A,{value:t,label:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),min:20,max:100},e))]}):l.jsxs("div",{className:"flex items-center justify-center h-20 text-text-muted text-sm",children:[l.jsx(w,{className:"w-4 h-4 mr-2"}),"No sensors available"]})]})})]})]}):null]})}export{T as default};
