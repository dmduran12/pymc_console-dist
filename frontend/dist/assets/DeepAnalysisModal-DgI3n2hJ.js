import{c as e,az as t,cj as a,ck as s,H as i,cl as n,I as c,m as r,au as o}from"./index-DFgVT2VN.js";import{r as l,j as d,c as m}from"./vendor-react-54o2BuWt.js";import{e as p,d as x}from"./config-C7QO3CEB.js";import{C as h}from"./DataBox-BVCZ0TUq.js";import{G as g}from"./git-branch-CZWrNFse.js";import{D as y}from"./house-B9WgHoyS.js";import{L as f}from"./loader-circle-Ctr2XVe4.js";const u=e("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),j=e("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),v=e("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]),b=e("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]]),k={hidden:{opacity:0,scale:.9},visible:{opacity:1,scale:1,transition:{type:"spring",stiffness:400,damping:15}},exit:{opacity:0,scale:.9,transition:{duration:x.fast}}},N={hidden:{opacity:0,y:"100%"},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,y:"100%",transition:{duration:x.medium,ease:p.easeIn}}};function w({label:e,icon:t,status:a,detail:s}){return d.jsxs("div",{className:m("flex items-center gap-3 py-3 px-4 radius-inset transition-base","active"===a&&"bg-accent-primary/10","complete"===a&&"bg-accent-primary/10 ring-2 ring-inset ring-accent-primary","pending"===a&&"opacity-40"),children:[d.jsx("div",{className:m("w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 transition-all duration-300","active"===a&&"bg-accent-primary/20","complete"===a&&"bg-accent-primary/20","pending"===a&&"bg-subtle-fill"),children:"complete"===a?d.jsx(h,{className:"w-4 h-4 text-accent-primary"}):"active"===a?d.jsx(f,{className:"w-4 h-4 animate-spin text-accent-primary"}):d.jsx("span",{className:"text-text-muted",children:t})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:m("text-sm font-medium transition-colors","active"===a&&"text-accent-primary","complete"===a&&"text-accent-primary","pending"===a&&"text-text-muted"),children:e}),s&&"pending"!==a&&d.jsx("div",{className:"text-xs text-text-muted mt-0.5 truncate",children:s})]})]})}const M=l.memo(function({isOpen:e,onClose:m}){const{packetCacheState:p,triggerDeepAnalysis:x}=t(),f=a(),j=s(),v=p.packetCount,[b,N]=l.useState("fetching");l.useEffect(()=>{e&&x()},[e,x]),l.useEffect(()=>{if(e)if(p.isTopologyLoading)N("fetching");else if(f)N("analyzing"),setTimeout(()=>N("building"),500),setTimeout(()=>N("discovering"),1e3);else if(j>0&&!p.isTopologyLoading){N("complete");const e=setTimeout(()=>{m()},1500);return()=>clearTimeout(e)}},[e,p.isTopologyLoading,f,j,m]);const M="complete"===b,T=p.loadProgress,z=l.useMemo(()=>T&&T.target>0?`Loading... ${(T.loaded/1e3).toFixed(1)}k / ${(T.target/1e3).toFixed(1)}k packets (${T.percent}%)`:v>0?`${v.toLocaleString()} packets loaded`:"Connecting to database...",[T,v]),C=e=>{const t=["fetching","analyzing","building","discovering","complete"],a=t.indexOf(b),s=t.indexOf(e);return s<a?"complete":s===a?"active":"pending"},D=M?m:()=>{};return d.jsx(i,{open:e,onClose:D,size:"sm",bottomSheet:!1,children:d.jsx(n,{isLoading:!M,borderRadius:16,children:d.jsx(c,{className:"p-6 radius-card overflow-hidden",children:M?d.jsxs("div",{className:"flex flex-col items-center py-6",children:[d.jsx(r.div,{variants:k,initial:"hidden",animate:"visible",className:"w-16 h-16 rounded-full flex items-center justify-center mb-4 bg-accent-primary/20",children:d.jsx(h,{className:"w-8 h-8 text-accent-primary"})}),d.jsx("h3",{className:"text-lg font-semibold text-accent-primary",children:"Ready!"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[d.jsx("div",{className:"w-10 h-10 radius-inset flex items-center justify-center bg-accent-primary/15",children:d.jsx(g,{className:"w-5 h-5 text-accent-primary"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-base font-semibold text-text-primary",children:"Deep Analysis"}),d.jsx("p",{className:"text-xs text-text-muted",children:"Building mesh topology"})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(w,{label:"Fetching Packets",icon:d.jsx(u,{className:"w-4 h-4"}),status:C("fetching"),detail:z}),d.jsx(w,{label:"Analyzing Database",icon:d.jsx(y,{className:"w-4 h-4"}),status:C("analyzing"),detail:"Processing packet paths"}),d.jsx(w,{label:"Building Topology",icon:d.jsx(g,{className:"w-4 h-4"}),status:C("building"),detail:"Computing mesh edges"}),d.jsx(w,{label:"Discovering Nodes",icon:d.jsx(o,{className:"w-4 h-4"}),status:C("discovering"),detail:"Viterbi HMM ghost detection"})]}),d.jsx("p",{className:"text-xs text-text-muted text-center mt-5",children:"This may take a few seconds..."})]})})})})});export{M as D,j as E,b as M,v as a,u as b,N as s};
