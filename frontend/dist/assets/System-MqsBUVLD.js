import{c as e,Y as t,Z as s,$ as a,o as r,j as c}from"./index-CuXXLMaO.js";import{b as n,c as l,d as o,A as i,C as d,X as m,Y as x,T as p,j as u,f as h}from"./recharts-bmHCCfxU.js";import{P as y,a as j,C as g,b as f}from"./PageLayout-BXg37b97.js";import{c as b}from"./useThemeColors-Co3IW0xw.js";import{R as v}from"./refresh-cw-Bu_SPswy.js";import{R as N,C as k}from"./Grid-Dosy-Ovb.js";import{A as w}from"./activity-DesFVJlt.js";import"./maplibre-gl-CFO9X1Ek.js";const M=e("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]]),C=e("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),_=e("thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]),F={primary:"bg-accent-tertiary",secondary:"bg-accent-secondary",green:"bg-accent-success",red:"bg-accent-danger",yellow:"bg-accent-secondary"},$=n.memo(function({value:e,max:t=100,color:s="primary"}){const a=Math.min(e/t*100,100),r=a>90?"bg-accent-danger":a>70?"bg-accent-secondary":F[s];return c.jsx("div",{className:"h-2.5 bg-white/10 rounded-full overflow-hidden",children:c.jsx("div",{className:l("h-full rounded-full",r),style:{width:`${a}%`}})})}),S={cold:30,normal:50,warm:65,hot:80},A=n.memo(function({value:e,label:t,min:s=20,max:a=100}){const r=Math.min(Math.max((e-s)/(a-s)*100,0),100),n=e<S.cold?{text:"Cool",bg:"bg-accent-tertiary/20",text_color:"text-accent-tertiary",border:"border-accent-tertiary/30"}:e<S.normal?{text:"Normal",bg:"bg-accent-success/20",text_color:"text-accent-success",border:"border-accent-success/30"}:e<S.warm?{text:"Warm",bg:"bg-accent-secondary/20",text_color:"text-accent-secondary",border:"border-accent-secondary/30"}:e<S.hot?{text:"Hot",bg:"bg-signal-poor/20",text_color:"text-signal-poor",border:"border-signal-poor/30"}:{text:"DANGER",bg:"bg-accent-danger/20",text_color:"text-accent-danger",border:"border-accent-danger/30"},o=a-s,i={cold:(S.cold-s)/o*100,normal:(S.normal-s)/o*100,warm:(S.warm-s)/o*100,hot:(S.hot-s)/o*100},d=`linear-gradient(to right,\n    var(--accent-tertiary) 0%,\n    var(--accent-tertiary) ${i.cold}%,\n    var(--accent-success) ${i.cold}%,\n    var(--accent-success) ${i.normal}%,\n    var(--accent-secondary) ${i.normal}%,\n    var(--accent-secondary) ${i.warm}%,\n    var(--signal-poor) ${i.warm}%,\n    var(--signal-poor) ${i.hot}%,\n    var(--accent-danger) ${i.hot}%,\n    var(--accent-danger) 100%\n  )`;return c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-xs text-text-muted uppercase tracking-wide",children:t}),c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx("span",{className:l("px-1.5 text-[9px] font-semibold rounded-full border leading-[14px]",n.bg,n.text_color,n.border),children:n.text}),c.jsxs("span",{className:"text-sm font-semibold tabular-nums text-text-primary",children:[e.toFixed(1),"Â°"]})]})]}),c.jsxs("div",{className:"relative h-2.5 bg-white/5 rounded-full overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 opacity-15 rounded-full",style:{background:d}}),c.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full transition-all duration-300 ease-out",style:{background:`linear-gradient(to right, ${[{pos:0,color:"var(--accent-tertiary)"},{pos:i.cold,color:"var(--accent-tertiary)"},{pos:i.cold,color:"var(--accent-success)"},{pos:i.normal,color:"var(--accent-success)"},{pos:i.normal,color:"var(--accent-secondary)"},{pos:i.warm,color:"var(--accent-secondary)"},{pos:i.warm,color:"var(--signal-poor)"},{pos:i.hot,color:"var(--signal-poor)"},{pos:i.hot,color:"var(--accent-danger)"},{pos:100,color:"var(--accent-danger)"}].map(e=>{const t=r>0?e.pos/r*100:0;return`${e.color} ${Math.min(t,100)}%`}).join(", ")})`,width:`${r}%`}}),c.jsx("div",{className:"absolute inset-0 flex items-center pointer-events-none",children:[S.normal,S.warm,S.hot].map(e=>{const t=(e-s)/(a-s)*100;return t<0||t>100?null:c.jsx("div",{className:"absolute w-px h-1.5 bg-white/20",style:{left:`${t}%`}},e)})})]})]})}),G=Math.floor(12e5/r.system);function L({payload:e}){return e?c.jsx("div",{className:"flex items-center gap-4 justify-center text-xs font-mono",children:e.map((e,t)=>c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),c.jsx("span",{className:"text-text-muted",children:e.value})]},t))}):null}function O({active:e,payload:t,label:s}){return e&&t&&0!==t.length?c.jsxs("div",{className:"bg-tooltip-bg border border-border-subtle rounded-lg px-3 py-2 text-sm shadow-xl",children:[c.jsx("div",{className:"font-medium text-text-primary mb-1",children:s}),t.map((e,t)=>c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),c.jsxs("span",{className:"text-text-muted",children:[e.name,":"]}),c.jsxs("span",{className:"text-text-primary tabular-nums",children:[e.value.toFixed(1),"%"]})]},t))]}):null}const U=n.memo(function({data:e,cpuColor:t,memoryColor:s}){const a=function(e){const t=[],s=Math.max(0,G-e.length),a=Date.now(),c=r.system;for(let r=0;r<s;r++){const e=new Date(a-(G-r)*c).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1});t.push({slot:r,time:e,cpu:null,memory:null})}const n=e.slice(-G);for(let r=0;r<n.length;r++){const e=n[r];t.push({slot:s+r,time:e.time.slice(0,5),cpu:e.cpu,memory:e.memory})}return t}(e),n=Math.floor(G/4),l=t,y=s;return 0===e.length?c.jsx("div",{className:"h-48 flex items-center justify-center text-text-muted",children:"Collecting data..."}):c.jsx("div",{className:"h-48",children:c.jsx(o,{width:"100%",height:"100%",children:c.jsxs(i,{data:a,children:[c.jsxs("defs",{children:[c.jsxs("linearGradient",{id:"cpuGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[c.jsx("stop",{offset:"5%",stopColor:l,stopOpacity:.4}),c.jsx("stop",{offset:"95%",stopColor:l,stopOpacity:.05})]}),c.jsxs("linearGradient",{id:"memoryGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[c.jsx("stop",{offset:"5%",stopColor:y,stopOpacity:.4}),c.jsx("stop",{offset:"95%",stopColor:y,stopOpacity:.05})]})]}),c.jsx(d,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.06)",vertical:!1}),c.jsx(m,{dataKey:"time",axisLine:!1,tickLine:!1,tick:{fill:"rgba(255,255,255,0.4)",fontSize:10,fontFamily:"'JetBrains Mono', monospace"},dy:8,interval:n}),c.jsx(x,{domain:[0,100],axisLine:!1,tickLine:!1,tick:{fill:"rgba(255,255,255,0.4)",fontSize:10},dx:-4,width:40,tickFormatter:e=>`${e}%`}),c.jsx(p,{content:c.jsx(O,{})}),c.jsx(u,{content:c.jsx(L,{})}),c.jsx(h,{type:"stepAfter",dataKey:"cpu",name:"CPU",stroke:l,strokeWidth:2,fill:"url(#cpuGradient)",fillOpacity:.85,isAnimationActive:!1,connectNulls:!1}),c.jsx(h,{type:"stepAfter",dataKey:"memory",name:"Memory",stroke:y,strokeWidth:2,fill:"url(#memoryGradient)",fillOpacity:.85,isAnimationActive:!1,connectNulls:!1})]})})})});function R(){const[e,o]=n.useState(null),[i,d]=n.useState(!0),[m,x]=n.useState(null),[p,u]=n.useState(!1),h=t(),F=s(),S=b(),L=S.chart3,O=S.chart4,R=n.useCallback(async()=>{try{const e=await a();e.success&&e.data?(o(e.data),x(null),F(e.data.cpu.usage_percent,e.data.memory.usage_percent,G)):x(e.error||"Failed to fetch hardware stats")}catch(e){x(e instanceof Error?e.message:"Failed to fetch hardware stats")}},[F]);return n.useEffect(()=>{let e=!0,t=null;if((async()=>{e&&(await R(),e&&d(!1))})(),"undefined"==typeof Worker){const t=setInterval(R,r.system);return()=>{e=!1,clearInterval(t)}}{const s=`\n        const interval = ${r.system};\n        setInterval(() => postMessage('tick'), interval);\n      `,a=new Blob([s],{type:"application/javascript"});t=new Worker(URL.createObjectURL(a)),t.onmessage=()=>{e&&R()}}return()=>{e=!1,t&&t.terminate()}},[R]),c.jsxs(y,{children:[c.jsx(j,{title:"System Stats",icon:c.jsx(M,{}),controls:c.jsxs("button",{onClick:async()=>{u(!0),await R(),u(!1)},disabled:p,className:"flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-bg-subtle hover:bg-bg-elevated rounded-lg transition-colors text-sm text-text-muted hover:text-text-primary self-start sm:self-auto",children:[c.jsx(v,{className:l("w-4 h-4",p&&"animate-spin")}),"Refresh"]})}),m&&c.jsx(g,{className:"border border-accent-danger/50 bg-accent-danger/10",children:c.jsx("p",{className:"text-accent-danger",children:m})}),i?c.jsx(g,{className:"p-12 text-center",children:c.jsx("div",{className:"animate-pulse text-text-muted",children:"Loading system stats..."})}):e?c.jsxs(c.Fragment,{children:[c.jsx(N,{template:"hero",children:c.jsxs(g,{children:[c.jsx(f,{icon:c.jsx(w,{}),title:"System Resources",subtitle:"20 minute rolling window",iconColor:"text-accent-tertiary",largeTitle:!0,actions:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"type-micro",children:"CPU"}),c.jsxs("span",{className:"type-data font-semibold tabular-nums",style:{color:L},children:[e.cpu.usage_percent.toFixed(0),"%"]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"type-micro",children:"MEM"}),c.jsxs("span",{className:"type-data font-semibold tabular-nums",style:{color:O},children:[e.memory.usage_percent.toFixed(0),"%"]})]})]})}),c.jsx("div",{className:"flex-1 min-h-0",children:c.jsx(U,{data:h,cpuColor:L,memoryColor:O})}),c.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-border-subtle text-xs text-text-muted flex-shrink-0",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{children:[e.cpu.count," CPU cores"]}),e.cpu.load_avg&&c.jsxs("span",{className:"tabular-nums",children:["Load: ",e.cpu.load_avg["1min"].toFixed(2)," / ",e.cpu.load_avg["5min"].toFixed(2)," / ",e.cpu.load_avg["15min"].toFixed(2)]})]}),c.jsxs("span",{className:"tabular-nums",children:[(e.memory.used/1048576).toFixed(0)," / ",(e.memory.total/1048576).toFixed(0)," MB"]})]})]})}),c.jsxs(N,{template:"compact",children:[c.jsx(k,{span:12,md:6,children:c.jsxs(g,{children:[c.jsx(f,{icon:c.jsx(C,{}),title:"Disk Usage",subtitle:"Storage utilization",iconColor:"text-accent-success",largeTitle:!0}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-text-muted",children:"Usage"}),c.jsxs("span",{className:"text-text-primary font-medium",children:[e.disk.usage_percent.toFixed(1),"%"]})]}),c.jsx($,{value:e.disk.usage_percent,color:"green"}),c.jsxs("div",{className:"flex justify-between text-sm mt-2",children:[c.jsxs("span",{className:"text-text-muted",children:[(e.disk.used/1073741824).toFixed(1)," GB used"]}),c.jsxs("span",{className:"text-text-muted",children:[(e.disk.total/1073741824).toFixed(1)," GB total"]})]})]})]})}),c.jsx(k,{span:12,md:6,children:c.jsxs(g,{children:[c.jsx(f,{icon:c.jsx(_,{}),title:"Temperature",subtitle:"System sensors",iconColor:"text-accent-secondary",largeTitle:!0}),e.temperatures&&Object.keys(e.temperatures).length>0?c.jsxs("div",{className:"space-y-2.5",children:[void 0!==e.temperatures.cpu_thermal&&c.jsx(A,{value:e.temperatures.cpu_thermal,label:"CPU",min:20,max:100}),Object.entries(e.temperatures).filter(([e])=>"cpu_thermal"!==e).slice(0,3).map(([e,t])=>c.jsx(A,{value:t,label:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),min:20,max:100},e))]}):c.jsxs("div",{className:"flex items-center justify-center h-20 text-text-muted text-sm",children:[c.jsx(w,{className:"w-4 h-4 mr-2"}),"No sensors available"]})]})})]})]}):null]})}export{R as default};
