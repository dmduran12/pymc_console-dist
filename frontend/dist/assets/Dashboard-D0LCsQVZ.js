import{r as e,j as t,c as s}from"./vendor-react-j_fHog8x.js";import{c as n,u as a,A as l,m as i,U as o,S as r,d as c,e as d,f as m,h as u,j as h,M as x,k as f,n as p,o as g,p as b,q as j,r as v,T as y,L as N,B as k,R as w,t as M,v as C,w as L,D as S,x as _,y as B,z as T,E as R,F as D,G as F,H,P as A,J as P,K as $,N as I,O as z,Q as E,V as q,W as O,X as W,Y as G,_ as V,$ as U,a0 as J,a1 as K}from"./index-BY6uUKaW.js";import{C as X,S as Q,a as Y,P as Z,b as ee,B as te}from"./PageLayout-CnRbvkoJ.js";import{S as se,M as ne}from"./sun-XqGUpE7j.js";import{A as ae,E as le,T as ie}from"./TimeRangeSelector-DrTay3dG.js";import{S as oe,u as re,P as ce,T as de,C as me}from"./PacketList-D4GTC9pk.js";import{T as ue,a as he,M as xe}from"./trending-up-BWQMkzTz.js";import{C as fe}from"./copy-ivfSr5Wu.js";import{C as pe}from"./Card-Cq9zGoPp.js";import{A as ge,Z as be,C as je}from"./SignalIndicator-D5UXAY1B.js";import{s as ve}from"./signal-scoring-CcBiRcks.js";import{L as ye}from"./LightSparkline-BCL2qx0n.js";import{a as Ne}from"./vendor-core-CmkNwW1A.js";import{c as ke}from"./link-scoring-DMllyO0E.js";import{N as we}from"./NodeInformationCard-JuoQU6W1.js";import{g as Me,e as Ce,a as Le,f as Se}from"./chat-utils-Cv7Riel7.js";import{M as _e,C as Be}from"./ChatBubble-DN4dM963.js";import{C as Te}from"./chevron-right-MY-Qway7.js";import{H as Re}from"./route-CNs7O3Lq.js";import{H as De}from"./DelayedAnimateNumber-CLmGbhgJ.js";import{R as Fe,C as He}from"./Grid-OFJ4oe0a.js";import"./maplibre-gl-b91ci4Kr.js";import"./index-CUw3DKhx.js";import"./payload-decoders-DoZGhocA.js";import"./arrow-up-D_1wu4Ec.js";import"./map-pin-HDnvTgMP.js";import"./triangle-alert-BOIygtvF.js";import"./DataBox-BfGRb9A8.js";import"./layers-BLMOkg18.js";import"./activity-ClSOfnuz.js";import"./circle-check-C0Rjagp4.js";import"./database-DBkDmrVM.js";const Ae=n("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),Pe=n("audio-waveform",[["path",{d:"M2 13a2 2 0 0 0 2-2V7a2 2 0 0 1 4 0v13a2 2 0 0 0 4 0V4a2 2 0 0 1 4 0v13a2 2 0 0 0 4 0v-4a2 2 0 0 1 2-2",key:"57tc96"}]]),$e=n("ear",[["path",{d:"M6 8.5a6.5 6.5 0 1 1 13 0c0 6-6 6-6 10a3.5 3.5 0 1 1-7 0",key:"1dfaln"}],["path",{d:"M15 8.5a2.5 2.5 0 0 0-5 0v1a2 2 0 1 1 0 4",key:"1qnva7"}]]),Ie=n("megaphone",[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]]),ze=n("satellite-dish",[["path",{d:"M4 10a7.31 7.31 0 0 0 10 10Z",key:"1fzpp3"}],["path",{d:"m9 15 3-3",key:"88sc13"}],["path",{d:"M17 13a6 6 0 0 0-6-6",key:"15cc6u"}],["path",{d:"M21 13A10 10 0 0 0 11 3",key:"11nf8s"}]]),Ee=n("square-activity",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M17 12h-2l-2 5-2-10-2 5H7",key:"15hlnc"}]]),qe=n("timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);function Oe({packets:s,rangeMinutes:n,bucketCount:c}){const d=a(),[m,u]=e.useState(null),[h,x]=e.useState(null),[f,p]=e.useState(null),{buckets:g,activeTypes:b,totalByType:j}=e.useMemo(()=>function(e,t,s){const n=Date.now()/1e3,a=60*t,l=n-a,i=a/s,o=[];for(let c=0;c<s;c++)o.push({start:l+c*i,end:l+(c+1)*i,bytesByType:{},totalBytes:0});const r={};for(const c of e){if(c.transmitted)continue;const e=c.timestamp;if(e<l||e>n)continue;const t=Math.min(s-1,Math.floor((e-l)/i)),a=c.type??c.payload_type??0,d=c.length??c.payload_length??0,m=o[t];m.bytesByType[a]=(m.bytesByType[a]??0)+d,m.totalBytes+=d,r[a]=(r[a]??0)+d}return{buckets:o,activeTypes:Object.keys(r).map(e=>parseInt(e,10)).filter(e=>r[e]>0).sort((e,t)=>r[t]-r[e]),totalByType:r}}(s,n,c),[s,n,c]),v=e.useCallback((e,t,s)=>{u(t),x(s)},[]),y=g.length>0&&b.length>0,N=m?function(e){const t=new Date(1e3*e).getHours();return t>=6&&t<18}(m.start):null,k=m?(w=m.start,new Date(1e3*w).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})):"";var w;const M=null!==f&&null!==N&&f!==N;return N!==f&&p(N),t.jsxs("div",{className:"flex flex-col h-full relative",children:[t.jsx("div",{className:"h-5 relative mb-1 shrink-0",children:m&&null!==h&&t.jsxs("div",{className:"absolute flex items-center gap-1.5 type-data-sm -translate-x-1/2",style:{left:`calc(48px + ${100*h}% * (1 - 48px / 100%))`},children:[t.jsx(l,{mode:"wait",children:t.jsx(i.span,{initial:!!M&&{opacity:0,scale:.5,rotate:-90},animate:{opacity:1,scale:1,rotate:0},exit:{opacity:0,scale:.5,rotate:90},transition:{duration:.25,ease:"easeOut"},children:N?t.jsx(se,{className:"w-4 h-4 text-sys-amber"}):t.jsx(ne,{className:"w-4 h-4 text-sys-blue"})},N?"sun":"moon")}),t.jsx("span",{className:"text-fg-secondary",children:k})]})}),t.jsx("div",{className:"flex-1 min-h-0",children:y&&t.jsx(o,{buckets:g,activeTypes:b,gridColor:d.grid,axisTickColor:d.axisTick,onHover:v})}),t.jsx("div",{className:"pt-2 px-1 pb-2 shrink-0",children:y&&t.jsx(r,{activeTypes:b,totalByType:j})})]})}const We=e.memo(function({buckets:s,activeTypes:n}){const a=e.useRef(null),l=e.useRef(s),i=e.useRef(n);l.current=s,i.current=n;const o=e.useMemo(()=>[s.map(e=>e.start),s.map(()=>1)],[s]);return e.useEffect(()=>{if(!a.current||0===s.length)return;const e=a.current,t=e.getBoundingClientRect(),n=Math.floor(t.width)||200,r=Math.floor(t.height)||60,u=new c({width:n,height:r,padding:[0,0,0,0],cursor:{show:!1},scales:{x:{time:!1},y:{range:[0,1]}},axes:[{show:!1},{show:!1}],series:[{},{show:!1}],legend:{show:!1},hooks:{draw:[e=>{const t=e.ctx,{left:s,top:n,width:a,height:o}=e.bbox;!function(e,t,s,n,a,l,i){if(0===t.length)return;const o=function(e,t,s){var n,a;if(e.length<=s)return e;const l=e.length/s,i=[];for(let o=0;o<s;o++){const s=Math.floor(o*l),r=Math.floor((o+1)*l),c=e.slice(s,r),d={start:(null==(n=c[0])?void 0:n.start)??0,end:(null==(a=c.at(-1))?void 0:a.end)??0,bytesByType:{},totalBytes:0};for(const e of c){d.totalBytes+=e.totalBytes;for(const s of t){const t=e.bytesByType[s]??0;t>0&&(d.bytesByType[s]=(d.bytesByType[s]??0)+t)}}i.push(d)}return i}(t,s,m.statsCard),r=o.length,c=l/r,u=o.map(e=>e.totalBytes).filter(e=>e>0);if(0===u.length)return;const h=Math.max(...u),x=Math.min(...u),f=h-x;for(let m=0;m<r;m++){const t=o[m],l=n+m*c,r=t.totalBytes;if(0===r)continue;let u,h,p;0===f?(h=.4,p=.3,u=.5):(u=(r-x)/f,p=.15*u,h=Math.max(.3,.3+.5*u));const g=h*i;let b=a+i-p*i-g+g;for(const n of s){const s=t.bytesByType[n]??0;if(0===s)continue;const a=s/r*g,i=b-a;e.fillStyle=d(n),e.globalAlpha=.85,e.fillRect(l,i,c,a),b=i}}e.globalAlpha=1}(t,l.current,i.current,s,n,a,o)}]}},o,e),h=new ResizeObserver(()=>{const t=e.getBoundingClientRect();t.width>0&&t.height>0&&u.setSize({width:Math.floor(t.width),height:Math.floor(t.height)})});return h.observe(e),()=>{h.disconnect(),u.destroy()}},[o,s.length]),0===s.length?t.jsx("div",{className:"h-full flex items-center justify-center",children:t.jsx("div",{className:"w-full h-0.5 rounded-full bg-fg-muted/15"})}):t.jsx("div",{ref:a,className:"w-full h-full"})});function Ge({value:s,receivedCount:n,packets:a,rangeMinutes:l,bucketCount:i,timeRangeLabel:o,icon:r,isLoaded:c=!0}){const{buckets:d,activeTypes:m,ratePerHour:x}=e.useMemo(()=>function(e,t,s){const n=Date.now()/1e3,a=60*t,l=n-a,i=a/s,o=[];for(let m=0;m<s;m++)o.push({start:l+m*i,end:l+(m+1)*i,bytesByType:{},totalBytes:0});const r={};let c=0;for(const m of e){if(!("tx_forward"===m.packet_origin||m.transmitted&&"tx_local"!==m.packet_origin))continue;const e=m.timestamp;if(e<l||e>n)continue;const t=Math.min(s-1,Math.floor((e-l)/i)),a=m.type??m.payload_type??0,d=m.length??m.payload_length??0,u=o[t];u.bytesByType[a]=(u.bytesByType[a]??0)+d,u.totalBytes+=d,r[a]=(r[a]??0)+d,c++}const d=t/60;return{buckets:o,activeTypes:Object.keys(r).map(e=>parseInt(e,10)).filter(e=>r[e]>0).sort((e,t)=>r[t]-r[e]),ratePerHour:d>0?Math.round(c/d):0}}(a,l,i),[a,l,i]),f=n>0?(s/n*100).toFixed(1):null;return c?t.jsxs(u,{compact:!0,children:[t.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-2 sm:mb-3",children:[r&&t.jsx("span",{className:"icon-sm text-icon-card-title",children:r}),t.jsx("span",{className:"type-micro",children:"FORWARDED"}),o&&t.jsx(h,{color:"zinc",className:"hidden sm:inline-flex",children:o})]}),t.jsx("div",{className:"type-data-xl text-fg-primary",children:t.jsx(ae,{value:s,className:"font-mono tabular-nums",priority:"high"})}),t.jsx("div",{className:"flex-1 mt-1 overflow-hidden min-h-[40px] sm:min-h-[60px]",children:m.length>0?t.jsx(We,{buckets:d,activeTypes:m}):t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.jsx("div",{className:"w-full h-0.5 rounded-full bg-fg-muted/15"})})}),t.jsx("div",{className:"pt-1.5 sm:pt-2 mt-1",children:t.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"data-box-label",children:"Rate"}),t.jsxs("div",{className:"data-box data-box-fill data-box-left",children:[x,"/hr"]})]}),null!==f&&t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"data-box-label",children:"Ratio"}),t.jsxs("div",{className:"data-box data-box-fill data-box-left",children:[f,"%"]})]})]})})]}):t.jsx(u,{compact:!0,children:t.jsx(X,{})})}function Ve({value:s,receivedCount:n,packets:a,rangeMinutes:l,bucketCount:i,timeRangeLabel:o,icon:r,isLoaded:c=!0}){const{buckets:d,activeTypes:m,ratePerHour:x}=e.useMemo(()=>function(e,t,s){const n=Date.now()/1e3,a=60*t,l=n-a,i=a/s,o=[];for(let m=0;m<s;m++)o.push({start:l+m*i,end:l+(m+1)*i,bytesByType:{},totalBytes:0});const r={};let c=0;for(const m of e){if(!m.drop_reason)continue;const e=m.timestamp;if(e<l||e>n)continue;const t=Math.min(s-1,Math.floor((e-l)/i)),a=m.type??m.payload_type??0,d=m.length??m.payload_length??0,u=o[t];u.bytesByType[a]=(u.bytesByType[a]??0)+d,u.totalBytes+=d,r[a]=(r[a]??0)+d,c++}const d=t/60;return{buckets:o,activeTypes:Object.keys(r).map(e=>parseInt(e,10)).filter(e=>r[e]>0).sort((e,t)=>r[t]-r[e]),ratePerHour:d>0?Math.round(c/d):0}}(a,l,i),[a,l,i]),f=n>0?(s/n*100).toFixed(1):null;return c?t.jsxs(u,{compact:!0,children:[t.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-2 sm:mb-3",children:[r&&t.jsx("span",{className:"icon-sm text-icon-card-title",children:r}),t.jsx("span",{className:"type-micro",children:"DROPPED"}),o&&t.jsx(h,{color:"zinc",className:"hidden sm:inline-flex",children:o})]}),t.jsx("div",{className:"type-data-xl text-fg-primary",children:t.jsx(ae,{value:s,className:"font-mono tabular-nums",priority:"high"})}),t.jsx("div",{className:"flex-1 mt-1 overflow-hidden min-h-[40px] sm:min-h-[60px]",children:m.length>0?t.jsx(We,{buckets:d,activeTypes:m}):t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.jsx("div",{className:"w-full h-0.5 rounded-full bg-fg-muted/15"})})}),t.jsx("div",{className:"pt-1.5 sm:pt-2 mt-1",children:t.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"data-box-label",children:"Rate"}),t.jsxs("div",{className:"data-box data-box-fill data-box-left",children:[x,"/hr"]})]}),null!==f&&t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"data-box-label",children:"Drop %"}),t.jsxs("div",{className:"data-box data-box-fill data-box-left",children:[f,"%"]})]})]})})]}):t.jsx(u,{compact:!0,children:t.jsx(X,{})})}const Ue={",":"punc",".":"punc-period",":":"punc-colon","/":"punc-slash"},Je=/([,\.:\/])/g,Ke=e.memo(function({children:s,className:n="",as:a="span"}){const l=e.useMemo(()=>{let e;return e="number"==typeof s?s.toLocaleString():Array.isArray(s)?s.join(""):String(s??""),Je.test(e)?(Je.lastIndex=0,e.split(Je).map((e,s)=>{const n=Ue[e];return n?t.jsx("span",{className:n,children:e},s):e})):e},[s]);return t.jsx(a,{className:`data-tight ${n}`.trim(),children:l})}),Xe=.2;function Qe(e,t=1){return Math.floor(5*t*e)}function Ye(e){const t=Math.round(e/Xe)*Xe;return Math.max(0,Math.min(5,t))}function Ze({stats:s,receivedBuckets:n,droppedBuckets:a,forwardedBuckets:l,bucketDurationSeconds:i,timeRangeLabel:o,isLoaded:r=!0}){var c,d,m,p;const[g,b]=e.useState(!1);if(!r)return t.jsx(u,{compact:!0,children:t.jsx(X,{})});const j=function(e,t,s,n,a){var l,i;const o=e=>(null==e?void 0:e.reduce((e,t)=>e+t.count,0))??0,r=o(t),c=o(s),d=o(n),m=r||(null==e?void 0:e.rx_count)||1,u=c||(null==e?void 0:e.dropped_count)||0,h=m>0?u/(m+u)*100:0;let x=0;if((null==n?void 0:n.length)&&a)x=100*d/(n.length*a*1e3)*100;else if(e){const t=1e3*(e.uptime_seconds||1);x=(e.total_airtime_ms||e.airtime_used_ms||0)/t*100}const f=(null==e?void 0:e.neighbors)??{},p=Object.values(f).filter(e=>e.zero_hop).length;let g=1;h<3?g-=Xe:h>15?g+=.4:h>10&&(g+=Xe),x>5&&(g+=Xe),p>10&&(g+=Xe);const b=Ye(g),j=Ye(.28*b),v=Qe(b),y=Qe(j),N=Qe((null==(i=null==(l=null==e?void 0:e.config)?void 0:l.delays)?void 0:i.tx_delay_factor)??1);return{floodFactor:b,directFactor:j,floodSlots:v,directSlots:y,adjustment:v>N?"increase":v<N?"decrease":"stable",duplicateRate:Math.round(100*h)/100,txUtilization:Math.round(1e3*x)/1e3,zeroHopCount:p,totalReceived:r,totalDropped:c}}(s,n,a,l,i),v=(null==(d=null==(c=null==s?void 0:s.config)?void 0:c.delays)?void 0:d.tx_delay_factor)??null,y=(null==(p=null==(m=null==s?void 0:s.config)?void 0:m.delays)?void 0:p.direct_tx_delay_factor)??null,N=null!==v?Qe(v):null,k=null!==N&&j.floodSlots!==N,w="increase"===j.adjustment?ue:"decrease"===j.adjustment?he:x;return t.jsxs(u,{compact:!0,children:[t.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-2 sm:mb-3 flex-wrap",children:[t.jsx(oe,{className:"w-4 h-4 text-icon-card-title flex-shrink-0"}),t.jsx("span",{className:"type-micro",children:"DELAY DOCTOR"}),o&&t.jsx(h,{color:"zinc",className:"hidden sm:inline-flex",children:o}),k&&t.jsxs(h,{color:"increase"===j.adjustment?"amber":"emerald",className:"flex items-center gap-1",children:[t.jsx(w,{className:"w-3 h-3"}),"increase"===j.adjustment?"+":"-",Math.abs(j.floodSlots-(N??0))]})]}),t.jsxs("button",{onClick:async()=>{const e=`set txdelay ${j.floodFactor.toFixed(1)}\nset direct.txdelay ${j.directFactor.toFixed(1)}`;try{await navigator.clipboard.writeText(e),b(!0),setTimeout(()=>b(!1),1500)}catch(t){const s=document.createElement("textarea");s.value=e,s.style.position="fixed",s.style.opacity="0",document.body.appendChild(s),s.select();try{document.execCommand("copy"),b(!0),setTimeout(()=>b(!1),1500)}catch{}document.body.removeChild(s)}},className:"flex gap-3 mb-2 sm:mb-3 w-full text-left hover:bg-subtle-fill radius-inner transition-base p-1 -m-1 group",title:"Click to copy CLI commands",children:[t.jsxs("div",{className:"flex-1 flex flex-col",children:[t.jsx("span",{className:"type-data-xl text-fg-primary",children:t.jsxs(Ke,{children:["Ã—",j.floodFactor.toFixed(1)]})}),t.jsx("span",{className:"type-micro text-fg-muted mt-0.5 sm:mt-1",children:"Flood"})]}),t.jsxs("div",{className:"flex-1 flex flex-col",children:[t.jsx("span",{className:"type-data-xl text-sys-blue",children:t.jsxs(Ke,{children:["Ã—",j.directFactor.toFixed(1)]})}),t.jsx("span",{className:"type-micro text-fg-muted mt-0.5 sm:mt-1",children:"Direct"})]}),t.jsx("div",{className:"flex items-center self-center opacity-0 group-hover:opacity-100 transition-opacity",children:g?t.jsx(f,{className:"w-4 h-4 text-sys-green"}):t.jsx(fe,{className:"w-4 h-4 text-fg-muted"})})]}),t.jsx("div",{className:"flex-1 py-2",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"data-box-label",children:"Dupe"}),t.jsxs("div",{className:"data-box data-box-fill data-box-left "+(j.duplicateRate>10?"text-status-warning":""),children:[j.duplicateRate.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"data-box-label",children:"TX Util"}),t.jsxs("div",{className:"data-box data-box-fill data-box-left",children:[j.txUtilization.toFixed(2),"%"]})]})]})}),t.jsxs("div",{className:"pt-2 mt-2",children:[t.jsx("div",{className:"data-box-label",children:"Current"}),t.jsx("div",{className:"flex gap-2",children:null!==v?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"data-box",children:["Ã—",v.toFixed(2)]}),t.jsxs("div",{className:"data-box",style:{color:"var(--sys-blue)"},children:["Ã—",(null==y?void 0:y.toFixed(2))??"â€”"]})]}):t.jsx("span",{className:"text-sm text-fg-muted",children:"No config"})})]})]})}function et(){const s=p(),n=g(),a=b(),l=j(),i=v(),o=re(e=>e.requestChannel),[r,c]=e.useState(!0),d=e.useCallback(e=>c(e),[]),m=e.useMemo(()=>[...s.length<=100?s:s.slice(-100)].sort((e,t)=>(t.timestamp??0)-(e.timestamp??0)),[s]),h=null==l?void 0:l.local_hash,x=null==l?void 0:l.neighbors;return t.jsxs(u,{noPadding:!0,className:"!overflow-visible",children:[t.jsx(pe,{listHeader:!0,icon:t.jsx(w,{}),title:"Recent Packets",actions:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(y,{enabled:r,onChange:d,label:"Hide Dupes",size:"sm"}),a&&t.jsx(N,{showLabel:!0}),t.jsxs(k,{color:"primary",outline:!0,href:"/packets",children:["View all",t.jsx(ge,{"data-slot":"icon"})]})]})}),t.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto px-1",children:t.jsx(ce,{packets:m,allPackets:s,localHash:h,neighbors:x,decodedMessages:i,onChannelClick:o,loading:n,maxPackets:25,showPagination:!1,flashNewest:!0,hideDupes:r,emptyMessage:"No packets received",footerAction:t.jsxs(k,{color:"primary",outline:!0,href:"/packets",children:["View all",t.jsx(ge,{"data-slot":"icon"})]})})})]})}const tt={stable:"M5 12h14",up:"M5 15l7-7 7 7",down:"M19 9l-7 7-7-7"};function st({trend:e}){return t.jsx("span",{className:`mini-widget-trend ${e}`,children:t.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:tt[e]})})})}function nt(){return t.jsx("div",{className:"mini-widget-loading",children:t.jsx("div",{className:"mini-widget-loading-spinner"})})}function at({message:e}){return t.jsx("div",{className:"mini-widget-error",children:t.jsx("span",{title:e,children:"No data"})})}function lt({title:e,icon:s,value:n,unit:a,valueSize:l="md",status:i,subtitle:o,trend:r,children:c,isLoading:d=!1,error:m,className:h="",onClick:x}){const f=["mini-widget-value","lg"===l&&"mini-widget-value-lg","sm"===l&&"mini-widget-value-sm"].filter(Boolean).join(" "),p=["mini-widget",h].filter(Boolean).join(" ");return t.jsxs(u,{noPadding:!0,className:p,onClick:x,children:[t.jsxs("div",{className:"mini-widget-header",children:[s,t.jsx("span",{className:"mini-widget-title",children:e}),i&&"unknown"!==i&&t.jsx("div",{className:`mini-widget-status-dot ${i}`}),r&&t.jsx(st,{trend:r})]}),d?t.jsx(nt,{}):m?t.jsx(at,{message:m}):t.jsxs(t.Fragment,{children:[void 0!==n&&t.jsxs("div",{className:f,children:["number"==typeof n?t.jsx(ae,{value:n,className:"font-mono tabular-nums",priority:"medium",format:Number.isInteger(n)?void 0:{minimumFractionDigits:1,maximumFractionDigits:1}}):t.jsx(Ke,{children:n}),a&&t.jsx("span",{className:"mini-widget-unit",children:a})]}),o&&t.jsx("div",{className:"mini-widget-subtitle",children:o}),c]})]})}const it={DELTA_CRITICAL:10,SLOPE_CRITICAL:4,JITTER_CRITICAL:6,DELTA_WARNING:5,SLOPE_WARNING:2,JITTER_WARNING:4},ot={baselineMedian:null,baselineP10:null,baselineP90:null,currentMedian:null,currentSampleCount:0,delta:0,slope:0,jitter:0,penalty:0,penaltyReason:null,computedAt:0,isReliable:!1};function rt(e,t){if(0===e.length)return null;const s=[...e].sort((e,t)=>e-t),n=t/100*(s.length-1),a=Math.floor(n),l=Math.ceil(n);return a===l?s[a]:s[a]+(s[l]-s[a])*(n-a)}function ct(e){return rt(e,50)}function dt(e){if(!e)return[];try{const t=JSON.parse(e);if(Array.isArray(t))return t.map(Number).filter(e=>!isNaN(e))}catch{}return[]}function mt(e){return null!=e&&0!==e&&!Object.is(e,-0)&&!(e>-50||e<-130)}function ut(e,t,s=2,n=!1){if(null===t)return"stable";const a=e-t;return(0!==t?100*Math.abs(a/t):Math.abs(a))<s?"stable":n?a>0?"up":"down":a>0?"down":"up"}const ht={lbtStats:null,noiseFloor:null,sparklineNoiseFloor:[],linkQuality:null,channelHealth:null,nfTrend:ot,radioConfig:null,trends:null,stats:null,recentPackets:[],quickNeighbors:[],isLoading:!0,error:null,refresh:async()=>{}},xt=e.createContext(ht);function ft({children:s}){var n;const a=j(),l=p(),i=M(),o=C(),r=L(),c=S[r],d=Math.max(1,c.minutes/60),m=null===a,u=e.useMemo(()=>function(e,t){const s=3600*t,n=Math.floor(Date.now()/1e3)-s,a=e.filter(e=>e.timestamp>=n&&void 0!==e.lbt_attempts&&e.lbt_attempts>0),l=a.length,i=a.filter(e=>(e.lbt_attempts??0)>1).length,o=l>0?i/l*100:0,r=a.filter(e=>(e.lbt_attempts??0)>1),c=r.length>0?r.reduce((e,t)=>e+(t.lbt_attempts??0),0)/r.length:0,d=a.filter(e=>(e.lbt_attempts??0)>=5).length,m=l>0?d/l*100:0,u=[];for(const v of a){const e=dt(v.lbt_backoff_delays_ms);u.push(...e)}const h=u.reduce((e,t)=>e+t,0),x=u.length>0?h/u.length:0,f=u.length>0?Math.min(...u):0,p=u.length>0?Math.max(...u):0,g=s/24,b=[],j=[];for(let v=0;v<24;v++){const e=n+v*g,t=e+g,s=a.filter(s=>s.timestamp>=e&&s.timestamp<t),l=s.filter(e=>(e.lbt_attempts??0)>1).length,i=s.length>0?l/s.length*100:0,o=[];for(const n of s){const e=dt(n.lbt_backoff_delays_ms);o.push(...e)}const r=o.length>0?o.reduce((e,t)=>e+t,0)/o.length:0;if(b.push(r),0===s.length)j.push(0);else{const e=s.filter(e=>(e.lbt_attempts??0)>=5).length,t=o.length>0?Math.max(...o):0,n=Math.min(s.length/5,1),a=.15,l=Math.log(1+i*a)/Math.log(1+100*a)*40,c=e/s.length*100,d=Math.min(.5*c,25);let m=0;r>100&&(m=Math.min(8*Math.log10(r/100),15));let u=0;t>500&&r>0&&t>2*r&&(u=Math.min((t-500)/200,5));const h=l+d+m+u;j.push(Math.min(h*n,85))}}return{totalPacketsWithLBT:l,packetsWithRetries:i,retryRate:o,avgRetries:c,channelBusyCount:d,channelBusyRate:m,avgBackoffMs:x,minBackoffMs:f,maxBackoffMs:p,totalBackoffMs:h,sparklineBackoff:b,sparklineCollisionRisk:j,windowHours:t,packetCount:e.length}}(l,d),[l,d]),h=(null==a?void 0:a.noise_floor_dbm)??null,x=e.useMemo(()=>mt(h)?h:null,[h]),f=e.useMemo(()=>{var e;const t=null==(e=null==a?void 0:a.config)?void 0:e.radio;return t?{sf:t.spreading_factor??7,bwHz:t.bandwidth??125e3}:null},[null==(n=null==a?void 0:a.config)?void 0:n.radio]),[g,b]=e.useState([]),v=e.useRef({time:0,hours:0});e.useEffect(()=>{const e=async()=>{var e;const t=Date.now(),s=Math.ceil(d);if(0===v.current.time||v.current.hours!==s||t-v.current.time>=6e4){v.current={time:t,hours:s};try{const t=await _(Math.max(s,24));t.success&&(null==(e=t.data)?void 0:e.history)&&b(t.data.history)}catch{}}};e();const t=setInterval(e,6e4);return()=>clearInterval(t)},[d]);const y=e.useMemo(()=>function(e,t){if(0===e.length)return[];const s=e.reduce((e,t)=>Math.max(e,t.timestamp),0);if(0===s)return[];const n=3600*t,a=s-n,l=n/24,i=[];for(let o=0;o<24;o++){const t=a+o*l,s=t+l,n=e.filter(e=>e.timestamp>=t&&e.timestamp<s&&mt(e.noise_floor_dbm));if(n.length>0){const e=n.reduce((e,t)=>e+t.noise_floor_dbm,0)/n.length;i.push(e)}else i.push(i.length>0?i[i.length-1]:-100)}return i}(g,d),[g,d]),N=null==a?void 0:a.neighbors,k=e.useMemo(()=>{const e=N??{};return Object.fromEntries(Object.entries(e).filter(([e])=>!o.has(e)))},[N,o]),w=e.useMemo(()=>i.filter(e=>!o.has(e.hash)),[i,o]),B=e.useMemo(()=>function(e){if(0===e.length)return{...ot,computedAt:Math.floor(Date.now()/1e3)};const t=Math.floor(Date.now()/1e3),s=e.filter(e=>Number.isFinite(e)),n=e.length>0?[e[e.length-1]]:[],a=e.slice(-4).filter(e=>Number.isFinite(e)),l=ct(s),i=rt(s,10),o=rt(s,90),r=ct(n),c=null!==r&&null!==i?r-i:0,d=function(e){if(e.length<2)return 0;const t=e.length;let s=0,n=0,a=0,l=0;const i=e[0].timestamp;for(const r of e){const e=(r.timestamp-i)/3600,t=r.value;s+=e,n+=t,a+=e*t,l+=e*e}const o=t*l-s*s;return Math.abs(o)<1e-4?0:(t*a-s*n)/o}(a.map((e,s)=>({timestamp:t-3600*(a.length-1-s),value:e}))),m=function(e){if(e.length<2)return 0;const t=e.reduce((e,t)=>e+t,0)/e.length,s=e.map(e=>Math.pow(e-t,2)).reduce((e,t)=>e+t,0)/e.length;return Math.sqrt(s)}(a),u=s.length>=12,[h,x]=u?function(e,t,s){const n=it;return e>=n.DELTA_CRITICAL?[2,`Noise floor ${e.toFixed(1)} dB above baseline`]:t>=n.SLOPE_CRITICAL?[2,`Noise floor rising ${t.toFixed(1)} dB/hour`]:s>=n.JITTER_CRITICAL?[2,`Noise floor unstable (Â±${s.toFixed(1)} dB)`]:e>=n.DELTA_WARNING?[1,`Noise floor ${e.toFixed(1)} dB above baseline`]:t>=n.SLOPE_WARNING?[1,`Noise floor rising ${t.toFixed(1)} dB/hour`]:s>=n.JITTER_WARNING?[1,`Noise floor variable (Â±${s.toFixed(1)} dB)`]:[0,null]}(c,d,m):[0,null];return{baselineMedian:l,baselineP10:i,baselineP90:o,currentMedian:r,currentSampleCount:n.length,delta:c,slope:d,jitter:m,penalty:h,penaltyReason:x,computedAt:t,isReliable:u}}(y),[y]),T=e.useMemo(()=>function(e,t,s){if(0===e.length)return{neighbors:[],networkScore:0,neighborCount:0,bestLink:null,worstLink:null};const n=e.map(e=>{const n=function(e,t,s){const n=ve(e,t,s,0);if(n)switch(n.finalGrade){case"excellent":return 100;case"good":return 80;case"fair":return 60;case"poor":return 40;case"critical":return 20}const a=void 0===e?50:e>=10?100:e>=5?80:e>=0?60:e>=-5?40:20,l=void 0===t?50:t>=-70?100:t>=-80?80:t>=-90?60:t>=-100?40:20;return Math.round(.6*a+.4*l)}(e.avgSnr??void 0,e.avgRssi??void 0,s),a=t[e.hash];return{name:(null==a?void 0:a.name)||(null==a?void 0:a.node_name)||e.prefix,hash:e.hash,rssi:e.avgRssi??-100,snr:e.avgSnr??-10,score:n,advertCount:e.count}});n.sort((e,t)=>t.score-e.score);const a=n.length>0?n.reduce((e,t)=>e+t.score,0)/n.length:0;return{neighbors:n,networkScore:Math.round(a),neighborCount:n.length,bestLink:n.length>0?{name:n[0].name,score:n[0].score}:null,worstLink:n.length>0?{name:n[n.length-1].name,score:n[n.length-1].score}:null}}(w,k,f),[w,k,f]),R=e.useMemo(()=>function(e,t,s){const n=e?Math.max(0,Math.min(100,100-5*e.retryRate)):50;let a=50;null!==t&&(a=Math.max(0,Math.min(100,(t+120)/30*100)));const l=(null==s?void 0:s.networkScore)??50,i=Math.round(.35*n+.25*a+.4*l);let o;return o=i>=85?"excellent":i>=70?"good":i>=50?"fair":i>=30?"congested":"critical",{score:i,status:o,components:{lbtHealth:Math.round(n),noiseHealth:Math.round(a),linkHealth:Math.round(l)}}}(u,x,T),[u,x,T]),[D,F]=e.useState({noiseFloor:null,networkScore:null,channelHealth:null}),H=e.useRef(0);e.useEffect(()=>{const e=()=>{const e=Date.now();e-H.current>3e4&&(H.current=e,F({noiseFloor:x,networkScore:(null==T?void 0:T.networkScore)??null,channelHealth:(null==R?void 0:R.score)??null}))};e();const t=setInterval(e,5e3);return()=>clearInterval(t)},[x,null==T?void 0:T.networkScore,null==R?void 0:R.score]);const A=e.useMemo(()=>({noiseFloor:{current:x,previous:D.noiseFloor,trend:null!==x?ut(x,D.noiseFloor,2,!0):"stable"},networkScore:{current:(null==T?void 0:T.networkScore)??0,previous:D.networkScore,trend:ut((null==T?void 0:T.networkScore)??0,D.networkScore,3,!1)},channelHealth:{current:(null==R?void 0:R.score)??0,previous:D.channelHealth,trend:ut((null==R?void 0:R.score)??0,D.channelHealth,3,!1)}}),[x,null==T?void 0:T.networkScore,null==R?void 0:R.score,D]),P={lbtStats:u,noiseFloor:x,sparklineNoiseFloor:y,linkQuality:T,channelHealth:R,nfTrend:B,radioConfig:f,trends:A,stats:a,recentPackets:l,quickNeighbors:i,isLoading:m,error:null,refresh:async()=>{}};return t.jsx(xt.Provider,{value:P,children:s})}function pt(){const t=e.useContext(xt);if(void 0===t)throw new Error("useLBTData must be used within an LBTDataProvider");return t}function gt(e,t){return 0===e?"No backoffs":`${t.toFixed(0)}% retry rate`}function bt(){const{lbtStats:s,isLoading:n,error:a}=pt(),l=Ne(),i=(null==s?void 0:s.avgBackoffMs)??0,o=(null==s?void 0:s.retryRate)??0,r=s?(c=i)<100?"excellent":c<250?"good":c<500?"fair":c<1e3?"congested":"critical":"unknown";var c;const d=null==s?void 0:s.sparklineBackoff,m=e.useMemo(()=>!d||d.length<2?[]:d.map((e,t)=>({timestamp:Date.now()-36e5*(d.length-1-t),count:e})),[d]);return t.jsx(lt,{title:"LBT Backoff",icon:t.jsx(qe,{className:"mini-widget-icon"}),value:Math.round(i),unit:"ms",status:r,subtitle:s?gt(i,o):void 0,isLoading:n,error:a,onClick:()=>l("/packets"),children:t.jsx("div",{className:"mini-widget-sparkline w-full",children:t.jsx(ye,{data:m,width:9999,height:24,color:"var(--sys-blue)",isLoading:n,className:"w-full"})})})}function jt(e){return 0===e?"â€”":e<1?"<1":Math.round(e).toString()}function vt(){const{lbtStats:e,isLoading:s,error:n}=pt(),a=Ne(),l=(null==e?void 0:e.channelBusyCount)??0,i=(null==e?void 0:e.totalPacketsWithLBT)??0,o=(null==e?void 0:e.channelBusyRate)??0,r=(null==e?void 0:e.retryRate)??0,c=(null==e?void 0:e.avgBackoffMs)??0,d=(null==e?void 0:e.minBackoffMs)??0,m=(null==e?void 0:e.maxBackoffMs)??0,u=r>0?Math.max(0,(r-o)/r*100):100;return t.jsx(lt,{title:"Ch. Busy",icon:t.jsx(le,{className:"mini-widget-icon"}),isLoading:s,error:n,onClick:()=>a("/packets"),children:t.jsx("div",{className:"flex-1 flex items-end",children:t.jsxs("div",{className:"grid grid-cols-[auto_minmax(0,1fr)] sm:grid-cols-[auto_minmax(0,1fr)_auto_minmax(0,1fr)] gap-x-2 gap-y-1 sm:gap-y-2 w-full items-baseline",children:[t.jsx("span",{className:"data-box-label mb-0 text-[10px] sm:text-sm",title:`${l} packets exceeded max CAD attempts (5) out of ${i} total transmissions.`,children:"Failed:"}),t.jsxs("div",{className:"data-box data-box-compact sm:data-box justify-self-start",title:`${l} packets exceeded max CAD attempts (5) out of ${i} total transmissions.`,children:[t.jsx(Ke,{children:l}),t.jsx("span",{className:"text-fg-muted punc-slash",children:"/"}),t.jsx(Ke,{children:i})]}),t.jsx("span",{className:"data-box-label mb-0 text-[10px] sm:text-sm",title:`${u.toFixed(1)}% of packets that needed LBT retries were sent successfully.`,children:"Sent:"}),t.jsx("div",{className:"data-box data-box-compact sm:data-box justify-self-start",title:`${u.toFixed(1)}% of packets that needed LBT retries were sent successfully.`,children:t.jsxs(Ke,{children:[u.toFixed(0),"%"]})}),t.jsx("span",{className:"data-box-label mb-0 text-[10px] sm:text-sm",title:`Average LBT backoff delay: ${c.toFixed(0)}ms.`,children:"Mean:"}),t.jsxs("div",{className:"data-box data-box-compact sm:data-box justify-self-start",title:`Average LBT backoff delay: ${c.toFixed(0)}ms.`,children:[t.jsx(Ke,{children:jt(c)}),t.jsx("span",{className:"text-fg-muted text-xs",children:"ms"})]}),t.jsx("span",{className:"data-box-label mb-0 text-[10px] sm:text-sm",title:`Backoff range: ${d.toFixed(0)}ms min, ${m.toFixed(0)}ms max.`,children:"Range:"}),t.jsxs("div",{className:"data-box data-box-compact sm:data-box justify-self-start",title:`Backoff range: ${d.toFixed(0)}ms min, ${m.toFixed(0)}ms max.`,children:[t.jsx(Ke,{children:jt(d)}),t.jsx("span",{className:"text-fg-muted punc-slash",children:"/"}),t.jsx(Ke,{children:jt(m)})]})]})})})}function yt(e){return null===e?"No reading":e<-115?"Very quiet":e<-105?"Quiet":e<-95?"Moderate":e<-85?"Elevated":"High interference"}function Nt(){const{noiseFloor:s,sparklineNoiseFloor:n,trends:a,isLoading:l,error:i}=pt(),o=null===(r=s)||r<-110?"excellent":r<-100?"good":r<-90?"fair":r<-80?"congested":"critical";var r;const c=null==a?void 0:a.noiseFloor.trend,d=e.useMemo(()=>!n||n.length<2?[]:n.map((e,t)=>({timestamp:Date.now()-36e5*(n.length-1-t),count:-e})),[n]),m=null!==s?Math.round(s):"â€”";return t.jsx(lt,{title:"Noise Floor",icon:t.jsx(Pe,{className:"mini-widget-icon"}),value:m,unit:null!==s?"dBm":void 0,status:o,trend:c,subtitle:yt(s),isLoading:l,error:i,children:t.jsx("div",{className:"mini-widget-sparkline w-full",children:t.jsx(ye,{data:d,width:9999,height:24,color:"var(--sys-blue)",isLoading:l,className:"w-full"})})})}function kt(){const s=Ne(),n=M(),a=p(),l=j(),i=L(),o=60*S[i].minutes,r=B(),c=e.useMemo(()=>{if(0===r)return a;const e=r-o;return a.filter(t=>t.timestamp>=e)},[a,o,r]),d=null===l,m=(null==l?void 0:l.local_hash)?T(l.local_hash):"",u=(null==l?void 0:l.neighbors)??{},{neighborHashes:h,neighborNames:x}=e.useMemo(()=>{const e=new Set,t=new Map;for(const s of n){e.add(s.hash);const n=u[s.hash],a=(null==n?void 0:n.name)||(null==n?void 0:n.node_name)||s.prefix;t.set(s.hash,a)}return{neighborHashes:e,neighborNames:t}},[n,u]),f=e.useMemo(()=>{if(0===h.size||0===c.length||!m)return{champion:null,listener:null,loudest:null};const{scores:e}=ke(c,h,m),t=[];for(const[l,i]of e)0!==i.blendedScore&&t.push({...i,name:x.get(l)??T(l)});let s=null,n=null,a=null;for(const l of t)(!s||l.blendedScore>s.blendedScore)&&(s=l),(!n||l.listenerScore>n.listenerScore)&&(n=l),(!a||l.loudScore>a.loudScore)&&(a=l);return{champion:s,listener:n,loudest:a}},[c,h,m,x]),{champion:g,listener:b,loudest:v}=f,y=g||b||v?t.jsxs("div",{className:"flex flex-col gap-0 sm:gap-0.5 mt-auto",children:[g&&t.jsx(R,{content:(N=g,t.jsxs("div",{className:"max-w-[220px]",children:[t.jsxs("div",{className:"font-semibold mb-1",children:["ðŸ† Champion: ",N.name]}),t.jsxs("div",{className:"text-fg-muted mb-1",children:["Blended Score: ",N.blendedScore,t.jsx("span",{className:"text-fg-muted/60 ml-1",children:"(Listener + Loud)"})]}),t.jsxs("div",{className:"border-t border-edge-subtle pt-1 mt-1 space-y-0.5",children:[t.jsxs("div",{children:["Listener: ",N.listenerScore,"/100 (",N.listenerCount," shared paths)"]}),t.jsxs("div",{children:["Loud: ",N.loudScore,"/100 (",N.loudCount," packets relayed)"]})]})]})),children:t.jsxs("div",{className:"flex items-center gap-1 text-xs sm:text-sm radius-badge px-1 -mx-1 hover-bg transition-base cursor-default",children:[t.jsx(de,{className:"w-2.5 h-2.5 sm:w-3 sm:h-3 text-map-neighbor-color flex-shrink-0"}),t.jsx("span",{className:"font-semibold text-map-neighbor-color font-mono truncate flex-1 min-w-0",children:g.name}),t.jsx("span",{className:"text-map-neighbor-color pl-1 sm:pl-2 tabular-nums flex-shrink-0 w-7 sm:w-9 text-right",children:g.blendedScore})]})}),b&&t.jsx(R,{content:(e=>t.jsxs("div",{className:"max-w-[220px]",children:[t.jsxs("div",{className:"font-semibold mb-1",children:["ðŸ‘‚ Best Listener: ",e.name]}),t.jsxs("div",{className:"text-fg-muted mb-1",children:["Score: ",e.listenerScore,"/100"]}),t.jsx("div",{className:"border-t border-edge-subtle pt-1 mt-1",children:t.jsxs("div",{children:[e.listenerCount," packets where they heard your transmissions"]})})]}))(b),children:t.jsxs("div",{className:"flex items-center gap-1 text-xs sm:text-sm radius-badge px-1 -mx-1 hover-bg transition-base cursor-default",children:[t.jsx($e,{className:"w-2.5 h-2.5 sm:w-3 sm:h-3 text-fg-muted flex-shrink-0"}),t.jsx("span",{className:"text-fg-muted font-mono truncate flex-1 min-w-0",children:b.name}),t.jsx("span",{className:"text-fg-muted pl-1 sm:pl-2 tabular-nums flex-shrink-0 w-7 sm:w-9 text-right",children:b.listenerScore})]})}),v&&t.jsx(R,{content:(e=>t.jsxs("div",{className:"max-w-[220px]",children:[t.jsxs("div",{className:"font-semibold mb-1",children:["ðŸ“¢ Loudest: ",e.name]}),t.jsxs("div",{className:"text-fg-muted mb-1",children:["Score: ",e.loudScore,"/100"]}),t.jsx("div",{className:"border-t border-edge-subtle pt-1 mt-1",children:t.jsxs("div",{children:[e.loudCount," packets they relayed directly to you"]})})]}))(v),children:t.jsxs("div",{className:"flex items-center gap-1 text-xs sm:text-sm radius-badge px-1 -mx-1 hover-bg transition-base cursor-default",children:[t.jsx(Ie,{className:"w-2.5 h-2.5 sm:w-3 sm:h-3 text-fg-muted flex-shrink-0"}),t.jsx("span",{className:"text-fg-muted font-mono truncate flex-1 min-w-0",children:v.name}),t.jsx("span",{className:"text-fg-muted pl-1 sm:pl-2 tabular-nums flex-shrink-0 w-7 sm:w-9 text-right",children:v.loudScore})]})})]}):0===n.length?t.jsx("div",{className:"flex items-center justify-center text-xs sm:text-sm text-fg-muted mt-auto",children:"No direct neighbors"}):t.jsx("div",{className:"flex items-center justify-center text-xs sm:text-sm text-fg-muted mt-auto",children:"No routing data yet"});var N;return t.jsx(lt,{title:"Link Leaders",icon:t.jsx(ze,{className:"mini-widget-icon"}),isLoading:d,onClick:()=>s("/contacts"),children:y})}function wt(){const{lbtStats:s,isLoading:n,error:a}=pt(),l=s?function(e){const{retryRate:t,channelBusyCount:s,totalPacketsWithLBT:n,avgBackoffMs:a,maxBackoffMs:l}=e;if(0===n)return 0;const i=Math.min(n/10,1),o=Math.log(1+.15*t)/Math.log(16)*40,r=s/n*100,c=Math.min(.5*r,25);let d=0;a>100&&(d=Math.min(8*Math.log10(a/100),15));let m=0;l>500&&a>0&&l>2*a&&(m=Math.min((l-500)/200,5));const u=(o+c+d+m)*i;return Math.min(u,85)}(s):0,i=s?(o=l)<15?"excellent":o<30?"good":o<45?"fair":o<60?"congested":"critical":"unknown";var o;const r=(null==s?void 0:s.maxBackoffMs)??0,c=s?r>200?`Max backoff: ${Math.round(r)}ms`:function(e){return e<15?"Clear channel":e<30?"Light traffic":e<45?"Moderate traffic":e<60?"Heavy traffic":e<75?"Congested":"Severe congestion"}(l):void 0,d=null==s?void 0:s.sparklineCollisionRisk,m=e.useMemo(()=>!d||d.length<2?[]:d.map((e,t)=>({timestamp:Date.now()-36e5*(d.length-1-t),count:e})),[d]),u=Math.round(10*l)/10;return t.jsx(lt,{title:"Collision Risk",icon:t.jsx(be,{className:"mini-widget-icon"}),value:u,unit:"%",status:i,subtitle:c,isLoading:n,error:a,children:t.jsx("div",{className:"mini-widget-sparkline w-full",children:t.jsx(ye,{data:m,width:9999,height:24,color:"var(--sys-blue)",isLoading:n,className:"w-full"})})})}function Mt(){const[s,n]=e.useState(!1),[a]=e.useState(0),{stats:l,lbtStats:i,isLoading:o}=pt(),r=e.useMemo(()=>{if(!l)return null;const e=l.airtime_used_ms??0,t=l.max_airtime_ms??1;return{usedMs:e,maxMs:t,remainingMs:l.airtime_remaining_ms??0,utilizationPercent:l.utilization_percent??(t>0?e/t*100:0)}},[l]),c=e.useMemo(()=>i&&0!==i.totalPacketsWithLBT?(i.totalPacketsWithLBT-i.packetsWithRetries)/i.totalPacketsWithLBT*100:100,[i]),d=(null==r?void 0:r.utilizationPercent)??0,m=(u=d)<30?"excellent":u<50?"good":u<70?"fair":u<90?"congested":"critical";var u;const h=(null==r?void 0:r.remainingMs)??0,x=c<95?`${c.toFixed(0)}% clean TX`:((f=h)<1e3?`${Math.round(f)}ms`:f<6e4?`${(f/1e3).toFixed(1)}s`:`${(f/6e4).toFixed(1)}m`)+" remaining";var f;const p=r?t.jsx("div",{className:"mini-widget-progress mt-auto",children:t.jsx("div",{className:`mini-widget-progress-bar ${m}`,style:{width:`${Math.min(d,100)}%`}})}):null;return t.jsx(lt,{title:"Duty Cycle",icon:t.jsx(w,{className:"mini-widget-icon"}),value:d.toFixed(1),unit:"%",status:m,subtitle:x,isLoading:o,children:p})}function Ct(){return t.jsxs("div",{className:"mini-widget",children:[t.jsxs("div",{className:"mini-widget-header",children:[t.jsx(Q,{className:"w-4 h-4"}),t.jsx(Q,{className:"h-3 w-16"})]}),t.jsx(Q,{className:"h-7 w-12 mt-2"}),t.jsx(Q,{className:"h-3 w-20 mt-2"})]})}function Lt(){return t.jsx("div",{className:"widget-row",children:Array.from({length:6}).map((e,s)=>t.jsx(Ct,{},s))})}function St({className:e="",isLoaded:s=!0}){return t.jsxs("div",{className:`mesh-health-container relative ${e}`,children:[t.jsxs("div",{className:"mesh-health-header",children:[t.jsx(Ee,{className:"w-4 h-4 text-sys-blue"}),t.jsx("span",{className:"type-label text-fg-muted",children:"MESH HEALTH"})]}),s?t.jsx(ft,{children:t.jsxs("div",{className:"widget-row",children:[t.jsx(bt,{}),t.jsx(wt,{}),t.jsx(Nt,{}),t.jsx(Mt,{}),t.jsx(vt,{}),t.jsx(kt,{})]})}):t.jsx(Lt,{})]})}let _t="",Bt="",Tt="";function Rt(e){!function(){const e=new Date,t=e.toDateString();if(t!==Tt){Tt=t,_t=t;const s=new Date(e);s.setDate(s.getDate()-1),Bt=s.toDateString()}}();const t=new Date(1e3*e).toDateString();return t===_t?"Today":t===Bt?"Yesterday":new Date(1e3*e).toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"})}function Dt(e,t,s){return`${e||""}|${t}|${s}`}const Ft=e.memo(function({message:e,onChannelClick:s,isChannelSelected:n}){const a=e.channelName||e.channelHash.slice(0,6);return t.jsx("div",{style:{transform:"translateZ(0)",willChange:"transform"},children:t.jsx(Be,{senderName:e.senderName||"Unknown",text:e.text,timestamp:e.timestamp,nameAccessory:t.jsx(me,{channelName:a,active:n,onClick:()=>null==s?void 0:s(e.channelHash)})})})},function(e,t){const s=e.message,n=t.message;return s.timestamp===n.timestamp&&s.text===n.text&&s.senderName===n.senderName&&s.channelHash===n.channelHash&&s.channelName===n.channelName&&e.isChannelSelected===t.isChannelSelected&&e.onChannelClick===t.onChannelClick});function Ht({open:n,onClose:a,messages:l,onLoadMore:i,hasMoreToLoad:o,isDecoding:r,initialChannel:c}){const d=e.useRef(null),m=e.useRef(!0),u=L(),h=I(),x=e.useRef(!1);e.useEffect(()=>{n?(x.current=!0,z.resume()):x.current&&z.pause()},[n]);const f=e.useMemo(()=>{const e=Date.now()/1e3-60*S[u].minutes;return[...l].filter(t=>t.timestamp>=e).sort((e,t)=>e.timestamp-t.timestamp)},[l,u]),p=e.useCallback(()=>{const e=d.current;e&&(m.current=e.scrollTop>=-50)},[]),g=e.useMemo(()=>{const e=new Map;for(const t of f){const s=t.channelHash,n=e.get(s);n?n.count++:e.set(s,{name:t.channelName||t.channelHash.slice(0,6),hash:t.channelHash,count:1})}return Array.from(e.values()).sort((e,t)=>t.count-e.count)},[f]),b=g.length,[j,v]=e.useState(null),[y,N]=e.useState(!1);e.useEffect(()=>{n&&c&&v(c)},[n,c]);const k=e.useCallback(()=>{i(j,g)},[i,j,g]),w=e.useMemo(()=>j?f.filter(e=>e.channelHash===j):f,[f,j]),M=e.useMemo(()=>{const e=[];let t="";for(const s of w){const n=Rt(s.timestamp);n!==t&&(e.push({type:"date",date:n}),t=n),e.push({type:"message",message:s})}return e},[w]);e.useLayoutEffect(()=>{const e=d.current;e&&m.current&&(e.scrollTop=0)},[w.length]);const C=g.slice(0,19),_=g.slice(19),B=_.length>0;return t.jsx(E,{open:n,onClose:a,size:"lg",motionPlus:!0,solid:!0,children:t.jsxs(q,{className:"p-0 flex flex-col h-[80vh] max-h-[700px] rounded-2xl",children:[t.jsx("div",{className:"flex-shrink-0 px-4 sm:px-5 py-3 sm:py-4",children:t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(_e,{className:"size-5 text-icon-card-title flex-shrink-0"}),t.jsx("h2",{className:"type-micro",children:"Public Channels"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ie,{ranges:S,selectedIndex:u,onSelect:h,size:"micro"}),t.jsx("button",{onClick:a,className:"sm:hidden min-h-[44px] min-w-[44px] px-3 flex items-center justify-center text-[15px] font-medium text-sys-blue active:text-sys-blue/70 transition-base radius-inner active:bg-subtle-fill",children:"Done"}),t.jsx("button",{onClick:a,className:"hidden sm:flex items-center justify-center p-2 text-fg-muted hover:text-fg-primary transition-base radius-inner hover:bg-subtle","aria-label":"Close",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})]})}),t.jsx("div",{className:"flex-shrink-0 px-3 pb-2 relative z-10 isolate",style:{minHeight:b>0?void 0:0},children:b>0&&t.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.jsx("button",{onClick:()=>v(null),className:s("px-2 py-0.5 rounded text-xs font-medium transition-all","ring-1 ring-inset",null===j?"bg-sys-blue/20 text-sys-blue ring-sys-blue/30":"bg-subtle-fill text-fg-secondary ring-edge-subtle hover:bg-subtle-fill-strong"),children:"All"}),C.map(e=>t.jsx("button",{onClick:()=>v(e.hash),className:s("flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium transition-all","ring-1 ring-inset",j===e.hash?"bg-sys-blue/20 text-sys-blue ring-sys-blue/30":"bg-subtle-fill text-fg-secondary ring-edge-subtle hover:bg-subtle-fill-strong"),children:t.jsx("span",{className:"truncate max-w-[80px]",children:e.name})},e.hash)),B&&t.jsxs("div",{className:"relative",children:[t.jsxs("button",{onClick:()=>N(!y),className:s("flex items-center gap-0.5 px-2 py-0.5 rounded text-xs font-medium transition-all","ring-1 ring-inset",y||_.some(e=>e.hash===j)?"bg-sys-blue/20 text-sys-blue ring-sys-blue/30":"bg-subtle-fill text-fg-secondary ring-edge-subtle hover:bg-subtle-fill-strong"),children:["+",_.length,t.jsx(O,{className:s("size-3 transition-transform",y&&"rotate-180")})]}),y&&t.jsx("div",{className:s("absolute top-full left-0 mt-1 z-50","min-w-[140px] max-h-[200px] overflow-y-auto","p-1 rounded-lg","bg-elevated backdrop-blur-xl","ring-1 ring-edge-subtle shadow-xl"),children:_.map(e=>t.jsxs("button",{onClick:()=>{v(e.hash),N(!1)},className:s("w-full flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium transition-all text-left",j===e.hash?"bg-sys-blue/20 text-sys-blue":"text-fg-secondary hover:bg-subtle-fill-strong"),children:[t.jsx(Re,{className:"size-2.5 opacity-60 flex-shrink-0"}),t.jsx("span",{className:"truncate",children:e.name}),t.jsxs("span",{className:"opacity-60 ml-auto",children:["(",e.count,")"]})]},e.hash))})]})]})}),t.jsx("div",{ref:d,onScroll:p,className:s("flex-1 overflow-y-auto overflow-x-hidden","mx-3 mb-3 rounded-md","bg-body","ring-1 ring-inset ring-edge-subtle","flex flex-col-reverse"),children:r&&0===w.length?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[300px] text-fg-muted px-4 py-4",children:[t.jsx(W,{className:"size-12 mb-4 text-sys-indigo animate-spin"}),t.jsx("p",{className:"text-lg font-medium",children:"Loading messages..."})]}):0===w.length?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[300px] text-fg-muted px-4 py-4",children:[t.jsx(xe,{className:"size-16 mb-4 opacity-20"}),t.jsx("p",{className:"text-lg font-medium",children:"No messages yet"}),t.jsx("p",{className:"text-sm mt-1 opacity-70",children:j?"No messages in this channel":"Public channel messages will appear here"})]}):t.jsxs("div",{className:"px-4 py-4",children:[o&&t.jsx("div",{className:"flex justify-center mb-4",children:t.jsx("button",{onClick:k,disabled:r,className:s("px-4 py-1.5 rounded-full","text-[11px] font-medium","ring-1 ring-inset",r?"bg-subtle-fill text-fg-muted ring-edge-subtle cursor-wait":"bg-sys-blue/10 text-sys-blue ring-sys-blue/20 hover:bg-sys-blue/20 hover:ring-sys-blue/30"),children:r?t.jsxs("span",{className:"flex items-center gap-1.5",children:[t.jsx(W,{className:"size-3 animate-spin"}),"Loading..."]}):"Load older messages"})}),M.map((e,n)=>{if("date"===e.type)return t.jsx("div",{className:"flex justify-center my-4",children:t.jsx("span",{className:s("px-3.5 py-1.5 rounded-full","bg-subtle-fill backdrop-blur-sm","text-[11px] text-fg-muted/80 font-medium","ring-1 ring-edge-subtle"),children:e.date})},`date-${e.date}-${n}`);const a=`msg-${e.message.timestamp}-${e.message.senderName||"anon"}-${e.message.channelHash}`;return t.jsx("div",{className:"mb-3",children:t.jsx(Ft,{message:e.message,onChannelClick:v,isChannelSelected:j===e.message.channelHash})},a)})]})}),t.jsx("div",{className:"flex-shrink-0 px-5 py-2 text-center",children:t.jsxs("p",{className:"text-[11px] text-fg-muted",children:[w.length," messages Â· ",b," ",1===b?"channel":"channels",r&&t.jsxs("span",{className:"ml-2 text-sys-indigo",children:[t.jsx(W,{className:"inline size-3 animate-spin mr-1"}),"Decrypting..."]})]})})]})})}function At({isLoaded:n=!0}){const a=p(),[o,r]=e.useState(!1),[c,d]=e.useState(null),m=L(),u=e.useCallback(()=>{d(null),r(!0),D.getState().queueDecryption(a)},[a]),h=re(e=>e.requestedHash),x=re(e=>e.clearRequest);e.useEffect(()=>{h&&(d(h),r(!0),D.getState().queueDecryption(a),x())},[h,x,a]);const f=v(),g=F(),b=H(),j=e.useMemo(()=>function(e){const t=[],s=new Set;for(const n of e.values()){const e=n.decoded;if(!e||!e.decrypted||e.macCorrupted||!e.text)continue;const a=Dt(e.senderName,e.channelHash,e.text);s.has(a)||(s.add(a),t.push({timestamp:n.timestamp,channelName:e.channelName,channelHash:e.channelHash,senderName:e.senderName,text:e.text,rssi:n.rssi,snr:n.snr}))}return t}(f),[f]),y=e.useMemo(()=>{const e=Date.now()/1e3-60*S[m].minutes;return j.filter(t=>t.timestamp>=e)},[j,m]),N=e.useMemo(()=>0===y.length?null:y.reduce((e,t)=>t.timestamp>e.timestamp?t:e),[y]),k=g.isDecoding,w=e.useMemo(()=>{const e=Date.now()/1e3-60*S[m].minutes,t=new Set;let s=0;for(const n of a)(n.type??n.payload_type)===A.GRP_TXT&&((n.timestamp??0)<e||t.has(n.packet_hash)||(t.add(n.packet_hash),s++));return s},[a,m]),M=P(),C=e.useMemo(()=>{const e=Date.now()/1e3-60*S[m].minutes;for(const t of a)if((t.type??t.payload_type)===A.GRP_TXT&&!((t.timestamp??0)<e||M.has(t.packet_hash)))return!0;return!1},[a,M,m]),_=e.useCallback((e,t)=>{if(!k){if(e){const s=t.find(t=>t.hash===e);if(s)return void D.getState().queueChannelDecryption(a,s.name)}D.getState().queueDecryption(a)}},[a,k]);return n?t.jsxs(t.Fragment,{children:[t.jsx("div",{onClick:u,className:s("group cursor-pointer rounded-2xl transition-all duration-150","bg-surface/80 backdrop-blur-lg neomorphic-outer","hover:bg-subtle-fill","px-3 py-2.5 sm:px-4 sm:py-3"),children:t.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0",children:[t.jsx(_e,{className:"size-4 text-icon-card-title flex-shrink-0"}),t.jsx("span",{className:"type-micro",children:"CHAT ACTIVITY"}),w>0&&t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md bg-subtle-fill ring-1 ring-inset ring-edge-subtle text-sm tabular-nums text-fg-secondary",children:w}),t.jsx(Te,{className:"size-4 text-fg-muted group-hover:text-sys-indigo transition-colors ml-auto sm:hidden"})]}),t.jsxs("div",{className:"flex items-center gap-2 sm:gap-1.5 min-w-0 overflow-hidden",children:[t.jsx(l,{mode:"wait",initial:!1,children:N?t.jsxs(i.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},exit:{opacity:0,y:-16},transition:{duration:.2,ease:[.4,0,.2,1]},className:"flex items-center gap-2 sm:gap-1.5 min-w-0",children:[N.channelName&&t.jsx("span",{className:"hidden sm:inline-flex",children:t.jsx(me,{channelName:N.channelName})}),t.jsx("div",{className:"hidden sm:flex w-[30px] h-[30px] rounded-full items-center justify-center flex-shrink-0 ring-1 ring-edge-subtle",style:{backgroundColor:Me(Ce(N.senderName||"").cleanName)},children:Ce(N.senderName||"").emoji?t.jsx("span",{className:"text-base",children:Ce(N.senderName||"").emoji}):t.jsx("span",{className:"text-white text-xs font-bold tracking-tighter",children:Le(N.senderName||"")})}),t.jsx("div",{className:"inline-flex items-center px-3 py-1.5 rounded-2xl rounded-tr-md bg-[#007AFF] shadow-sm min-w-0 flex-1 sm:flex-initial sm:max-w-xs sm:-ml-px",children:t.jsx("span",{className:"text-sm text-white truncate tracking-wide",children:Se(N.text)})}),t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md bg-subtle-fill ring-1 ring-inset ring-edge-subtle text-sm tabular-nums text-fg-secondary flex-shrink-0",children:$(N.timestamp)})]},`msg-${N.timestamp}-${N.senderName}-${N.channelHash}`):b?t.jsx(i.span,{initial:{opacity:0},animate:{opacity:1},className:"text-sm text-fg-muted italic",children:"No messages yet"},"empty"):t.jsxs(i.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,y:-16},transition:{duration:.15},className:"flex items-center gap-2 sm:gap-1.5",children:[t.jsx("div",{className:"hidden sm:block w-8 h-4 rounded bg-subtle-fill-strong animate-pulse"}),t.jsx("div",{className:"hidden sm:block w-[30px] h-[30px] rounded-full bg-subtle-fill-strong animate-pulse"}),t.jsx("div",{className:"h-8 w-32 sm:w-48 rounded-2xl bg-subtle-fill-strong animate-pulse"}),t.jsx("div",{className:"w-12 h-6 rounded-md bg-subtle-fill-strong animate-pulse"})]},"skeleton")}),t.jsx(Te,{className:"size-4 text-fg-muted group-hover:text-sys-indigo transition-colors flex-shrink-0 hidden sm:block ml-1"})]})]})}),t.jsx(Ht,{open:o,onClose:()=>r(!1),messages:j,onLoadMore:_,hasMoreToLoad:C,isDecoding:k,initialChannel:c})]}):t.jsx("div",{className:"h-14 rounded-xl bg-elevated/50 animate-pulse"})}function Pt(){var s,n;const a=j(),l=G(),i=p(),o=V(),r=e.useRef(!1);o&&!r.current&&(r.current=!0);const c=r.current,d=L(),m=I(),u=U(),x=S[d],f=5===d&&!u.threeDayLoadComplete,g=6===d&&!u.sevenDayLoadComplete,b=7===d&&!u.fourteenDayLoadComplete,v=u.isBackgroundLoading&&(f||g||b),y=null==(s=null==a?void 0:a.config)?void 0:s.radio,N=e.useMemo(()=>y?{sf:y.spreading_factor??10,bw:y.bandwidth??25e4,cr:y.coding_rate??5,preamble:y.preamble_length??8}:null,[y]),k=i.length,w=e.useMemo(()=>k?J(x.minutes,x.buckets,i,a):null,[k,x.minutes,x.buckets,N]),M=e.useMemo(()=>{const e=e=>(null==e?void 0:e.reduce((e,t)=>e+t.count,0))??0,t=e(null==w?void 0:w.received),s=e(null==w?void 0:w.unique_received),n=e(null==w?void 0:w.forwarded),a=e(null==w?void 0:w.dropped),l=e(null==w?void 0:w.transmitted),i=((null==w?void 0:w.time_range_minutes)??x.minutes)/60;return{received:t,uniqueReceived:s,forwarded:n,dropped:a,transmitted:l,rxPerHour:i>0?Math.round(t/i):0,fwdPerHour:i>0?Math.round(n/i):0}},[w,x.minutes]),C=e.useMemo(()=>{if(!i.length)return{totalBytes:0,kbPerHour:0};const e=Date.now()/1e3,t=e-60*x.minutes;let s=0;for(const a of i)a.transmitted||a.timestamp<t||a.timestamp>e||(s+=a.length??a.payload_length??0);const n=x.minutes/60;return{totalBytes:s,kbPerHour:n>0?Math.round(s/1024/n):0}},[i,x.minutes]),_=(null==a?void 0:a.node_name)??(null==(n=null==a?void 0:a.config)?void 0:n.node_name)??"Unknown Node";return e.useEffect(()=>{_&&"Unknown Node"!==_&&(document.title=`pyMC: ${_}`)},[_]),l?t.jsxs(Y,{neomorphic:!0,className:"p-8 text-center",children:[t.jsx("p",{className:"type-subheading text-sys-red mb-2",children:"Failed to connect to backend"}),t.jsx("p",{className:"type-body text-fg-muted",children:l}),t.jsx("p",{className:"type-data-sm text-fg-muted mt-4",children:"Make sure the backend is running on port 8000"})]}):t.jsxs(Z,{children:[t.jsx(ee,{title:_,icon:t.jsx(De,{}),controls:t.jsx(ie,{ranges:S,selectedIndex:d,onSelect:m,isPending:v})}),t.jsxs(te,{children:[t.jsx(At,{isLoaded:c}),t.jsx(Fe,{template:"hero-auto",children:t.jsxs(Y,{neomorphic:!0,compact:!0,children:[t.jsx(pe,{icon:t.jsx(K,{}),title:"PACKETS RECEIVED",badge:x.label,badgeColor:"zinc",actions:c?t.jsxs("div",{className:"data-box",children:[C.kbPerHour," KB/hr"]}):t.jsx("div",{className:"data-box opacity-0",children:"0 KB/hr"})}),t.jsxs("div",{className:"flex flex-wrap gap-4 sm:gap-8",children:[t.jsxs("div",{className:"flex items-end gap-2",children:[t.jsx("div",{className:"type-data-xl text-fg-primary",children:c?t.jsx(ae,{value:M.received,className:"font-mono tabular-nums",priority:"high"}):t.jsx("span",{className:"opacity-30",children:"â€”"})}),t.jsx(h,{color:"zinc",className:"mb-0.5 sm:mb-1",children:"Total Rx"})]}),t.jsxs("div",{className:"flex items-end gap-2",children:[t.jsx("div",{className:"type-data-xl text-fg-primary",children:c?t.jsx(ae,{value:M.uniqueReceived,className:"font-mono tabular-nums",priority:"high"}):t.jsx("span",{className:"opacity-30",children:"â€”"})}),t.jsx(h,{color:"zinc",className:"mb-0.5 sm:mb-1",children:"Unique"})]})]}),t.jsxs("div",{className:"mt-2 flex-1 min-h-0 relative",children:[t.jsx("div",{className:"absolute inset-0 flex items-end gap-1 transition-opacity duration-300 "+(c?"opacity-0 pointer-events-none":"opacity-100"),"aria-hidden":c,children:[45,72,33,58,80,42,65,28,55,75,38,62].map((e,s)=>t.jsx("div",{className:"flex-1 bg-subtle-fill rounded-sm animate-pulse",style:{height:`${e}%`}},s))}),t.jsx("div",{className:"h-full transition-opacity duration-300 "+(c?"opacity-100":"opacity-0"),children:t.jsx(Oe,{packets:i,rangeMinutes:x.minutes,bucketCount:x.buckets})})]})]})}),t.jsxs(Fe,{template:"compact",children:[t.jsx(He,{span:6,lg:4,children:t.jsx(Ge,{value:M.forwarded,receivedCount:M.received,packets:i,rangeMinutes:x.minutes,bucketCount:x.buckets,timeRangeLabel:x.label,icon:t.jsx(Ae,{className:"w-4 h-4"}),isLoaded:c})}),t.jsx(He,{span:6,lg:4,children:t.jsx(Ve,{value:M.dropped,receivedCount:M.received,packets:i,rangeMinutes:x.minutes,bucketCount:x.buckets,timeRangeLabel:x.label,icon:t.jsx(je,{className:"w-4 h-4"}),isLoaded:c})}),t.jsx(He,{span:12,lg:4,children:t.jsx(Ze,{stats:a,receivedBuckets:null==w?void 0:w.received,droppedBuckets:null==w?void 0:w.dropped,forwardedBuckets:null==w?void 0:w.forwarded,bucketDurationSeconds:null==w?void 0:w.bucket_duration_seconds,timeRangeLabel:x.label,isLoaded:c})})]}),t.jsx(St,{isLoaded:c}),t.jsx(et,{}),a&&t.jsx(Fe,{template:"auto",children:t.jsx(we,{nodeName:_,repeaterVersion:a.version,coreVersion:a.core_version,localHash:a.local_hash,publicKey:a.public_key})})]})]})}export{Pt as default};
