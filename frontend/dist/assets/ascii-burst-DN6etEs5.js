const wt="\x1B[0m",s="\x1B[1m",et="\x1B[2m";function x(o,t,h){return`\x1B[38;2;${o};${t};${h}m`}const at="   . ˙',·∙⁺˚°:;~*+✧✩×✴░✦✶✳oO▒#%&xX▓@MW8B█████",it="✦✶✳✧✴✩×";function Rt(o,t=.08){const h=o+(Math.random()-.5)*t*2,n=Math.max(0,Math.min(.999,h));return at[Math.floor(n*at.length)]}function lt(){return it[Math.floor(Math.random()*it.length)]}const C=[[6,4,28],[14,10,60],[30,24,105],[50,45,160],[72,70,200],[91,91,214],[150,150,245]];function k(o){const h=Math.max(0,Math.min(1,o))*(C.length-1),n=Math.floor(h),A=Math.min(n+1,C.length-1),T=h-n;return x(Math.round(C[n][0]+(C[A][0]-C[n][0])*T),Math.round(C[n][1]+(C[A][1]-C[n][1])*T),Math.round(C[n][2]+(C[A][2]-C[n][2])*T))}const B=x(0,240,255),j=x(255,50,180),K=x(255,252,255),_t=x(80,255,180),ht=x(255,180,120),P="\x1B[38;2;91;91;214m";function mt(o){return 1-Math.pow(1-o,3)}function Nt(o){return o*.3+o*o*o*.7}const Lt=80,R=14,b=12,yt=1,Dt=R+b+yt;function Ft(o){var N;const t=o.length,h=Math.max(...o.map(f=>f.length)),n=t/2,A=h/2,T=new Float32Array(t*h);let F=0;for(let f=0;f<t;f++)for(let _=0;_<h;_++){const O=f-n,g=(_-A)*.5,L=Math.sqrt(O*O+g*g);T[f*h+_]=L,(((N=o[f])==null?void 0:N[_])??" ")!==" "&&L>F&&(F=L)}return{dist:T,maxDist:F,cols:h,rows:t}}let V=null,W=null;function Bt(){V=null,W=null}function Pt(o,t){W!==o&&(V=Ft(o),W=o);const{dist:h,maxDist:n,cols:A,rows:T}=V,F=t<R,N=t>=R&&t<R+b,f=t>=R+b,_=Math.min(1,t/R),O=N?Math.min(1,(t-R)/Math.max(1,b-1)):f?1:0,g=N||f?n*(1-Nt(O)):mt(_)*n,L=g*.72,X=g*.45,v=F?-.6:.9,Y=[],rt=T/2,Mt=A/2,U=5,$=R,q=19,z=t>=U&&t<=q,J=z?t<=$?(t-U)/($-U):1-(t-$)/(q-$):0,ut=Math.sin(t*3.4)*.28+Math.sin(t*5.9)*.24+Math.sin(t*9.7)*.18+Math.sin(t*14.3)*.12,Q=Math.max(.12,.55+ut*.55),Z=Math.sin(t*.85),dt=.5+.5*Z,ft=.5-.5*Z,H=(.3+2.7*dt)*Math.max(0,J)*Q,tt=(.5+3.5*ft)*Math.max(0,J)*Q;for(let w=0;w<T;w++){const nt=o[w]||"";let c="",i="";for(let S=0;S<A;S++){const I=S<nt.length?nt[S]:" ",Et=I===" ",E=h[w*A+S];if(z&&(H>.2||tt>.3)){const M=Math.abs(w-rt),D=Math.abs(S-Mt);if(M<H&&D<tt){const e=Math.sin(t*5.3+w*7+S*11)*.5+.5,u=M<.6&&D<1,a=u&&H>.8?"█":u||e>.6?"✦":e>.3?"✶":"✴",d=a==="█"?K+s:u||a==="✦"?(e>.5?K:B)+s:(e>.65?B:P)+s;d!==i&&(c+=d,i=d),c+=a;continue}}if(Et){c+=" ",i="";continue}if(f){const M=P+s;M!==i&&(c+=M,i=M),c+=I}else if(N&&E>g){const M=E-g;if(M<n*.2){const e=1-M/(n*.2),u=Math.random();let a;if(e>.85){const d=(e-.85)/.15;a=x(Math.round(190+65*d),Math.round(210+42*d),255)+s}else if(e>.6)if(u<.1)a=B+s;else if(u<.16)a=j+s;else{const d=(e-.6)/.25;a=x(Math.round(120+70*d),Math.round(150+60*d),255)+s}else a=k(.7+e*.3)+s;a!==i&&(c+=a,i=a)}else if(Math.random()<.008){const e=ht;e!==i&&(c+=e,i=e)}else P!==i&&(c+=P,i=P);c+=I}else if(E>g)c+=" ",i="";else{const M=g-E,D=Math.exp(-M/(n*.22)),e=Math.max(0,1-M/(n*.55)),u=D*.7+e*.3,a=Math.max(0,1-Math.abs(E-L)/(n*.18)),d=Math.max(0,1-Math.abs(E-X)/(n*.22)),G=Math.sin(S*.3)*.8,Ct=Math.sin(w*.4+S*.15)*.5,ot=Math.sin(E*3+t*v+G)*.5+.5,xt=Math.sin(E*6.5+t*v*1.8+G*.5+Ct)*.5+.5,At=Math.sin(E*1.3-t*v*.35+G*1.5+w*.08)*.5+.5,st=ot*ot*.5+xt*.28+At*.22,ct=t<2&&E<n*.35?.7*(1-E/(n*.35)):0,Tt=u*.52,gt=(.3+(1-u)*.7)*st*.32,St=a*.18+d*.1,p=Math.min(1,Tt+gt+St+ct);if(p<.025)c+=" ",i="";else{const y=Math.max(u,a*.65,d*.45),pt=p*.8+u*.2,m=Math.random();let l;if(ct>.2)m<.35?l=K+s:m<.55?l=j+s:m<.7?l=B+s:l=k(.95)+s;else if(y>.8)if(m<.08)l=j+s;else if(m<.14)l=B+s;else{const r=(y-.8)/.2;l=x(Math.round(190+65*r),Math.round(210+42*r),255)+s}else if(y>.55)if(m<.05)l=_t+s;else{const r=(y-.55)/.25;l=x(Math.round(110+80*r),Math.round(140+70*r),Math.round(245+10*r))+s}else if(y>.32){const r=(y-.32)/.23;l=x(Math.round(91+19*r),Math.round(91+49*r),Math.round(214+31*r))+(r>.5?s:"")}else p<.12&&st>.65&&m<.08?l=ht+et:l=k(pt)+(p>.4?s:p<.12?et:"");if(l!==i&&(c+=l,i=l),p>.82&&u>.7)c+=lt();else if(p>.7&&a>.5&&Math.random()<.2)c+=lt();else{const r=.02+(1-p)*.05;c+=Rt(p,r)}}}}Y.push(c+wt)}return Y}export{Lt as B,Dt as T,Pt as g,Bt as r};
