import{r as e,j as t,ah as s,bd as a,ar as n,aj as r,aP as l,ad as c,be as i,bf as o,aB as m,p as x,an as d}from"./vendor-react-BXhrzaGn.js";import{c as u,R as p,A as h,C as j,X as f,Y as g,T as y,b}from"./recharts-CnLSZmAf.js";import{af as v,ag as N,ah as w,ai as k,S as _,aj as C,ak as M,F as S}from"./index-BnwqqupC.js";import{a as F,b as T}from"./useThemeColors-DrOzcAOp.js";import{P as B,b as R,a as L}from"./PageLayout-CkP0WgKw.js";import{R as P,C as $}from"./Grid-BzkaU71a.js";import{C as A}from"./Card-BIJYdycY.js";import"./vendor-core-WoOfkQwm.js";import"./deckgl-DTsmDcfs.js";const U=_.hero,D=_.hero,E={warning:80,danger:95},G={warning:85,danger:95},K={warning:70,danger:85},O=[{threshold:30,color:"var(--accent-tertiary)"},{threshold:50,color:"var(--accent-primary)"},{threshold:65,color:"var(--accent-secondary)"},{threshold:80,color:"var(--signal-poor)"}];function W(e,t,s){const a=s-t,n={cold:(30-t)/a*100,normal:(50-t)/a*100,warm:(65-t)/a*100,hot:(80-t)/a*100};return`linear-gradient(to right, ${[{pos:0,color:"var(--accent-tertiary)"},{pos:n.cold,color:"var(--accent-tertiary)"},{pos:n.cold,color:"var(--accent-primary)"},{pos:n.normal,color:"var(--accent-primary)"},{pos:n.normal,color:"var(--accent-secondary)"},{pos:n.warm,color:"var(--accent-secondary)"},{pos:n.warm,color:"var(--signal-poor)"},{pos:n.hot,color:"var(--signal-poor)"},{pos:n.hot,color:"var(--accent-danger)"},{pos:100,color:"var(--accent-danger)"}].map(t=>{const s=e>0?t.pos/e*100:0;return`${t.color} ${Math.min(s,100)}%`}).join(", ")})`}function I(e,t){return e>=t.danger?"danger":e>=t.warning?"warning":"none"}function X(e){let t="none";for(const s of Object.values(e)){const e=I(s,K);if("danger"===e)return"danger";"warning"===e&&(t="warning")}return t}function z(e){let t,s,a;return e>=1073741824?(t=e/1073741824,s="GB/s"):e>=1048576?(t=e/1048576,s="MB/s"):e>=1024?(t=e/1024,s="KB/s"):(t=e,s="B/s"),a=t>=100?t.toFixed(0):t.toFixed(1),`${a} ${s}`}function H(e){return e>=1073741824?{value:(e/1073741824).toFixed(1),unit:"GiB"}:e>=1048576?{value:(e/1048576).toFixed(1),unit:"MiB"}:e>=1024?{value:(e/1024).toFixed(1),unit:"KiB"}:{value:String(e),unit:"B"}}const Y=e.memo(function({level:e}){return"none"===e?null:t.jsxs("span",{className:u("inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs font-medium","danger"===e&&"bg-accent-danger/20 text-accent-danger","warning"===e&&"bg-accent-secondary/20 text-accent-secondary"),children:[t.jsx(d,{className:"w-3 h-3"}),"danger"===e?"High":"Warn"]})}),q=e.memo(function({data:e,color:s,flipped:a=!1,fixedSlots:n}){const r=[...Array(Math.max(0,n-e.length)).fill(0),...e.slice(-n)],l=Math.max(...r,1),c=r.map(e=>0===e?0:Math.max(e/l*100,3));return t.jsx("div",{className:"w-full h-full flex items-end",style:{transform:a?"scaleY(-1)":void 0},children:c.map((e,a)=>t.jsx("div",{className:"flex-1 min-w-0",style:{height:e>0?`${e}%`:"0%",backgroundColor:e>0?s:"transparent"}},a))})}),J=e.memo(function({value:e,max:s=100,width:a=10,color:n="primary"}){const r=Math.min(e/s,1),l=Math.round(r*a),c=a-l,i="■".repeat(l),o="·".repeat(c),m={primary:"text-accent-primary",secondary:"text-accent-secondary",success:"text-accent-success",danger:"text-accent-danger"}[n];return t.jsxs("span",{className:"font-mono text-[10px] tracking-tight",children:[t.jsx("span",{className:m,children:i}),t.jsx("span",{className:"text-text-muted/40",children:o})]})}),Q=e.memo(function({index:e,usage:s}){const a=s>90?"danger":s>70?"secondary":"primary";return t.jsxs("div",{className:"flex items-center gap-1 text-xs font-mono",children:[t.jsxs("span",{className:"text-text-muted w-5",children:["C",e]}),t.jsx(J,{value:s,width:8,color:a}),t.jsxs("span",{className:u("w-7 text-right tabular-nums",s>90?"text-accent-danger":s>70?"text-accent-secondary":"text-accent-success"),children:[s.toFixed(0),"%"]})]})}),V=e.memo(function({pid:e,name:s,cpu:a,mem:n,isTopCpu:r=!1,isTopMem:l=!1}){return t.jsxs("div",{className:"flex items-center gap-2 py-1 text-sm font-mono hover:bg-subtle-fill -mx-1 px-1 rounded",children:[t.jsx("span",{className:"text-text-muted w-14 tabular-nums",children:e}),t.jsx("span",{className:"flex-1 truncate text-text-primary",children:s}),t.jsx(J,{value:a,max:100,width:6,color:a>50?"danger":a>20?"secondary":"success"}),t.jsx("span",{className:u("w-12 text-right tabular-nums",r?"text-text-primary":a>50?"text-accent-danger":a>20?"text-accent-secondary":"text-text-muted"),children:a.toFixed(1)}),t.jsx("span",{className:u("w-12 text-right tabular-nums",l?"text-text-primary":n>50?"text-accent-danger":n>20?"text-accent-secondary":"text-text-muted"),children:n.toFixed(1)})]})}),Z=e.memo(function({value:e,label:s,min:a=20,max:n=100}){const r=Math.min(Math.max((e-a)/(n-a)*100,0),100),l=function(e){return e<30?{text:"Cool",color:"text-accent-tertiary"}:e<50?{text:"Normal",color:"text-accent-primary"}:e<65?{text:"Warm",color:"text-accent-secondary"}:e<80?{text:"Hot",color:"text-signal-poor"}:{text:"Danger",color:"text-accent-danger"}}(e),c=n-a;return t.jsxs("div",{className:"space-y-1.5",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm font-mono text-text-muted",children:s}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-mono text-text-muted",children:l.text}),t.jsxs("span",{className:"px-1.5 py-0.5 bg-subtle-fill-strong rounded text-sm font-mono tabular-nums",children:[t.jsx("span",{className:l.color,children:e.toFixed(1)}),t.jsx("span",{className:"text-text-primary",children:"°C"})]})]})]}),t.jsxs("div",{className:"relative h-3 bg-subtle-fill overflow-hidden",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 transition-all duration-300 ease-out",style:{background:W(r,a,n),width:`${r}%`}}),t.jsx("div",{className:"absolute inset-0 flex items-center pointer-events-none",children:O.map(({threshold:e,color:s})=>{const n=(e-a)/c*100;return n<0||n>100?null:t.jsx("div",{className:"absolute w-px h-full",style:{left:`${n}%`,backgroundColor:s}},e)})})]})]})});function ee({active:e,payload:s,label:a}){return e&&(null==s?void 0:s.length)?t.jsxs("div",{className:"bg-tooltip-bg border border-border-subtle rounded-lg px-3 py-2 text-sm shadow-xl",children:[t.jsx("div",{className:"font-medium text-text-primary mb-1",children:a}),s.map((e,s)=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),t.jsxs("span",{className:"text-text-muted",children:[e.name,":"]}),t.jsxs("span",{className:"text-text-primary tabular-nums",children:[e.value.toFixed(1),"%"]})]},s))]}):null}const te=e.memo(function({data:e,cpuColor:s,memoryColor:a,chartGridColors:n}){const r=function(e){const t=[],s=Math.max(0,U-e.length),a=Date.now(),n=C.system;for(let l=0;l<s;l++){const e=new Date(a-(U-l)*n).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1});t.push({slot:l,time:e,cpu:null,memory:null})}const r=e.slice(-U);for(let l=0;l<r.length;l++){const e=r[l];t.push({slot:s+l,time:e.time.slice(0,5),cpu:e.cpu,memory:e.memory})}return t}(e),l=Math.floor(U/4);return 0===e.length?t.jsx("div",{className:"h-[240px] flex items-center justify-center text-text-muted",children:"Collecting data..."}):t.jsx("div",{className:"h-[240px]",children:t.jsx(p,{width:"100%",height:"100%",children:t.jsxs(h,{data:r,margin:{top:4,right:8,bottom:0,left:0},children:[t.jsx(j,{strokeDasharray:"3 3",stroke:n.grid,vertical:!1}),t.jsx(f,{dataKey:"time",axisLine:!1,tickLine:!1,tick:{fill:n.axisTick,fontSize:10,fontFamily:S},dy:8,interval:l}),t.jsx(g,{domain:[0,100],axisLine:!1,tickLine:!1,tick:{fill:n.axisTick,fontSize:10},dx:-4,width:40,tickFormatter:e=>`${e}%`}),t.jsx(y,{content:t.jsx(ee,{})}),t.jsx(b,{type:"stepAfter",dataKey:"cpu",name:"CPU",stroke:"none",fill:s,fillOpacity:1,isAnimationActive:!1,connectNulls:!1}),t.jsx(b,{type:"stepAfter",dataKey:"memory",name:"Memory",stroke:a,strokeWidth:2.5,fill:"none",isAnimationActive:!1,connectNulls:!1})]})})})});function se(){var d;const[p,h]=e.useState(null),[j,f]=e.useState([]),[g,y]=e.useState(!0),[b,S]=e.useState(null),[K,O]=e.useState(!1),[W,J]=e.useState(!1),[ee,se]=e.useState([]),[ae,ne]=e.useState(0),[re,le]=e.useState(0),ce=e.useRef(null),ie=v(),oe=N(),me=F(),xe=T(),de=xe.primary,ue=xe.tertiary,pe=function(){const[t,s]=e.useState("undefined"!=typeof window&&window.matchMedia("(max-width: 767px)").matches);return e.useEffect(()=>{const e=window.matchMedia("(max-width: 767px)");s(e.matches);const t=e=>s(e.matches);return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[]),t?_.hero:40}(),he=e.useCallback(async()=>{var e;try{const[t,s]=await Promise.all([w(),k()]);if(t.success&&t.data){const e=t.data;h(e),S(null),oe(e.cpu.usage_percent,e.memory.usage_percent,U);const s=Date.now(),a={timestamp:s,bytesRecv:e.network.bytes_recv,bytesSent:e.network.bytes_sent};if(ce.current){const e=(s-ce.current.timestamp)/1e3;if(e>0){const t=(a.bytesRecv-ce.current.bytesRecv)/e,s=(a.bytesSent-ce.current.bytesSent)/e;t>=0&&s>=0&&(ne(t),le(s))}}ce.current=a,se(e=>[...e,a].slice(-D))}else S(t.error??"Failed to fetch hardware stats");s.success&&(null==(e=s.data)?void 0:e.processes)&&f(s.data.processes)}catch(t){S(t instanceof Error?t.message:"Failed to fetch hardware stats")}},[oe]);return e.useEffect(()=>{let e=!0,t=null;if((async()=>{e&&(await he(),e&&y(!1))})(),"undefined"==typeof Worker){const t=setInterval(he,C.system);return()=>{e=!1,clearInterval(t)}}{const s=`setInterval(() => postMessage('tick'), ${C.system});`,a=new Blob([s],{type:"application/javascript"});t=new Worker(URL.createObjectURL(a)),t.onmessage=()=>{e&&he()}}return()=>{e=!1,null==t||t.terminate()}},[he]),t.jsxs(B,{children:[t.jsx(R,{title:"System Stats",icon:t.jsx(a,{}),controls:t.jsxs("button",{onClick:async()=>{O(!0),await he(),O(!1)},disabled:K,className:"flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-bg-subtle hover:bg-bg-elevated rounded-lg transition-colors text-sm text-text-muted hover:text-text-primary self-start sm:self-auto",children:[t.jsx(s,{className:u("w-4 h-4",K&&"animate-spin")}),"Refresh"]})}),b&&t.jsx(L,{className:"border border-accent-danger/50 bg-accent-danger/10",children:t.jsx("p",{className:"text-accent-danger",children:b})}),g?t.jsx(L,{className:"p-12 text-center",children:t.jsx("div",{className:"animate-pulse text-text-muted",children:"Loading system stats..."})}):p?t.jsxs(t.Fragment,{children:[t.jsx(P,{template:"hero",children:t.jsxs(L,{children:[t.jsx(A,{icon:t.jsx(n,{}),title:"System Resources",largeTitle:!0,actions:t.jsxs("div",{className:"flex items-center gap-4",children:[(null==(d=p.system)?void 0:d.uptime)&&t.jsx("span",{className:"px-2 py-0.5 bg-white/[0.04] rounded text-sm font-mono tabular-nums text-text-primary",children:M(p.system.uptime)}),t.jsx(Y,{level:I(p.cpu.usage_percent,E)}),t.jsx(Y,{level:I(p.memory.usage_percent,G)}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-mono text-text-muted",children:"CPU"}),t.jsxs("span",{className:"text-base font-mono font-semibold tabular-nums",style:{color:de},children:[p.cpu.usage_percent.toFixed(0),"%"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-mono text-text-muted",children:"MEM"}),t.jsxs("span",{className:"text-base font-mono font-semibold tabular-nums",style:{color:ue},children:[p.memory.usage_percent.toFixed(0),"%"]})]})]})}),t.jsx("div",{className:"flex-1 min-h-0 mt-2",children:t.jsx(te,{data:ie,cpuColor:de,memoryColor:ue,chartGridColors:me})}),p.cpu.per_core_percent&&p.cpu.per_core_percent.length>0&&t.jsx("div",{className:"mt-3 pt-3 border-t border-border-subtle",children:t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-8 gap-x-3 gap-y-0.5",children:p.cpu.per_core_percent.map((e,s)=>t.jsx(Q,{index:s,usage:e},s))})})]})}),t.jsxs(P,{template:"compact",children:[t.jsx($,{span:12,md:6,children:t.jsxs(L,{className:"flex flex-col",children:[t.jsx(A,{icon:t.jsx(l,{}),title:"Network",largeTitle:!0,actions:t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(r,{className:"w-3.5 h-3.5",style:{color:ue}}),t.jsx("span",{className:"text-xs font-mono",style:{color:ue},children:"TX"}),t.jsx("span",{className:"px-2 py-1 bg-subtle-fill-strong rounded text-sm font-mono tabular-nums text-text-primary",children:z(re)})]})}),t.jsxs("div",{className:"flex-1 flex flex-col min-h-[80px]",children:[t.jsx("div",{className:"flex-1 min-h-[40px]",children:t.jsx(q,{data:ee.map((e,t,s)=>{if(0===t)return 0;const a=(e.timestamp-s[t-1].timestamp)/1e3;return a>0?(e.bytesSent-s[t-1].bytesSent)/a:0}),color:ue,fixedSlots:pe})}),t.jsx("div",{className:"flex-1 min-h-[40px]",children:t.jsx(q,{data:ee.map((e,t,s)=>{if(0===t)return 0;const a=(e.timestamp-s[t-1].timestamp)/1e3;return a>0?(e.bytesRecv-s[t-1].bytesRecv)/a:0}),color:de,flipped:!0,fixedSlots:pe})})]}),t.jsxs("div",{className:"pt-2 flex justify-between items-center text-sm font-mono",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-text-muted",children:"Total"}),t.jsxs("span",{className:"px-2 py-1 bg-subtle-fill-strong rounded tabular-nums",children:[t.jsx("span",{className:"text-accent-tertiary",children:H(p.network.bytes_sent).value})," ",t.jsx("span",{className:"text-text-muted",children:H(p.network.bytes_sent).unit})]}),t.jsxs("span",{className:"px-2 py-1 bg-subtle-fill-strong rounded tabular-nums",children:[t.jsx("span",{className:"text-accent-primary",children:H(p.network.bytes_recv).value})," ",t.jsx("span",{className:"text-text-muted",children:H(p.network.bytes_recv).unit})]})]}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(c,{className:"w-3.5 h-3.5",style:{color:de}}),t.jsx("span",{className:"text-xs font-mono",style:{color:de},children:"RX"}),t.jsx("span",{className:"px-2 py-1 bg-subtle-fill-strong rounded tabular-nums text-text-primary",children:z(ae)})]})]})]})}),t.jsx($,{span:12,md:6,children:t.jsxs(L,{className:"flex flex-col",children:[t.jsx(A,{icon:t.jsx(i,{}),title:"Temperature",largeTitle:!0,actions:p.temperatures&&t.jsx(Y,{level:X(p.temperatures)})}),t.jsx("div",{className:"flex-1 flex flex-col justify-center min-h-0",children:p.temperatures&&Object.keys(p.temperatures).length>0?t.jsxs("div",{className:"space-y-3",children:[void 0!==p.temperatures.cpu_thermal&&t.jsx(Z,{value:p.temperatures.cpu_thermal,label:"CPU",min:20,max:100}),Object.entries(p.temperatures).filter(([e])=>"cpu_thermal"!==e).slice(0,2).map(([e,s])=>t.jsx(Z,{value:s,label:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),min:20,max:100},e))]}):t.jsxs("div",{className:"flex items-center justify-center text-text-muted text-sm",children:[t.jsx(n,{className:"w-4 h-4 mr-2"}),"No sensors"]})})]})})]}),t.jsxs(P,{template:"compact",children:[t.jsx($,{span:6,children:t.jsxs(L,{className:"flex flex-col",children:[t.jsx(A,{icon:t.jsx(n,{}),title:"Memory",largeTitle:!0,actions:t.jsxs("span",{className:"px-2 py-0.5 bg-subtle-fill-strong rounded text-base font-mono tabular-nums",style:{color:ue},children:[p.memory.usage_percent.toFixed(0),"%"]})}),t.jsxs("div",{className:"flex-1 flex flex-col justify-center min-h-0",children:[t.jsxs("div",{className:"flex gap-1 h-12",children:[t.jsx("div",{className:"h-full transition-all duration-300 bg-accent-primary",style:{width:`${p.memory.usage_percent}%`}}),t.jsx("div",{className:"h-full transition-all duration-300 bg-accent-tertiary",style:{width:100-p.memory.usage_percent+"%"}})]}),t.jsxs("div",{className:"flex items-center justify-between text-xs font-mono pt-2",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-accent-primary"}),t.jsx("span",{className:"text-text-muted",children:"Used"}),t.jsxs("span",{className:"px-1.5 py-0.5 bg-subtle-fill-strong rounded tabular-nums text-text-primary",children:[(p.memory.used/1048576).toFixed(0)," MB"]})]}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-accent-tertiary"}),t.jsx("span",{className:"text-text-muted",children:"Avail"}),t.jsxs("span",{className:"px-1.5 py-0.5 bg-subtle-fill-strong rounded tabular-nums text-text-muted",children:[(p.memory.available/1048576).toFixed(0)," MB"]})]})]})]})]})}),t.jsx($,{span:6,children:t.jsxs(L,{className:"flex flex-col",children:[t.jsx(A,{icon:t.jsx(o,{}),title:"Disk",largeTitle:!0,actions:t.jsxs("span",{className:"px-2 py-0.5 bg-subtle-fill-strong rounded text-base font-mono tabular-nums",style:{color:de},children:[p.disk.usage_percent.toFixed(0),"%"]})}),t.jsxs("div",{className:"flex-1 flex flex-col justify-center min-h-0",children:[t.jsxs("div",{className:"flex gap-1 h-12",children:[t.jsx("div",{className:"h-full transition-all duration-300 bg-accent-primary",style:{width:`${p.disk.usage_percent}%`}}),t.jsx("div",{className:"h-full transition-all duration-300 bg-accent-tertiary",style:{width:100-p.disk.usage_percent+"%"}})]}),t.jsxs("div",{className:"flex items-center justify-between text-xs font-mono pt-2",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-accent-primary"}),t.jsx("span",{className:"text-text-muted",children:"Used"}),t.jsxs("span",{className:"px-1.5 py-0.5 bg-subtle-fill-strong rounded tabular-nums text-text-primary",children:[(p.disk.used/1073741824).toFixed(1)," GB"]})]}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-accent-tertiary"}),t.jsx("span",{className:"text-text-muted",children:"Free"}),t.jsxs("span",{className:"px-1.5 py-0.5 bg-subtle-fill-strong rounded tabular-nums text-text-muted",children:[(p.disk.free/1073741824).toFixed(1)," GB"]})]})]})]})]})})]}),j.length>0&&t.jsx(P,{template:"auto",children:t.jsx(L,{noPadding:!0,children:t.jsxs("div",{className:"px-4 py-3",children:[t.jsx(A,{icon:t.jsx(n,{}),title:"Processes",largeTitle:!0,actions:t.jsxs("button",{onClick:()=>J(!W),className:"text-xs text-text-muted hover:text-text-primary flex items-center gap-1",children:[W?"Less":"More",W?t.jsx(m,{className:"w-3 h-3"}):t.jsx(x,{className:"w-3 h-3"})]})}),t.jsxs("div",{className:"flex items-center gap-2 py-1.5 text-sm text-text-muted border-b border-border-subtle font-mono",children:[t.jsx("span",{className:"w-14",children:"PID"}),t.jsx("span",{className:"flex-1",children:"Program"}),t.jsx("span",{className:"w-[52px]"}),t.jsx("span",{className:"w-12 text-right",children:"CPU%"}),t.jsx("span",{className:"w-12 text-right",children:"MEM%"})]}),(()=>{const e=j.slice(0,W?10:5),s=Math.max(...e.map(e=>e.cpu_percent)),a=Math.max(...e.map(e=>e.memory_percent));return e.map(e=>t.jsx(V,{pid:e.pid,name:e.name,cpu:e.cpu_percent,mem:e.memory_percent,isTopCpu:e.cpu_percent===s&&s>0,isTopMem:e.memory_percent===a&&a>0},e.pid))})()]})})})]}):null]})}export{se as default};
