import{j as e,r as t,T as s,y as n,z as a,A as l,p as r,D as i,g as o,E as c,x as d,H as u,I as m,J as h,K as x,O as p,Q as f,Z as g,U as v,V as j,W as b,Y as N,o as y}from"./vendor-react-O8XH9yVn.js";import{u as w,a as k,b as M,c as _,d as L,e as S,f as C,h as R,j as T,T as B,k as F,m as A,n as I,D as P,o as D}from"./index-Dp0UlTio.js";import{u as $,a as E}from"./useThemeColors-CD0TSU03.js";import{C as H,S as W,a as z,P as O,b as G,c as K}from"./PageLayout-DE5PEtD2.js";import{P as J,a as V,b as U,g as q}from"./PacketDetailModal-CR1FHEH5.js";import{T as X}from"./TimeRangeSelector-9pGCd7oa.js";import{H as Q}from"./HashBadge-aS_UIcg2.js";import{s as Y}from"./SignalIndicator-BVAbF7xm.js";import{R as Z,L as ee,a as te,A as se,C as ne,X as ae,Y as le,T as re,b as ie}from"./recharts-BU7auunF.js";import{c as oe}from"./link-scoring-DacI-LFP.js";import{R as ce}from"./Grid-CIZAny_R.js";import"./vendor-core-WoOfkQwm.js";import"./deckgl-DTsmDcfs.js";const de={received:{barBase:"var(--metric-received)"},forwarded:{barBase:"var(--metric-forwarded)"},transmitted:{barBase:"var(--metric-transmitted)"},dropped:{barBase:"var(--metric-dropped)"},neutral:{barBase:"var(--metric-neutral)"}},ue={sm:"card-sm",md:"card-md",lg:"card-lg",hero:"card-hero",auto:""};function me({buckets:s,colorType:n,height:a=64}){const l=de[n].barBase,r=t.useMemo(()=>{if(!(null==s?void 0:s.length))return[];const e=s.length/60,t=e<=1?s:Array.from({length:60},(t,n)=>{var a,l;const r=s.slice(Math.floor(n*e),Math.floor((n+1)*e)),i=r.reduce((e,t)=>e+t.count,0),o=r.length?r.reduce((e,t)=>e+t.avg_snr,0)/r.length:0;return{bucket:n,start:(null==(a=r[0])?void 0:a.start)??0,end:(null==(l=r.at(-1))?void 0:l.end)??0,count:i,airtime_ms:r.reduce((e,t)=>e+t.airtime_ms,0),avg_snr:o,avg_rssi:0}}),n=Math.max(...t.map(e=>e.count),1);return t.map(e=>({height:e.count>0?Math.max(e.count/n*100,8):0,color:e.count>0?l:"transparent",count:e.count,snr:e.avg_snr}))},[s,l]);return(null==s?void 0:s.length)?e.jsx("div",{className:"w-full flex items-end gap-[1px]",style:{height:a},children:r.map((t,s)=>{var n;return e.jsx("div",{className:"flex-1 rounded-t-sm",style:{height:`${t.height}%`,backgroundColor:t.color,opacity:t.count>0?.8:.1,minHeight:t.count>0?"4px":"2px",maxWidth:"4px"},title:t.count>0?`${t.count} packets, SNR: ${null==(n=t.snr)?void 0:n.toFixed(1)}dB`:"No packets"},s)})}):e.jsx("div",{className:"w-full flex items-end justify-center gap-[2px] opacity-20",style:{height:a},children:e.jsx("span",{className:"type-data-xs text-text-muted",children:"No data"})})}function he({title:t,value:s,color:n="neutral",subtitle:a,buckets:l,timeRangeLabel:r,icon:i,size:o="md",isLoaded:c=!0}){const{barBase:d}=de[n],u="string"==typeof s?s:s.toLocaleString();return c?e.jsxs("div",{className:`data-card flex flex-col relative ${ue[o]}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i&&e.jsx("span",{className:"icon-sm text-text-secondary",children:i}),e.jsx("span",{className:"type-micro",children:t}),r&&e.jsx("span",{className:"pill-tag",children:r})]}),e.jsx("div",{className:"data-card-value",children:u}),e.jsx("div",{className:"flex-1 py-2 mt-2",children:l?e.jsx(me,{buckets:l,colorType:n,height:64}):e.jsx("div",{className:"w-full h-16 flex items-center justify-center",children:e.jsx("div",{className:"w-full h-0.5 rounded-full",style:{backgroundColor:d,opacity:.15}})})}),e.jsx("div",{className:"type-label text-text-muted border-t border-border-subtle pt-3 mt-2",children:a??`Total ${t.toLowerCase()}`})]}):e.jsx("div",{className:`data-card flex flex-col relative ${ue[o]}`,children:e.jsx(H,{})})}const xe=.2;function pe(e,t=1){return Math.floor(5*t*e)}function fe(e){const t=Math.round(e/xe)*xe;return Math.max(0,Math.min(5,t))}function ge({stats:t,receivedBuckets:r,droppedBuckets:i,forwardedBuckets:o,bucketDurationSeconds:c,timeRangeLabel:d,isLoaded:u=!0}){var m,h,x,p;if(!u)return e.jsx("div",{className:"data-card flex flex-col relative",children:e.jsx(H,{})});const f=function(e,t,s,n,a){var l,r;const i=e=>(null==e?void 0:e.reduce((e,t)=>e+t.count,0))??0,o=i(t),c=i(s),d=i(n),u=o||(null==e?void 0:e.rx_count)||1,m=c||(null==e?void 0:e.dropped_count)||0,h=u>0?m/(u+m)*100:0;let x=0;if((null==n?void 0:n.length)&&a)x=100*d/(n.length*a*1e3)*100;else if(e){const t=1e3*(e.uptime_seconds||1);x=(e.total_airtime_ms||e.airtime_used_ms||0)/t*100}const p=(null==e?void 0:e.neighbors)??{},f=Object.values(p).filter(e=>e.zero_hop).length;let g=1;h<3?g-=xe:h>15?g+=.4:h>10&&(g+=xe),x>5&&(g+=xe),f>10&&(g+=xe);const v=fe(g),j=fe(.28*v),b=pe(v),N=pe(j),y=pe((null==(r=null==(l=null==e?void 0:e.config)?void 0:l.delays)?void 0:r.tx_delay_factor)??1);return{floodFactor:v,directFactor:j,floodSlots:b,directSlots:N,adjustment:b>y?"increase":b<y?"decrease":"stable",duplicateRate:Math.round(100*h)/100,txUtilization:Math.round(1e3*x)/1e3,zeroHopCount:f,totalReceived:o,totalDropped:c}}(t,r,i,o,c),g=(null==(h=null==(m=null==t?void 0:t.config)?void 0:m.delays)?void 0:h.tx_delay_factor)??null,v=(null==(p=null==(x=null==t?void 0:t.config)?void 0:x.delays)?void 0:p.direct_tx_delay_factor)??null,j=null!==g?pe(g):null,b=null!==j&&f.floodSlots!==j,N="increase"===f.adjustment?n:"decrease"===f.adjustment?a:l;return e.jsxs("div",{className:"data-card flex flex-col relative",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:[e.jsx(s,{className:"w-4 h-4 text-[var(--metric-transmitted)] flex-shrink-0"}),e.jsx("span",{className:"type-micro",children:"TX DELAY"}),d&&e.jsx("span",{className:"pill-tag",children:d}),b&&e.jsxs("span",{className:"pill-tag flex items-center gap-1 "+("increase"===f.adjustment?"bg-accent-warning/20 text-accent-warning border-accent-warning/30":"bg-accent-success/20 text-accent-success border-accent-success/30"),children:[e.jsx(N,{className:"w-3 h-3"}),"increase"===f.adjustment?"+":"-",Math.abs(f.floodSlots-(j??0))]})]}),e.jsxs("div",{className:"data-card-value",children:["Ã—",f.floodFactor.toFixed(1)]}),e.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-x-3 gap-y-1 py-2 mt-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-muted",children:"Flood"}),e.jsxs("span",{className:"tabular-nums text-accent-secondary font-medium",children:[f.floodSlots," slots"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-muted",children:"Direct"}),e.jsxs("span",{className:"tabular-nums text-accent-secondary font-medium",children:[f.directSlots," slots"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-muted",children:"Dup Rate"}),e.jsxs("span",{className:"tabular-nums "+(f.duplicateRate>10?"text-accent-warning":"text-text-secondary"),children:[f.duplicateRate.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-muted",children:"TX Util"}),e.jsxs("span",{className:"tabular-nums text-text-secondary",children:[f.txUtilization.toFixed(2),"%"]})]})]}),e.jsx("div",{className:"type-label text-text-muted border-t border-border-subtle pt-3 mt-2 truncate",children:null!==g?e.jsxs("span",{children:["Current: Ã—",g.toFixed(1)," / Ã—",(null==v?void 0:v.toFixed(1))??"â€”"]}):e.jsx("span",{children:"Slot-aligned factors"})})]})}function ve(e){return(e.payload_type_name||q(e.payload_type??e.type)).toLowerCase().includes("advert")}function je(){const s=w(),n=k(),a=M(),l=_(),d=L(),[u,m]=t.useState(null),[h,x]=t.useState(null),p=t.useRef(0),f=t.useRef(0),g=t.useMemo(()=>[...s.length<=100?s:s.slice(-100)].sort((e,t)=>(t.timestamp??0)-(e.timestamp??0)),[s]),v=t.useMemo(()=>{const e=new Map;if(!(null==d?void 0:d.neighbors))return e;d.local_hash&&e.set(S(d.local_hash),d.local_hash);for(const t of Object.keys(d.neighbors)){const s=S(t);e.has(s)||e.set(s,t)}return e},[d]),j=t.useMemo(()=>g.slice(0,15).map(e=>{if(e.src_hash&&e.src_hash.length<=4){const t=v.get(e.src_hash.toUpperCase());if(t)return{...e,src_hash_full:t}}return e}),[g,v]);t.useEffect(()=>{var e;if(!g.length)return;const t=(null==(e=g[0])?void 0:e.timestamp)??0,s=t>f.current&&f.current>0;if(f.current=t,!s)return;const n=g.find(ve);if(!n||(n.timestamp??0)<=f.current)return;const a=requestAnimationFrame(()=>m(n.packet_hash)),l=setTimeout(()=>m(null),600);return()=>{cancelAnimationFrame(a),clearTimeout(l)}},[g]),t.useEffect(()=>{if(l>0&&l!==p.current&&g.length>0){p.current=l;const e=g.find(ve);if(e){const t=requestAnimationFrame(()=>m(e.packet_hash)),s=setTimeout(()=>m(null),600);return()=>{cancelAnimationFrame(t),clearTimeout(s)}}}},[l,g]);const b=()=>e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"w-6 h-6 text-text-muted mx-auto mb-2"}),e.jsx("div",{className:"text-sm text-text-primary",children:"No packets received"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Packets will appear here"})]});return e.jsxs("div",{className:"chart-container h-full flex flex-col",children:[e.jsxs("div",{className:"chart-header",children:[e.jsxs("div",{className:"chart-title",children:[e.jsx(r,{className:"chart-title-icon"}),"Recent Packets"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[a&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{className:"w-2 h-2 fill-accent-success text-accent-success animate-pulse"}),e.jsx("span",{className:"type-data-xs text-text-muted",children:"LIVE"})]}),e.jsxs(o,{to:"/packets",className:"pill-subtle",children:["View all ",e.jsx(c,{className:"w-3 h-3"})]})]})]}),e.jsxs("div",{className:"sm:hidden flex items-center gap-1.5 px-3 py-1.5 border-b border-border-subtle/50 bg-bg-elevated/20",children:[e.jsx("span",{className:"text-[9px] font-semibold text-text-muted uppercase tracking-wider w-14 flex-shrink-0",children:"Dir"}),e.jsx("span",{className:"text-[9px] font-semibold text-text-muted uppercase tracking-wider w-7 flex-shrink-0",children:"Time"}),e.jsx("span",{className:"text-[9px] font-semibold text-text-muted uppercase tracking-wider w-9 flex-shrink-0",children:"Src"}),e.jsx("span",{className:"text-[9px] font-semibold text-text-muted uppercase tracking-wider flex-1 min-w-0",children:"Type"}),e.jsx("span",{className:"text-[9px] font-semibold text-text-muted uppercase tracking-wider w-14 flex-shrink-0",children:"Route"}),e.jsx("span",{className:"text-[9px] font-semibold text-text-muted uppercase tracking-wider w-12 flex-shrink-0",children:"Signal"})]}),e.jsx("div",{className:"hidden sm:block flex-1 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"sticky top-0 bg-bg-elevated/95 backdrop-blur-sm",children:e.jsxs("tr",{className:"border-b border-border-subtle/50",children:[e.jsx("th",{className:"text-left py-1.5 px-3 text-[9px] font-semibold text-text-muted uppercase tracking-wider w-16",children:"Dir"}),e.jsx("th",{className:"text-left py-1.5 px-3 text-[9px] font-semibold text-text-muted uppercase tracking-wider",children:"Time"}),e.jsx("th",{className:"text-left py-1.5 px-3 text-[9px] font-semibold text-text-muted uppercase tracking-wider",children:"Source"}),e.jsx("th",{className:"text-left py-1.5 px-3 text-[9px] font-semibold text-text-muted uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"text-left py-1.5 px-3 text-[9px] font-semibold text-text-muted uppercase tracking-wider",children:"Route"}),e.jsx("th",{className:"text-right py-1.5 px-3 pr-4 text-[9px] font-semibold text-text-muted uppercase tracking-wider",children:"Signal"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle/30",children:n&&0===g.length?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-8 text-text-muted",children:"Loading packets..."})}):0===j.length?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-8",children:b()})}):j.map((t,s)=>e.jsx(J,{packet:t,onClick:x,isFlashing:ve(t)&&u===t.packet_hash},`${t.packet_hash}_${t.timestamp}_${s}`))})]})})}),e.jsx("div",{className:"sm:hidden flex-1 overflow-y-auto divide-y divide-border-subtle/30",children:n&&0===g.length?e.jsx("div",{className:"p-8 text-center text-text-muted",children:"Loading packets..."}):0===j.length?e.jsx("div",{className:"p-8 text-center",children:b()}):j.map((t,s)=>e.jsx(V,{packet:t,onClick:x,isFlashing:ve(t)&&u===t.packet_hash},`${t.packet_hash}_${t.timestamp}_${s}`))}),e.jsxs("div",{className:"px-3 py-1.5 border-t border-border-subtle/50 text-[10px] text-text-muted bg-bg-elevated/20 text-center",children:["Showing ",j.length," of ",g.length," packets"]}),h&&e.jsx(U,{packet:h,onClose:()=>x(null)})]})}t.memo(function({active:t,payload:s,label:n,formatValue:a,labelKey:l}){var r;if(!t||!(null==s?void 0:s.length))return null;const i=l&&(null==(r=s[0])?void 0:r.payload)?s[0].payload[l]:n;return e.jsxs("div",{className:"bg-tooltip-bg border border-border-subtle rounded-lg px-4 py-3 shadow-xl",children:[i&&e.jsx("p",{className:"type-data-xs text-white/50 mb-2",children:i}),e.jsx("div",{className:"space-y-1.5",children:s.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:t.color}}),e.jsx("span",{className:"type-body-sm text-white/70 capitalize min-w-[60px]",children:t.name}),e.jsx("span",{className:"type-data-sm text-white tabular-nums",children:a?a(t.value,t.name):t.value.toLocaleString()})]},s))})]})});const be=t.memo(function({active:t,payload:s,color:n,labelKey:a,unit:l=""}){var r,i;if(!t||!(null==s?void 0:s.length))return null;const o=s[0],c=null==(r=null==o?void 0:o.payload)?void 0:r[a];return e.jsxs("div",{className:"bg-tooltip-bg border border-border-subtle rounded-lg px-3 py-2 shadow-xl",children:[e.jsx("p",{className:"type-data-xs text-white/50 mb-1",children:c}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:n}}),e.jsxs("span",{className:"type-data-sm text-white tabular-nums",children:[null==(i=null==o?void 0:o.value)?void 0:i.toLocaleString(),l]})]})]})});t.memo(function({payload:t}){return(null==t?void 0:t.length)?e.jsx("div",{className:"flex items-center justify-center gap-6 mt-4 pt-4 border-t border-white/5",children:t.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:t.color}}),e.jsx("span",{className:"type-body-sm text-white/60 capitalize",children:t.value})]},s))}):null});const Ne={stable:"M5 12h14",up:"M5 15l7-7 7 7",down:"M19 9l-7 7-7-7"};function ye({trend:t}){return e.jsx("span",{className:`mini-widget-trend ${t}`,children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:Ne[t]})})})}function we(){return e.jsx("div",{className:"mini-widget-loading",children:e.jsx("div",{className:"mini-widget-loading-spinner"})})}function ke({message:t}){return e.jsx("div",{className:"mini-widget-error",children:e.jsx("span",{title:t,children:"No data"})})}function Me({title:t,icon:s,value:n,unit:a,valueSize:l="md",status:r,subtitle:i,trend:o,children:c,isLoading:d=!1,error:u,className:m="",onClick:h}){const x=["mini-widget-value","lg"===l&&"mini-widget-value-lg","sm"===l&&"mini-widget-value-sm"].filter(Boolean).join(" "),p=["mini-widget",h&&"cursor-pointer",m].filter(Boolean).join(" ");return e.jsxs("div",{className:p,onClick:h,role:h?"button":void 0,children:[e.jsxs("div",{className:"mini-widget-header",children:[s,e.jsx("span",{className:"mini-widget-title",children:t}),r&&"unknown"!==r&&e.jsx("div",{className:`mini-widget-status-dot ${r}`}),o&&e.jsx(ye,{trend:o})]}),d?e.jsx(we,{}):u?e.jsx(ke,{message:u}):e.jsxs(e.Fragment,{children:[void 0!==n&&e.jsxs("div",{className:x,children:[n,a&&e.jsx("span",{className:"mini-widget-unit",children:a})]}),i&&e.jsx("div",{className:"mini-widget-subtitle",children:i}),c]})]})}const _e={DELTA_CRITICAL:10,SLOPE_CRITICAL:4,JITTER_CRITICAL:6,DELTA_WARNING:5,SLOPE_WARNING:2,JITTER_WARNING:4},Le={baselineMedian:null,baselineP10:null,baselineP90:null,currentMedian:null,currentSampleCount:0,delta:0,slope:0,jitter:0,penalty:0,penaltyReason:null,computedAt:0,isReliable:!1};function Se(e,t){if(0===e.length)return null;const s=[...e].sort((e,t)=>e-t),n=t/100*(s.length-1),a=Math.floor(n),l=Math.ceil(n);return a===l?s[a]:s[a]+(s[l]-s[a])*(n-a)}function Ce(e){return Se(e,50)}const Re={lbtStats:null,noiseFloor:null,hourlyNoiseFloor:[],linkQuality:null,channelHealth:null,nfTrend:Le,radioConfig:null,trends:null,stats:null,recentPackets:[],quickNeighbors:[],isLoading:!0,error:null,refresh:async()=>{}},Te=t.createContext(Re);function Be(e){if(!e)return[];try{const t=JSON.parse(e);if(Array.isArray(t))return t.map(Number).filter(e=>!isNaN(e))}catch{}return[]}function Fe(e,t,s=2,n=!1){if(null===t)return"stable";const a=e-t;return(0!==t?100*Math.abs(a/t):Math.abs(a))<s?"stable":n?a>0?"up":"down":a>0?"down":"up"}function Ae({children:s}){var n;const a=L(),l=w(),r=C(),i=R(),o=null===a,c=t.useMemo(()=>function(e){const t=Math.floor(Date.now()/1e3),s=t-86400,n=e.filter(e=>e.timestamp>=s&&void 0!==e.lbt_attempts&&e.lbt_attempts>0),a=n.length,l=n.filter(e=>(e.lbt_attempts??0)>1).length,r=a>0?l/a*100:0,i=n.filter(e=>(e.lbt_attempts??0)>1),o=i.length>0?i.reduce((e,t)=>e+(t.lbt_attempts??0),0)/i.length:0,c=n.filter(e=>!0===e.lbt_channel_busy||1===e.lbt_channel_busy).length,d=a>0?c/a*100:0,u=[];for(const v of n){const e=Be(v.lbt_backoff_delays_ms);u.push(...e)}const m=u.reduce((e,t)=>e+t,0),h=u.length>0?m/u.length:0,x=u.length>0?Math.max(...u):0,p=[],f=[],g=[];for(let v=0;v<24;v++){const e=t-3600*(24-v),s=e+3600,a=n.filter(t=>t.timestamp>=e&&t.timestamp<s),l=a.filter(e=>(e.lbt_attempts??0)>1).length,r=a.length>0?l/a.length*100:0;p.push(r);const i=[];for(const t of a){const e=Be(t.lbt_backoff_delays_ms);i.push(...e)}const o=i.length>0?i.reduce((e,t)=>e+t,0)/i.length:0;if(g.push(o),0===a.length)f.push(0);else{const e=a.filter(e=>!0===e.lbt_channel_busy||1===e.lbt_channel_busy).length,t=i.length>0?Math.max(...i):0,s=Math.min(a.length/5,1),n=.15,l=Math.log(1+r*n)/Math.log(1+100*n)*40,c=e/a.length*100,d=Math.min(.5*c,25);let u=0;o>100&&(u=Math.min(8*Math.log10(o/100),15));let m=0;t>500&&o>0&&t>2*o&&(m=Math.min((t-500)/200,5));const h=l+d+u+m;f.push(Math.min(h*s,85))}}return{totalPacketsWithLBT:a,packetsWithRetries:l,retryRate:r,avgRetries:o,channelBusyCount:c,channelBusyRate:d,avgBackoffMs:h,maxBackoffMs:x,totalBackoffMs:m,hourlyRetryRates:p,hourlyCollisionRisk:f,hourlyAvgBackoffMs:g,windowHours:24,packetCount:e.length}}(l),[l]),d=(null==a?void 0:a.noise_floor_dbm)??null,u=t.useMemo(()=>{var e;const t=null==(e=null==a?void 0:a.config)?void 0:e.radio;return t?{sf:t.spreading_factor??7,bwHz:t.bandwidth??125e3}:null},[null==(n=null==a?void 0:a.config)?void 0:n.radio]),[m,h]=t.useState([]),x=t.useRef(0);t.useEffect(()=>{const e=async()=>{var e;const t=Date.now();if(!(t-x.current<6e4)){x.current=t;try{const t=await T(24);if(t.success&&(null==(e=t.data)?void 0:e.history)){const e=Math.floor(Date.now()/1e3),s=[];for(let n=0;n<24;n++){const a=e-3600*(24-n),l=a+3600,r=t.data.history.filter(e=>e.timestamp>=a&&e.timestamp<l);if(r.length>0){const e=r.reduce((e,t)=>e+t.noise_floor_dbm,0)/r.length;s.push(e)}else s.push(s.length>0?s[s.length-1]:-100)}h(s)}}catch{}}};e();const t=setInterval(e,6e4);return()=>clearInterval(t)},[]);const p=null==a?void 0:a.neighbors,f=t.useMemo(()=>{const e=p??{};return Object.fromEntries(Object.entries(e).filter(([e])=>!i.has(e)))},[p,i]),g=t.useMemo(()=>r.filter(e=>!i.has(e.hash)),[r,i]),v=t.useMemo(()=>function(e){if(0===e.length)return{...Le,computedAt:Math.floor(Date.now()/1e3)};const t=Math.floor(Date.now()/1e3),s=e.filter(e=>Number.isFinite(e)),n=e.length>0?[e[e.length-1]]:[],a=e.slice(-4).filter(e=>Number.isFinite(e)),l=Ce(s),r=Se(s,10),i=Se(s,90),o=Ce(n),c=null!==o&&null!==r?o-r:0,d=function(e){if(e.length<2)return 0;const t=e.length;let s=0,n=0,a=0,l=0;const r=e[0].timestamp;for(const o of e){const e=(o.timestamp-r)/3600,t=o.value;s+=e,n+=t,a+=e*t,l+=e*e}const i=t*l-s*s;return Math.abs(i)<1e-4?0:(t*a-s*n)/i}(a.map((e,s)=>({timestamp:t-3600*(a.length-1-s),value:e}))),u=function(e){if(e.length<2)return 0;const t=e.reduce((e,t)=>e+t,0)/e.length,s=e.map(e=>Math.pow(e-t,2)).reduce((e,t)=>e+t,0)/e.length;return Math.sqrt(s)}(a),m=s.length>=12,[h,x]=m?function(e,t,s){const n=_e;return e>=n.DELTA_CRITICAL?[2,`Noise floor ${e.toFixed(1)} dB above baseline`]:t>=n.SLOPE_CRITICAL?[2,`Noise floor rising ${t.toFixed(1)} dB/hour`]:s>=n.JITTER_CRITICAL?[2,`Noise floor unstable (Â±${s.toFixed(1)} dB)`]:e>=n.DELTA_WARNING?[1,`Noise floor ${e.toFixed(1)} dB above baseline`]:t>=n.SLOPE_WARNING?[1,`Noise floor rising ${t.toFixed(1)} dB/hour`]:s>=n.JITTER_WARNING?[1,`Noise floor variable (Â±${s.toFixed(1)} dB)`]:[0,null]}(c,d,u):[0,null];return{baselineMedian:l,baselineP10:r,baselineP90:i,currentMedian:o,currentSampleCount:n.length,delta:c,slope:d,jitter:u,penalty:h,penaltyReason:x,computedAt:t,isReliable:m}}(m),[m]),j=t.useMemo(()=>function(e,t,s){if(0===e.length)return{neighbors:[],networkScore:0,neighborCount:0,bestLink:null,worstLink:null};const n=e.map(e=>{const n=function(e,t,s){const n=Y(e,t,s,0);if(n)switch(n.finalGrade){case"excellent":return 100;case"good":return 80;case"fair":return 60;case"poor":return 40;case"critical":return 20}const a=void 0===e?50:e>=10?100:e>=5?80:e>=0?60:e>=-5?40:20,l=void 0===t?50:t>=-70?100:t>=-80?80:t>=-90?60:t>=-100?40:20;return Math.round(.6*a+.4*l)}(e.avgSnr??void 0,e.avgRssi??void 0,s),a=t[e.hash];return{name:(null==a?void 0:a.name)||(null==a?void 0:a.node_name)||e.prefix,hash:e.hash,rssi:e.avgRssi??-100,snr:e.avgSnr??-10,score:n,advertCount:e.count}});n.sort((e,t)=>t.score-e.score);const a=n.length>0?n.reduce((e,t)=>e+t.score,0)/n.length:0;return{neighbors:n,networkScore:Math.round(a),neighborCount:n.length,bestLink:n.length>0?{name:n[0].name,score:n[0].score}:null,worstLink:n.length>0?{name:n[n.length-1].name,score:n[n.length-1].score}:null}}(g,f,u),[g,f,u]),b=t.useMemo(()=>function(e,t,s){const n=e?Math.max(0,Math.min(100,100-5*e.retryRate)):50;let a=50;null!==t&&(a=Math.max(0,Math.min(100,(t+120)/30*100)));const l=(null==s?void 0:s.networkScore)??50,r=Math.round(.35*n+.25*a+.4*l);let i;return i=r>=85?"excellent":r>=70?"good":r>=50?"fair":r>=30?"congested":"critical",{score:r,status:i,components:{lbtHealth:Math.round(n),noiseHealth:Math.round(a),linkHealth:Math.round(l)}}}(c,d,j),[c,d,j]),[N,y]=t.useState({noiseFloor:null,networkScore:null,channelHealth:null}),k=t.useRef(0);t.useEffect(()=>{const e=()=>{const e=Date.now();e-k.current>3e4&&(k.current=e,y({noiseFloor:d,networkScore:(null==j?void 0:j.networkScore)??null,channelHealth:(null==b?void 0:b.score)??null}))};e();const t=setInterval(e,5e3);return()=>clearInterval(t)},[d,null==j?void 0:j.networkScore,null==b?void 0:b.score]);const M=t.useMemo(()=>({noiseFloor:{current:d,previous:N.noiseFloor,trend:null!==d?Fe(d,N.noiseFloor,2,!0):"stable"},networkScore:{current:(null==j?void 0:j.networkScore)??0,previous:N.networkScore,trend:Fe((null==j?void 0:j.networkScore)??0,N.networkScore,3,!1)},channelHealth:{current:(null==b?void 0:b.score)??0,previous:N.channelHealth,trend:Fe((null==b?void 0:b.score)??0,N.channelHealth,3,!1)}}),[d,null==j?void 0:j.networkScore,null==b?void 0:b.score,N]),_={lbtStats:c,noiseFloor:d,hourlyNoiseFloor:m,linkQuality:j,channelHealth:b,nfTrend:v,radioConfig:u,trends:M,stats:a,recentPackets:l,quickNeighbors:r,isLoading:o,error:null,refresh:async()=>{}};return e.jsx(Te.Provider,{value:_,children:s})}function Ie(){const e=t.useContext(Te);if(void 0===e)throw new Error("useLBTData must be used within an LBTDataProvider");return e}const Pe={excellent:"var(--signal-excellent)",good:"var(--signal-good)",fair:"var(--signal-fair)",congested:"var(--signal-poor)",critical:"var(--signal-critical)",unknown:"var(--text-muted)"};function De(e,t){return 0===e?"No backoffs":`${t.toFixed(0)}% retry rate`}function $e(){const{lbtStats:n,isLoading:a,error:l}=Ie(),r=d(),i=(null==n?void 0:n.avgBackoffMs)??0,o=(null==n?void 0:n.retryRate)??0,c=n?(u=i)<100?"excellent":u<250?"good":u<500?"fair":u<1e3?"congested":"critical":"unknown";var u;const m=null==n?void 0:n.hourlyAvgBackoffMs,h=t.useMemo(()=>!m||m.length<2?[]:m.map(e=>({value:e})),[m]),x=Pe[c];return e.jsx(Me,{title:"LBT Backoff",icon:e.jsx(s,{className:"mini-widget-icon"}),value:Math.round(i),unit:"ms",status:c,subtitle:n?De(i,o):void 0,isLoading:a,error:l,onClick:()=>r("/packets"),children:e.jsx("div",{className:"mini-widget-sparkline",children:h.length>0?e.jsx(Z,{width:"100%",height:24,children:e.jsx(ee,{data:h,margin:{top:2,right:2,bottom:2,left:2},children:e.jsx(te,{type:"monotone",dataKey:"value",stroke:x,strokeWidth:1,dot:!1,isAnimationActive:!1})})}):e.jsx("div",{className:"h-full"})})})}function Ee(){const{lbtStats:t,isLoading:s,error:n}=Ie(),a=d(),l=(null==t?void 0:t.channelBusyCount)??0,r=(null==t?void 0:t.totalPacketsWithLBT)??0,i=(null==t?void 0:t.channelBusyRate)??0,o=t?(c=i)<.5?"excellent":c<1?"good":c<2?"fair":c<5?"congested":"critical":"unknown";var c;return e.jsx(Me,{title:"Ch. Busy",icon:e.jsx(u,{className:"mini-widget-icon"}),value:l,status:o,subtitle:t?`${i.toFixed(2)}% of ${r} TX`:void 0,isLoading:s,error:n,onClick:()=>a("/packets")})}function He(e){return null===e?"No reading":e<-115?"Very quiet":e<-105?"Quiet":e<-95?"Moderate":e<-85?"Elevated":"High interference"}const We={excellent:"var(--signal-excellent)",good:"var(--signal-good)",fair:"var(--signal-fair)",congested:"var(--signal-poor)",critical:"var(--signal-critical)",unknown:"var(--text-muted)"};function ze(){const{noiseFloor:s,hourlyNoiseFloor:n,trends:a,isLoading:l,error:r}=Ie(),i=null===(o=s)||o<-110?"excellent":o<-100?"good":o<-90?"fair":o<-80?"congested":"critical";var o;const c=null==a?void 0:a.noiseFloor.trend,d=t.useMemo(()=>!n||n.length<2?[]:n.map(e=>({value:e})),[n]),u=We[i];return e.jsx(Me,{title:"Noise Floor",icon:e.jsx(m,{className:"mini-widget-icon"}),value:null!==s?Math.round(s):"â€”",unit:null!==s?"dBm":void 0,status:i,trend:c,subtitle:He(s),isLoading:l,error:r,children:e.jsx("div",{className:"mini-widget-sparkline",children:d.length>0?e.jsx(Z,{width:"100%",height:24,children:e.jsx(ee,{data:d,margin:{top:2,right:2,bottom:2,left:2},children:e.jsx(te,{type:"monotone",dataKey:"value",stroke:u,strokeWidth:1,dot:!1,isAnimationActive:!1})})}):e.jsx("div",{className:"h-full"})})})}function Oe(){const s=d(),n=C(),a=w(),l=L(),r=null===l,i=(null==l?void 0:l.local_hash)?S(l.local_hash):"",o=(null==l?void 0:l.neighbors)??{},{neighborHashes:c,neighborNames:u}=t.useMemo(()=>{const e=new Set,t=new Map;for(const s of n){e.add(s.hash);const n=o[s.hash],a=(null==n?void 0:n.name)||(null==n?void 0:n.node_name)||s.prefix;t.set(s.hash,a)}return{neighborHashes:e,neighborNames:t}},[n,o]),m=t.useMemo(()=>{if(0===c.size||0===a.length||!i)return{champion:null,listener:null,loudest:null};const{scores:e}=oe(a,c,i),t=[];for(const[a,r]of e)0!==r.blendedScore&&t.push({...r,name:u.get(a)??S(a)});let s=null,n=null,l=null;for(const a of t)(!s||a.blendedScore>s.blendedScore)&&(s=a),(!n||a.listenerScore>n.listenerScore)&&(n=a),(!l||a.loudScore>l.loudScore)&&(l=a);return{champion:s,listener:n,loudest:l}},[a,c,i,u]),{champion:g,listener:v,loudest:j}=m,b=g||v||j?e.jsxs("div",{className:"flex flex-col gap-0.5 mt-auto",children:[g&&e.jsx(B,{content:(N=g,e.jsxs("div",{className:"max-w-[220px]",children:[e.jsxs("div",{className:"font-semibold mb-1",children:["ðŸ† Champion: ",N.name]}),e.jsxs("div",{className:"text-text-muted mb-1",children:["Blended Score: ",N.blendedScore,e.jsx("span",{className:"text-text-muted/60 ml-1",children:"(Listener + Loud)"})]}),e.jsxs("div",{className:"border-t border-border-subtle pt-1 mt-1 space-y-0.5",children:[e.jsxs("div",{children:["Listener: ",N.listenerScore,"/100 (",N.listenerCount," shared paths)"]}),e.jsxs("div",{children:["Loud: ",N.loudScore,"/100 (",N.loudCount," packets relayed)"]})]})]})),children:e.jsxs("div",{className:"flex items-center gap-1 text-sm rounded px-1 -mx-1 hover:bg-white/5 transition-colors cursor-default",children:[e.jsx(h,{className:"w-3 h-3 text-map-neighbor-color flex-shrink-0"}),e.jsx("span",{className:"font-semibold text-map-neighbor-color font-mono truncate flex-1 min-w-0",children:g.name}),e.jsx("span",{className:"text-map-neighbor-color pl-2 tabular-nums flex-shrink-0 w-9 text-right",children:g.blendedScore})]})}),v&&v.hash!==(null==g?void 0:g.hash)&&e.jsx(B,{content:(t=>e.jsxs("div",{className:"max-w-[220px]",children:[e.jsxs("div",{className:"font-semibold mb-1",children:["ðŸ‘‚ Best Listener: ",t.name]}),e.jsxs("div",{className:"text-text-muted mb-1",children:["Score: ",t.listenerScore,"/100"]}),e.jsx("div",{className:"border-t border-border-subtle pt-1 mt-1",children:e.jsxs("div",{children:[t.listenerCount," packets where they heard your transmissions"]})})]}))(v),children:e.jsxs("div",{className:"flex items-center gap-1 text-sm rounded px-1 -mx-1 hover:bg-white/5 transition-colors cursor-default",children:[e.jsx(x,{className:"w-3 h-3 text-text-muted flex-shrink-0"}),e.jsx("span",{className:"text-text-muted font-mono truncate flex-1 min-w-0",children:v.name}),e.jsx("span",{className:"text-text-muted pl-2 tabular-nums flex-shrink-0 w-9 text-right",children:v.blendedScore})]})}),j&&j.hash!==(null==g?void 0:g.hash)&&j.hash!==(null==v?void 0:v.hash)&&e.jsx(B,{content:(t=>e.jsxs("div",{className:"max-w-[220px]",children:[e.jsxs("div",{className:"font-semibold mb-1",children:["ðŸ“¢ Loudest: ",t.name]}),e.jsxs("div",{className:"text-text-muted mb-1",children:["Score: ",t.loudScore,"/100"]}),e.jsx("div",{className:"border-t border-border-subtle pt-1 mt-1",children:e.jsxs("div",{children:[t.loudCount," packets they relayed directly to you"]})})]}))(j),children:e.jsxs("div",{className:"flex items-center gap-1 text-sm rounded px-1 -mx-1 hover:bg-white/5 transition-colors cursor-default",children:[e.jsx(p,{className:"w-3 h-3 text-text-muted flex-shrink-0"}),e.jsx("span",{className:"text-text-muted font-mono truncate flex-1 min-w-0",children:j.name}),e.jsx("span",{className:"text-text-muted pl-2 tabular-nums flex-shrink-0 w-9 text-right",children:j.blendedScore})]})})]}):0===n.length?e.jsx("div",{className:"flex items-center justify-center text-sm text-text-muted mt-auto",children:"No direct neighbors"}):e.jsx("div",{className:"flex items-center justify-center text-sm text-text-muted mt-auto",children:"No routing data yet"});var N;return e.jsx(Me,{title:"Link Leaders",icon:e.jsx(f,{className:"mini-widget-icon"}),isLoading:r,onClick:()=>s("/contacts"),children:b})}const Ge={excellent:"var(--signal-excellent)",good:"var(--signal-good)",fair:"var(--signal-fair)",congested:"var(--signal-poor)",critical:"var(--signal-critical)",unknown:"var(--text-muted)"};function Ke(){const{lbtStats:s,isLoading:n,error:a}=Ie(),l=s?function(e){const{retryRate:t,channelBusyCount:s,totalPacketsWithLBT:n,avgBackoffMs:a,maxBackoffMs:l}=e;if(0===n)return 0;const r=Math.min(n/10,1),i=Math.log(1+.15*t)/Math.log(16)*40,o=s/n*100,c=Math.min(.5*o,25);let d=0;a>100&&(d=Math.min(8*Math.log10(a/100),15));let u=0;l>500&&a>0&&l>2*a&&(u=Math.min((l-500)/200,5));const m=(i+c+d+u)*r;return Math.min(m,85)}(s):0,r=s?(i=l)<15?"excellent":i<30?"good":i<45?"fair":i<60?"congested":"critical":"unknown";var i;const o=(null==s?void 0:s.maxBackoffMs)??0,c=s?o>200?`Max backoff: ${Math.round(o)}ms`:function(e){return e<15?"Clear channel":e<30?"Light traffic":e<45?"Moderate traffic":e<60?"Heavy traffic":e<75?"Congested":"Severe congestion"}(l):void 0,d=null==s?void 0:s.hourlyCollisionRisk,u=t.useMemo(()=>!d||d.length<2?[]:d.map(e=>({value:e})),[d]),m=Ge[r];return e.jsx(Me,{title:"Collision Risk",icon:e.jsx(g,{className:"mini-widget-icon"}),value:l.toFixed(1),unit:"%",status:r,subtitle:c,isLoading:n,error:a,children:e.jsx("div",{className:"mini-widget-sparkline",children:u.length>0?e.jsx(Z,{width:"100%",height:24,children:e.jsx(ee,{data:u,margin:{top:2,right:2,bottom:2,left:2},children:e.jsx(te,{type:"monotone",dataKey:"value",stroke:m,strokeWidth:1,dot:!1,isAnimationActive:!1})})}):e.jsx("div",{className:"h-full"})})})}function Je(){const[s,n]=t.useState(!1),[a]=t.useState(0),{stats:l,lbtStats:i,isLoading:o}=Ie(),c=t.useMemo(()=>{if(!l)return null;const e=l.airtime_used_ms??0,t=l.max_airtime_ms??1;return{usedMs:e,maxMs:t,remainingMs:l.airtime_remaining_ms??0,utilizationPercent:l.utilization_percent??(t>0?e/t*100:0)}},[l]),d=t.useMemo(()=>{if(!i||0===i.totalPacketsWithLBT)return 100;const e=i.channelBusyCount,t=i.totalPacketsWithLBT;return(t-e)/t*100},[i]),u=(null==c?void 0:c.utilizationPercent)??0,m=(h=u)<30?"excellent":h<50?"good":h<70?"fair":h<90?"congested":"critical";var h;const x=(null==c?void 0:c.remainingMs)??0,p=d<99?`${d.toFixed(0)}% TX success`:((f=x)<1e3?`${Math.round(f)}ms`:f<6e4?`${(f/1e3).toFixed(1)}s`:`${(f/6e4).toFixed(1)}m`)+" remaining";var f;const g=c?e.jsx("div",{className:"mini-widget-progress mt-auto",children:e.jsx("div",{className:`mini-widget-progress-bar ${m}`,style:{width:`${Math.min(u,100)}%`}})}):null;return e.jsx(Me,{title:"Duty Cycle",icon:e.jsx(r,{className:"mini-widget-icon"}),value:u.toFixed(1),unit:"%",status:m,subtitle:p,isLoading:o,children:g})}function Ve(){return e.jsxs("div",{className:"mini-widget",children:[e.jsxs("div",{className:"mini-widget-header",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx(W,{className:"h-3 w-16"})]}),e.jsx(W,{className:"h-7 w-12 mt-2"}),e.jsx(W,{className:"h-3 w-20 mt-2"})]})}function Ue(){return e.jsx("div",{className:"widget-row",children:Array.from({length:6}).map((t,s)=>e.jsx(Ve,{},s))})}function qe({className:t="",isLoaded:s=!0}){return e.jsxs("div",{className:`mesh-health-container relative ${t}`,children:[e.jsxs("div",{className:"mesh-health-header",children:[e.jsx(v,{className:"w-4 h-4 text-accent-primary"}),e.jsx("span",{className:"type-label text-text-muted",children:"MESH HEALTH"})]}),s?e.jsx(Ae,{children:e.jsxs("div",{className:"widget-row",children:[e.jsx($e,{}),e.jsx(Ke,{}),e.jsx(ze,{}),e.jsx(Je,{}),e.jsx(Ee,{}),e.jsx(Oe,{})]})}):e.jsx(Ue,{})]})}function Xe(){var s,a;const l=L(),i=F(),o=w(),c=A(),d=$(),u=E(),[m,h]=t.useState(4),x=P[m],p=null==(s=null==l?void 0:l.config)?void 0:s.radio,f=t.useMemo(()=>p?{sf:p.spreading_factor??10,bw:p.bandwidth??25e4,cr:p.coding_rate??5,preamble:p.preamble_length??8}:null,[p]),g=o.length,v=t.useMemo(()=>g?I(x.minutes,x.buckets,o,l):null,[g,x.minutes,x.buckets,f]),k=t.useMemo(()=>function(e,t){if(!(null==e?void 0:e.length))return[];const s=t>1440?{weekday:"short",hour:"2-digit",minute:"2-digit",hour12:!1}:{hour:"2-digit",minute:"2-digit",hour12:!1};return e.map(e=>({time:new Date(1e3*e.start).toLocaleString([],s),received:e.count}))}(null==v?void 0:v.received,x.minutes),[null==v?void 0:v.received,x.minutes]),M=t.useMemo(()=>function(e){if(!e.length)return[0,"auto"];const t=e.map(e=>e.received),s=Math.min(...t),n=Math.max(...t);if(s===n)return[Math.max(0,s-1),n+1];const a=.1*(n-s);return[Math.max(0,Math.floor(s-a)),Math.ceil(n+a)]}(k),[k]),_=t.useMemo(()=>{return(e=k.length)<=12?0:e<=24?2:e<=48?5:e<=72?8:Math.floor(e/7);var e},[k.length]),S=t.useMemo(()=>{const e=e=>(null==e?void 0:e.reduce((e,t)=>e+t.count,0))??0,t=e(null==v?void 0:v.received),s=e(null==v?void 0:v.forwarded),n=e(null==v?void 0:v.dropped),a=e(null==v?void 0:v.transmitted),l=((null==v?void 0:v.time_range_minutes)??x.minutes)/60;return{received:t,forwarded:s,dropped:n,transmitted:a,rxPerHour:l>0?Math.round(t/l):0,fwdPerHour:l>0?Math.round(s/l):0}},[v,x.minutes]),C=(null==l?void 0:l.uptime_seconds)?D(l.uptime_seconds):"0m",R=(null==l?void 0:l.node_name)??(null==(a=null==l?void 0:l.config)?void 0:a.node_name)??"Unknown Node";return i?e.jsxs(z,{className:"p-8 text-center",children:[e.jsx("p",{className:"type-subheading text-accent-red mb-2",children:"Failed to connect to backend"}),e.jsx("p",{className:"type-body text-white/50",children:i}),e.jsx("p",{className:"type-data-sm text-white/40 mt-4",children:"Make sure the backend is running on port 8000"})]}):e.jsxs(O,{children:[e.jsx(G,{title:R,icon:e.jsx(j,{}),controls:e.jsx(X,{ranges:P,selectedIndex:m,onSelect:h})}),e.jsx(ce,{template:"hero",children:e.jsx(z,{isLoaded:c,skeletonType:"chart",children:c&&e.jsxs(e.Fragment,{children:[e.jsx(K,{icon:e.jsx(n,{}),title:"RECEIVED",badge:x.label,iconColor:"text-accent-success"}),e.jsx("div",{className:"type-hero font-semibold min-h-[3rem]",style:{color:d.received},children:S.received.toLocaleString()}),e.jsxs("div",{className:"type-body-sm text-text-secondary mt-1",children:[S.rxPerHour,"/hr rate"]}),e.jsx("div",{className:"mt-4",children:k.length>0?e.jsx(Z,{width:"100%",height:180,children:e.jsxs(se,{data:k,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"gradient-received",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:d.received,stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:d.received,stopOpacity:0})]})}),e.jsx(ne,{strokeDasharray:"3 3",stroke:u.grid,vertical:!1}),e.jsx(ae,{dataKey:"time",axisLine:!1,tickLine:!1,tick:{fill:u.axisTick,fontSize:10,fontFamily:"'JetBrains Mono', monospace"},dy:8,interval:_,minTickGap:20}),e.jsx(le,{domain:M,axisLine:!1,tickLine:!1,tick:{fill:u.axisTick,fontSize:10,fontFamily:"'JetBrains Mono', monospace"},dx:-8,width:40}),e.jsx(re,{content:e.jsx(be,{color:d.received,labelKey:"time",unit:" packets"}),cursor:{stroke:u.cursor,strokeWidth:1}}),e.jsx(ie,{type:"stepAfter",dataKey:"received",stroke:d.received,fill:"url(#gradient-received)",strokeWidth:1,dot:!1,activeDot:{r:4,strokeWidth:0,fill:d.received},isAnimationActive:!1})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-text-muted",children:"No data available for this time range"})})]})})}),e.jsxs(ce,{template:"compact",children:[e.jsx(he,{title:"FORWARDED",value:S.forwarded,subtitle:`${S.fwdPerHour}/hr rate`,color:"forwarded",buckets:null==v?void 0:v.forwarded,timeRangeLabel:x.label,icon:e.jsx(b,{className:"w-4 h-4"}),isLoaded:c}),e.jsx(he,{title:"DROPPED",value:S.dropped,subtitle:"Filtered or duplicate",color:"dropped",buckets:null==v?void 0:v.dropped,timeRangeLabel:x.label,icon:e.jsx(N,{className:"w-4 h-4"}),isLoaded:c}),e.jsx(ge,{stats:l,receivedBuckets:null==v?void 0:v.received,droppedBuckets:null==v?void 0:v.dropped,forwardedBuckets:null==v?void 0:v.forwarded,bucketDurationSeconds:null==v?void 0:v.bucket_duration_seconds,timeRangeLabel:x.label,isLoaded:c}),e.jsx(he,{title:"UPTIME",value:C,subtitle:"Since last restart",color:"neutral",icon:e.jsx(y,{className:"w-4 h-4"}),isLoaded:c})]}),e.jsx(qe,{isLoaded:c}),e.jsx(je,{}),l&&e.jsx(ce,{template:"auto",children:e.jsxs(z,{children:[e.jsx(K,{icon:e.jsx(r,{}),title:"Node Information",largeTitle:!0}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"type-label text-text-muted",children:"Node Name"}),e.jsx("p",{className:"type-body text-text-primary mt-1",children:R})]}),e.jsxs("div",{children:[e.jsx("span",{className:"type-label text-text-muted",children:"Version"}),e.jsxs("p",{className:"type-data text-text-primary mt-1",children:["v",l.version]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"type-label text-text-muted",children:"Core Version"}),e.jsxs("p",{className:"type-data text-text-primary mt-1",children:["v",l.core_version]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"type-label text-text-muted",children:"Local Hash"}),e.jsx("div",{className:"mt-1",children:l.local_hash?e.jsx(Q,{hash:l.local_hash,size:"sm"}):e.jsx("span",{className:"type-data-sm text-text-muted",children:"N/A"})})]})]}),l.public_key&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-border-subtle",children:[e.jsx("span",{className:"type-label text-text-muted",children:"Public Key"}),e.jsx("div",{className:"mt-1",children:e.jsx(Q,{hash:l.public_key,prefixLength:12,suffixLength:8})})]})]})})]})}export{Xe as default};
