import{r as e,j as t,$ as s,aL as a,ab as r,aM as l,aN as c}from"./vendor-react-CUlQ5-Td.js";import{Y as o,Z as n,_ as i,$ as d}from"./index-C1whtcFB.js";import{c as m,R as x,A as u,C as p,X as h,Y as j,T as y,e as f,b as g}from"./recharts-7RsRrQtf.js";import{P as v,b,a as N,c as w}from"./PageLayout-CViR4hDG.js";import{f as k,a as C}from"./useThemeColors-8RSyMp_o.js";import{R as F,C as _}from"./Grid-HJLNnEZz.js";import"./vendor-core-XI_xDZ-M.js";import"./deckgl-MTXp-Y3t.js";const M={primary:"bg-accent-tertiary",secondary:"bg-accent-secondary",green:"bg-accent-success",red:"bg-accent-danger",yellow:"bg-accent-secondary"},S=e.memo(function({value:e,max:s=100,color:a="primary"}){const r=Math.min(e/s*100,100),l=r>90?"bg-accent-danger":r>70?"bg-accent-secondary":M[a];return t.jsx("div",{className:"h-2.5 bg-white/[0.02] rounded-full overflow-hidden",children:t.jsx("div",{className:m("h-full rounded-full",l),style:{width:`${r}%`}})})}),G={cold:30,normal:50,warm:65,hot:80},L=e.memo(function({value:e,label:s,min:a=20,max:r=100}){const l=Math.min(Math.max((e-a)/(r-a)*100,0),100),c=e<G.cold?{text:"Cool",color:"text-accent-tertiary"}:e<G.normal?{text:"Normal",color:"text-accent-success"}:e<G.warm?{text:"Warm",color:"text-accent-secondary"}:e<G.hot?{text:"Hot",color:"text-signal-poor"}:{text:"Danger",color:"text-accent-danger"},o=r-a,n={cold:(G.cold-a)/o*100,normal:(G.normal-a)/o*100,warm:(G.warm-a)/o*100,hot:(G.hot-a)/o*100};return t.jsxs("div",{className:"space-y-1.5",children:[t.jsxs("div",{className:"flex justify-between items-baseline",children:[t.jsx("span",{className:"text-sm text-text-muted",children:s}),t.jsxs("div",{className:"flex items-baseline gap-2",children:[t.jsx("span",{className:"text-xs text-text-muted",children:c.text}),t.jsxs("span",{className:"text-sm font-mono tabular-nums",children:[t.jsx("span",{className:c.color,children:e.toFixed(1)}),t.jsx("span",{className:"text-text-primary",children:"Â°"})]})]})]}),t.jsxs("div",{className:"relative h-2 bg-white/[0.02] rounded-full overflow-hidden",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full transition-all duration-300 ease-out",style:{background:`linear-gradient(to right, ${[{pos:0,color:"var(--accent-tertiary)"},{pos:n.cold,color:"var(--accent-tertiary)"},{pos:n.cold,color:"var(--accent-success)"},{pos:n.normal,color:"var(--accent-success)"},{pos:n.normal,color:"var(--accent-secondary)"},{pos:n.warm,color:"var(--accent-secondary)"},{pos:n.warm,color:"var(--signal-poor)"},{pos:n.hot,color:"var(--signal-poor)"},{pos:n.hot,color:"var(--accent-danger)"},{pos:100,color:"var(--accent-danger)"}].map(e=>{const t=l>0?e.pos/l*100:0;return`${e.color} ${Math.min(t,100)}%`}).join(", ")})`,width:`${l}%`}}),t.jsx("div",{className:"absolute inset-0 flex items-center pointer-events-none",children:[{threshold:G.cold,color:"var(--accent-tertiary)"},{threshold:G.normal,color:"var(--accent-success)"},{threshold:G.warm,color:"var(--accent-secondary)"},{threshold:G.hot,color:"var(--signal-poor)"}].map(({threshold:e,color:s})=>{const l=(e-a)/(r-a)*100;return l<0||l>100?null:t.jsx("div",{className:"absolute w-px h-full",style:{left:`${l}%`,backgroundColor:s}},e)})})]})]})}),$=Math.floor(12e5/d.system);function O({payload:e}){return e?t.jsx("div",{className:"flex items-center gap-4 justify-center text-xs font-mono",children:e.map((e,s)=>t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),t.jsx("span",{className:"text-text-muted",children:e.value})]},s))}):null}function T({active:e,payload:s,label:a}){return e&&s&&0!==s.length?t.jsxs("div",{className:"bg-tooltip-bg border border-border-subtle rounded-lg px-3 py-2 text-sm shadow-xl",children:[t.jsx("div",{className:"font-medium text-text-primary mb-1",children:a}),s.map((e,s)=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),t.jsxs("span",{className:"text-text-muted",children:[e.name,":"]}),t.jsxs("span",{className:"text-text-primary tabular-nums",children:[e.value.toFixed(1),"%"]})]},s))]}):null}const U=e.memo(function({data:e,cpuColor:s,memoryColor:a,chartGridColors:r}){const l=function(e){const t=[],s=Math.max(0,$-e.length),a=Date.now(),r=d.system;for(let c=0;c<s;c++){const e=new Date(a-($-c)*r).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1});t.push({slot:c,time:e,cpu:null,memory:null})}const l=e.slice(-$);for(let c=0;c<l.length;c++){const e=l[c];t.push({slot:s+c,time:e.time.slice(0,5),cpu:e.cpu,memory:e.memory})}return t}(e),c=Math.floor($/4),o=s,n=a;return 0===e.length?t.jsx("div",{className:"flex items-center justify-center text-text-muted",style:{height:192},children:"Collecting data..."}):t.jsx("div",{style:{height:192},children:t.jsx(x,{width:"100%",height:192,minWidth:1,minHeight:1,children:t.jsxs(u,{data:l,children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"cpuGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:o,stopOpacity:.4}),t.jsx("stop",{offset:"95%",stopColor:o,stopOpacity:.05})]}),t.jsxs("linearGradient",{id:"memoryGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:n,stopOpacity:.4}),t.jsx("stop",{offset:"95%",stopColor:n,stopOpacity:.05})]})]}),t.jsx(p,{strokeDasharray:"3 3",stroke:r.grid,vertical:!1}),t.jsx(h,{dataKey:"time",axisLine:!1,tickLine:!1,tick:{fill:r.axisTick,fontSize:10,fontFamily:"'JetBrains Mono', monospace"},dy:8,interval:c}),t.jsx(j,{domain:[0,100],axisLine:!1,tickLine:!1,tick:{fill:r.axisTick,fontSize:10},dx:-4,width:40,tickFormatter:e=>`${e}%`}),t.jsx(y,{content:t.jsx(T,{})}),t.jsx(f,{content:t.jsx(O,{})}),t.jsx(g,{type:"stepAfter",dataKey:"cpu",name:"CPU",stroke:o,strokeWidth:2,fill:"url(#cpuGradient)",fillOpacity:.85,isAnimationActive:!1,connectNulls:!1}),t.jsx(g,{type:"stepAfter",dataKey:"memory",name:"Memory",stroke:n,strokeWidth:2,fill:"url(#memoryGradient)",fillOpacity:.85,isAnimationActive:!1,connectNulls:!1})]})})})});function A(){const[x,u]=e.useState(null),[p,h]=e.useState(!0),[j,y]=e.useState(null),[f,g]=e.useState(!1),M=o(),G=n(),O=k(),T=C(),A=O.chart3,P=O.chart4,R=e.useCallback(async()=>{try{const e=await i();e.success&&e.data?(u(e.data),y(null),G(e.data.cpu.usage_percent,e.data.memory.usage_percent,$)):y(e.error||"Failed to fetch hardware stats")}catch(e){y(e instanceof Error?e.message:"Failed to fetch hardware stats")}},[G]);return e.useEffect(()=>{let e=!0,t=null;if((async()=>{e&&(await R(),e&&h(!1))})(),"undefined"==typeof Worker){const t=setInterval(R,d.system);return()=>{e=!1,clearInterval(t)}}{const s=`\n        const interval = ${d.system};\n        setInterval(() => postMessage('tick'), interval);\n      `,a=new Blob([s],{type:"application/javascript"});t=new Worker(URL.createObjectURL(a)),t.onmessage=()=>{e&&R()}}return()=>{e=!1,t&&t.terminate()}},[R]),t.jsxs(v,{children:[t.jsx(b,{title:"System Stats",icon:t.jsx(a,{}),controls:t.jsxs("button",{onClick:async()=>{g(!0),await R(),g(!1)},disabled:f,className:"flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-bg-subtle hover:bg-bg-elevated rounded-lg transition-colors text-sm text-text-muted hover:text-text-primary self-start sm:self-auto",children:[t.jsx(s,{className:m("w-4 h-4",f&&"animate-spin")}),"Refresh"]})}),j&&t.jsx(N,{className:"border border-accent-danger/50 bg-accent-danger/10",children:t.jsx("p",{className:"text-accent-danger",children:j})}),p?t.jsx(N,{className:"p-12 text-center",children:t.jsx("div",{className:"animate-pulse text-text-muted",children:"Loading system stats..."})}):x?t.jsxs(t.Fragment,{children:[t.jsx(F,{template:"hero",children:t.jsxs(N,{children:[t.jsx(w,{icon:t.jsx(r,{}),title:"System Resources",subtitle:"20 minute rolling window",iconColor:"text-accent-tertiary",largeTitle:!0,actions:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"type-micro",children:"CPU"}),t.jsxs("span",{className:"type-data font-semibold tabular-nums",style:{color:A},children:[x.cpu.usage_percent.toFixed(0),"%"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"type-micro",children:"MEM"}),t.jsxs("span",{className:"type-data font-semibold tabular-nums",style:{color:P},children:[x.memory.usage_percent.toFixed(0),"%"]})]})]})}),t.jsx("div",{className:"flex-1 min-h-0",children:t.jsx(U,{data:M,cpuColor:A,memoryColor:P,chartGridColors:T})}),t.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-border-subtle text-xs text-text-muted flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("span",{children:[x.cpu.count," CPU cores"]}),x.cpu.load_avg&&t.jsxs("span",{className:"tabular-nums",children:["Load: ",x.cpu.load_avg["1min"].toFixed(2)," / ",x.cpu.load_avg["5min"].toFixed(2)," / ",x.cpu.load_avg["15min"].toFixed(2)]})]}),t.jsxs("span",{className:"tabular-nums",children:[(x.memory.used/1048576).toFixed(0)," / ",(x.memory.total/1048576).toFixed(0)," MB"]})]})]})}),t.jsxs(F,{template:"compact",children:[t.jsx(_,{span:12,md:6,children:t.jsxs(N,{children:[t.jsx(w,{icon:t.jsx(l,{}),title:"Disk Usage",subtitle:"Storage utilization",iconColor:"text-accent-success",largeTitle:!0}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-text-muted",children:"Usage"}),t.jsxs("span",{className:"text-text-primary font-medium",children:[x.disk.usage_percent.toFixed(1),"%"]})]}),t.jsx(S,{value:x.disk.usage_percent,color:"green"}),t.jsxs("div",{className:"flex justify-between text-sm mt-2",children:[t.jsxs("span",{className:"text-text-muted",children:[(x.disk.used/1073741824).toFixed(1)," GB used"]}),t.jsxs("span",{className:"text-text-muted",children:[(x.disk.total/1073741824).toFixed(1)," GB total"]})]})]})]})}),t.jsx(_,{span:12,md:6,children:t.jsxs(N,{children:[t.jsx(w,{icon:t.jsx(c,{}),title:"Temperature",subtitle:"System sensors",iconColor:"text-accent-secondary",largeTitle:!0}),x.temperatures&&Object.keys(x.temperatures).length>0?t.jsxs("div",{className:"space-y-2.5",children:[void 0!==x.temperatures.cpu_thermal&&t.jsx(L,{value:x.temperatures.cpu_thermal,label:"CPU",min:20,max:100}),Object.entries(x.temperatures).filter(([e])=>"cpu_thermal"!==e).slice(0,3).map(([e,s])=>t.jsx(L,{value:s,label:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),min:20,max:100},e))]}):t.jsxs("div",{className:"flex items-center justify-center h-20 text-text-muted text-sm",children:[t.jsx(r,{className:"w-4 h-4 mr-2"}),"No sensors available"]})]})})]})]}):null]})}export{A as default};
