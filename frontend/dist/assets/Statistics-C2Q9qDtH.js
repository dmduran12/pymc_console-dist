var e,t,n=Object.defineProperty,s=(e,t,s)=>((e,t,s)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);import{j as l,r as a,at as i,H as r,au as o,av as c,aw as u,ax as d,ay as m,az as h,aA as f,aB as p,o as x,aC as g,aD as b,aE as v,aF as y,aG as w,aH as j,a4 as k,J as N,h as M,aa as T,aI as S,aJ as C,a8 as _,p as P,C as A,T as R,aK as D,ak as E}from"./vendor-react-CUlQ5-Td.js";import{M as $,N as F,O as L,o as z,Q as W,S as H,z as B,J as O,d as G,f as V,e as I,u as Y,j as q,T as U,U as X,V as K,g as J,X as Z}from"./index-C1whtcFB.js";import{T as Q}from"./TimeRangeSelector-Pa-lVKQc.js";import{u as ee}from"./usePolling-BvmU-1bN.js";import{a as te,b as ne,u as se,c as le,d as ae,e as ie,f as re,s as oe,p as ce}from"./useThemeColors-8RSyMp_o.js";import{c as ue,R as de,d as me,L as he,C as fe,X as pe,Y as xe,T as ge,a as be}from"./recharts-7RsRrQtf.js";import{a as ve,c as ye,P as we,b as je}from"./PageLayout-CViR4hDG.js";import{C as ke}from"./CollisionExplorerModal-BU96fXkT.js";import{R as Ne,C as Me}from"./Grid-HJLNnEZz.js";import"./vendor-core-XI_xDZ-M.js";import"./deckgl-MTXp-Y3t.js";import"./leaflet-ChRwnWLk.js";function Te({children:e,centered:t,className:n}){return l.jsx("div",{className:ue("flex-1 min-h-0",t&&"flex items-center justify-center",n),children:e})}const Se=new class{constructor(){s(this,"caches",new Map),s(this,"lastRadioConfigHash","")}getBucketedStats(e,t,n,s){const l=this.extractRadioConfig(s),a=this.hashRadioConfig(l);a!==this.lastRadioConfigHash&&(this.caches.clear(),this.lastRadioConfigHash=a);const i=60*e/t,r=Math.floor(Date.now()/1e3),o=Math.floor(r/i)*i,c=o-60*e;let u=this.caches.get(e);return u&&u.bucketCount===t&&u.radioConfigHash===a&&Math.abs(u.endTime-o)<i?u&&(u.endTime!==o&&this.shiftTimeWindow(u,c,o),this.processPackets(u,n,l,!1)):(u=this.createCache(e,t,c,o,i,a),this.caches.set(e,u),this.processPackets(u,n,l,!0)),this.toOutputFormat(u)}clear(){this.caches.clear()}createCache(e,t,n,s,l,a){const i=()=>{const e=new Array(t);for(let n=0;n<t;n++)e[n]={count:0,airtime_ms:0,snr_sum:0,rssi_sum:0,signal_count:0};return e};return{minutes:e,bucketCount:t,startTime:n,endTime:s,bucketDuration:l,radioConfigHash:a,lastProcessedTimestamp:0,received:i(),transmitted:i(),forwarded:i(),dropped:i()}}processPackets(e,t,n,s){const{startTime:l,endTime:a,bucketDuration:i,bucketCount:r}=e;for(const o of t){const t=o.timestamp;if(t<l||t>a)continue;if(!s&&t<=e.lastProcessedTimestamp)continue;const c=Math.floor((t-l)/i);if(c<0||c>=r)continue;const u=$(o),d=F(u,{spreadingFactor:n.sf,bandwidthHz:n.bw,codingRate:n.cr,preambleLength:n.preamble}),m=o.packet_origin;"tx_local"===m?(e.transmitted[c].count++,e.transmitted[c].airtime_ms+=d):"tx_forward"===m||o.transmitted?(e.forwarded[c].count++,e.forwarded[c].airtime_ms+=d):o.drop_reason&&(e.dropped[c].count++,e.dropped[c].airtime_ms+=d),"tx_local"!==m&&(e.received[c].count++,e.received[c].airtime_ms+=d,e.received[c].snr_sum+=o.snr||0,e.received[c].rssi_sum+=o.rssi||0,e.received[c].signal_count++),t>e.lastProcessedTimestamp&&(e.lastProcessedTimestamp=t)}}shiftTimeWindow(e,t,n){const{bucketDuration:s,bucketCount:l}=e,a=Math.round((n-e.endTime)/s);if(0!==a){if(a>0&&a<l){for(let t=0;t<l-a;t++)e.received[t]=e.received[t+a],e.transmitted[t]=e.transmitted[t+a],e.forwarded[t]=e.forwarded[t+a],e.dropped[t]=e.dropped[t+a];for(let t=l-a;t<l;t++)e.received[t]={count:0,airtime_ms:0,snr_sum:0,rssi_sum:0,signal_count:0},e.transmitted[t]={count:0,airtime_ms:0,snr_sum:0,rssi_sum:0,signal_count:0},e.forwarded[t]={count:0,airtime_ms:0,snr_sum:0,rssi_sum:0,signal_count:0},e.dropped[t]={count:0,airtime_ms:0,snr_sum:0,rssi_sum:0,signal_count:0}}else{const s=this.createCache(e.minutes,e.bucketCount,t,n,e.bucketDuration,e.radioConfigHash);e.received=s.received,e.transmitted=s.transmitted,e.forwarded=s.forwarded,e.dropped=s.dropped,e.lastProcessedTimestamp=0}e.startTime=t,e.endTime=n}}toOutputFormat(e){const{startTime:t,bucketDuration:n,bucketCount:s}=e,l=e=>{const l=new Array(s);for(let a=0;a<s;a++){const s=e[a],i=t+a*n;l[a]={bucket:a,start:i,end:i+n,count:s.count,airtime_ms:s.airtime_ms,avg_snr:s.signal_count>0?s.snr_sum/s.signal_count:0,avg_rssi:s.signal_count>0?s.rssi_sum/s.signal_count:0}}return l};return{time_range_minutes:e.minutes,bucket_count:e.bucketCount,bucket_duration_seconds:e.bucketDuration,start_time:e.startTime,end_time:e.endTime,received:l(e.received),transmitted:l(e.transmitted),forwarded:l(e.forwarded),dropped:l(e.dropped)}}extractRadioConfig(e){var t;const n=null==(t=null==e?void 0:e.config)?void 0:t.radio;return{sf:(null==n?void 0:n.spreading_factor)??10,bw:(null==n?void 0:n.bandwidth)??25e4,cr:(null==n?void 0:n.coding_rate)??5,preamble:(null==n?void 0:n.preamble_length)??8}}hashRadioConfig(e){return`${e.sf}-${e.bw}-${e.cr}-${e.preamble}`}},Ce=3e5;function _e(e,t,n,s=!0,l=60){const a=[...e].sort((e,t)=>e.start-t.start),i=[...t].sort((e,t)=>e.start-t.start),r=new Map(e.map(e=>[e.start,e])),o=new Map(t.map(e=>[e.start,e])),c=Array.from(new Set([...r.keys(),...o.keys()])).sort((e,t)=>e-t);if(0===c.length)return[];const u=new Float64Array(a.length+1),d=new Float64Array(i.length+1),m=new Float64Array(a.length),h=new Float64Array(i.length);for(let x=0;x<a.length;x++)u[x+1]=u[x]+a[x].airtime_ms,m[x]=a[x].start;for(let x=0;x<i.length;x++)d[x+1]=d[x]+i[x].airtime_ms,h[x]=i[x].start;const f=(e,t)=>{let n=0,s=e.length;for(;n<s;){const l=n+s>>>1;e[l]<t?n=l+1:s=l}return n},p=c.map(e=>{const t=e-300,n=f(m,t),s=f(m,e+1),l=u[s]-u[n],a=f(h,t),i=f(h,e+1),r=d[i]-d[a];return{timestamp:e,rxUtilW:l/Ce*100,txUtilW:r/Ce*100}});return s&&p.length>1?function(e,t=60){if(0===e.length)return[];const n=1-Math.pow(.5,1/t),s=Math.min(e.length,Math.max(10,Math.floor(t/3)));let l=0,a=0;for(let i=0;i<s;i++)l+=e[i].rxUtilW,a+=e[i].txUtilW;return l/=s,a/=s,e.map(e=>(l=n*e.rxUtilW+(1-n)*l,a=n*e.txUtilW+(1-n)*a,{...e,rxRolling:l,txRolling:a}))}(p,l):p}const Pe="u-off",Ae="u-label",Re="width",De="height",Ee="top",$e="bottom",Fe="left",Le="right",ze="#000",We=ze+"0",He="mousemove",Be="mousedown",Oe="mouseup",Ge="mouseenter",Ve="mouseleave",Ie="dblclick",Ye="change",qe="dppxchange",Ue="--",Xe="undefined"!=typeof window,Ke=Xe?document:null,Je=Xe?window:null,Ze=Xe?navigator:null;let Qe,et;function tt(e,t){if(null!=t){let n=e.classList;!n.contains(t)&&n.add(t)}}function nt(e,t){let n=e.classList;n.contains(t)&&n.remove(t)}function st(e,t,n){e.style[t]=n+"px"}function lt(e,t,n,s){let l=Ke.createElement(e);return null!=t&&tt(l,t),null!=n&&n.insertBefore(l,s),l}function at(e,t){return lt("div",e,t)}const it=new WeakMap;function rt(e,t,n,s,l){let a="translate("+t+"px,"+n+"px)";a!=it.get(e)&&(e.style.transform=a,it.set(e,a),t<0||n<0||t>s||n>l?tt(e,Pe):nt(e,Pe))}const ot=new WeakMap;function ct(e,t,n){let s=t+n;s!=ot.get(e)&&(ot.set(e,s),e.style.background=t,e.style.borderColor=n)}const ut=new WeakMap;function dt(e,t,n,s){let l=t+""+n;l!=ut.get(e)&&(ut.set(e,l),e.style.height=n+"px",e.style.width=t+"px",e.style.marginLeft=s?-t/2+"px":0,e.style.marginTop=s?-n/2+"px":0)}const mt={passive:!0},ht={...mt,capture:!0};function ft(e,t,n,s){t.addEventListener(e,n,s?ht:mt)}function pt(e,t,n,s){t.removeEventListener(e,n,mt)}function xt(e,t,n,s){let l;n=n||0;let a=(s=s||t.length-1)<=2147483647;for(;s-n>1;)l=a?n+s>>1:$t((n+s)/2),t[l]<e?n=l:s=l;return e-t[n]<=t[s]-e?n:s}function gt(e){return(t,n,s)=>{let l=-1,a=-1;for(let i=n;i<=s;i++)if(e(t[i])){l=i;break}for(let i=s;i>=n;i--)if(e(t[i])){a=i;break}return[l,a]}}Xe&&function e(){let t=devicePixelRatio;Qe!=t&&(Qe=t,et&&pt(Ye,et,e),et=matchMedia(`(min-resolution: ${Qe-.001}dppx) and (max-resolution: ${Qe+.001}dppx)`),ft(Ye,et,e),Je.dispatchEvent(new CustomEvent(qe)))}();const bt=e=>null!=e,vt=e=>null!=e&&e>0,yt=gt(bt),wt=gt(vt);function jt(e,t,n,s){let l=Bt(e),a=Bt(t);e==t&&(-1==l?(e*=n,t/=n):(e/=n,t*=n));let i=10==n?Ot:Gt,r=1==a?Lt:$t,o=(1==l?$t:Lt)(i(Et(e))),c=r(i(Et(t))),u=Ht(n,o),d=Ht(n,c);return 10==n&&(o<0&&(u=rn(u,-o)),c<0&&(d=rn(d,-c))),s||2==n?(e=u*l,t=d*a):(e=an(e,u),t=ln(t,d)),[e,t]}function kt(e,t,n,s){let l=jt(e,t,n,s);return 0==e&&(l[0]=0),0==t&&(l[1]=0),l}const Nt={mode:3,pad:.1},Mt={pad:0,soft:null,mode:0},Tt={min:Mt,max:Mt};function St(e,t,n,s){return gn(n)?_t(e,t,n):(Mt.pad=n,Mt.soft=s?0:null,Mt.mode=s?3:0,_t(e,t,Tt))}function Ct(e,t){return null==e?t:e}function _t(e,t,n){let s=n.min,l=n.max,a=Ct(s.pad,0),i=Ct(l.pad,0),r=Ct(s.hard,-It),o=Ct(l.hard,It),c=Ct(s.soft,It),u=Ct(l.soft,-It),d=Ct(s.mode,0),m=Ct(l.mode,0),h=t-e,f=Ot(h),p=Wt(Et(e),Et(t)),x=Ot(p),g=Et(x-f);(h<1e-24||g>10)&&(h=0,0!=e&&0!=t||(h=1e-24,2==d&&c!=It&&(a=0),2==m&&u!=-It&&(i=0)));let b=h||p||1e3,v=Ot(b),y=Ht(10,$t(v)),w=rn(an(e-b*(0==h?0==e?.1:1:a),y/10),24),j=e>=c&&(1==d||3==d&&w<=c||2==d&&w>=c)?c:It,k=Wt(r,w<j&&e>=j?j:zt(j,w)),N=rn(ln(t+b*(0==h?0==t?.1:1:i),y/10),24),M=t<=u&&(1==m||3==m&&N>=u||2==m&&N<=u)?u:-It,T=zt(o,N>M&&t<=M?M:Wt(M,N));return k==T&&0==k&&(T=100),[k,T]}const Pt=new Intl.NumberFormat(Xe?Ze.language:"en-US"),At=e=>Pt.format(e),Rt=Math,Dt=Rt.PI,Et=Rt.abs,$t=Rt.floor,Ft=Rt.round,Lt=Rt.ceil,zt=Rt.min,Wt=Rt.max,Ht=Rt.pow,Bt=Rt.sign,Ot=Rt.log10,Gt=Rt.log2,Vt=(e,t=1)=>Rt.asinh(e/t),It=1/0;function Yt(e){return 1+(0|Ot((e^e>>31)-(e>>31)))}function qt(e,t,n){return zt(Wt(e,t),n)}function Ut(e){return"function"==typeof e}function Xt(e){return Ut(e)?e:()=>e}const Kt=e=>e,Jt=(e,t)=>t,Zt=e=>null,Qt=e=>!0,en=(e,t)=>e==t,tn=/\.\d*?(?=9{6,}|0{6,})/gm,nn=e=>{if(pn(e)||on.has(e))return e;const t=`${e}`,n=t.match(tn);if(null==n)return e;let s=n[0].length-1;if(-1!=t.indexOf("e-")){let[e,n]=t.split("e");return+`${nn(e)}e${n}`}return rn(e,s)};function sn(e,t){return nn(rn(nn(e/t))*t)}function ln(e,t){return nn(Lt(nn(e/t))*t)}function an(e,t){return nn($t(nn(e/t))*t)}function rn(e,t=0){if(pn(e))return e;let n=10**t,s=e*n*(1+Number.EPSILON);return Ft(s)/n}const on=new Map;function cn(e){return((""+e).split(".")[1]||"").length}function un(e,t,n,s){let l=[],a=s.map(cn);for(let i=t;i<n;i++){let t=Et(i),n=rn(Ht(e,i),t);for(let r=0;r<s.length;r++){let o=10==e?+`${s[r]}e${i}`:s[r]*n,c=(i>=0?0:t)+(i>=a[r]?0:a[r]),u=10==e?o:rn(o,c);l.push(u),on.set(u,c)}}return l}const dn={},mn=[],hn=[null,null],fn=Array.isArray,pn=Number.isInteger;function xn(e){return"string"==typeof e}function gn(e){let t=!1;if(null!=e){let n=e.constructor;t=null==n||n==Object}return t}function bn(e){return null!=e&&"object"==typeof e}const vn=Object.getPrototypeOf(Uint8Array),yn="__proto__";function wn(e,t=gn){let n;if(fn(e)){let s=e.find(e=>null!=e);if(fn(s)||t(s)){n=Array(e.length);for(let s=0;s<e.length;s++)n[s]=wn(e[s],t)}else n=e.slice()}else if(e instanceof vn)n=e.slice();else if(t(e)){n={};for(let s in e)s!=yn&&(n[s]=wn(e[s],t))}else n=e;return n}function jn(e){let t=arguments;for(let n=1;n<t.length;n++){let s=t[n];for(let t in s)t!=yn&&(gn(e[t])?jn(e[t],wn(s[t])):e[t]=wn(s[t]))}return e}function kn(e,t,n){for(let s,l=0,a=-1;l<t.length;l++){let i=t[l];if(i>a){for(s=i-1;s>=0&&null==e[s];)e[s--]=null;for(s=i+1;s<n&&null==e[s];)e[a=s++]=null}}}const Nn="undefined"==typeof queueMicrotask?e=>Promise.resolve().then(e):queueMicrotask,Mn=["January","February","March","April","May","June","July","August","September","October","November","December"],Tn=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Sn(e){return e.slice(0,3)}const Cn=Tn.map(Sn),_n=Mn.map(Sn),Pn={MMMM:Mn,MMM:_n,WWWW:Tn,WWW:Cn};function An(e){return(e<10?"0":"")+e}const Rn={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,t)=>t.MMMM[e.getMonth()],MMM:(e,t)=>t.MMM[e.getMonth()],MM:e=>An(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>An(e.getDate()),D:e=>e.getDate(),WWWW:(e,t)=>t.WWWW[e.getDay()],WWW:(e,t)=>t.WWW[e.getDay()],HH:e=>An(e.getHours()),H:e=>e.getHours(),h:e=>{let t=e.getHours();return 0==t?12:t>12?t-12:t},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>An(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>An(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>{return((t=e.getMilliseconds())<10?"00":t<100?"0":"")+t;var t}};function Dn(e,t){t=t||Pn;let n,s=[],l=/\{([a-z]+)\}|[^{]+/gi;for(;n=l.exec(e);)s.push("{"==n[0][0]?Rn[n[1]]:n[0]);return e=>{let n="";for(let l=0;l<s.length;l++)n+="string"==typeof s[l]?s[l]:s[l](e,t);return n}}const En=(new Intl.DateTimeFormat).resolvedOptions().timeZone,$n=e=>e%1==0,Fn=[1,2,2.5,5],Ln=un(10,-32,0,Fn),zn=un(10,0,32,Fn),Wn=zn.filter($n),Hn=Ln.concat(zn),Bn="{YYYY}",On="\n"+Bn,Gn="{M}/{D}",Vn="\n"+Gn,In=Vn+"/{YY}",Yn="{aa}",qn="{h}:{mm}"+Yn,Un="\n"+qn,Xn=":{ss}",Kn=null;function Jn(e){let t=1e3*e,n=60*t,s=60*n,l=24*s,a=30*l,i=365*l;return[(1==e?un(10,0,3,Fn).filter($n):un(10,-3,0,Fn)).concat([t,5*t,10*t,15*t,30*t,n,5*n,10*n,15*n,30*n,s,2*s,3*s,4*s,6*s,8*s,12*s,l,2*l,3*l,4*l,5*l,6*l,7*l,8*l,9*l,10*l,15*l,a,2*a,3*a,4*a,6*a,i,2*i,5*i,10*i,25*i,50*i,100*i]),[[i,Bn,Kn,Kn,Kn,Kn,Kn,Kn,1],[28*l,"{MMM}",On,Kn,Kn,Kn,Kn,Kn,1],[l,Gn,On,Kn,Kn,Kn,Kn,Kn,1],[s,"{h}"+Yn,In,Kn,Vn,Kn,Kn,Kn,1],[n,qn,In,Kn,Vn,Kn,Kn,Kn,1],[t,Xn,In+" "+qn,Kn,Vn+" "+qn,Kn,Un,Kn,1],[e,Xn+".{fff}",In+" "+qn,Kn,Vn+" "+qn,Kn,Un,Kn,1]],function(t){return(r,o,c,u,d,m)=>{let h=[],f=d>=i,p=d>=a&&d<i,x=t(c),g=rn(x*e,3),b=is(x.getFullYear(),f?0:x.getMonth(),p||f?1:x.getDate()),v=rn(b*e,3);if(p||f){let n=p?d/a:0,s=f?d/i:0,l=g==v?g:rn(is(b.getFullYear()+s,b.getMonth()+n,1)*e,3),r=new Date(Ft(l/e)),o=r.getFullYear(),c=r.getMonth();for(let a=0;l<=u;a++){let i=is(o+s*a,c+n*a,1),r=i-t(rn(i*e,3));l=rn((+i+r)*e,3),l<=u&&h.push(l)}}else{let a=d>=l?l:d,i=v+($t(c)-$t(g))+ln(g-v,a);h.push(i);let f=t(i),p=f.getHours()+f.getMinutes()/n+f.getSeconds()/s,x=d/s,b=m/r.axes[o]._space;for(;i=rn(i+d,1==e?0:3),!(i>u);)if(x>1){let e=$t(rn(p+x,6))%24,n=t(i).getHours()-e;n>1&&(n=-1),i-=n*s,p=(p+x)%24,rn((i-h[h.length-1])/d,3)*b>=.7&&h.push(i)}else h.push(i)}return h}}]}const[Zn,Qn,es]=Jn(1),[ts,ns,ss]=Jn(.001);function ls(e,t){return e.map(e=>e.map((n,s)=>0==s||8==s||null==n?n:t(1==s||0==e[8]?n:e[1]+n)))}function as(e,t){return(n,s,l,a,i)=>{let r,o,c,u,d,m,h=t.find(e=>i>=e[0])||t[t.length-1];return s.map(t=>{let n=e(t),s=n.getFullYear(),l=n.getMonth(),a=n.getDate(),i=n.getHours(),f=n.getMinutes(),p=n.getSeconds(),x=s!=r&&h[2]||l!=o&&h[3]||a!=c&&h[4]||i!=u&&h[5]||f!=d&&h[6]||p!=m&&h[7]||h[1];return r=s,o=l,c=a,u=i,d=f,m=p,x(n)})}}function is(e,t,n){return new Date(e,t,n)}function rs(e,t){return t(e)}function os(e,t){return(n,s,l,a)=>null==a?Ue:t(e(s))}un(2,-53,53,[1]);const cs={show:!0,live:!0,isolate:!1,mount:()=>{},markers:{show:!0,width:2,stroke:function(e,t){let n=e.series[t];return n.width?n.stroke(e,t):n.points.width?n.points.stroke(e,t):null},fill:function(e,t){return e.series[t].fill(e,t)},dash:"solid"},idx:null,idxs:null,values:[]},us=[0,0];function ds(e,t,n,s=!0){return e=>{0==e.button&&(!s||e.target==t)&&n(e)}}function ms(e,t,n,s=!0){return e=>{(!s||e.target==t)&&n(e)}}const hs={show:!0,x:!0,y:!0,lock:!1,move:function(e,t,n){return us[0]=t,us[1]=n,us},points:{one:!1,show:function(e,t){let n=e.cursor.points,s=at(),l=n.size(e,t);st(s,Re,l),st(s,De,l);let a=l/-2;st(s,"marginLeft",a),st(s,"marginTop",a);let i=n.width(e,t,l);return i&&st(s,"borderWidth",i),s},size:function(e,t){return e.series[t].points.size},width:0,stroke:function(e,t){let n=e.series[t].points;return n._stroke||n._fill},fill:function(e,t){let n=e.series[t].points;return n._fill||n._stroke}},bind:{mousedown:ds,mouseup:ds,click:ds,dblclick:ds,mousemove:ms,mouseleave:ms,mouseenter:ms},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,click:(e,t)=>{t.stopPropagation(),t.stopImmediatePropagation()},_x:!1,_y:!1},focus:{dist:(e,t,n,s,l)=>s-l,prox:-1,bias:0},hover:{skip:[void 0],prox:null,bias:0},left:-10,top:-10,idx:null,dataIdx:null,idxs:null,event:null},fs={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},ps=jn({},fs,{filter:Jt}),xs=jn({},ps,{size:10}),gs=jn({},fs,{show:!1}),bs='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',vs="bold "+bs,ys={show:!0,scale:"x",stroke:ze,space:50,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:vs,side:2,grid:ps,ticks:xs,border:gs,font:bs,lineGap:1.5,rotate:0},ws={show:!0,scale:"x",auto:!1,sorted:1,min:It,max:-It,idxs:[]};function js(e,t,n,s,l){return t.map(e=>null==e?"":At(e))}function ks(e,t,n,s,l,a,i){let r=[],o=on.get(l)||0;for(let c=n=i?n:rn(ln(n,l),o);c<=s;c=rn(c+l,o))r.push(Object.is(c,-0)?0:c);return r}function Ns(e,t,n,s,l,a,i){const r=[],o=e.scales[e.axes[t].scale].log,c=$t((10==o?Ot:Gt)(n));l=Ht(o,c),10==o&&(l=Hn[xt(l,Hn)]);let u=n,d=l*o;10==o&&(d=Hn[xt(d,Hn)]);do{r.push(u),u+=l,10!=o||on.has(u)||(u=rn(u,on.get(l))),u>=d&&(d=(l=u)*o,10==o&&(d=Hn[xt(d,Hn)]))}while(u<=s);return r}function Ms(e,t,n,s,l,a,i){let r=e.scales[e.axes[t].scale].asinh,o=s>r?Ns(e,t,Wt(r,n),s,l):[r],c=s>=0&&n<=0?[0]:[];return(n<-r?Ns(e,t,Wt(r,-s),-n,l):[r]).reverse().map(e=>-e).concat(c,o)}const Ts=/./,Ss=/[12357]/,Cs=/[125]/,_s=/1/,Ps=(e,t,n,s)=>e.map((e,l)=>4==t&&0==e||l%s==0&&n.test(e.toExponential()[e<0?1:0])?e:null);function As(e,t,n,s,l){let a=e.axes[n],i=a.scale,r=e.scales[i],o=e.valToPos,c=a._space,u=o(10,i),d=o(9,i)-u>=c?Ts:o(7,i)-u>=c?Ss:o(5,i)-u>=c?Cs:_s;if(d==_s){let e=Et(o(1,i)-u);if(e<c)return Ps(t.slice().reverse(),r.distr,d,Lt(c/e)).reverse()}return Ps(t,r.distr,d,1)}function Rs(e,t,n,s,l){let a=e.axes[n],i=a.scale,r=a._space,o=e.valToPos,c=Et(o(1,i)-o(2,i));return c<r?Ps(t.slice().reverse(),3,Ts,Lt(r/c)).reverse():t}function Ds(e,t,n,s){return null==s?Ue:null==t?"":At(t)}const Es={show:!0,scale:"y",stroke:ze,space:30,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:vs,side:3,grid:ps,ticks:xs,border:gs,font:bs,lineGap:1.5,rotate:0},$s={scale:null,auto:!0,sorted:0,min:It,max:-It},Fs=(e,t,n,s,l)=>l,Ls={show:!0,auto:!0,sorted:0,gaps:Fs,alpha:1,facets:[jn({},$s,{scale:"x"}),jn({},$s,{scale:"y"})]},zs={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:Fs,alpha:1,points:{show:function(e,t){let{scale:n,idxs:s}=e.series[0],l=e._data[0],a=e.valToPos(l[s[0]],n,!0),i=e.valToPos(l[s[1]],n,!0),r=Et(i-a)/(e.series[t].points.space*Qe);return s[1]-s[0]<=r},filter:null},values:null,min:It,max:-It,idxs:[],path:null,clip:null};function Ws(e,t,n,s,l){return n/10}const Hs={time:!0,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},Bs=jn({},Hs,{time:!1,ori:1}),Os={};function Gs(e,t){let n=Os[e];return n||(n={key:e,plots:[],sub(e){n.plots.push(e)},unsub(e){n.plots=n.plots.filter(t=>t!=e)},pub(e,t,s,l,a,i,r){for(let o=0;o<n.plots.length;o++)n.plots[o]!=t&&n.plots[o].pub(e,t,s,l,a,i,r)}},null!=e&&(Os[e]=n)),n}function Vs(e,t,n){const s=e.mode,l=e.series[t],a=2==s?e._data[t]:e._data,i=e.scales,r=e.bbox;let o=a[0],c=2==s?a[1]:a[t],u=2==s?i[l.facets[0].scale]:i[e.series[0].scale],d=2==s?i[l.facets[1].scale]:i[l.scale],m=r.left,h=r.top,f=r.width,p=r.height,x=e.valToPosH,g=e.valToPosV;return 0==u.ori?n(l,o,c,u,d,x,g,m,h,f,p,Zs,el,nl,ll,il):n(l,o,c,u,d,g,x,h,m,p,f,Qs,tl,sl,al,rl)}function Is(e,t){let n=0,s=0,l=Ct(e.bands,mn);for(let a=0;a<l.length;a++){let e=l[a];e.series[0]==t?n=e.dir:e.series[1]==t&&(1==e.dir?s|=1:s|=2)}return[n,1==s?-1:2==s?1:3==s?2:0]}function Ys(e,t,n,s,l){let a=e.mode,i=e.series[t],r=2==a?i.facets[1].scale:i.scale,o=e.scales[r];return-1==l?o.min:1==l?o.max:3==o.distr?1==o.dir?o.min:o.max:0}function qs(e,t,n,s,l,a){return Vs(e,t,(e,t,i,r,o,c,u,d,m,h,f)=>{let p=e.pxRound;const x=r.dir*(0==r.ori?1:-1),g=0==r.ori?el:tl;let b,v;1==x?(b=n,v=s):(b=s,v=n);let y=p(c(t[b],r,h,d)),w=p(u(i[b],o,f,m)),j=p(c(t[v],r,h,d)),k=p(u(1==a?o.max:o.min,o,f,m)),N=new Path2D(l);return g(N,j,k),g(N,y,k),g(N,y,w),N})}function Us(e,t,n,s,l,a){let i=null;if(e.length>0){i=new Path2D;const r=0==t?nl:sl;let o=n;for(let t=0;t<e.length;t++){let n=e[t];if(n[1]>n[0]){let e=n[0]-o;e>0&&r(i,o,s,e,s+a),o=n[1]}}let c=n+l-o,u=10;c>0&&r(i,o,s-u/2,c,s+a+u)}return i}function Xs(e,t,n,s,l,a,i){let r=[],o=e.length;for(let c=1==l?n:s;c>=n&&c<=s;c+=l)if(null===t[c]){let u=c,d=c;if(1==l)for(;++c<=s&&null===t[c];)d=c;else for(;--c>=n&&null===t[c];)d=c;let m=a(e[u]),h=d==u?m:a(e[d]),f=u-l;m=i<=0&&f>=0&&f<o?a(e[f]):m;let p=d+l;h=i>=0&&p>=0&&p<o?a(e[p]):h,h>=m&&r.push([m,h])}return r}function Ks(e){return 0==e?Kt:1==e?Ft:t=>sn(t,e)}function Js(e){let t=0==e?Zs:Qs,n=0==e?(e,t,n,s,l,a)=>{e.arcTo(t,n,s,l,a)}:(e,t,n,s,l,a)=>{e.arcTo(n,t,l,s,a)},s=0==e?(e,t,n,s,l)=>{e.rect(t,n,s,l)}:(e,t,n,s,l)=>{e.rect(n,t,l,s)};return(e,l,a,i,r,o=0,c=0)=>{0==o&&0==c?s(e,l,a,i,r):(o=zt(o,i/2,r/2),c=zt(c,i/2,r/2),t(e,l+o,a),n(e,l+i,a,l+i,a+r,o),n(e,l+i,a+r,l,a+r,c),n(e,l,a+r,l,a,c),n(e,l,a,l+i,a,o),e.closePath())}}const Zs=(e,t,n)=>{e.moveTo(t,n)},Qs=(e,t,n)=>{e.moveTo(n,t)},el=(e,t,n)=>{e.lineTo(t,n)},tl=(e,t,n)=>{e.lineTo(n,t)},nl=Js(0),sl=Js(1),ll=(e,t,n,s,l,a)=>{e.arc(t,n,s,l,a)},al=(e,t,n,s,l,a)=>{e.arc(n,t,s,l,a)},il=(e,t,n,s,l,a,i)=>{e.bezierCurveTo(t,n,s,l,a,i)},rl=(e,t,n,s,l,a,i)=>{e.bezierCurveTo(n,t,l,s,i,a)};function ol(e){return(e,t,n,s,l)=>Vs(e,t,(t,a,i,r,o,c,u,d,m,h,f)=>{let p,x,{pxRound:g,points:b}=t;0==r.ori?(p=Zs,x=ll):(p=Qs,x=al);const v=rn(b.width*Qe,3);let y=(b.size-b.width)/2*Qe,w=rn(2*y,3),j=new Path2D,k=new Path2D,{left:N,top:M,width:T,height:S}=e.bbox;nl(k,N-w,M-w,T+2*w,S+2*w);const C=e=>{if(null!=i[e]){let t=g(c(a[e],r,h,d)),n=g(u(i[e],o,f,m));p(j,t+y,n),x(j,t,n,y,0,2*Dt)}};if(l)l.forEach(C);else for(let e=n;e<=s;e++)C(e);return{stroke:v>0?j:null,fill:j,clip:k,flags:3}})}function cl(e){return(t,n,s,l,a,i)=>{s!=l&&(a!=s&&i!=s&&e(t,n,s),a!=l&&i!=l&&e(t,n,l),e(t,n,i))}}const ul=cl(el),dl=cl(tl);function ml(e){const t=Ct(null==e?void 0:e.alignGaps,0);return(e,n,s,l)=>Vs(e,n,(a,i,r,o,c,u,d,m,h,f,p)=>{[s,l]=yt(r,s,l);let x,g,b=a.pxRound,v=e=>b(u(e,o,f,m)),y=e=>b(d(e,c,p,h));0==o.ori?(x=el,g=ul):(x=tl,g=dl);const w=o.dir*(0==o.ori?1:-1),j={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:1},k=j.stroke;let N=!1;if(l-s>=4*f){let t,n,a,c=t=>e.posToVal(t,o.key,!0),u=null,d=null,m=v(i[1==w?s:l]),h=v(i[s]),f=v(i[l]),p=c(1==w?h+1:f-1);for(let e=1==w?s:l;e>=s&&e<=l;e+=w){let s=i[e],l=(1==w?s<p:s>p)?m:v(s),a=r[e];l==m?null!=a?(n=a,null==u?(x(k,l,y(n)),t=u=d=n):n<u?u=n:n>d&&(d=n)):null===a&&(N=!0):(null!=u&&g(k,m,y(u),y(d),y(t),y(n)),null!=a?(n=a,x(k,l,y(n)),u=d=t=n):(u=d=null,null===a&&(N=!0)),m=l,p=c(m+w))}null!=u&&u!=d&&a!=m&&g(k,m,y(u),y(d),y(t),y(n))}else for(let e=1==w?s:l;e>=s&&e<=l;e+=w){let t=r[e];null===t?N=!0:null!=t&&x(k,v(i[e]),y(t))}let[M,T]=Is(e,n);if(null!=a.fill||0!=M){let t=j.fill=new Path2D(k),r=y(a.fillTo(e,n,a.min,a.max,M)),o=v(i[s]),c=v(i[l]);-1==w&&([c,o]=[o,c]),x(t,c,r),x(t,o,r)}if(!a.spanGaps){let c=[];N&&c.push(...Xs(i,r,s,l,w,v,t)),j.gaps=c=a.gaps(e,n,s,l,c),j.clip=Us(c,o.ori,m,h,f,p)}return 0!=T&&(j.band=2==T?[qs(e,n,s,l,k,-1),qs(e,n,s,l,k,1)]:qs(e,n,s,l,k,T)),j})}function hl(e,t,n,s,l,a,i=It){if(e.length>1){let r=null;for(let o=0,c=1/0;o<e.length;o++)if(void 0!==t[o]){if(null!=r){let t=Et(e[o]-e[r]);t<c&&(c=t,i=Et(n(e[o],s,l,a)-n(e[r],s,l,a)))}r=o}}return i}function fl(e,t,n,s,l,a){const i=e.length;if(i<2)return null;const r=new Path2D;if(n(r,e[0],t[0]),2==i)s(r,e[1],t[1]);else{let n=Array(i),s=Array(i-1),a=Array(i-1),o=Array(i-1);for(let l=0;l<i-1;l++)a[l]=t[l+1]-t[l],o[l]=e[l+1]-e[l],s[l]=a[l]/o[l];n[0]=s[0];for(let e=1;e<i-1;e++)0===s[e]||0===s[e-1]||s[e-1]>0!=s[e]>0?n[e]=0:(n[e]=3*(o[e-1]+o[e])/((2*o[e]+o[e-1])/s[e-1]+(o[e]+2*o[e-1])/s[e]),isFinite(n[e])||(n[e]=0));n[i-1]=s[i-2];for(let c=0;c<i-1;c++)l(r,e[c]+o[c]/3,t[c]+n[c]*o[c]/3,e[c+1]-o[c]/3,t[c+1]-n[c+1]*o[c]/3,e[c+1],t[c+1])}return r}const pl=new Set;function xl(){for(let e of pl)e.syncRect(!0)}Xe&&(ft("resize",Je,xl),ft("scroll",Je,xl,!0),ft(qe,Je,()=>{Pl.pxRatio=Qe}));const gl=ml(),bl=ol();function vl(e,t,n,s){return(s?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map((e,s)=>yl(e,s,t,n))}function yl(e,t,n,s){return jn({},0==t?n:s,e)}function wl(e,t,n){return null==t?hn:[t,n]}const jl=wl;function kl(e,t,n){return null==t?hn:St(t,n,.1,!0)}function Nl(e,t,n,s){return null==t?hn:jt(t,n,e.scales[s].log,!1)}const Ml=Nl;function Tl(e,t,n,s){return null==t?hn:kt(t,n,e.scales[s].log,!1)}const Sl=Tl;function Cl(e){let t,n;return[e=e.replace(/(\d+)px/,(e,s)=>(t=Ft((n=+s)*Qe))+"px"),t,n]}function _l(e){e.show&&[e.font,e.labelFont].forEach(e=>{let t=rn(e[2]*Qe,1);e[0]=e[0].replace(/[0-9.]+px/,t+"px"),e[1]=t})}function Pl(e,t,n){const s={mode:Ct(e.mode,1)},l=s.mode;function a(e,t,n,s){let l=t.valToPct(e);return s+n*(-1==t.dir?1-l:l)}function i(e,t,n,s){let l=t.valToPct(e);return s+n*(-1==t.dir?l:1-l)}function r(e,t,n,s){return 0==t.ori?a(e,t,n,s):i(e,t,n,s)}s.valToPosH=a,s.valToPosV=i;let o=!1;s.status=0;const c=s.root=at("uplot");null!=e.id&&(c.id=e.id),tt(c,e.class),e.title&&(at("u-title",c).textContent=e.title);const u=lt("canvas"),d=s.ctx=u.getContext("2d"),m=at("u-wrap",c);ft("click",m,e=>{e.target===f&&(us!=Xn||ds!=Kn)&&Ss.click(s,e)},!0);const h=s.under=at("u-under",m);m.appendChild(u);const f=s.over=at("u-over",m),p=+Ct((e=wn(e)).pxAlign,1),x=Ks(p);(e.plugins||[]).forEach(t=>{t.opts&&(e=t.opts(s,e)||e)});const g=e.ms||.001,b=s.series=1==l?vl(e.series||[],ws,zs,!1):(v=e.series||[null],y=Ls,v.map((e,t)=>0==t?{}:jn({},y,e)));var v,y;const w=s.axes=vl(e.axes||[],ys,Es,!0),j=s.scales={},k=s.bands=e.bands||[];k.forEach(e=>{e.fill=Xt(e.fill||null),e.dir=Ct(e.dir,-1)});const N=2==l?b[1].facets[0].scale:b[0].scale,M={axes:function(){for(let e=0;e<w.length;e++){let t=w[e];if(!t.show||!t._show)continue;let n,l,a=t.side,i=a%2,o=t.stroke(s,e),c=0==a||3==a?-1:1,[u,m]=t._found;if(null!=t.label){let r=t.labelGap*c,h=Ft((t._lpos+r)*Qe);Sn(t.labelFont[0],o,"center",2==a?Ee:$e),d.save(),1==i?(n=l=0,d.translate(h,Ft(xe+be/2)),d.rotate((3==a?-Dt:Dt)/2)):(n=Ft(pe+ge/2),l=h);let f=Ut(t.label)?t.label(s,e,u,m):t.label;d.fillText(f,n,l),d.restore()}if(0==m)continue;let h=j[t.scale],f=0==i?ge:be,p=0==i?pe:xe,g=t._splits,b=2==h.distr?g.map(e=>vn[e]):g,v=2==h.distr?vn[g[1]]-vn[g[0]]:u,y=t.ticks,k=t.border,N=y.show?y.size:0,M=Ft(N*Qe),T=Ft((2==t.alignTo?t._size-N-t.gap:t.gap)*Qe),S=t._rotate*-Dt/180,C=x(t._pos*Qe),_=C+(M+T)*c;l=0==i?_:0,n=1==i?_:0,Sn(t.font[0],o,1==t.align?Fe:2==t.align?Le:S>0?Fe:S<0?Le:0==i?"center":3==a?Le:Fe,S||1==i?"middle":2==a?Ee:$e);let P=t.font[1]*t.lineGap,A=g.map(e=>x(r(e,h,f,p))),R=t._values;for(let e=0;e<R.length;e++){let t=R[e];if(null!=t){0==i?n=A[e]:l=A[e],t=""+t;let s=-1==t.indexOf("\n")?[t]:t.split(/\n/gm);for(let e=0;e<s.length;e++){let t=s[e];S?(d.save(),d.translate(n,l+e*P),d.rotate(S),d.fillText(t,0,0),d.restore()):d.fillText(t,n,l+e*P)}}}y.show&&Ln(A,y.filter(s,b,e,m,v),i,a,C,M,rn(y.width*Qe,3),y.stroke(s,e),y.dash,y.cap);let D=t.grid;D.show&&Ln(A,D.filter(s,b,e,m,v),i,0==i?2:1,0==i?xe:pe,0==i?be:ge,rn(D.width*Qe,3),D.stroke(s,e),D.dash,D.cap),k.show&&Ln([C],[1],0==i?1:0,0==i?1:2,1==i?xe:pe,1==i?be:ge,rn(k.width*Qe,3),k.stroke(s,e),k.dash,k.cap)}$l("drawAxes")},series:function(){if(Tt>0){let e=b.some(e=>e._focus)&&pn!=ze.alpha;e&&(d.globalAlpha=pn=ze.alpha),b.forEach((e,n)=>{if(n>0&&e.show&&(Pn(n,!1),Pn(n,!0),null==e._paths)){let a=pn;pn!=e.alpha&&(d.globalAlpha=pn=e.alpha);let i=2==l?[0,t[n][0].length-1]:function(e){let t=qt(_t-1,0,Tt-1),n=qt(Pt+1,0,Tt-1);for(;null==e[t]&&t>0;)t--;for(;null==e[n]&&n<Tt-1;)n++;return[t,n]}(t[n]);e._paths=e.paths(s,n,i[0],i[1]),pn!=a&&(d.globalAlpha=pn=a)}}),b.forEach((e,t)=>{if(t>0&&e.show){let n=pn;pn!=e.alpha&&(d.globalAlpha=pn=e.alpha),null!=e._paths&&An(t,!1);{let n=null!=e._paths?e._paths.gaps:null,l=e.points.show(s,t,_t,Pt,n),a=e.points.filter(s,t,l,n);(l||a)&&(e.points._paths=e.points.paths(s,t,_t,Pt,a),An(t,!0))}pn!=n&&(d.globalAlpha=pn=n),$l("drawSeries",t)}}),e&&(d.globalAlpha=pn=1)}}},T=(e.drawOrder||["axes","series"]).map(e=>M[e]);function S(e){const t=3==e.distr?t=>Ot(t>0?t:e.clamp(s,t,e.min,e.max,e.key)):4==e.distr?t=>Vt(t,e.asinh):100==e.distr?t=>e.fwd(t):e=>e;return n=>{let s=t(n),{_min:l,_max:a}=e;return(s-l)/(a-l)}}function C(t){let n=j[t];if(null==n){let s=(e.scales||dn)[t]||dn;if(null!=s.from){C(s.from);let e=jn({},j[s.from],s,{key:t});e.valToPct=S(e),j[t]=e}else{n=j[t]=jn({},t==N?Hs:Bs,s),n.key=t;let e=n.time,a=n.range,i=fn(a);if((t!=N||2==l&&!e)&&(!i||null!=a[0]&&null!=a[1]||(a={min:null==a[0]?Nt:{mode:1,hard:a[0],soft:a[0]},max:null==a[1]?Nt:{mode:1,hard:a[1],soft:a[1]}},i=!1),!i&&gn(a))){let e=a;a=(t,n,s)=>null==n?hn:St(n,s,e)}n.range=Xt(a||(e?jl:t==N?3==n.distr?Ml:4==n.distr?Sl:wl:3==n.distr?Nl:4==n.distr?Tl:kl)),n.auto=Xt(!i&&n.auto),n.clamp=Xt(n.clamp||Ws),n._min=n._max=null,n.valToPct=S(n)}}}C("x"),C("y"),1==l&&b.forEach(e=>{C(e.scale)}),w.forEach(e=>{C(e.scale)});for(let Pe in e.scales)C(Pe);const _=j[N],P=_.distr;let A,R;0==_.ori?(tt(c,"u-hz"),A=a,R=i):(tt(c,"u-vt"),A=i,R=a);const D={};for(let Pe in j){let e=j[Pe];null==e.min&&null==e.max||(D[Pe]={min:e.min,max:e.max},e.min=e.max=null)}const E=e.tzDate||(e=>new Date(Ft(e/g))),$=e.fmtDate||Dn,F=1==g?es(E):ss(E),L=as(E,ls(1==g?Qn:ns,$)),z=os(E,rs("{YYYY}-{MM}-{DD} {h}:{mm}{aa}",$)),W=[],H=s.legend=jn({},cs,e.legend),B=s.cursor=jn({},hs,{drag:{y:2==l}},e.cursor),O=H.show,G=B.show,V=H.markers;let I,Y,q;H.idxs=W,V.width=Xt(V.width),V.dash=Xt(V.dash),V.stroke=Xt(V.stroke),V.fill=Xt(V.fill);let U,X=[],K=[],J=!1,Z={};if(H.live){const e=b[1]?b[1].values:null;J=null!=e,U=J?e(s,1,0):{_:0};for(let t in U)Z[t]=Ue}if(O)if(I=lt("table","u-legend",c),q=lt("tbody",null,I),H.mount(s,I),J){Y=lt("thead",null,I,q);let e=lt("tr",null,Y);for(var Q in lt("th",null,e),U)lt("th",Ae,e).textContent=Q}else tt(I,"u-inline"),H.live&&tt(I,"u-live");const ee={show:!0},te={show:!1},ne=new Map;function se(e,t,n,l=!0){const a=ne.get(t)||{},i=B.bind[e](s,t,n,l);i&&(ft(e,t,a[e]=i),ne.set(t,a))}function le(e,t,n){const s=ne.get(t)||{};for(let l in s)null!=e&&l!=e||(pt(l,t,s[l]),delete s[l]);null==e&&ne.delete(t)}let ae=0,ie=0,re=0,oe=0,ce=0,ue=0,de=ce,me=ue,he=re,fe=oe,pe=0,xe=0,ge=0,be=0;s.bbox={};let ve=!1,ye=!1,we=!1,je=!1,ke=!1,Ne=!1;function Me(e,t,n){(n||e!=s.width||t!=s.height)&&Te(e,t),On(!1),we=!0,ye=!0,gs()}function Te(e,t){s.width=ae=re=e,s.height=ie=oe=t,ce=ue=0,function(){let e=!1,t=!1,n=!1,s=!1;w.forEach((l,a)=>{if(l.show&&l._show){let{side:a,_size:i}=l,r=a%2,o=i+(null!=l.label?l.labelSize:0);o>0&&(r?(re-=o,3==a?(ce+=o,s=!0):n=!0):(oe-=o,0==a?(ue+=o,e=!0):t=!0))}}),mt[0]=e,mt[1]=n,mt[2]=t,mt[3]=s,re-=Mt[1]+Mt[3],ce+=Mt[3],oe-=Mt[2]+Mt[0],ue+=Mt[0]}(),function(){let e=ce+re,t=ue+oe,n=ce,s=ue;function l(l,a){switch(l){case 1:return e+=a,e-a;case 2:return t+=a,t-a;case 3:return n-=a,n+a;case 0:return s-=a,s+a}}w.forEach((e,t)=>{if(e.show&&e._show){let t=e.side;e._pos=l(t,e._size),null!=e.label&&(e._lpos=l(t,e.labelSize))}})}();let n=s.bbox;pe=n.left=sn(ce*Qe,.5),xe=n.top=sn(ue*Qe,.5),ge=n.width=sn(re*Qe,.5),be=n.height=sn(oe*Qe,.5)}const Se=3;if(s.setSize=function({width:e,height:t}){Me(e,t)},null==B.dataIdx){let e=B.hover,n=e.skip=new Set(e.skip??[]);n.add(void 0);let s=e.prox=Xt(e.prox),l=e.bias??(e.bias=0);B.dataIdx=(e,a,i,r)=>{if(0==a)return i;let o=i,c=s(e,a,i,r)??It,u=c>=0&&c<It,d=0==_.ori?re:oe,m=B.left,h=t[0],f=t[a];if(n.has(f[i])){o=null;let e,t=null,s=null;if(0==l||-1==l)for(e=i;null==t&&e-- >0;)n.has(f[e])||(t=e);if(0==l||1==l)for(e=i;null==s&&e++<f.length;)n.has(f[e])||(s=e);if(null!=t||null!=s)if(u){let e=m-(null==t?-1/0:A(h[t],_,d,0)),n=(null==s?1/0:A(h[s],_,d,0))-m;e<=n?e<=c&&(o=t):n<=c&&(o=s)}else o=null==s?t:null==t?s:i-t<=s-i?t:s}else u&&Et(m-A(h[i],_,d,0))>c&&(o=null);return o}}const Ce=e=>{B.event=e};B.idxs=W,B._lock=!1;let _e=B.points;_e.show=Xt(_e.show),_e.size=Xt(_e.size),_e.stroke=Xt(_e.stroke),_e.width=Xt(_e.width),_e.fill=Xt(_e.fill);const ze=s.focus=jn({},e.focus||{alpha:.3},B.focus),Ye=ze.prox>=0,Xe=Ye&&_e.one;let Ze=[],et=[],it=[];function ot(e,t){let n=_e.show(s,t);if(n instanceof HTMLElement)return tt(n,"u-cursor-pt"),tt(n,e.class),rt(n,-10,-10,re,oe),f.insertBefore(n,Ze[t]),n}function ut(e,t){if(1==l||t>0){let t=1==l&&j[e.scale].time,n=e.value;e.value=t?xn(n)?os(E,rs(n,$)):n||z:n||Ds,e.label=e.label||(t?"Time":"Value")}if(Xe||t>0){e.width=null==e.width?1:e.width,e.paths=e.paths||gl||Zt,e.fillTo=Xt(e.fillTo||Ys),e.pxAlign=+Ct(e.pxAlign,p),e.pxRound=Ks(e.pxAlign),e.stroke=Xt(e.stroke||null),e.fill=Xt(e.fill||null),e._stroke=e._fill=e._paths=e._focus=null;let t=rn(1*(3+2*(Wt(1,e.width)||1)),3),n=e.points=jn({},{size:t,width:Wt(1,.2*t),stroke:e.stroke,space:2*t,paths:bl,_stroke:null,_fill:null},e.points);n.show=Xt(n.show),n.filter=Xt(n.filter),n.fill=Xt(n.fill),n.stroke=Xt(n.stroke),n.paths=Xt(n.paths),n.pxAlign=e.pxAlign}if(O){let n=function(e,t){if(0==t&&(J||!H.live||2==l))return hn;let n=[],a=lt("tr","u-series",q,q.childNodes[t]);tt(a,e.class),e.show||tt(a,Pe);let i=lt("th",null,a);if(V.show){let e=at("u-marker",i);if(t>0){let n=V.width(s,t);n&&(e.style.border=n+"px "+V.dash(s,t)+" "+V.stroke(s,t)),e.style.background=V.fill(s,t)}}let r=at(Ae,i);for(var o in e.label instanceof HTMLElement?r.appendChild(e.label):r.textContent=e.label,t>0&&(V.show||(r.style.color=e.width>0?V.stroke(s,t):V.fill(s,t)),se("click",i,t=>{if(B._lock)return;Ce(t);let n=b.indexOf(e);if((t.ctrlKey||t.metaKey)!=H.isolate){let e=b.some((e,t)=>t>0&&t!=n&&e.show);b.forEach((t,s)=>{s>0&&Vs(s,e?s==n?ee:te:ee,!0,Ll.setSeries)})}else Vs(n,{show:!e.show},!0,Ll.setSeries)},!1),Ye&&se(Ge,i,t=>{B._lock||(Ce(t),Vs(b.indexOf(e),Xs,!0,Ll.setSeries))},!1)),U){let e=lt("td","u-value",a);e.textContent="--",n.push(e)}return[a,n]}(e,t);X.splice(t,0,n[0]),K.splice(t,0,n[1]),H.values.push(null)}if(G){W.splice(t,0,null);let n=null;Xe?0==t&&(n=ot(e,t)):t>0&&(n=ot(e,t)),Ze.splice(t,0,n),et.splice(t,0,0),it.splice(t,0,0)}$l("addSeries",t)}s.addSeries=function(e,t){t=null==t?b.length:t,e=1==l?yl(e,t,ws,zs):yl(e,t,{},Ls),b.splice(t,0,e),ut(b[t],t)},s.delSeries=function(e){if(b.splice(e,1),O){H.values.splice(e,1),K.splice(e,1);let t=X.splice(e,1)[0];le(null,t.firstChild),t.remove()}G&&(W.splice(e,1),Ze.splice(e,1)[0].remove(),et.splice(e,1),it.splice(e,1)),$l("delSeries",e)};const mt=[!1,!1,!1,!1];function ht(e,t,n,s){let[l,a,i,r]=n,o=t%2,c=0;return 0==o&&(r||a)&&(c=0==t&&!l||2==t&&!i?Ft(ys.size/3):0),1==o&&(l||i)&&(c=1==t&&!a||3==t&&!r?Ft(Es.size/2):0),c}const gt=s.padding=(e.padding||[ht,ht,ht,ht]).map(e=>Xt(Ct(e,ht))),Mt=s._padding=gt.map((e,t)=>e(s,t,mt,0));let Tt,_t=null,Pt=null;const At=1==l?b[0].idxs:null;let $t,Bt,Gt,Kt,tn,nn,ln,an,un,pn,vn=null,yn=!1;function kn(e,n){if(t=null==e?[]:e,s.data=s._data=t,2==l){Tt=0;for(let e=1;e<b.length;e++)Tt+=t[e][0].length}else{0==t.length&&(s.data=s._data=t=[[]]),vn=t[0],Tt=vn.length;let e=t;if(2==P){e=t.slice();let n=e[0]=Array(Tt);for(let e=0;e<Tt;e++)n[e]=e}s._data=t=e}if(On(!0),$l("setData"),2==P&&(we=!0),!1!==n){let e=_;e.auto(s,yn)?Mn():Os(N,e.min,e.max),je=je||B.left>=0,Ne=!0,gs()}}function Mn(){let e,n;yn=!0,1==l&&(Tt>0?(_t=At[0]=0,Pt=At[1]=Tt-1,e=t[0][_t],n=t[0][Pt],2==P?(e=_t,n=Pt):e==n&&(3==P?[e,n]=jt(e,e,_.log,!1):4==P?[e,n]=kt(e,e,_.log,!1):_.time?n=e+Ft(86400/g):[e,n]=St(e,n,.1,!0))):(_t=At[0]=e=null,Pt=At[1]=n=null)),Os(N,e,n)}function Tn(e,t,n,s,l,a){e??(e=We),n??(n=mn),s??(s="butt"),l??(l=We),a??(a="round"),e!=$t&&(d.strokeStyle=$t=e),l!=Bt&&(d.fillStyle=Bt=l),t!=Gt&&(d.lineWidth=Gt=t),a!=tn&&(d.lineJoin=tn=a),s!=nn&&(d.lineCap=nn=s),n!=Kt&&d.setLineDash(Kt=n)}function Sn(e,t,n,s){t!=Bt&&(d.fillStyle=Bt=t),e!=ln&&(d.font=ln=e),n!=an&&(d.textAlign=an=n),s!=un&&(d.textBaseline=un=s)}function Cn(e,t,n,l,a=0){if(l.length>0&&e.auto(s,yn)&&(null==t||null==t.min)){let t=Ct(_t,0),s=Ct(Pt,l.length-1),i=null==n.min?function(e,t,n,s=0,l=!1){let a=l?wt:yt,i=l?vt:bt;[t,n]=a(e,t,n);let r=e[t],o=e[t];if(t>-1)if(1==s)r=e[t],o=e[n];else if(-1==s)r=e[n],o=e[t];else for(let c=t;c<=n;c++){let t=e[c];i(t)&&(t<r?r=t:t>o&&(o=t))}return[r??It,o??-It]}(l,t,s,a,3==e.distr):[n.min,n.max];e.min=zt(e.min,n.min=i[0]),e.max=Wt(e.max,n.max=i[1])}}s.setData=kn;const _n={min:null,max:null};function Pn(e,t){let n=t?b[e].points:b[e];n._stroke=n.stroke(s,e),n._fill=n.fill(s,e)}function An(e,n){let l=n?b[e].points:b[e],{stroke:a,fill:i,clip:r,flags:o,_stroke:c=l._stroke,_fill:u=l._fill,_width:m=l.width}=l._paths;m=rn(m*Qe,3);let h=null,f=m%2/2;n&&null==u&&(u=m>0?"#fff":c);let p=1==l.pxAlign&&f>0;if(p&&d.translate(f,f),!n){let e=pe-m/2,t=xe-m/2,n=ge+m,s=be+m;h=new Path2D,h.rect(e,t,n,s)}n?En(c,m,l.dash,l.cap,u,a,i,o,r):function(e,n,l,a,i,r,o,c,u,d,m){let h=!1;0!=u&&k.forEach((f,p)=>{if(f.series[0]==e){let e,x=b[f.series[1]],g=t[f.series[1]],v=(x._paths||dn).band;fn(v)&&(v=1==f.dir?v[0]:v[1]);let y=null;x.show&&v&&function(e,t,n){for(t=Ct(t,0),n=Ct(n,e.length-1);t<=n;){if(null!=e[t])return!0;t++}return!1}(g,_t,Pt)?(y=f.fill(s,p)||r,e=x._paths.clip):v=null,En(n,l,a,i,y,o,c,u,d,m,e,v),h=!0}}),h||En(n,l,a,i,r,o,c,u,d,m)}(e,c,m,l.dash,l.cap,u,a,i,o,h,r),p&&d.translate(-f,-f)}const Rn=3;function En(e,t,n,s,l,a,i,r,o,c,u,m){Tn(e,t,n,s,l),(o||c||m)&&(d.save(),o&&d.clip(o),c&&d.clip(c)),m?(r&Rn)==Rn?(d.clip(m),u&&d.clip(u),Fn(l,i),$n(e,a,t)):2&r?(Fn(l,i),d.clip(m),$n(e,a,t)):1&r&&(d.save(),d.clip(m),u&&d.clip(u),Fn(l,i),d.restore(),$n(e,a,t)):(Fn(l,i),$n(e,a,t)),(o||c||m)&&d.restore()}function $n(e,t,n){n>0&&(t instanceof Map?t.forEach((e,t)=>{d.strokeStyle=$t=t,d.stroke(e)}):null!=t&&e&&d.stroke(t))}function Fn(e,t){t instanceof Map?t.forEach((e,t)=>{d.fillStyle=Bt=t,d.fill(e)}):null!=t&&e&&d.fill(t)}function Ln(e,t,n,s,l,a,i,r,o,c){let u=i%2/2;1==p&&d.translate(u,u),Tn(r,i,o,c,r),d.beginPath();let m,h,f,x,g=l+(0==s||3==s?-a:a);0==n?(h=l,x=g):(m=l,f=g);for(let p=0;p<e.length;p++)null!=t[p]&&(0==n?m=f=e[p]:h=x=e[p],d.moveTo(m,h),d.lineTo(f,x));d.stroke(),1==p&&d.translate(-u,-u)}function zn(e){let t=!0;return w.forEach((n,l)=>{if(!n.show)return;let a=j[n.scale];if(null==a.min)return void(n._show&&(t=!1,n._show=!1,On(!1)));n._show||(t=!1,n._show=!0,On(!1));let i=n.side,r=i%2,{min:o,max:c}=a,[u,d]=function(e,t,n,l){let a,i=w[e];if(l<=0)a=[0,0];else{let r=i._space=i.space(s,e,t,n,l);a=function(e,t,n,s,l){let a=Wt(Yt(e),Yt(t)),i=t-e,r=xt(l/s*i,n);do{let e=n[r],t=s*e/i;if(t>=l&&a+(e<5?on.get(e):0)<=17)return[e,t]}while(++r<n.length);return[0,0]}(t,n,i._incrs=i.incrs(s,e,t,n,l,r),l,r)}return i._found=a}(l,o,c,0==r?re:oe);if(0==d)return;let m=2==a.distr,h=n._splits=n.splits(s,l,o,c,u,d,m),f=2==a.distr?h.map(e=>vn[e]):h,p=2==a.distr?vn[h[1]]-vn[h[0]]:u,x=n._values=n.values(s,n.filter(s,f,l,d,p),l,d,p);n._rotate=2==i?n.rotate(s,x,l,d):0;let g=n._size;n._size=Lt(n.size(s,x,l,e)),null!=g&&n._size!=g&&(t=!1)}),t}function Bn(e){let t=!0;return gt.forEach((n,l)=>{let a=n(s,l,mt,e);a!=Mt[l]&&(t=!1),Mt[l]=a}),t}function On(e){b.forEach((t,n)=>{n>0&&(t._paths=null,e&&(1==l?(t.min=null,t.max=null):t.facets.forEach(e=>{e.min=null,e.max=null})))})}let Gn,Vn,In,Yn,qn,Un,Xn,Kn,Jn,is,us,ds,ms=!1,fs=!1,ps=[];function xs(){fs=!1;for(let e=0;e<ps.length;e++)$l(...ps[e]);ps.length=0}function gs(){ms||(Nn(bs),ms=!0)}function bs(){if(ve&&(function(){for(let t in j){let e=j[t];null==D[t]&&(null==e.min||null!=D[N]&&e.auto(s,yn))&&(D[t]=_n)}for(let t in j){let e=j[t];null==D[t]&&null!=e.from&&null!=D[e.from]&&(D[t]=_n)}null!=D[N]&&On(!0);let e={};for(let t in D){let n=D[t];if(null!=n){let a=e[t]=wn(j[t],bn);if(null!=n.min)jn(a,n);else if(t!=N||2==l)if(0==Tt&&null==a.from){let e=a.range(s,null,null,t);a.min=e[0],a.max=e[1]}else a.min=It,a.max=-It}}if(Tt>0){b.forEach((n,a)=>{if(1==l){let l=n.scale,i=D[l];if(null==i)return;let r=e[l];if(0==a){let e=r.range(s,r.min,r.max,l);r.min=e[0],r.max=e[1],_t=xt(r.min,t[0]),Pt=xt(r.max,t[0]),Pt-_t>1&&(t[0][_t]<r.min&&_t++,t[0][Pt]>r.max&&Pt--),n.min=vn[_t],n.max=vn[Pt]}else n.show&&n.auto&&Cn(r,i,n,t[a],n.sorted);n.idxs[0]=_t,n.idxs[1]=Pt}else if(a>0&&n.show&&n.auto){let[s,l]=n.facets,i=s.scale,r=l.scale,[o,c]=t[a],u=e[i],d=e[r];null!=u&&Cn(u,D[i],s,o,s.sorted),null!=d&&Cn(d,D[r],l,c,l.sorted),n.min=l.min,n.max=l.max}});for(let t in e){let n=e[t],l=D[t];if(null==n.from&&(null==l||null==l.min)){let e=n.range(s,n.min==It?null:n.min,n.max==-It?null:n.max,t);n.min=e[0],n.max=e[1]}}}for(let t in e){let n=e[t];if(null!=n.from){let l=e[n.from];if(null==l.min)n.min=n.max=null;else{let e=n.range(s,l.min,l.max,t);n.min=e[0],n.max=e[1]}}}let n={},a=!1;for(let t in e){let s=e[t],l=j[t];if(l.min!=s.min||l.max!=s.max){l.min=s.min,l.max=s.max;let e=l.distr;l._min=3==e?Ot(l.min):4==e?Vt(l.min,l.asinh):100==e?l.fwd(l.min):l.min,l._max=3==e?Ot(l.max):4==e?Vt(l.max,l.asinh):100==e?l.fwd(l.max):l.max,n[t]=a=!0}}if(a){b.forEach((e,t)=>{2==l?t>0&&n.y&&(e._paths=null):n[e.scale]&&(e._paths=null)});for(let e in n)we=!0,$l("setScale",e);G&&B.left>=0&&(je=Ne=!0)}for(let t in D)D[t]=null}(),ve=!1),we&&(function(){let e=!1,t=0;for(;!e;){t++;let n=zn(t),l=Bn(t);e=t==Se||n&&l,e||(Te(s.width,s.height),ye=!0)}}(),we=!1),ye){if(st(h,Fe,ce),st(h,Ee,ue),st(h,Re,re),st(h,De,oe),st(f,Fe,ce),st(f,Ee,ue),st(f,Re,re),st(f,De,oe),st(m,Re,ae),st(m,De,ie),u.width=Ft(ae*Qe),u.height=Ft(ie*Qe),w.forEach(({_el:e,_show:t,_size:n,_pos:s,side:l})=>{if(null!=e)if(t){let t=l%2==1;st(e,t?"left":"top",s-(3===l||0===l?n:0)),st(e,t?"width":"height",n),st(e,t?"top":"left",t?ue:ce),st(e,t?"height":"width",t?oe:re),nt(e,Pe)}else tt(e,Pe)}),$t=Bt=Gt=tn=nn=ln=an=un=Kt=null,pn=1,il(!0),ce!=de||ue!=me||re!=he||oe!=fe){On(!1);let e=re/he,t=oe/fe;if(G&&!je&&B.left>=0){B.left*=e,B.top*=t,In&&rt(In,Ft(B.left),0,re,oe),Yn&&rt(Yn,0,Ft(B.top),re,oe);for(let n=0;n<Ze.length;n++){let s=Ze[n];null!=s&&(et[n]*=e,it[n]*=t,rt(s,Lt(et[n]),Lt(it[n]),re,oe))}}if(Ps.show&&!ke&&Ps.left>=0&&Ps.width>0){Ps.left*=e,Ps.width*=e,Ps.top*=t,Ps.height*=t;for(let e in cl)st($s,e,Ps[e])}de=ce,me=ue,he=re,fe=oe}$l("setSize"),ye=!1}ae>0&&ie>0&&(d.clearRect(0,0,u.width,u.height),$l("drawClear"),T.forEach(e=>e()),$l("draw")),Ps.show&&ke&&(Fs(Ps),ke=!1),G&&je&&(ll(null,!0,!1),je=!1),H.show&&H.live&&Ne&&(nl(),Ne=!1),o||(o=!0,s.status=1,$l("ready")),yn=!1,ms=!1}function vs(e,n){let l=j[e];if(null==l.from){if(0==Tt){let t=l.range(s,n.min,n.max,e);n.min=t[0],n.max=t[1]}if(n.min>n.max){let e=n.min;n.min=n.max,n.max=e}if(Tt>1&&null!=n.min&&null!=n.max&&n.max-n.min<1e-16)return;e==N&&2==l.distr&&Tt>0&&(n.min=xt(n.min,t[0]),n.max=xt(n.max,t[0]),n.min==n.max&&n.max++),D[e]=n,ve=!0,gs()}}s.batch=function(e,t=!1){ms=!0,fs=t,e(s),bs(),t&&ps.length>0&&queueMicrotask(xs)},s.redraw=(e,t)=>{we=t||!1,!1!==e?Os(N,_.min,_.max):gs()},s.setScale=vs;let Ts=!1;const Ss=B.drag;let Cs=Ss.x,_s=Ss.y;G&&(B.x&&(Gn=at("u-cursor-x",f)),B.y&&(Vn=at("u-cursor-y",f)),0==_.ori?(In=Gn,Yn=Vn):(In=Vn,Yn=Gn),us=B.left,ds=B.top);const Ps=s.select=jn({show:!0,over:!0,left:0,width:0,top:0,height:0},e.select),$s=Ps.show?at("u-select",Ps.over?f:h):null;function Fs(e,t){if(Ps.show){for(let t in e)Ps[t]=e[t],t in cl&&st($s,t,e[t]);!1!==t&&$l("setSelect")}}function Os(e,t,n){vs(e,{min:t,max:n})}function Vs(e,t,n,a){null!=t.focus&&function(e){if(e!=Us){let t=null==e,n=1!=ze.alpha;b.forEach((s,a)=>{if(1==l||a>0){let l=t||0==a||a==e;s._focus=t?null:l,n&&function(e,t){b[e].alpha=t,G&&null!=Ze[e]&&(Ze[e].style.opacity=t),O&&X[e]&&(X[e].style.opacity=t)}(a,l?1:ze.alpha)}}),Us=e,n&&gs()}}(e),null!=t.show&&b.forEach((n,s)=>{s>0&&(e==s||null==e)&&(n.show=t.show,function(e){if(b[e].show)O&&nt(X[e],Pe);else if(O&&tt(X[e],Pe),G){let t=Xe?Ze[0]:Ze[e];null!=t&&rt(t,-10,-10,re,oe)}}(s),2==l?(Os(n.facets[0].scale,null,null),Os(n.facets[1].scale,null,null)):Os(n.scale,null,null),gs())}),!1!==n&&$l("setSeries",e,t),a&&Hl("setSeries",s,e,t)}let Is,qs,Us;s.setSelect=Fs,s.setSeries=Vs,s.addBand=function(e,t){e.fill=Xt(e.fill||null),e.dir=Ct(e.dir,-1),t=null==t?k.length:t,k.splice(t,0,e)},s.setBand=function(e,t){jn(k[e],t)},s.delBand=function(e){null==e?k.length=0:k.splice(e,1)};const Xs={focus:!0};function Js(e,t,n){let s=j[t];n&&(e=e/Qe-(1==s.ori?ue:ce));let l=re;1==s.ori&&(l=oe,e=l-e),-1==s.dir&&(e=l-e);let a=s._min,i=a+(s._max-a)*(e/l),r=s.distr;return 3==r?Ht(10,i):4==r?((e,t=1)=>Rt.sinh(e)*t)(i,s.asinh):100==r?s.bwd(i):i}function Zs(e,t){st($s,Fe,Ps.left=e),st($s,Re,Ps.width=t)}function Qs(e,t){st($s,Ee,Ps.top=e),st($s,De,Ps.height=t)}O&&Ye&&se(Ve,I,e=>{B._lock||(Ce(e),null!=Us&&Vs(null,Xs,!0,Ll.setSeries))}),s.valToIdx=e=>xt(e,t[0]),s.posToIdx=function(e,n){return xt(Js(e,N,n),t[0],_t,Pt)},s.posToVal=Js,s.valToPos=(e,t,n)=>0==j[t].ori?a(e,j[t],n?ge:re,n?pe:0):i(e,j[t],n?be:oe,n?xe:0),s.setCursor=(e,t,n)=>{us=e.left,ds=e.top,ll(null,t,n)};let el=0==_.ori?Zs:Qs,tl=1==_.ori?Zs:Qs;function nl(e,t){if(null!=e&&(e.idxs?e.idxs.forEach((e,t)=>{W[t]=e}):void 0!==e.idx&&W.fill(e.idx),H.idx=W[0]),O&&H.live){for(let e=0;e<b.length;e++)(e>0||1==l&&!J)&&sl(e,W[e]);!function(){if(O&&H.live)for(let e=2==l?1:0;e<b.length;e++){if(0==e&&J)continue;let t=H.values[e],n=0;for(let s in t)K[e][n++].firstChild.nodeValue=t[s]}}()}Ne=!1,!1!==t&&$l("setLegend")}function sl(e,n){let l,a=b[e],i=0==e&&2==P?vn:t[e];J?l=a.values(s,e,n)??Z:(l=a.value(s,null==n?null:i[n],e,n),l=null==l?Z:{_:l}),H.values[e]=l}function ll(e,n,a){let i;Jn=us,is=ds,[us,ds]=B.move(s,us,ds),B.left=us,B.top=ds,G&&(In&&rt(In,Ft(us),0,re,oe),Yn&&rt(Yn,0,Ft(ds),re,oe));let r=_t>Pt;Is=It,qs=null;let o=0==_.ori?re:oe,c=1==_.ori?re:oe;if(us<0||0==Tt||r){i=B.idx=null;for(let e=0;e<b.length;e++){let t=Ze[e];null!=t&&rt(t,-10,-10,re,oe)}Ye&&Vs(null,Xs,!0,null==e&&Ll.setSeries),H.live&&(W.fill(i),Ne=!0)}else{let e,n,a;1==l&&(e=0==_.ori?us:ds,n=Js(e,N),i=B.idx=xt(n,t[0],_t,Pt),a=A(t[0][i],_,o,0));let r=-10,u=-10,d=0,m=0,h=!0,f="",p="";for(let x=2==l?1:0;x<b.length;x++){let e=b[x],g=W[x],v=null==g?null:1==l?t[x][g]:t[x][1][g],y=B.dataIdx(s,x,i,n),w=null==y?null:1==l?t[x][y]:t[x][1][y];if(Ne=Ne||w!=v||y!=g,W[x]=y,x>0&&e.show){let n=null==y?-10:y==i?a:A(1==l?t[0][y]:t[x][0][y],_,o,0),g=null==w?-10:R(w,1==l?j[e.scale]:j[e.facets[1].scale],c,0);if(Ye&&null!=w){let t=1==_.ori?us:ds,n=Et(ze.dist(s,x,y,g,t));if(n<Is){let s=ze.bias;if(0!=s){let l=Js(t,e.scale),a=l>=0?1:-1;a==(w>=0?1:-1)&&(1==a?1==s?w>=l:w<=l:1==s?w<=l:w>=l)&&(Is=n,qs=x)}else Is=n,qs=x}}if(Ne||Xe){let e,t;0==_.ori?(e=n,t=g):(e=g,t=n);let l,a,i,o,c,b,v=!0,y=_e.bbox;if(null!=y){v=!1;let e=y(s,x);i=e.left,o=e.top,l=e.width,a=e.height}else i=e,o=t,l=a=_e.size(s,x);if(b=_e.fill(s,x),c=_e.stroke(s,x),Xe)x==qs&&Is<=ze.prox&&(r=i,u=o,d=l,m=a,h=v,f=b,p=c);else{let e=Ze[x];null!=e&&(et[x]=i,it[x]=o,dt(e,l,a,v),ct(e,b,c),rt(e,Lt(i),Lt(o),re,oe))}}}}if(Xe){let e=ze.prox;if(Ne||(null==Us?Is<=e:Is>e||qs!=Us)){let e=Ze[0];null!=e&&(et[0]=r,it[0]=u,dt(e,d,m,h),ct(e,f,p),rt(e,Lt(r),Lt(u),re,oe))}}}if(Ps.show&&Ts)if(null!=e){let[t,n]=Ll.scales,[s,l]=Ll.match,[a,i]=e.cursor.sync.scales,r=e.cursor.drag;if(Cs=r._x,_s=r._y,Cs||_s){let r,u,d,m,h,{left:f,top:p,width:x,height:g}=e.select,b=e.scales[a].ori,v=e.posToVal,y=null!=t&&s(t,a),w=null!=n&&l(n,i);y&&Cs?(0==b?(r=f,u=x):(r=p,u=g),d=j[t],m=A(v(r,a),d,o,0),h=A(v(r+u,a),d,o,0),el(zt(m,h),Et(h-m))):el(0,o),w&&_s?(1==b?(r=f,u=x):(r=p,u=g),d=j[n],m=R(v(r,i),d,c,0),h=R(v(r+u,i),d,c,0),tl(zt(m,h),Et(h-m))):tl(0,c)}else ul()}else{let e=Et(Jn-qn),t=Et(is-Un);if(1==_.ori){let n=e;e=t,t=n}Cs=Ss.x&&e>=Ss.dist,_s=Ss.y&&t>=Ss.dist;let n,s,l=Ss.uni;null!=l?Cs&&_s&&(Cs=e>=l,_s=t>=l,Cs||_s||(t>e?_s=!0:Cs=!0)):Ss.x&&Ss.y&&(Cs||_s)&&(Cs=_s=!0),Cs&&(0==_.ori?(n=Xn,s=us):(n=Kn,s=ds),el(zt(n,s),Et(s-n)),_s||tl(0,c)),_s&&(1==_.ori?(n=Xn,s=us):(n=Kn,s=ds),tl(zt(n,s),Et(s-n)),Cs||el(0,o)),Cs||_s||(el(0,0),tl(0,0))}if(Ss._x=Cs,Ss._y=_s,null==e){if(a){if(null!=zl){let[e,t]=Ll.scales;Ll.values[0]=null!=e?Js(0==_.ori?us:ds,e):null,Ll.values[1]=null!=t?Js(1==_.ori?us:ds,t):null}Hl(He,s,us,ds,re,oe,i)}if(Ye){let e=a&&Ll.setSeries,t=ze.prox;null==Us?Is<=t&&Vs(qs,Xs,!0,e):Is>t?Vs(null,Xs,!0,e):qs!=Us&&Vs(qs,Xs,!0,e)}}Ne&&(H.idx=i,nl()),!1!==n&&$l("setCursor")}s.setLegend=nl;let al=null;function il(e=!1){e?al=null:(al=f.getBoundingClientRect(),$l("syncRect",al))}function rl(e,t,n,s,l,a,i){B._lock||Ts&&null!=e&&0==e.movementX&&0==e.movementY||(ol(e,t,n,s,l,a,0,!1,null!=e),null!=e?ll(null,!0,!0):ll(t,!0,!1))}function ol(e,t,n,l,a,i,o,c,u){if(null==al&&il(!1),Ce(e),null!=e)n=e.clientX-al.left,l=e.clientY-al.top;else{if(n<0||l<0)return us=-10,void(ds=-10);let[e,s]=Ll.scales,o=t.cursor.sync,[c,u]=o.values,[d,m]=o.scales,[h,f]=Ll.match,p=t.axes[0].side%2==1,x=0==_.ori?re:oe,g=1==_.ori?re:oe,b=p?i:a,v=p?a:i,y=p?l:n,w=p?n:l;if(n=null!=d?h(e,d)?r(c,j[e],x,0):-10:x*(y/b),l=null!=m?f(s,m)?r(u,j[s],g,0):-10:g*(w/v),1==_.ori){let e=n;n=l,l=e}}!u||null!=t&&t.cursor.event.type!=He||((n<=1||n>=re-1)&&(n=sn(n,re)),(l<=1||l>=oe-1)&&(l=sn(l,oe))),c?(qn=n,Un=l,[Xn,Kn]=B.move(s,n,l)):(us=n,ds=l)}Object.defineProperty(s,"rect",{get:()=>(null==al&&il(!1),al)});const cl={width:0,height:0,left:0,top:0};function ul(){Fs(cl,!1)}let dl,ml,hl,fl;function xl(e,t,n,l,a,i,r){Ts=!0,Cs=_s=Ss._x=Ss._y=!1,ol(e,t,n,l,a,i,0,!0,!1),null!=e&&(se(Oe,Ke,Pl,!1),Hl(Be,s,Xn,Kn,re,oe,null));let{left:o,top:c,width:u,height:d}=Ps;dl=o,ml=c,hl=u,fl=d}function Pl(e,t,n,l,a,i,r){Ts=Ss._x=Ss._y=!1,ol(e,t,n,l,a,i,0,!1,!0);let{left:o,top:c,width:u,height:d}=Ps,m=u>0||d>0,h=dl!=o||ml!=c||hl!=u||fl!=d;if(m&&h&&Fs(Ps),Ss.setScale&&m&&h){let e=o,t=u,n=c,s=d;if(1==_.ori&&(e=c,t=d,n=o,s=u),Cs&&Os(N,Js(e,N),Js(e+t,N)),_s)for(let l in j){let e=j[l];l!=N&&null==e.from&&e.min!=It&&Os(l,Js(n+s,l),Js(n,l))}ul()}else B.lock&&(B._lock=!B._lock,ll(t,!0,null!=e));null!=e&&(le(Oe,Ke),Hl(Oe,s,us,ds,re,oe,null))}function Al(e,t,n,l,a,i,r){B._lock||(Ce(e),Mn(),ul(),null!=e&&Hl(Ie,s,us,ds,re,oe,null))}function Rl(){w.forEach(_l),Me(s.width,s.height,!0)}ft(qe,Je,Rl);const Dl={};Dl.mousedown=xl,Dl.mousemove=rl,Dl.mouseup=Pl,Dl.dblclick=Al,Dl.setSeries=(e,t,n,l)=>{-1!=(n=(0,Ll.match[2])(s,t,n))&&Vs(n,l,!0,!1)},G&&(se(Be,f,xl),se(He,f,rl),se(Ge,f,e=>{Ce(e),il(!1)}),se(Ve,f,function(e,t,n,s,l,a,i){if(B._lock)return;Ce(e);let r=Ts;if(Ts){let e,t,n=!0,s=!0,l=10;0==_.ori?(e=Cs,t=_s):(e=_s,t=Cs),e&&t&&(n=us<=l||us>=re-l,s=ds<=l||ds>=oe-l),e&&n&&(us=us<Xn?0:re),t&&s&&(ds=ds<Kn?0:oe),ll(null,!0,!0),Ts=!1}us=-10,ds=-10,W.fill(null),ll(null,!0,!0),r&&(Ts=r)}),se(Ie,f,Al),pl.add(s),s.syncRect=il);const El=s.hooks=e.hooks||{};function $l(e,t,n){fs?ps.push([e,t,n]):e in El&&El[e].forEach(e=>{e.call(null,s,t,n)})}(e.plugins||[]).forEach(e=>{for(let t in e.hooks)El[t]=(El[t]||[]).concat(e.hooks[t])});const Fl=(e,t,n)=>n,Ll=jn({key:null,setSeries:!1,filters:{pub:Qt,sub:Qt},scales:[N,b[1]?b[1].scale:null],match:[en,en,Fl],values:[null,null]},B.sync);2==Ll.match.length&&Ll.match.push(Fl),B.sync=Ll;const zl=Ll.key,Wl=Gs(zl);function Hl(e,t,n,s,l,a,i){Ll.filters.pub(e,t,n,s,l,a,i)&&Wl.pub(e,t,n,s,l,a,i)}function Bl(){$l("init",e,t),kn(t||e.data,!1),D[N]?vs(N,D[N]):Mn(),ke=Ps.show&&(Ps.width>0||Ps.height>0),je=Ne=!0,Me(e.width,e.height)}return Wl.sub(s),s.pub=function(e,t,n,s,l,a,i){Ll.filters.sub(e,t,n,s,l,a,i)&&Dl[e](null,t,n,s,l,a,i)},s.destroy=function(){Wl.unsub(s),pl.delete(s),ne.clear(),pt(qe,Je,Rl),c.remove(),null==I||I.remove(),$l("destroy")},b.forEach(ut),w.forEach(function(e,t){if(e._show=e.show,e.show){let n=e.side%2,l=j[e.scale];null==l&&(e.scale=n?b[1].scale:N,l=j[e.scale]);let a=l.time;e.size=Xt(e.size),e.space=Xt(e.space),e.rotate=Xt(e.rotate),fn(e.incrs)&&e.incrs.forEach(e=>{!on.has(e)&&on.set(e,cn(e))}),e.incrs=Xt(e.incrs||(2==l.distr?Wn:a?1==g?Zn:ts:Hn)),e.splits=Xt(e.splits||(a&&1==l.distr?F:3==l.distr?Ns:4==l.distr?Ms:ks)),e.stroke=Xt(e.stroke),e.grid.stroke=Xt(e.grid.stroke),e.ticks.stroke=Xt(e.ticks.stroke),e.border.stroke=Xt(e.border.stroke);let i=e.values;e.values=fn(i)&&!fn(i[0])?Xt(i):a?fn(i)?as(E,ls(i,$)):xn(i)?function(e,t){let n=Dn(t);return(t,s,l,a,i)=>s.map(t=>n(e(t)))}(E,i):i||L:i||js,e.filter=Xt(e.filter||(l.distr>=3&&10==l.log?As:3==l.distr&&2==l.log?Rs:Jt)),e.font=Cl(e.font),e.labelFont=Cl(e.labelFont),e._size=e.size(s,null,t,0),e._space=e._rotate=e._incrs=e._found=e._splits=e._values=null,e._size>0&&(mt[t]=!0,e._el=at("u-axis",m))}}),n?n instanceof HTMLElement?(n.appendChild(c),Bl()):n(s,Bl):Bl(),s}Pl.assign=jn,Pl.fmtNum=At,Pl.rangeNum=St,Pl.rangeLog=jt,Pl.rangeAsinh=kt,Pl.orient=Vs,Pl.pxRatio=Qe,Pl.join=function(e,t){if(function(e){let t=e[0][0],n=t.length;for(let s=1;s<e.length;s++){let l=e[s][0];if(l.length!=n)return!1;if(l!=t)for(let e=0;e<n;e++)if(l[e]!=t[e])return!1}return!0}(e)){let t=e[0].slice();for(let n=1;n<e.length;n++)t.push(...e[n].slice(1));return function(e,t=100){const n=e.length;if(n<=1)return!0;let s=0,l=n-1;for(;s<=l&&null==e[s];)s++;for(;l>=s&&null==e[l];)l--;if(l<=s)return!0;const a=Wt(1,$t((l-s+1)/t));for(let i=e[s],r=s+a;r<=l;r+=a){const t=e[r];if(null!=t){if(t<=i)return!1;i=t}}return!0}(t[0])||(t=function(e){let t=e[0],n=t.length,s=Array(n);for(let a=0;a<s.length;a++)s[a]=a;s.sort((e,n)=>t[e]-t[n]);let l=[];for(let a=0;a<e.length;a++){let t=e[a],i=Array(n);for(let e=0;e<n;e++)i[e]=t[s[e]];l.push(i)}return l}(t)),t}let n=new Set;for(let i=0;i<e.length;i++){let t=e[i][0],s=t.length;for(let e=0;e<s;e++)n.add(t[e])}let s=[Array.from(n).sort((e,t)=>e-t)],l=s[0].length,a=new Map;for(let i=0;i<l;i++)a.set(s[0][i],i);for(let i=0;i<e.length;i++){let n=e[i],r=n[0];for(let e=1;e<n.length;e++){let o=n[e],c=Array(l).fill(void 0),u=t?t[i][e]:1,d=[];for(let e=0;e<o.length;e++){let t=o[e],n=a.get(r[e]);null===t?0!=u&&(c[n]=t,2==u&&d.push(n)):c[n]=t}kn(c,d,l),s.push(c)}}return s},Pl.fmtDate=Dn,Pl.tzDate=function(e,t){let n;return"UTC"==t||"Etc/UTC"==t?n=new Date(+e+6e4*e.getTimezoneOffset()):t==En?n=e:(n=new Date(e.toLocaleString("en-US",{timeZone:t})),n.setMilliseconds(e.getMilliseconds())),n},Pl.sync=Gs;{Pl.addGap=function(e,t,n){let s=e[e.length-1];s&&s[0]==t?s[1]=n:e.push([t,n])},Pl.clipGaps=Us;let e=Pl.paths={points:ol};e.linear=ml,e.stepped=function(e){const t=Ct(e.align,1),n=Ct(e.ascDesc,!1),s=Ct(e.alignGaps,0),l=Ct(e.extend,!1);return(e,a,i,r)=>Vs(e,a,(o,c,u,d,m,h,f,p,x,g,b)=>{[i,r]=yt(u,i,r);let v=o.pxRound,{left:y,width:w}=e.bbox,j=e=>v(h(e,d,g,p)),k=e=>v(f(e,m,b,x)),N=0==d.ori?el:tl;const M={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:1},T=M.stroke,S=d.dir*(0==d.ori?1:-1);let C=k(u[1==S?i:r]),_=j(c[1==S?i:r]),P=_,A=_;l&&-1==t&&(A=y,N(T,A,C)),N(T,_,C);for(let e=1==S?i:r;e>=i&&e<=r;e+=S){let n=u[e];if(null==n)continue;let s=j(c[e]),l=k(n);1==t?N(T,s,C):N(T,P,l),N(T,s,l),C=l,P=s}let R=P;l&&1==t&&(R=y+w,N(T,R,C));let[D,E]=Is(e,a);if(null!=o.fill||0!=D){let t=M.fill=new Path2D(T),n=k(o.fillTo(e,a,o.min,o.max,D));N(t,R,n),N(t,A,n)}if(!o.spanGaps){let l=[];l.push(...Xs(c,u,i,r,S,j,s));let m=o.width*Qe/2,h=n||1==t?m:-m,f=n||-1==t?-m:m;l.forEach(e=>{e[0]+=h,e[1]+=f}),M.gaps=l=o.gaps(e,a,i,r,l),M.clip=Us(l,d.ori,p,x,g,b)}return 0!=E&&(M.band=2==E?[qs(e,a,i,r,T,-1),qs(e,a,i,r,T,1)]:qs(e,a,i,r,T,E)),M})},e.bars=function(e){const t=Ct((e=e||dn).size,[.6,It,1]),n=e.align||0,s=e.gap||0;let l=e.radius;l=null==l?[0,0]:"number"==typeof l?[l,0]:l;const a=Xt(l),i=1-t[0],r=Ct(t[1],It),o=Ct(t[2],1),c=Ct(e.disp,dn),u=Ct(e.each,e=>{}),{fill:d,stroke:m}=c;return(e,t,l,h)=>Vs(e,t,(f,p,x,g,b,v,y,w,j,k,N)=>{let M,T,S=f.pxRound,C=n,_=s*Qe,P=r*Qe,A=o*Qe;0==g.ori?[M,T]=a(e,t):[T,M]=a(e,t);const R=g.dir*(0==g.ori?1:-1);let D,E,$,F=0==g.ori?nl:sl,L=0==g.ori?u:(e,t,n,s,l,a,i)=>{u(e,t,n,l,s,i,a)},z=Ct(e.bands,mn).find(e=>e.series[0]==t),W=null!=z?z.dir:0,H=f.fillTo(e,t,f.min,f.max,W),B=S(y(H,b,N,j)),O=k,G=S(f.width*Qe),V=!1,I=null,Y=null,q=null,U=null;null==d||0!=G&&null==m||(V=!0,I=d.values(e,t,l,h),Y=new Map,new Set(I).forEach(e=>{null!=e&&Y.set(e,new Path2D)}),G>0&&(q=m.values(e,t,l,h),U=new Map,new Set(q).forEach(e=>{null!=e&&U.set(e,new Path2D)})));let{x0:X,size:K}=c;if(null!=X&&null!=K){C=1,p=X.values(e,t,l,h),2==X.unit&&(p=p.map(t=>e.posToVal(w+t*k,g.key,!0)));let n=K.values(e,t,l,h);E=2==K.unit?n[0]*k:v(n[0],g,k,w)-v(0,g,k,w),O=hl(p,x,v,g,k,w,O),$=O-E+_}else O=hl(p,x,v,g,k,w,O),$=O*i+_,E=O-$;$<1&&($=0),G>=E/2&&(G=0),$<5&&(S=Kt);let J=$>0;E=S(qt(O-$-(J?G:0),A,P)),D=(0==C?E/2:C==R?0:E)-C*R*((0==C?_/2:0)+(J?G/2:0));const Z={stroke:null,fill:null,clip:null,band:null,gaps:null,flags:0},Q=V?null:new Path2D;let ee=null;if(null!=z)ee=e.data[z.series[1]];else{let{y0:n,y1:s}=c;null!=n&&null!=s&&(x=s.values(e,t,l,h),ee=n.values(e,t,l,h))}let te=M*E,ne=T*E;for(let n=1==R?l:h;n>=l&&n<=h;n+=R){let s=x[n];if(null==s)continue;if(null!=ee){let e=ee[n]??0;if(s-e==0)continue;B=y(e,b,N,j)}let l=v(2!=g.distr||null!=c?p[n]:n,g,k,w),a=y(Ct(s,H),b,N,j),i=S(l-D),r=S(Wt(a,B)),o=S(zt(a,B)),u=r-o;if(null!=s){let l=s<0?ne:te,a=s<0?te:ne;V?(G>0&&null!=q[n]&&F(U.get(q[n]),i,o+$t(G/2),E,Wt(0,u-G),l,a),null!=I[n]&&F(Y.get(I[n]),i,o+$t(G/2),E,Wt(0,u-G),l,a)):F(Q,i,o+$t(G/2),E,Wt(0,u-G),l,a),L(e,t,n,i-G/2,o,E+G,u)}}return G>0?Z.stroke=V?U:Q:V||(Z._fill=0==f.width?f._fill:f._stroke??f._fill,Z.width=0),Z.fill=V?Y:Q,Z})},e.spline=function(e){return function(e,t){const n=Ct(null==t?void 0:t.alignGaps,0);return(t,s,l,a)=>Vs(t,s,(i,r,o,c,u,d,m,h,f,p,x)=>{[l,a]=yt(o,l,a);let g,b,v,y=i.pxRound,w=e=>y(d(e,c,p,h)),j=e=>y(m(e,u,x,f));0==c.ori?(g=Zs,v=el,b=il):(g=Qs,v=tl,b=rl);const k=c.dir*(0==c.ori?1:-1);let N=w(r[1==k?l:a]),M=N,T=[],S=[];for(let e=1==k?l:a;e>=l&&e<=a;e+=k)if(null!=o[e]){let t=w(r[e]);T.push(M=t),S.push(j(o[e]))}const C={stroke:e(T,S,g,v,b,y),fill:null,clip:null,band:null,gaps:null,flags:1},_=C.stroke;let[P,A]=Is(t,s);if(null!=i.fill||0!=P){let e=C.fill=new Path2D(_),n=j(i.fillTo(t,s,i.min,i.max,P));v(e,M,n),v(e,N,n)}if(!i.spanGaps){let e=[];e.push(...Xs(r,o,l,a,k,w,n)),C.gaps=e=i.gaps(t,s,l,a,e),C.clip=Us(e,c.ori,h,f,p,x)}return 0!=A&&(C.band=2==A?[qs(t,s,l,a,_,-1),qs(t,s,l,a,_,1)]:qs(t,s,l,a,_,A)),C})}(fl,e)}}a.memo(function({options:e,data:t,className:n="",onCreate:s}){const i=a.useRef(null),r=a.useRef(null);return a.useEffect(()=>{const n=i.current;if(!n)return;const l=n.getBoundingClientRect(),a=Math.floor(l.width)||400,o=Math.floor(l.height)||200,c=new Pl({...e,width:a,height:o},t,n);return r.current=c,null==s||s(c),()=>{c.destroy(),r.current=null}},[e]),a.useEffect(()=>{r.current&&t&&r.current.setData(t)},[t]),a.useEffect(()=>{const e=i.current;if(!e)return;const t=new ResizeObserver(e=>{const t=e[0];if(!t||!r.current)return;const{width:n,height:s}=t.contentRect;n>0&&s>0&&r.current.setSize({width:Math.floor(n),height:Math.floor(s)})});return t.observe(e),()=>{t.disconnect()}},[]),l.jsx("div",{ref:i,className:`w-full h-full ${n}`,style:{minHeight:100}})});const Al=new Map;function Rl(e){var t;if(!e.startsWith("var("))return e;const n=Al.get(e);if(n)return n;const s=e.match(/var\(([^,)]+)(?:,\s*([^)]+))?\)/);if(!s)return e;const l=s[1].trim(),a=(null==(t=s[2])?void 0:t.trim())||"#888888",i=getComputedStyle(document.documentElement).getPropertyValue(l).trim()||a;return Al.set(e,i),i}const Dl=a.memo(function({timestamps:e,series:t,onHover:n,highlightedKey:s=null,cursorColor:i="rgba(255,255,255,0.5)"}){const r=a.useRef(null),o=a.useRef(null),c=a.useRef(t),u=a.useRef(s),d=a.useRef(n),m=a.useRef(e.length);c.current=t,u.current=s,d.current=n;const h=a.useMemo(()=>{const t=new Array(e.length).fill(1);return[e,t]},[e]),f=a.useMemo(()=>({hooks:{draw:e=>{!function(e,t,n){if(0===t.length)return;const s=e.ctx,l=e.bbox,a=l.left,i=l.top,r=l.width,o=l.height;if(r<=0||o<=0)return;const c=e.data[0],u=c.length;if(0===u)return;const d=c[0],m=c[u-1]-d||1,h=e=>{const t=c[e];return a+(t-d)/m*r},f=e=>i+o*(1-e);for(let p=0;p<t.length;p++){const e=t[p],l=new Array(u).fill(0),a=new Array(u).fill(0);for(let n=0;n<p;n++){const e=t[n].values;for(let t=0;t<u;t++)a[t]+=e[t]??0}for(let t=0;t<u;t++)l[t]=a[t]+(e.values[t]??0);const i=n&&n!==e.key?.3:1,r=Rl(e.color);s.save(),s.globalAlpha=i,s.fillStyle=r,s.beginPath();let o=h(0),c=f(a[0]),d=f(l[0]);s.moveTo(o,c),s.lineTo(o,d);for(let t=1;t<u;t++){o=h(t);const e=d;d=f(l[t]),s.lineTo(o,e),s.lineTo(o,d)}for(let t=u-1;t>=0;t--){const e=h(t),n=f(a[t]);if(t===u-1)s.lineTo(e,n);else{const l=h(t+1);s.lineTo(l,n),s.lineTo(e,n)}}s.closePath(),s.fill(),s.restore()}}(e,c.current,u.current),function(e){const t=e.ctx,{left:n,top:s,width:l,height:a}=e.bbox;t.save(),t.strokeStyle="#1a3a4a",t.lineWidth=1,t.setLineDash([4,4]);for(const i of[.2,.4,.6,.8]){const e=s+a*(1-i);t.beginPath(),t.moveTo(n,e),t.lineTo(n+l,e),t.stroke()}t.restore(),t.save(),t.font='bold 10px "JetBrains Mono", monospace',t.fillStyle="#1a3a4a",t.textBaseline="bottom";for(const i of[20,40,60,80]){const e=s+a*(1-i/100);t.fillText(`${i}%`,n+4,e-4)}t.restore()}(e)}}}),[]),p=a.useMemo(()=>({width:400,height:200,padding:[0,0,0,0],cursor:{show:!0,x:!0,y:!1,drag:{x:!1,y:!1},points:{show:!1}},scales:{x:{time:!0},y:{range:[0,1]}},axes:[{show:!1},{show:!1}],series:[{},{show:!1}],hooks:{setCursor:[e=>{var t,n;const s=e.cursor.idx;if(null!=s&&s>=0){const n=e.data[0][s];null==(t=d.current)||t.call(d,s,n)}else null==(n=d.current)||n.call(d,null,null)}]},plugins:[f]}),[f]);a.useEffect(()=>{const t=r.current;if(!t||0===e.length)return;const n=m.current,s=e.length,l=Math.abs(s-n);if(!(!o.current||l>100||n>0&&l/n>.1)&&o.current)return o.current.setData(h),void(m.current=s);o.current&&o.current.destroy();const a=t.getBoundingClientRect(),i=Math.floor(a.width)||400,c=Math.floor(a.height)||200,u=new Pl({...p,width:i,height:c},h,t);return o.current=u,m.current=s,()=>{u.destroy(),o.current=null}},[p,h,e.length]),a.useEffect(()=>{const e=r.current;if(!e)return;const t=new ResizeObserver(e=>{const t=e[0];if(!t||!o.current)return;const{width:n,height:s}=t.contentRect;n>0&&s>0&&o.current.setSize({width:Math.floor(n),height:Math.floor(s)})});return t.observe(e),()=>{t.disconnect()}},[]),a.useEffect(()=>{o.current&&o.current.redraw()},[s,t]);const x=a.useCallback(()=>{null==n||n(null,null)},[n]);return 0===e.length?l.jsx("div",{className:"h-full flex items-center justify-center text-text-muted",children:"No data available"}):l.jsx("div",{ref:r,className:"w-full h-full rounded-2xl overflow-hidden",onMouseLeave:x})}),El=new Map;function $l(e){var t;if(!e.startsWith("var("))return e;const n=El.get(e);if(n)return n;const s=e.match(/var\(([^,)]+)(?:,\s*([^)]+))?\)/);if(!s)return e;const l=s[1].trim(),a=(null==(t=s[2])?void 0:t.trim())||"#888888",i=getComputedStyle(document.documentElement).getPropertyValue(l).trim()||a;return El.set(e,i),i}function Fl(e,t,n=!1){if(t.length<2)return;if(e.beginPath(),e.moveTo(t[0].x,t[0].y),2===t.length)return void e.lineTo(t[1].x,t[1].y);const s=.5;for(let l=0;l<t.length-1;l++){const n=t[Math.max(0,l-1)],a=t[l],i=t[l+1],r=t[Math.min(t.length-1,l+2)],o=a.x+(i.x-n.x)/6*s,c=a.y+(i.y-n.y)/6*s,u=i.x-(r.x-a.x)/6*s,d=i.y-(r.y-a.y)/6*s;e.bezierCurveTo(o,c,u,d,i.x,i.y)}n&&e.closePath()}function Ll(e,t,n,s){return{hooks:{draw:l=>{const a=e.current,i=t.current,r=n.current;if(0===a.length)return;const o=l.ctx,c=l.bbox,u=c.left,d=c.top,m=c.width,h=c.height;if(m<=0||h<=0)return;const f=l.data[0],p=f.length;if(0===p)return;const x=f[0],g=f[p-1]-x||1,b=e=>u+(e-x)/g*m,v=e=>d+h*(1-e/i),y={min:a.map(e=>({x:b(e.timestamp),y:v(e.min)})),max:a.map(e=>({x:b(e.timestamp),y:v(e.max)})),p5:a.map(e=>({x:b(e.timestamp),y:v(e.p5)})),p95:a.map(e=>({x:b(e.timestamp),y:v(e.p95)})),p25:a.map(e=>({x:b(e.timestamp),y:v(e.p25)})),p75:a.map(e=>({x:b(e.timestamp),y:v(e.p75)})),mean:a.map(e=>({x:b(e.timestamp),y:v(e.mean)})),median:a.map(e=>({x:b(e.timestamp),y:v(e.median)})),average:a.map(e=>({x:b(e.timestamp),y:v(e.average)}))},w=(e,t)=>r?r===e?Math.min(1,1.5*t):"minMax"===r||"p5p95"===r||"p25p75"===r?.3*t:t:t,j=e=>r?r===e?1:"mean"===r||"median"===r||"average"===r?.3:1:1,k={band:$l(s.band),innerBand:$l(s.innerBand),mean:$l(s.mean),median:$l(s.median),average:$l(s.average)};o.save(),o.strokeStyle=k.average,o.lineWidth=4,o.globalAlpha=j("average"),Fl(o,y.average),o.stroke(),o.globalAlpha=w("minMax",.15),o.fillStyle=k.band,o.beginPath(),Fl(o,y.max);const N=[...y.min].reverse();for(const e of N)o.lineTo(e.x,e.y);o.closePath(),o.fill(),o.globalAlpha=w("p5p95",.3),o.fillStyle=k.band,o.beginPath(),Fl(o,y.p95);const M=[...y.p5].reverse();for(const e of M)o.lineTo(e.x,e.y);o.closePath(),o.fill(),o.globalAlpha=w("p25p75",.55),o.fillStyle=k.innerBand,o.beginPath(),Fl(o,y.p75);const T=[...y.p25].reverse();for(const e of T)o.lineTo(e.x,e.y);o.closePath(),o.fill(),o.strokeStyle=k.median,o.lineWidth=1.5,o.globalAlpha=j("median"),o.setLineDash([4,4]),Fl(o,y.median),o.stroke(),o.strokeStyle=k.mean,o.lineWidth=1.5,o.globalAlpha=j("mean"),o.setLineDash([]),Fl(o,y.mean),o.stroke(),o.restore()}}}}a.memo(function({data:e,maxValue:t,onHover:n,highlightedItem:s=null,bandColor:i="#E12672",innerBandColor:r="#FF2D7A",meanColor:o="#FF6B9D",medianColor:c="#FF85AD",averageColor:u="#FFE135",cursorColor:d="rgba(255,255,255,0.5)"}){const m=a.useRef(null),h=a.useRef(null),f=a.useRef(e),p=a.useRef(t),x=a.useRef(s),g=a.useRef(n),b=a.useRef(e.length);f.current=e,p.current=t,x.current=s,g.current=n;const v=a.useMemo(()=>({band:i,innerBand:r,mean:o,median:c,average:u,cursor:d}),[i,r,o,c,u,d]),y=a.useMemo(()=>[e.map(e=>e.timestamp),e.map(e=>e.max)],[e]),w=a.useMemo(()=>({width:400,height:200,padding:[4,4,4,4],cursor:{show:!0,x:!0,y:!1,drag:{x:!1,y:!1},points:{show:!1}},scales:{x:{time:!0},y:{range:[0,t]}},axes:[{show:!1},{show:!1}],series:[{},{show:!1}],hooks:{setCursor:[e=>{var t,n;const s=e.cursor.idx;null!=s&&s>=0?null==(t=g.current)||t.call(g,s):null==(n=g.current)||n.call(g,null)}]},plugins:[Ll(f,p,x,v)]}),[t,v]);a.useEffect(()=>{const t=m.current;if(!t||0===e.length)return;const n=b.current,s=e.length,l=Math.abs(s-n);if(!(!h.current||l>100||n>0&&l/n>.1)&&h.current)return h.current.setData(y),void(b.current=s);h.current&&h.current.destroy();const a=t.getBoundingClientRect(),i=Math.floor(a.width)||400,r=Math.floor(a.height)||200,o=new Pl({...w,width:i,height:r},y,t);return h.current=o,b.current=s,()=>{o.destroy(),h.current=null}},[w,y,e.length]),a.useEffect(()=>{const e=m.current;if(!e)return;const t=new ResizeObserver(e=>{const t=e[0];if(!t||!h.current)return;const{width:n,height:s}=t.contentRect;n>0&&s>0&&h.current.setSize({width:Math.floor(n),height:Math.floor(s)})});return t.observe(e),()=>{t.disconnect()}},[]),a.useEffect(()=>{h.current&&h.current.redraw()},[s,e]);const j=a.useCallback(()=>{null==n||n(null)},[n]);return 0===e.length?l.jsx("div",{className:"h-full flex items-center justify-center text-text-muted",children:"No data available"}):l.jsx("div",{ref:m,className:"w-full h-full rounded-2xl overflow-hidden",onMouseLeave:j})});const zl={useAbsoluteThresholds:!0,baselinePercentile:6,spikePercentile:50,baselineDbm:-107,spikeDbm:-100,mergeGapSeconds:45,minSequenceLength:16,similarityToleranceDbm:5};function Wl(e,t){if(0===e.length)return 0;const n=t/100*(e.length-1),s=Math.floor(n),l=Math.ceil(n);return s===l?e[s]:e[s]+(e[l]-e[s])*(n-s)}function Hl(e){if(0===e.length)return{median:0,p90:0,p95:0,p99:0,max:0,min:0};const t=[...e].sort((e,t)=>e-t);return{median:Wl(t,50),p90:Wl(t,90),p95:Wl(t,95),p99:Wl(t,99),max:t[t.length-1],min:t[0]}}function Bl(e,t,n){const s=n-t;if(0===s)return"moderate";const l=(e-t)/s;return l>.66?"critical":l>.33?"severe":"moderate"}function Ol(e){switch(e){case"critical":return"rgba(239, 68, 68, 0.6)";case"severe":return"rgba(249, 115, 22, 0.5)";case"moderate":return"rgba(250, 204, 21, 0.4)"}}function Gl(){const e=getComputedStyle(document.documentElement);return{fontFamily:e.getPropertyValue("--font-data").trim()||'"JetBrains Mono", ui-monospace, monospace',axisColor:e.getPropertyValue("--chart-axis-tick").trim()||"rgba(255, 255, 255, 0.4)",gridColor:e.getPropertyValue("--chart-grid").trim()||"rgba(255, 255, 255, 0.06)",textMuted:e.getPropertyValue("--text-muted").trim()||"#727272",textPrimary:e.getPropertyValue("--text-primary").trim()||"#FFFFFF"}}"undefined"!=typeof window&&(null==(t=null==(e=window.matchMedia)?void 0:e.call(window,"(color-gamut: p3)"))||t.matches);const Vl=["min","max","p75","p95","p99","mean","median","average","midpoint"];let Il=null,Yl=0;const ql={0:"--pkt-science-req",1:"--pkt-science-response",2:"--pkt-science-txt-msg",3:"--pkt-science-ack",4:"--pkt-science-advert",5:"--pkt-science-grp-txt",6:"--pkt-science-grp-data",7:"--pkt-science-anon-req",8:"--pkt-science-path",9:"--pkt-science-trace",10:"--pkt-science-multipart",15:"--pkt-science-raw-custom"};let Ul=null,Xl=0;function Kl(e){if(!e||!e.startsWith("#"))return{r:102,g:102,b:102};const t=e.slice(1);return 3===t.length?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16)}:6===t.length?{r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16)}:{r:102,g:102,b:102}}function Jl(e){const t=function(){const e=Date.now();if(Ul&&e-Xl<1e3)return Ul;const t=getComputedStyle(document.documentElement),n=new Map;for(const[l,a]of Object.entries(ql)){const e=Kl(t.getPropertyValue(a).trim());n.set(parseInt(l),e)}const s=t.getPropertyValue("--pkt-science-unknown").trim();return n.set(255,Kl(s)),Ul=n,Xl=e,n}();return t.get(e)??t.get(255)??{r:102,g:102,b:102}}function Zl(e){const t=Date.now();(!Il||t-Yl>1e3)&&(Il={green:{r:34,g:197,b:94,p3:"color(display-p3 0.13 0.77 0.37)"},good:{r:132,g:204,b:22,p3:"color(display-p3 0.52 0.80 0.09)"},fair:{r:250,g:204,b:21,p3:"color(display-p3 0.98 0.80 0.08)"},poor:{r:249,g:115,b:22,p3:"color(display-p3 0.98 0.45 0.09)"},critical:{r:239,g:68,b:68,p3:"color(display-p3 0.94 0.27 0.27)"}},Yl=t);const n=Il;return e>=1?n.critical:e>=.75?n.poor:e>=.5?n.fair:e>=.25?n.good:n.green}const Ql=a.memo(function({data:e,maxValue:t,visibleLines:n=Vl,highlightedLine:s=null,onHover:i,scatterData:r=null,noiseFloorAnomalies:o=null,showNoiseFloorOverlay:c=!1,highlightedType:u=null,hoveredTimeRange:d=null,timeRangeHours:m=24}){const h=a.useRef(null),f=a.useRef(null),p=a.useRef(e),x=a.useRef(t),g=a.useRef(n),b=a.useRef(s),v=a.useRef(i),y=a.useRef(r),w=a.useRef(o),j=a.useRef(c),k=a.useRef(u),N=a.useRef(d),M=a.useRef(null),T=a.useRef(null),S=m<=12?1.2:1,C=a.useRef(S),_=a.useRef(e.length);p.current=e,x.current=t,g.current=n,b.current=s,v.current=i,y.current=r,w.current=o,j.current=c,k.current=u,N.current=d,C.current=S,a.useEffect(()=>{M.current=Gl()},[]);const P=a.useMemo(()=>[e.map(e=>e.timestamp),new Array(e.length).fill(1)],[e]),A=a.useMemo(()=>({hooks:{draw:e=>{const t=M.current||Gl();!function(e,t,n,s,l,a,i,r,o,c=null,u=null,d=1,m=null){if(0===t.length)return;const h=e.ctx,{left:f,top:p,width:x,height:g}=e.bbox,b=window.devicePixelRatio||1;if(x<=0||g<=0)return;const v=e.data[0],y=v.length;if(0===y)return;const w=v[0],j=v[y-1],k=n,N=getComputedStyle(document.documentElement),M=N.getPropertyValue("--signal-critical").trim()||"#EF4444",T=N.getPropertyValue("--bg-elevated").trim()||"#333233";h.save(),h.fillStyle="rgba(0, 0, 0, 0.4)";const S=8*b;if(h.beginPath(),h.roundRect(f,p,x,g,S),h.fill(),h.restore(),k>=20){h.save();const e=p+g*(1-20/k);h.fillStyle=T,h.globalAlpha=.5,h.fillRect(f,p,x,e-p),h.restore()}h.save(),h.lineWidth=1*b,h.setLineDash([4*b,4*b]);for(let _=5;_<k;_+=5){const e=_/k,t=Math.round(p+g*(1-e))+.5;20===_?(h.strokeStyle=M,h.globalAlpha=1):(h.strokeStyle=a.textPrimary,h.globalAlpha=.25),h.beginPath(),h.moveTo(Math.round(f),t),h.lineTo(Math.round(f+x),t),h.stroke()}h.restore(),h.save(),h.font=`bold ${10*b}px ${a.fontFamily}`,h.fillStyle=a.textPrimary,h.textBaseline="middle",h.textAlign="left";const C=8*b;for(let _=0;_<=k;_+=5){const e=p+g*(1-_/k),t=Math.max(p+C,Math.min(p+g-C,e)),n=`${_}%`;h.fillText(n,0,t)}if(h.restore(),function(e,t,n,s,l,a,i){if(null===t)return;if(t<n||t>n+l)return;const r=getComputedStyle(document.documentElement).getPropertyValue("--text-primary").trim()||"#FFFFFF";e.save(),e.strokeStyle=r,e.globalAlpha=.5,e.lineWidth=1*i,e.setLineDash([4*i,4*i]),e.beginPath(),e.moveTo(Math.round(t)+.5,s),e.lineTo(Math.round(t)+.5,s+a),e.stroke(),e.restore()}(h,m,f,p,x,g,b),i){!function(e,t,n,s,l,a,i=null,r=null,o=1,c=25){const{points:u,rawValues:d,count:m,packetTypes:h,timestamps:f,maxValue:p}=t,x=3*o*(window.devicePixelRatio||1);e.globalCompositeOperation="source-over";const g=i?parseInt(i.replace("TYPE_",""),10):null;for(let b=0;b<m;b++){const t=u[2*b],i=1-d[b]/c,o=n+t*l,m=s+Math.max(0,Math.min(1,i))*a,p=h[b],v=Jl(p);let y=!0;if(r&&f){const e=f[b];y=e>=r.start&&e<r.end}const w=!y||null!==g&&p!==g?.03:.8,j=e.createRadialGradient(o,m,0,o,m,x);j.addColorStop(0,`rgba(${v.r}, ${v.g}, ${v.b}, ${w})`),j.addColorStop(.25,`rgba(${v.r}, ${v.g}, ${v.b}, ${w})`),j.addColorStop(.26,`rgba(${v.r}, ${v.g}, ${v.b}, ${.4*w})`),j.addColorStop(.5,`rgba(${v.r}, ${v.g}, ${v.b}, ${.15*w})`),j.addColorStop(1,`rgba(${v.r}, ${v.g}, ${v.b}, 0)`),e.fillStyle=j,e.beginPath(),e.arc(o,m,x,0,2*Math.PI),e.fill()}e.globalCompositeOperation="source-over"}(h,i,f,p,x,g,c,u,d,k),h.save(),h.font=`bold ${9*b}px ${a.fontFamily}`,h.textBaseline="middle",h.textAlign="left";const e=i.maxValue,t=[{pct:0,label:`${e.toFixed(0)}%`},{pct:.25,label:`${(.75*e).toFixed(0)}%`},{pct:.5,label:`${(.5*e).toFixed(0)}%`},{pct:.75,label:`${(.25*e).toFixed(0)}%`},{pct:1,label:"0%"}];for(const{pct:n,label:s}of t){const e=p+g*n,t=Zl(n);h.fillStyle=`rgb(${t.r}, ${t.g}, ${t.b})`,h.fillText(s,f+x+8*b,e)}h.restore()}o&&r&&r.length>0&&function(e,t,n,s,l,a,i,r,o,c){if(0===t.length)return;const u=o-r||1;e.save();for(const d of t){if(d.endTs<r||d.startTs>o)continue;const t=s+(Math.max(d.startTs,r)-r)/u*a,n=s+(Math.min(d.endTs,o)-r)/u*a,m=Math.max(n-t,2*c);e.fillStyle=Ol(d.severity),e.fillRect(t,l,m,i)}e.restore()}(h,r,0,f,p,x,g,w,j,b)}(e,p.current,x.current,g.current,b.current,t,y.current,w.current,j.current,k.current,N.current,C.current,T.current)}}}),[]),R=a.useMemo(()=>({width:400,height:200,padding:[8,0,8,28],cursor:{show:!1,x:!1,y:!1,drag:{x:!1,y:!1},points:{show:!1}},scales:{x:{time:!0},y:{range:[0,1]}},axes:[{show:!1},{show:!1}],series:[{},{show:!1}],plugins:[A]}),[A]);a.useEffect(()=>{const t=h.current;if(!t||0===e.length)return;const n=_.current,s=e.length,l=Math.abs(s-n);if(!(!f.current||l>100||n>0&&l/n>.1)&&f.current)return f.current.setData(P),void(_.current=s);f.current&&f.current.destroy();const a=t.getBoundingClientRect(),i=Math.floor(a.width)||400,r=Math.floor(a.height)||200,o=new Pl({...R,width:i,height:r},P,t);return f.current=o,_.current=s,()=>{o.destroy(),f.current=null}},[R,P,e.length]),a.useEffect(()=>{const e=h.current;if(!e)return;const t=new ResizeObserver(e=>{const t=e[0];if(!t||!f.current)return;const{width:n,height:s}=t.contentRect;n>0&&s>0&&f.current.setSize({width:Math.floor(n),height:Math.floor(s)})});return t.observe(e),()=>{t.disconnect()}},[]),a.useEffect(()=>{f.current&&f.current.redraw()},[s,n,e,r,o,c,u,d,S]);const D=a.useCallback(t=>{var n,s;const l=h.current,a=f.current;if(!l||!a||0===e.length)return;const i=l.getBoundingClientRect(),r=t.clientX-i.left,o=window.devicePixelRatio||1,c=a.bbox,u=c.left/o,d=c.width/o;if(r<u||r>u+d)return T.current=null,a.redraw(),void(null==(n=v.current)||n.call(v,null));T.current=r*o;const m=(r-u)/d,p=e.length,x=Math.floor(m*p),g=Math.max(0,Math.min(p-1,x));a.redraw(),null==(s=v.current)||s.call(v,g)},[e.length]),E=a.useCallback(()=>{var e;T.current=null,f.current&&f.current.redraw(),null==(e=v.current)||e.call(v,null)},[]);return 0===e.length?l.jsx("div",{className:"h-full flex items-center justify-center text-text-muted",children:"No data available"}):l.jsx("div",{ref:h,className:"w-full h-full rounded-lg overflow-hidden",onMouseMove:D,onMouseLeave:E})}),ea={[L.REQ]:"var(--pkt-science-req)",[L.ANON_REQ]:"var(--pkt-science-anon-req)",[L.RESPONSE]:"var(--pkt-science-response)",[L.ACK]:"var(--pkt-science-ack)",[L.ADVERT]:"var(--pkt-science-advert)",[L.TXT_MSG]:"var(--pkt-science-txt-msg)",[L.GRP_TXT]:"var(--pkt-science-grp-txt)",[L.GRP_DATA]:"var(--pkt-science-grp-data)",[L.PATH]:"var(--pkt-science-path)",[L.TRACE]:"var(--pkt-science-trace)",[L.MULTIPART]:"var(--pkt-science-multipart)",[L.RAW_CUSTOM]:"var(--pkt-science-raw-custom)"},ta="var(--pkt-science-unknown)";function na(e){return"number"!=typeof e?ta:ea[e]??ta}const sa=new class{constructor(){s(this,"buckets",new Map),s(this,"lastProcessedTimestamp",0),s(this,"processedPacketCount",0),s(this,"cacheKey",null),s(this,"bucketDuration",60),s(this,"bucketDurationMs",6e4)}getBuckets(e,t,n,s){const l={startTs:t,endTs:n,radioConfigHash:this.hashRadioConfig(s)};return this.isCacheValid(l)?this.processPackets(e,t,n,s,!1):(this.invalidate(l),this.processPackets(e,t,n,s,!0)),this.toBucketDataArray(t,n)}processPackets(e,t,n,s,l){const a=Math.ceil((n-t)/this.bucketDuration);let i=0;for(const r of e){const e=r.timestamp;if(e<t||e>=n)continue;if(!l&&e<=this.lastProcessedTimestamp)continue;const o=Math.min(Math.floor((e-t)/this.bucketDuration),a-1),c=this.buckets.get(o)??{total:0,totalAirtime:0};c.total+=1;const u=$(r);c.totalAirtime+=F(u,{spreadingFactor:s.sf,bandwidthHz:s.bw,codingRate:s.cr,preambleLength:s.preamble}),this.buckets.set(o,c),e>this.lastProcessedTimestamp&&(this.lastProcessedTimestamp=e),i++}this.processedPacketCount+=i}toBucketDataArray(e,t){const n=t-e,s=Math.ceil(n/this.bucketDuration),l=n/3600,a=[];for(let i=0;i<s;i++){const t=e+i*this.bucketDuration,n=new Date(1e3*t),s=l>24?n.toLocaleDateString([],{weekday:"short",hour:"2-digit",minute:"2-digit",hour12:!1}):n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}),r=this.buckets.get(i)??{total:0,totalAirtime:0};a.push({timestamp:t,time:s,total:r.total,totalAirtime:r.totalAirtime,bucketDurationMs:this.bucketDurationMs})}return a}isCacheValid(e){return!!this.cacheKey&&this.cacheKey.startTs===e.startTs&&this.cacheKey.endTs===e.endTs&&this.cacheKey.radioConfigHash===e.radioConfigHash}invalidate(e){this.buckets.clear(),this.lastProcessedTimestamp=0,this.processedPacketCount=0,this.cacheKey=e}hashRadioConfig(e){return`${e.sf}-${e.bw}-${e.cr}-${e.preamble}`}clear(){this.buckets.clear(),this.lastProcessedTimestamp=0,this.processedPacketCount=0,this.cacheKey=null}getStats(){return{bucketCount:this.buckets.size,processedPackets:this.processedPacketCount,lastTimestamp:this.lastProcessedTimestamp,cacheKey:this.cacheKey}}};function la(e){return z[e]??`TYPE_${e.toString(16).toUpperCase()}`}const aa={sf:10,bw:25e4,cr:5,preamble:8};function ia(e,t){if(0===e.length)return[];const n=Math.floor((t-1)/2),s=[];for(let l=0;l<e.length;l++){const t=l>=n?e[l-n]:e[0];s.push(e[l]+(e[l]-t))}return function(e,t){if(0===e.length)return[];const n=2/(t+1),s=[e[0]];for(let l=1;l<e.length;l++)s.push(n*e[l]+(1-n)*s[l-1]);return s}(s,t)}function ra({sortedTypes:e,highlightedType:t,onTypeHover:n,aggregateShares:s,hoverData:i}){const r=a.useMemo(()=>{if(!i)return null;const e=new Map;for(const t of i.items)e.set(t.key,t.value);return e},[i]),o=null!==r;return l.jsx("div",{className:"flex-shrink-0 pt-3 mt-2",children:l.jsx("div",{className:"grid ml-9 gap-y-0.5",style:{gridTemplateColumns:"repeat(auto-fill, minmax(105px, 1fr))"},onMouseLeave:()=>n(null),children:e.map(e=>{const a=na(e.typeNum),i=(null==r?void 0:r.get(e.key))??0,c=s.get(e.key)??0,u=o?i:c,d=u>1e-4,m=t===e.key,h=t&&t!==e.key;let f="legend-item";return m?f+=" legend-item-active":h?f+=" legend-item-dimmed":o&&i>1e-4?f+=" legend-item-chart-active":o&&i<=1e-4&&(f+=" legend-item-dimmed"),l.jsxs("div",{className:f,onMouseEnter:()=>n(e.key),children:[l.jsx("div",{className:"w-2.5 h-2.5 rounded flex-shrink-0",style:{backgroundColor:a}}),l.jsx("span",{className:"legend-label",children:e.label}),d&&l.jsxs("span",{className:"legend-value "+(o?"legend-value-live":""),children:[(100*u).toFixed(1),"%"]})]},e.key)})})})}function oa({x:e,y:t,width:n,height:s,name:a,size:i,index:r,depth:o,hoveredIndex:c,onHover:u,total:d,typeNum:m}){if(1!==o)return null;const h=null!==c&&!(c===r),f=na(m),p=d>0?i/d*100:0,x=n>36&&s>20,g=n>36&&s>32;return l.jsxs("g",{onMouseEnter:e=>u(r,e),onMouseLeave:()=>u(null),style:{cursor:"default"},children:[l.jsx("rect",{x:e,y:t,width:n,height:s,fill:f,opacity:h?.4:1,stroke:"rgba(0,0,0,0.2)",strokeWidth:1,rx:3,style:{transition:"opacity 150ms ease"}}),x&&l.jsxs(l.Fragment,{children:[g&&l.jsxs("text",{x:e+4,y:t+s-4-11,textAnchor:"start",dominantBaseline:"auto",fill:"rgba(0,0,0,0.6)",fontSize:8,fontFamily:"'JetBrains Mono', monospace",fontWeight:500,style:{pointerEvents:"none"},children:[p.toFixed(1),"%"]}),l.jsx("text",{x:e+4,y:t+s-4,textAnchor:"start",dominantBaseline:"auto",fill:"rgba(0,0,0,0.85)",fontSize:9,fontFamily:"'JetBrains Mono', monospace",fontWeight:600,style:{pointerEvents:"none"},children:a})]})]})}function ca({data:e,total:t,color:n,position:s,containerWidth:a}){if(!e||!s)return null;const i=(e.value/t*100).toFixed(1),r=a-s.x<184?Math.max(8,s.x-160-8):s.x+16;return l.jsx("div",{className:"absolute z-50 pointer-events-none",style:{left:r,top:Math.max(8,s.y-60)},children:l.jsxs("div",{className:"bg-tooltip-bg border border-border-subtle rounded-lg px-3 py-2 shadow-xl min-w-[140px]",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"w-2.5 h-2.5 rounded-sm flex-shrink-0",style:{backgroundColor:n}}),l.jsx("span",{className:"type-data-sm font-semibold text-text-primary",children:e.name})]}),l.jsxs("div",{className:"space-y-0.5 type-data-xs text-text-muted",children:[l.jsxs("div",{className:"flex justify-between gap-4",children:[l.jsx("span",{children:"Count"}),l.jsx("span",{className:"text-text-primary tabular-nums font-medium",children:e.value.toLocaleString()})]}),l.jsxs("div",{className:"flex justify-between gap-4",children:[l.jsx("span",{children:"Share"}),l.jsxs("span",{className:"text-text-primary tabular-nums font-medium",children:[i,"%"]})]}),l.jsxs("div",{className:"flex justify-between gap-4",children:[l.jsx("span",{children:"Total"}),l.jsx("span",{className:"text-text-primary tabular-nums font-medium",children:t.toLocaleString()})]})]})]})})}function ua({sortedTypes:e,aggregateShares:t}){var n,s,i;const[r,o]=a.useState(null),[c,u]=a.useState(null),[d,m]=a.useState(0),[h,f]=a.useState(null),x=a.useRef(null),g=a.useMemo(()=>e.reduce((e,t)=>e+t.totalCount,0),[e]),b=a.useMemo(()=>e.map((e,t)=>({name:e.label,size:e.totalCount,index:t,typeNum:e.typeNum,key:e.key})),[e]),v=a.useCallback((e,t)=>{if(o(e),t&&null!==e){const e=x.current;if(e){const n=e.getBoundingClientRect();m(n.width),u({x:t.clientX-n.left,y:t.clientY-n.top})}}else u(null)},[]),y=a.useCallback(e=>{if(f(e),e){const t=b.findIndex(t=>t.key===e);o(t>=0?t:null)}else o(null)},[b]),w=null!==r?{name:(null==(n=b[r])?void 0:n.name)??"",value:(null==(s=b[r])?void 0:s.size)??0}:null,j=null!==r?na(null==(i=b[r])?void 0:i.typeNum):"";return 0===e.length||0===g?l.jsxs("div",{className:"h-full flex items-center justify-center text-text-muted",children:[l.jsx(p,{className:"w-6 h-6 mr-2 opacity-50"}),l.jsx("span",{children:"No packet type data available"})]}):l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("div",{className:"analyzer-chart-height relative flex-shrink-0",ref:x,children:[l.jsx(de,{width:"100%",height:"100%",children:l.jsx(me,{data:b,dataKey:"size",aspectRatio:4/3,stroke:"none",isAnimationActive:!1,content:l.jsx(oa,{x:0,y:0,width:0,height:0,name:"",size:0,index:0,depth:0,hoveredIndex:r,onHover:v,total:g,typeNum:0})})}),l.jsx(ca,{data:w,total:g,color:j,position:c,containerWidth:d})]}),l.jsx(ra,{sortedTypes:e,highlightedType:h,onTypeHover:y,aggregateShares:t})]})}function da(e){const{values:t,sum:n}=e;if(0===t.length)return{min:0,mean:0,median:0,p75:0,p95:0,p99:0,max:0};const s=[...t].sort((e,t)=>e-t),l=s.length,a=n/l,i=s[0],r=s[l-1],o=e=>{const t=Math.min(Math.ceil(e*l)-1,l-1);return s[Math.max(0,t)]};return{min:i,mean:a,median:l%2==0?(s[l/2-1]+s[l/2])/2:s[Math.floor(l/2)],p75:o(.75),p95:o(.95),p99:o(.99),max:r}}function ma({statsBuckets:e,bucketData:t,mode:n,packets:s,startTs:i,endTs:r,radioConfig:o,sortedTypes:c,aggregateShares:u,noiseFloorAnomalies:d,showNoiseFloorOverlay:m}){const[h,f]=a.useState(null),[x,g]=a.useState(null),b=a.useMemo(()=>(r-i)/3600,[i,r]),v=a.useCallback(e=>{g(e)},[]),y=function(e,t,n,s,l){return a.useMemo(()=>{if(0===e.length||!l)return null;const a=e.filter(e=>e.timestamp>=t&&e.timestamp<=n);if(0===a.length)return null;const i=Ce,r=[],o=new Map;for(const e of a){const n=e.type??e.payload_type??-1;let a;if("airtime"===s){const t=$(e);a=F(t,{spreadingFactor:l.sf,bandwidthHz:l.bw,codingRate:l.cr,preambleLength:l.preamble})}else a=1;if(a<=0)continue;const i=Math.floor((e.timestamp-t)/300),c={timestamp:e.timestamp,airtimeMs:a,packetType:n,bucketIndex:i};r.push(c),o.has(i)||o.set(i,[]),o.get(i).push(c)}if(0===r.length)return null;const c=[],u=[],d=[],m=new Map;for(const[,e]of o){const t=e.reduce((e,t)=>e+t.airtimeMs,0)/i*100,n=Math.max(...e.map(e=>e.airtimeMs));for(const s of e){const e=s.airtimeMs/n*t;m.set(s,e)}}for(const e of r){const t=m.get(e);void 0!==t&&(c.push(t),u.push(e.timestamp),d.push(e.packetType))}const h=Math.min(...u),f=Math.max(...u),p=f-h||1,x=[...c].sort((e,t)=>e-t),g=x[0],b=x[x.length-1],v=Math.floor(.05*x.length),y=Math.floor(.5*x.length),w=Math.min(Math.ceil(.95*x.length),x.length-1),j=x[v],k=x[y],N=x[w],M=new Map;for(const e of c){const t=Math.round(100*e)/100;M.set(t,(M.get(t)??0)+1)}const T=M.size,S=[...M.entries()].sort((e,t)=>t[1]-e[1]).slice(0,5).map(([e,t])=>({value:e,count:t,percent:t/c.length*100})),C=5*Math.ceil(b/5),_=Math.max(C+5,10),P=new Float32Array(2*c.length),A=new Float32Array(c.length),R=new Uint8Array(c.length),D=new Float32Array(c.length);for(let e=0;e<c.length;e++){const t=(u[e]-h)/p,n=1-Math.max(0,Math.min(_,c[e]))/_;P[2*e]=t,P[2*e+1]=n,A[e]=c[e],R[e]=d[e]>=0?d[e]:255,D[e]=u[e]}if(c.length>100){const e=[];for(const[,t]of o){const n=t.reduce((e,t)=>e+t.airtimeMs,0);e.push(n/i*100)}e.reduce((e,t)=>e+t,0),e.length,Math.max(...e)}return{points:P,rawValues:A,packetTypes:R,timestamps:D,count:c.length,minTime:h,maxTime:f,minValue:0,maxValue:_,rawMinValue:g,rawMaxValue:b,unit:"%",stats:{p5:j,p50:k,p95:N,uniqueValues:T,topValues:S}}},[e,t,n,s,l])}(s,i,r,"airtime"===n?"airtime":"rate",o),{data:w}=a.useMemo(()=>function(e,t){var n;const s=e.length;if(0===s)return{data:[],windowSize:0,windowDurationMs:0};const l=(null==(n=e[0])?void 0:n.bucketDurationMs)??1e3,a=Math.min(Math.max(5,Math.round(3e5/l)),s),i=Math.floor(a/2),r=[];let o=0,c=0;for(let u=0;u<s;u++){const n=e[u],l=Math.max(0,u-i),a=Math.min(s,u+i+1),d=[];let m,h=0;for(let s=l;s<a;s++){const n=e[s];let l;l="share"===t?n.total/Math.max(1,n.bucketDurationMs/1e3):n.totalAirtime/n.bucketDurationMs*100,d.push(l),h+=l}m="share"===t?n.total/Math.max(1,n.bucketDurationMs/1e3):n.totalAirtime/n.bucketDurationMs*100,o+=m,c++;const f=da({values:d,sum:h}),p=(f.min+f.max)/2;r.push({timestamp:n.timestamp,time:n.time,min:f.min,max:f.max,p75:f.p75,p95:f.p95,p99:f.p99,mean:f.mean,median:f.median,average:o/c,midpoint:p})}return{data:r,windowSize:a,windowDurationMs:a*l}}(e,n),[e,n]),j=a.useMemo(()=>w.map(e=>({timestamp:e.timestamp,min:e.min,max:e.max,p75:e.p75,p95:e.p95,p99:e.p99,mean:e.mean,median:e.median,average:e.average,midpoint:e.midpoint})),[w]),k=a.useMemo(()=>{const e=(null==y?void 0:y.rawMaxValue)??5,t=5*Math.ceil(e/5);return Math.max(5,t)},[y]),N=a.useCallback(e=>{f(e)},[]),M=a.useMemo(()=>{if(null===h||!w[h])return null;const e=w[h];let t;t=b>=168?75:b>=72?35:b>=24?15:b>=3?10:5;const n=60*t/2,s=e.timestamp;return{start:s-n,end:s+n}},[h,w,b]),T=a.useMemo(()=>{if(null===h||!w[h]||!M)return null;const e=w[h].time,{start:t,end:l}=M,a=s.filter(e=>e.timestamp>=t&&e.timestamp<l);if(0===a.length)return{timestamp:w[h].timestamp,timeLabel:e,items:c.map(e=>({key:e.key,label:e.label,value:0,color:na(e.typeNum)}))};const i=new Map,r=new Map;let u=0,d=0;for(const n of a){const e=`TYPE_${n.type??n.payload_type??-1}`;if(i.set(e,(i.get(e)??0)+1),u++,o){const t=$(n),s=F(t,{spreadingFactor:o.sf,bandwidthHz:o.bw,codingRate:o.cr,preambleLength:o.preamble});r.set(e,(r.get(e)??0)+s),d+=s}}const m=c.map(e=>{let t;return t="airtime"===n?d>0?(r.get(e.key)??0)/d:0:u>0?(i.get(e.key)??0)/u:0,{key:e.key,label:e.label,value:t,color:na(e.typeNum)}});return{timestamp:w[h].timestamp,timeLabel:e,items:m}},[h,w,M,s,c,n,o]);if(0===w.length)return l.jsxs("div",{className:"h-full flex items-center justify-center text-text-muted",children:[l.jsx(p,{className:"w-6 h-6 mr-2 opacity-50"}),l.jsx("span",{children:"No packet data available"})]});const S=(null==T?void 0:T.timeLabel)??null;return l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("div",{className:"analyzer-chart-height relative flex-shrink-0",children:[l.jsx("div",{className:"absolute inset-0 rounded-lg overflow-hidden",children:l.jsx(Ql,{data:j,maxValue:k,onHover:N,scatterData:y,noiseFloorAnomalies:d,showNoiseFloorOverlay:m,highlightedType:x,hoveredTimeRange:M,timeRangeHours:b})}),S&&l.jsx("div",{className:"absolute top-1 right-1 px-2 py-0.5 bg-bg-elevated/90 rounded text-xs text-accent-secondary font-mono pointer-events-none",children:S})]}),l.jsx(ra,{sortedTypes:c,highlightedType:x,onTypeHover:v,aggregateShares:u,hoverData:T})]})}function ha({mode:e,onChange:t}){return l.jsxs("div",{className:"toggle-group toggle-group-sm",children:[l.jsx("button",{onClick:()=>t("share"),className:"toggle-group-item "+("share"===e?"active":""),children:"Total"}),l.jsx("button",{onClick:()=>t("airtime"),className:"toggle-group-item "+("airtime"===e?"active":""),children:"Airtime"})]})}function fa({enabled:e,onChange:t,anomalyCount:n=0,showTuning:s=!1,onTuningChange:a}){return l.jsxs("div",{className:"relative inline-flex items-center gap-1",children:[e&&a&&l.jsx("button",{onClick:()=>a(!s),className:"toggle-group toggle-group-sm "+(s?"active":""),title:s?"Hide tuning panel":"Show tuning panel",children:l.jsx("span",{className:"toggle-group-item "+(s?"active":""),children:l.jsx(i,{className:"w-3.5 h-3.5"})})}),l.jsx("button",{onClick:()=>t(!e),className:"toggle-group toggle-group-sm "+(e?"active":""),title:e?"Hide noise floor anomalies":"Show noise floor anomalies",children:l.jsx("span",{className:"toggle-group-item "+(e?"active":""),children:l.jsx(r,{className:"w-3.5 h-3.5"})})}),n>0&&l.jsx("span",{className:"absolute -top-2 -right-2 min-w-[18px] h-[18px] px-1 rounded-full bg-accent-danger text-white text-[10px] font-bold flex items-center justify-center pointer-events-none z-10",children:n>99?"99+":n})]})}function pa({smoothing:e,onChange:t}){return l.jsxs("div",{className:"toggle-group toggle-group-sm",children:[l.jsx("button",{onClick:()=>t("stats"),className:"toggle-group-item "+("stats"===e?"active":""),title:"Statistics view (scatter plot)",children:l.jsx(o,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>t("raw"),className:"toggle-group-item "+("raw"===e?"active":""),title:"No smoothing (raw values)",children:l.jsx(c,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>t("zlema"),className:"toggle-group-item "+("zlema"===e?"active":""),title:"6-period Zero-Lag EMA (light smoothing)",children:l.jsx(u,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>t("ema"),className:"toggle-group-item "+("ema"===e?"active":""),title:"12-period Zero-Lag EMA (moderate smoothing)",children:l.jsx(d,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>t("smooth"),className:"toggle-group-item "+("smooth"===e?"active":""),title:"24-period Zero-Lag EMA (heavy smoothing)",children:l.jsx(m,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>t("ultra"),className:"toggle-group-item "+("ultra"===e?"active":""),title:"96-period Zero-Lag EMA (ultra smoothing)",children:l.jsx(h,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>t("mosaic"),className:"toggle-group-item "+("mosaic"===e?"active":""),title:"Mosaic view (treemap chart)",children:l.jsx(f,{className:"w-3.5 h-3.5"})})]})}const xa=a.memo(function({packets:e,startTs:t,endTs:n,bucketCount:s,radioConfig:i=aa,mode:r="share",smoothing:o="raw",noiseFloorAnomalies:c=null,showNoiseFloorOverlay:u=!1}){const d=te(),[m,h]=a.useState(null),[f,x]=a.useState([]),g=a.useRef(null),b=a.useRef(0);a.useEffect(()=>{const t=Math.abs(e.length-b.current);if(0===t&&f.length>0)return;g.current&&clearTimeout(g.current);const n=t>100?50:500;return g.current=setTimeout(()=>{b.current=e.length,x(e)},n),()=>{g.current&&clearTimeout(g.current)}},[e,f.length]);const v=a.useMemo(()=>function(e){const t=new Map;for(const s of e){const e=s.type??s.payload_type??-1;t.set(e,(t.get(e)??0)+1)}const n=[];for(const[s,l]of t)n.push({typeNum:s,key:`TYPE_${s}`,label:la(s),totalCount:l});return n.sort((e,t)=>t.totalCount-e.totalCount)}(f),[f]),y=a.useMemo(()=>function(e,t,n,s,l,a){const i=n-t,r=i/s,o=1e3*r,c=[];for(let u=0;u<s;u++){const e=t+u*r,n=new Date(1e3*e),s=i/3600>24?n.toLocaleDateString([],{weekday:"short",hour:"2-digit",minute:"2-digit",hour12:!1}):n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1});c.push({timestamp:e,time:s,counts:{},shares:{},airtimes:{},total:0,totalAirtime:0,bucketDurationMs:o});for(const t of a)c[u].counts[t.key]=0,c[u].airtimes[t.key]=0}for(const u of e){const e=u.timestamp;if(e<t||e>=n)continue;const a=Math.min(Math.floor((e-t)/r),s-1),i=`TYPE_${u.type??u.payload_type??-1}`;c[a].counts[i]=(c[a].counts[i]??0)+1,c[a].total++;const o=$(u),d=F(o,{spreadingFactor:l.sf,bandwidthHz:l.bw,codingRate:l.cr,preambleLength:l.preamble});c[a].airtimes[i]=(c[a].airtimes[i]??0)+d,c[a].totalAirtime+=d}for(const u of c)for(const e of a)u.total>0?u.shares[e.key]=u.counts[e.key]/u.total*100:u.shares[e.key]=0;return c}(f,t,n,s,i,v),[f,t,n,s,i,v]),w=a.useMemo(()=>sa.getBuckets(f,t,n,i),[f,t,n,i]),j=a.useMemo(()=>v.reduce((e,t)=>e+t.totalCount,0),[v]),{sortedTypes:k,aggregateShares:N}=a.useMemo(()=>{const e=new Map;if("share"===r){if(j>0)for(const t of v)e.set(t.key,t.totalCount/j)}else{let t=0;const n=new Map;for(const e of y){t+=e.totalAirtime;for(const t of v){const s=n.get(t.key)??0;n.set(t.key,s+(e.airtimes[t.key]??0))}}if(t>0)for(const s of v)e.set(s.key,(n.get(s.key)??0)/t)}return{sortedTypes:[...v].sort((t,n)=>{const s=e.get(t.key)??0;return(e.get(n.key)??0)-s}),aggregateShares:e}},[v,j,r,y]),M=a.useMemo(()=>function(e,t,n,s="raw"){const l=function(e,t,n){if(e.length<=360)return e;const s=Math.ceil(e.length/360),l=[];for(let a=0;a<e.length;a+=s){const t=e.slice(a,Math.min(a+s,e.length));if(0===t.length)continue;const i={timestamp:t[0].timestamp,time:t[0].time,counts:{},shares:{},airtimes:{},total:0,totalAirtime:0,bucketDurationMs:t[0].bucketDurationMs*t.length};for(const e of t){i.total+=e.total,i.totalAirtime+=e.totalAirtime;for(const t of n)i.counts[t.key]=(i.counts[t.key]??0)+(e.counts[t.key]??0),i.airtimes[t.key]=(i.airtimes[t.key]??0)+(e.airtimes[t.key]??0)}for(const e of n)i.shares[e.key]=i.total>0?i.counts[e.key]/i.total*100:0;l.push(i)}return l}(e,0,n),a=l.length,i=n.length,r=Array.from({length:i},()=>new Array(a).fill(0));for(let m=0;m<a;m++){const e=l[m];if("share"===t)for(let t=0;t<i;t++){const s=n[t].key;r[t][m]=e.total>0?(e.counts[s]??0)/e.total:0}else{let t=0;for(let s=0;s<i;s++)t+=e.airtimes[n[s].key]??0;for(let s=0;s<i;s++){const l=n[s].key,a=e.airtimes[l]??0;r[s][m]=t>0?a/t:0}}}const o=Array.from({length:i},()=>new Array(a).fill(0));for(let m=0;m<i;m++)for(let e=0;e<a;e++){let t=0;for(let n=0;n<=m;n++)t+=r[n][e];o[m][e]=t}const c=o.map(e=>function(e,t){switch(t){case"zlema":return ia(e,6);case"ema":return ia(e,12);case"smooth":return ia(e,24);case"ultra":return ia(e,96);default:return e}}(e,s)),u=Array.from({length:i},()=>new Array(a).fill(0));for(let m=0;m<i;m++)for(let e=0;e<a;e++){const t=m>0?c[m-1][e]:0;let n=c[m][e]-t;n<0&&(n=0),n>1&&(n=1),u[m][e]=n}for(let m=0;m<a;m++){let e=0;for(let t=0;t<i;t++)e+=u[t][m];if(e>0&&Math.abs(e-1)>1e-6){const t=1/e;for(let e=0;e<i;e++)u[e][m]*=t}}const d=[];for(let m=0;m<a;m++){const e={timestamp:l[m].timestamp,time:l[m].time};for(let t=0;t<i;t++)e[n[t].key]=u[t][m];d.push(e)}return d}(y,r,k,o),[y,r,k,o]),T=a.useCallback(e=>{h(e)},[]),[S,C]=a.useState(null),_=a.useCallback(e=>{C(e)},[]),P=a.useMemo(()=>{if(null===S||!M[S])return null;const e=M[S];return{timestamp:e.timestamp,timeLabel:e.time,items:k.map(t=>({key:t.key,label:t.label,value:e[t.key]??0,color:na(t.typeNum)}))}},[S,M,k]),A=a.useMemo(()=>({timestamps:M.map(e=>e.timestamp),series:k.map(e=>({key:e.key,label:e.label,color:na(e.typeNum),values:M.map(t=>t[e.key]??0)}))}),[M,k]);return 0===f.length?0===e.length?l.jsxs("div",{className:"h-full flex items-center justify-center text-text-muted",children:[l.jsx(p,{className:"w-6 h-6 mr-2 opacity-50"}),l.jsx("span",{children:"No packet data available"})]}):null:"mosaic"===o?l.jsx(ua,{sortedTypes:k,aggregateShares:N}):"stats"===o?l.jsx(ma,{statsBuckets:w,bucketData:y,mode:r,packets:f,startTs:t,endTs:n,radioConfig:i,sortedTypes:k,aggregateShares:N,noiseFloorAnomalies:c,showNoiseFloorOverlay:u}):l.jsxs("div",{className:"flex flex-col",children:[l.jsx("div",{className:"analyzer-chart-height relative flex-shrink-0",children:l.jsx("div",{className:"absolute inset-0 rounded-lg overflow-hidden",children:l.jsx(Dl,{timestamps:A.timestamps,series:A.series,highlightedKey:m,cursorColor:d.cursor,onHover:_})})}),l.jsx(ra,{sortedTypes:k,highlightedType:m,onTypeHover:T,aggregateShares:N,hoverData:P})]})});function ga(e){const t=e.match(/\(([^)]+)\)\s*$/);return t?t[1]:e.length>10?e.slice(0,10):e}function ba({x:e,y:t,width:n,height:s,name:a,size:i,index:r,colors:o,depth:c,hoveredIndex:u,onHover:d,total:m}){if(1!==c)return null;const h=null!==u&&!(u===r),f=o[r%o.length],p=m>0?i/m*100:0,x=n>36&&s>20,g=n>36&&s>32,b=ga(a);return l.jsxs("g",{onMouseEnter:e=>d(r,e),onMouseLeave:()=>d(null),style:{cursor:"default"},children:[l.jsx("rect",{x:e,y:t,width:n,height:s,fill:f,opacity:h?.4:1,stroke:"rgba(0,0,0,0.2)",strokeWidth:1,rx:3,style:{transition:"opacity 150ms ease"}}),x&&l.jsxs(l.Fragment,{children:[g&&l.jsxs("text",{x:e+4,y:t+s-4-11,textAnchor:"start",dominantBaseline:"auto",fill:"rgba(0,0,0,0.6)",fontSize:8,fontFamily:"'JetBrains Mono', monospace",fontWeight:500,style:{pointerEvents:"none"},children:[p.toFixed(1),"%"]}),l.jsx("text",{x:e+4,y:t+s-4,textAnchor:"start",dominantBaseline:"auto",fill:"rgba(0,0,0,0.85)",fontSize:9,fontFamily:"'JetBrains Mono', monospace",fontWeight:600,style:{pointerEvents:"none"},children:b})]})]})}function va({data:e,total:t,color:n,position:s,containerWidth:a}){if(!e||!s)return null;const i=(e.value/t*100).toFixed(1),r=a-s.x<184?Math.max(8,s.x-160-8):s.x+16;return l.jsx("div",{className:"absolute z-50 pointer-events-none",style:{left:r,top:Math.max(8,s.y-60)},children:l.jsxs("div",{className:"bg-tooltip-bg border border-border-subtle rounded-lg px-3 py-2 shadow-xl min-w-[140px]",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"w-2.5 h-2.5 rounded-sm flex-shrink-0",style:{backgroundColor:n}}),l.jsx("span",{className:"type-data-sm font-semibold text-text-primary",children:ga(e.name)})]}),l.jsxs("div",{className:"space-y-0.5 type-data-xs text-text-muted",children:[l.jsxs("div",{className:"flex justify-between gap-4",children:[l.jsx("span",{children:"Count"}),l.jsx("span",{className:"text-text-primary tabular-nums font-medium",children:e.value.toLocaleString()})]}),l.jsxs("div",{className:"flex justify-between gap-4",children:[l.jsx("span",{children:"Share"}),l.jsxs("span",{className:"text-text-primary tabular-nums font-medium",children:[i,"%"]})]}),l.jsxs("div",{className:"flex justify-between gap-4",children:[l.jsx("span",{children:"Total"}),l.jsx("span",{className:"text-text-primary tabular-nums font-medium",children:t.toLocaleString()})]})]})]})})}const ya=a.memo(function({data:e}){var t,n;const[s,i]=a.useState(null),[r,o]=a.useState(null),[c,u]=a.useState(0),d=a.useRef(null),m=ne(),{treemapData:h,total:f}=a.useMemo(()=>{const t=e.reduce((e,t)=>e+t.value,0);return{treemapData:[...e].sort((e,t)=>t.value-e.value).filter(e=>t>0&&e.value/t*100>=.5).map((e,t)=>({name:e.name,size:e.value,index:t})),total:t}},[e]),p=a.useCallback((e,t)=>{if(i(e),t&&null!==e){const e=d.current;if(e){const n=e.getBoundingClientRect();u(n.width),o({x:t.clientX-n.left,y:t.clientY-n.top})}}else o(null)},[]),x=null!==s?{name:(null==(t=h[s])?void 0:t.name)??"",value:(null==(n=h[s])?void 0:n.size)??0}:null,g=null!==s?m[s%m.length]:"";return 0===e.length||0===f?l.jsx("div",{className:"h-56 flex items-center justify-center text-text-muted",children:"No packet type data available"}):l.jsxs("div",{className:"relative treemap-container",style:{height:224},ref:d,children:[l.jsx(de,{width:"100%",height:224,minWidth:1,minHeight:1,children:l.jsx(me,{data:h,dataKey:"size",aspectRatio:4/3,stroke:"none",isAnimationActive:!1,content:l.jsx(ba,{x:0,y:0,width:0,height:0,name:"",value:0,size:0,index:0,colors:m,depth:0,hoveredIndex:s,onHover:p,total:f})})}),l.jsx(va,{data:x,total:f,color:g,position:r,containerWidth:c})]})}),wa="airtimeSpectrumBlur";function ja({active:e,payload:t,label:n}){if(!e||!t||0===t.length)return null;const s=t.filter(e=>null!==e.value&&void 0!==e.value);if(0===s.length)return null;const a=n?new Date(1e3*n).toLocaleString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}):"";return l.jsxs("div",{className:"bg-tooltip-bg border border-border-subtle rounded-lg px-3 py-2 text-sm shadow-xl",children:[l.jsx("div",{className:"font-medium text-text-primary mb-1 font-mono",children:a}),s.map((e,t)=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-0.5",style:{backgroundColor:e.color}}),l.jsxs("span",{className:"text-text-muted",children:[e.name,":"]}),l.jsxs("span",{className:"text-text-primary tabular-nums font-mono",children:[Number(e.value).toFixed(2),"%"]})]},t))]})}function ka({payload:e,showDensityScale:t=!1}){return e?l.jsxs("div",{className:"flex items-center gap-4 justify-start text-xs font-mono pl-11",children:[e.map((e,t)=>l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-4 h-0.5",style:{backgroundColor:e.color}}),l.jsx("span",{className:"text-text-muted",children:e.value})]},t)),t&&l.jsxs("div",{className:"flex items-center gap-1.5 ml-2",children:[l.jsx("div",{className:"w-16 h-2 rounded-sm",style:{background:"linear-gradient(to right, \n                rgb(1,26,51), \n                rgb(53,82,85), \n                rgb(85,121,74), \n                rgb(150,149,53), \n                rgb(228,168,98), \n                rgb(250,195,165)\n              )"}}),l.jsx("span",{className:"text-text-muted",children:"Density"})]})]}):null}const Na=[[1,26,51],[20,43,67],[38,62,79],[53,82,85],[67,102,83],[85,121,74],[112,137,62],[150,149,53],[192,156,58],[228,168,98],[250,195,165]];function Ma(e){const t=Math.max(0,Math.min(1,e))*(Na.length-1),n=Math.floor(t),s=Math.min(n+1,Na.length-1),l=t-n;return`rgb(${Math.round(Na[n][0]+l*(Na[s][0]-Na[n][0]))},${Math.round(Na[n][1]+l*(Na[s][1]-Na[n][1]))},${Math.round(Na[n][2]+l*(Na[s][2]-Na[n][2]))})`}const Ta=a.memo(function({samples:e,startTs:t,endTs:n,yMax:s}){const i=se(),r=le(),o=ae(),c=a.useMemo(()=>void 0!==s?s:function(e){if(0===e.length)return 10;let t=0;for(const l of e){const e=l.rxRolling??l.rxUtilW;e>t&&(t=e)}const n=1.05*t,s=Math.ceil(n);return Math.max(1,s)}(e),[s,e]),u=r.critical,d=i.neutral,{cells:m,cellWidth:h,cellHeight:f}=a.useMemo(()=>function(e,t,n,s,l=120,a=30){const i=100/l+.5+"%",r=100/a+.5+"%";if(0===e.length||n<=t)return{cells:[],cellWidth:i,cellHeight:r};const o=n-t,c=a*l,u=new Float32Array(c),d=new Float32Array(c),m=(e,t)=>e*l+t;for(let y=0;y<e.length;y++){const i=e[y];if(i.timestamp<t||i.timestamp>n)continue;const r=Math.floor((i.timestamp-t)/o*(l-1)),c=Math.max(0,Math.min(l-1,r));if(i.rxUtilW>0){const e=Math.min(i.rxUtilW/s,1),t=Math.floor((1-e)*(a-1));for(let n=t;n<a;n++){const e=a-1-t,s=e>0?1-(n-t)/e*.7:1;u[m(n,c)]+=s}}if(i.txUtilW>0){const e=Math.min(i.txUtilW/s,1),t=Math.floor((1-e)*(a-1));for(let n=t;n<a;n++){const e=a-1-t,s=e>0?1-(n-t)/e*.7:1;d[m(n,c)]+=s}}}const h=[];for(let y=0;y<c;y++)u[y]>0&&h.push(u[y]),d[y]>0&&h.push(d[y]);h.sort((e,t)=>e-t);const f=h.length>0?h[Math.floor(.95*h.length)]:1,p=new Array(l),x=new Array(a),g=100/l,b=100/a;for(let y=0;y<l;y++)p[y]=y*g+"%";for(let y=0;y<a;y++)x[y]=y*b+"%";const v=[];for(let y=0;y<a;y++)for(let e=0;e<l;e++){const t=m(y,e),n=u[t]+.3*d[t];if(n>0&&f>0){const t=Math.min(n/f,1.5),s=Math.sqrt(t/1.5);v.push({xPct:p[e],yPct:x[y],intensity:s})}}return{cells:v,cellWidth:i,cellHeight:r}}(e,t,n,100,80,10),[e,t,n]),p=a.useMemo(()=>{if(0===e.length)return[];const t=e.filter(e=>"number"==typeof e.timestamp&&!isNaN(e.timestamp));if(t.length<=500)return t.map(e=>{const t=e.rxRolling??e.rxUtilW,n=e.txRolling??e.txUtilW;return{timestamp:e.timestamp,rx:"number"!=typeof t||isNaN(t)?0:t,tx:"number"!=typeof n||isNaN(n)?0:n}});const n=Math.ceil(t.length/250),s=[];for(let e=0;e<t.length;e+=n){const l=t.slice(e,Math.min(e+n,t.length));if(0===l.length)continue;let a=1/0,i=-1/0,r=l[0],o=l[0];for(const e of l){const t=e.rxRolling??e.rxUtilW;t<a&&(a=t,r=e),t>i&&(i=t,o=e)}const c=r.timestamp<o.timestamp?[r,o]:[o,r];r===o&&(c.length=1);for(const e of c){const t=e.rxRolling??e.rxUtilW,n=e.txRolling??e.txUtilW;s.push({timestamp:e.timestamp,rx:"number"!=typeof t||isNaN(t)?0:t,tx:"number"!=typeof n||isNaN(n)?0:n})}}return s},[e]),g=a.useMemo(()=>{const e=n-t,s=e/3600;return[0,.25,.5,.75,1].map(n=>{const l=new Date(1e3*(t+e*n)),a=l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}),i=l.toLocaleDateString([],{weekday:"short"});return{pct:n,label:s>24?`${i} ${a}`:a}})},[t,n]);return 0===e.length?l.jsx("div",{className:"h-full flex items-center justify-center text-text-muted",children:"No traffic data available"}):l.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[l.jsx("div",{className:"flex items-center flex-shrink-0 text-text-muted",style:{height:20,paddingLeft:44,paddingRight:8},children:l.jsx("div",{className:"relative w-full h-full flex items-center",children:g.map((e,t)=>l.jsxs("div",{className:"absolute flex items-center gap-1 type-data-xs",style:{left:100*e.pct+"%",transform:0===e.pct?"translateX(0)":1===e.pct?"translateX(-100%)":"translateX(-50%)"},children:[l.jsx(x,{className:"w-2.5 h-2.5 opacity-60"}),l.jsx("span",{className:"tabular-nums",children:e.label})]},t))})}),l.jsx("div",{className:"relative",style:{height:160},children:l.jsx(de,{width:"100%",height:160,minWidth:1,minHeight:1,children:l.jsxs(he,{data:p,margin:{top:4,right:8,bottom:0,left:0},children:[l.jsx(fe,{strokeDasharray:"3 3",stroke:o.primary,strokeOpacity:.15,vertical:!1}),l.jsx(pe,{dataKey:"timestamp",type:"number",domain:[t,n],axisLine:!1,tickLine:!1,tick:!1,height:0}),l.jsx(xe,{axisLine:!1,tickLine:!1,tick:{fill:o.primary,fontSize:10,fontFamily:"'JetBrains Mono', monospace"},dx:-8,width:44,tickFormatter:e=>`${e.toFixed(0)}%`,domain:[0,c]}),l.jsx(ge,{content:l.jsx(ja,{})}),l.jsx(be,{type:"linear",dataKey:"rx",name:"RX Avg",stroke:u,strokeWidth:2.5,strokeOpacity:.9,dot:!1,connectNulls:!1,isAnimationActive:!1}),l.jsx(be,{type:"linear",dataKey:"tx",name:"TX Avg",stroke:d,strokeWidth:2.5,strokeOpacity:.9,dot:!1,connectNulls:!1,isAnimationActive:!1})]})})}),l.jsx("div",{className:"relative overflow-hidden",style:{height:32,marginLeft:44,marginRight:8},children:l.jsxs("svg",{className:"absolute inset-0 w-full h-full",preserveAspectRatio:"none","aria-hidden":"true",children:[l.jsx("defs",{children:l.jsx("filter",{id:wa,x:"-100%",y:"-100%",width:"300%",height:"300%",children:l.jsx("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1 3"})})}),l.jsx("g",{filter:`url(#${wa})`,children:m.map((e,t)=>l.jsx("rect",{x:e.xPct,y:e.yPct,width:h,height:f,fill:Ma(e.intensity),opacity:.9},`cell-${t}`))})]})}),l.jsx("div",{className:"flex-shrink-0",style:{height:24,marginTop:8},children:l.jsx(ka,{payload:[{value:`RX (${Math.round(5)}m)`,color:u},{value:`TX (${Math.round(5)}m)`,color:d}],showDensityScale:!0})})]})}),Sa={"1x":1,"2x":2,"4x":4,"8x":8,"16x":16,"36x":36},Ca=[1,5,10,25,50,100,150];function _a(e,t,n,s){const l=Math.PI/180,a=(s-t)*l,i=e*l,r=n*l,o=Math.sin(a)*Math.cos(r),c=Math.cos(i)*Math.sin(r)-Math.sin(i)*Math.cos(r)*Math.cos(a);return(180*Math.atan2(o,c)/Math.PI+360)%360}function Pa(e,t,n,s){const l=Math.PI/180,a=(n-e)*l,i=(s-t)*l,r=Math.sin(a/2)**2+Math.cos(e*l)*Math.cos(n*l)*Math.sin(i/2)**2;return 12742*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))}const Aa=[{min:10,label:"Excellent"},{min:7,label:"Very Good"},{min:4,label:"Good"},{min:1,label:"Fair+"},{min:-2,label:"Fair"},{min:-5,label:"Fair-"},{min:-8,label:"Poor"},{min:-11,label:"Bad"},{min:-1/0,label:"Critical"}];function Ra(e,t){return t[oe(e)]||"#808080"}const Da=a.memo(function({neighbors:e,quickNeighbors:t,localLat:n,localLon:s,onStatsChange:i}){const[r,o]=a.useState(null),[c,u]=a.useState(new Set),[d,m]=a.useState({width:0,height:0}),[h,f]=a.useState("1x"),[p,x]=a.useState(1),b=a.useRef(null),v=a.useRef({}),y=a.useRef(null),w=a.useRef(null),j=a.useRef(p);j.current=p;const k=ie(),N=le(),M=re(),T=ae();a.useEffect(()=>{const e=w.current;if(!e)return;const t=new ResizeObserver(e=>{for(const t of e){const{width:e,height:n}=t.contentRect;e>0&&n>0&&m({width:e,height:n})}});t.observe(e);const n=e.getBoundingClientRect();return n.width>0&&n.height>0&&m({width:n.width,height:n.height}),()=>t.disconnect()},[]);const S=a.useMemo(()=>{const e=new Set;if(t)for(const n of t)e.add(n.hash);return e},[t]),C=a.useMemo(()=>{const e=new Map;if(t)for(const n of t)e.set(n.hash,{snr:n.avgSnr,rssi:n.avgRssi});return e},[t]),{processedNeighbors:_,maxDistance:P,totalNeighbors:A,zeroHopCount:R}=a.useMemo(()=>{const t=[];for(const[a,i]of Object.entries(e)){if(!i.latitude||!i.longitude||0===i.latitude||0===i.longitude)continue;if(!S.has(a))continue;const e=_a(n,s,i.latitude,i.longitude),l=Pa(n,s,i.latitude,i.longitude),r=C.get(a);t.push({hash:a.slice(0,8),name:i.node_name||i.name||"Unknown",snr:(null==r?void 0:r.snr)??i.snr??null,rssi:(null==r?void 0:r.rssi)??i.rssi??null,bearing:e,distance:l,normalizedDistance:0,lastSeen:i.last_seen,isZeroHop:!0})}const l=1.08*(t.length>0?Math.max(...t.map(e=>e.distance)):0);return t.sort((e,t)=>(e.snr??-1/0)-(t.snr??-1/0)),{processedNeighbors:t,maxDistance:l,totalNeighbors:t.length,zeroHopCount:t.length}},[e,n,s,S,C]);a.useEffect(()=>{null==i||i({zeroHopCount:R,totalCount:A,maxDistanceKm:P})},[R,A,P]),a.useEffect(()=>{const e=Sa[h],t=j.current;b.current&&cancelAnimationFrame(b.current);const n=performance.now(),s=l=>{const a=l-n,i=Math.min(a/400,1),r=(o=i)<.5?8*o*o*o*o:1-Math.pow(-2*o+2,4)/2;var o;x(t+(e-t)*r),b.current=i<1?requestAnimationFrame(s):null};return b.current=requestAnimationFrame(s),()=>{b.current&&cancelAnimationFrame(b.current)}},[h]);const D=P/p,E=a.useMemo(()=>Ca.filter(e=>e<=1.1*D),[D]);a.useEffect(()=>{const e=[];for(const n of _){const t=v.current[n.hash];void 0!==t&&t!==n.lastSeen&&e.push(n.hash),v.current[n.hash]=n.lastSeen}if(0===e.length)return;queueMicrotask(()=>{u(t=>new Set([...t,...e]))});const t=setTimeout(()=>{u(t=>{const n=new Set(t);return e.forEach(e=>n.delete(e)),n})},600);return()=>clearTimeout(t)},[_]);const $=0!==n&&0!==s,F=a.useMemo(()=>{const{width:e,height:t}=d,n=e/2,s=t/2,l=Math.max(10,e/2-12),a=Math.max(10,t/2-12),i=Math.max(10,l-16),r=Math.max(10,a-16);return{width:e,height:t,centerX:n,centerY:s,maxRadiusX:i,maxRadiusY:r,labelRadiusX:l,labelRadiusY:a,cornerRadius:.2*Math.min(i,r)}},[d]),{width:L,height:z,centerX:W,centerY:H,maxRadiusX:B,maxRadiusY:O,labelRadiusX:G,labelRadiusY:V,cornerRadius:I}=F,Y=a.useCallback((e,t=1)=>{const n=B*t,s=O*t,l=Math.min(I*t,n,s),a=(e%360+360)%360,i=a*Math.PI/180,r=180*Math.atan2(s-l,n-l)/Math.PI;let o,c;if(a<=45-r||a>315+r){const e=Math.tan(i);o=Math.max(W-n+l,Math.min(W+n-l,W+s*e*(n/s))),c=H-s}else if(a>45-r&&a<=45+r)o=W+n-l+l*Math.sin(i),c=H-s+l-l*Math.cos(i);else if(a>45+r&&a<=135-r){const e=1/Math.tan(i);c=Math.max(H-s+l,Math.min(H+s-l,H-n*e*(s/n))),o=W+n}else if(a>135-r&&a<=135+r)o=W+n-l+l*Math.sin(i),c=H+s-l-l*Math.cos(i);else if(a>135+r&&a<=225-r){const e=Math.tan(i);o=Math.max(W-n+l,Math.min(W+n-l,W-s*e*(n/s))),c=H+s}else if(a>225-r&&a<=225+r)o=W-n+l+l*Math.sin(i),c=H+s-l-l*Math.cos(i);else if(a>225+r&&a<=315-r){const e=1/Math.tan(i);c=Math.max(H-s+l,Math.min(H+s-l,H-n*e*(s/n))),o=W-n}else o=W-n+l+l*Math.sin(i),c=H-s+l-l*Math.cos(i);return{x:o,y:c}},[W,H,B,O,I]),q=a.useCallback((e,t)=>{const n=Y(e,1);return{x:W+(n.x-W)*t,y:H+(n.y-H)*t}},[Y,W,H]),U=a.useCallback(e=>({N:{x:W,y:H-V},S:{x:W,y:H+V},E:{x:W+G,y:H},W:{x:W-G,y:H},NE:{x:W+G,y:H-V},SE:{x:W+G,y:H+V},SW:{x:W-G,y:H+V},NW:{x:W-G,y:H-V}}[e]),[W,H,G,V]),X=a.useCallback(e=>{const t=B*e,n=O*e,s=Math.min(I*e,t,n),l=W-t,a=W+t,i=H-n,r=H+n;return[`M ${l+s} ${i}`,`L ${a-s} ${i}`,`Q ${a} ${i} ${a} ${i+s}`,`L ${a} ${r-s}`,`Q ${a} ${r} ${a-s} ${r}`,`L ${l+s} ${r}`,`Q ${l} ${r} ${l} ${r-s}`,`L ${l} ${i+s}`,`Q ${l} ${i} ${l+s} ${i}`,"Z"].join(" ")},[W,H,B,O,I]),K=a.useCallback(e=>{o(e)},[]),J=a.useCallback(e=>{f(e)},[]),Z=a.useCallback(e=>P<=0?0:e/P*p,[P,p]),Q=e=>`${e}km`,ee=a.useMemo(()=>{const e=E.map(e=>{const t=e/P*p;return{km:e,scale:t,labelY:H-O*t*.71}}).filter(e=>e.scale<=1.05&&e.scale>=.02).sort((e,t)=>t.km-e.km),t=[];for(const n of e)t.some(e=>Math.abs(e.labelY-n.labelY)<28)||t.push(n);return t},[E,P,p,H,O]),te=d.width>0&&d.height>0;return $?0===A?l.jsxs("div",{ref:y,className:"flex flex-col items-center justify-center h-full text-text-muted",children:[l.jsx(g,{className:"w-8 h-8 mb-2 opacity-50"}),l.jsx("p",{children:"No nodes with location data"})]}):l.jsxs("div",{ref:y,className:"relative h-full w-full flex overflow-hidden",children:[l.jsx("div",{ref:w,className:"relative flex-1 min-w-0 h-full",children:te&&l.jsxs("svg",{width:L,height:z,className:"absolute inset-0 z-0",children:[l.jsxs("defs",{children:[l.jsx("style",{children:"\n                @keyframes neighbor-blink-scale {\n                  0%, 100% {\n                    transform: scale(1);\n                    opacity: 0;\n                  }\n                  50% {\n                    transform: scale(1.3);\n                    opacity: 0.8;\n                  }\n                }\n                .neighbor-blink-ring {\n                  transform-origin: center;\n                  animation: neighbor-blink-scale 600ms ease-out forwards;\n                }\n              "}),l.jsx("clipPath",{id:"radar-clip",children:l.jsx("path",{d:X(1)})})]}),E.map(e=>{const t=Z(e);if(t>1.05||t<.02)return null;const n=ee.some(t=>t.km===e),s=W+B*t*.71,a=H-O*t*.71;return l.jsxs("g",{children:[l.jsx("path",{d:X(t),fill:"none",stroke:T.primary,strokeOpacity:.15,strokeWidth:1}),n&&l.jsx("text",{x:s+4,y:a-2,textAnchor:"start",dominantBaseline:"auto",className:"fill-text-secondary",fontSize:10,fontFamily:"'JetBrains Mono', monospace",children:Q(e)})]},`ring-${e}`)}),["N","E","S","W"].map(e=>{const t="N"===e||"S"===e,n=t?W:"E"===e?W+B:W-B,s=t?"N"===e?H-O:H+O:H;return l.jsx("line",{x1:W,y1:H,x2:n,y2:s,stroke:T.primary,strokeOpacity:.15,strokeWidth:1,strokeDasharray:"4 4"},e)}),["NE","SE","SW","NW"].map(e=>{const t=U(e);return l.jsx("line",{x1:W,y1:H,x2:t.x,y2:t.y,stroke:T.primary,strokeOpacity:.08,strokeWidth:1,strokeDasharray:"4 4"},`diag-${e}`)}),["N","E","S","W"].map(e=>{const t=U(e),n="E"===e?"end":"W"===e?"start":"middle",s="N"===e?"hanging":"S"===e?"auto":"middle";return l.jsx("text",{x:t.x,y:t.y,textAnchor:n,dominantBaseline:s,fill:N.critical,fontSize:16,fontWeight:600,fontFamily:"'JetBrains Mono', monospace","aria-hidden":"true",children:e},e)}),["NE","SE","SW","NW"].map(e=>{const t=U(e),n="NE"===e||"SE"===e?"end":"start",s="NE"===e||"NW"===e?"hanging":"auto";return l.jsx("text",{x:t.x,y:t.y,textAnchor:n,dominantBaseline:s,fill:N.critical,fontSize:16,fontWeight:600,fontFamily:"'JetBrains Mono', monospace","aria-hidden":"true",children:e},e)}),l.jsx("circle",{cx:W,cy:H,r:5,fill:M.chart6,stroke:"rgba(255,255,255,0.3)",strokeWidth:1,role:"img","aria-label":"Local node"}),l.jsx("g",{clipPath:"url(#radar-clip)",children:_.map(e=>{const t=P>0?e.distance/P*p:0;if(t>1)return null;const{x:n,y:s}=q(e.bearing,t),a=null!==e.snr?Ra(e.snr,k):"#808080",i=(null==r?void 0:r.hash)===e.hash,o=c.has(e.hash);return l.jsxs("g",{role:"img","aria-label":`${e.name}: ${e.distance.toFixed(1)}km ${e.bearing.toFixed(0)}`,children:[o&&l.jsx("circle",{cx:n,cy:s,r:10.5,fill:"none",stroke:"rgba(255,255,255,0.9)",strokeWidth:2,className:"neighbor-blink-ring"}),i&&l.jsx("circle",{cx:n,cy:s,r:10.5,fill:a,opacity:.3}),l.jsx("circle",{cx:n,cy:s,r:i?7:5,fill:a,stroke:"rgba(0,0,0,0.5)",strokeWidth:1,style:{cursor:"pointer",transition:"r 0.15s"},onMouseEnter:()=>K(e),onMouseLeave:()=>K(null)})]},e.hash)})})]})}),l.jsx("div",{className:"flex flex-col h-full items-stretch gap-1 py-2 pl-2 flex-shrink-0",role:"group","aria-label":"Zoom level",children:["1x","2x","4x","8x","16x","36x"].map(e=>l.jsx("button",{onClick:()=>J(e),"aria-pressed":h===e,className:"flex flex-1 items-center justify-center px-1.5 text-xs font-medium rounded transition-colors "+(h===e?"bg-accent-primary/20 text-accent-primary":"bg-white/5 text-text-muted hover:bg-white/10 hover:text-text-secondary"),children:e},e))}),r&&l.jsxs("div",{className:"absolute bg-tooltip-bg border border-border-subtle rounded-lg px-3 py-2 text-sm pointer-events-none z-10 shadow-xl",style:{left:"50%",bottom:8,transform:"translateX(-50%)"},children:[l.jsx("div",{className:"font-medium text-text-primary",children:r.name}),l.jsx("div",{className:"text-text-muted text-xs font-mono",children:r.hash}),null!==r.snr?l.jsx("div",{className:"flex gap-3 mt-1 text-xs",children:l.jsxs("span",{children:[l.jsx("span",{className:"text-text-muted",children:"SNR:"})," ",l.jsxs("span",{className:"tabular-nums",style:{color:Ra(r.snr,k)},children:[r.snr.toFixed(1)," dB"]}),l.jsxs("span",{className:"text-text-muted ml-1",children:["(",(ne=r.snr,(null==(se=Aa.find(e=>ne>=e.min))?void 0:se.label)??"Critical"),")"]})]})}):l.jsx("div",{className:"text-xs text-text-muted mt-1",children:"No SNR data"}),l.jsxs("div",{className:"flex gap-3 text-xs",children:[l.jsxs("span",{children:[l.jsx("span",{className:"text-text-muted",children:"Distance:"})," ",l.jsxs("span",{className:"tabular-nums text-text-secondary",children:[r.distance.toFixed(2)," km"]})]}),l.jsxs("span",{children:[l.jsx("span",{className:"text-text-muted",children:"Bearing:"})," ",l.jsxs("span",{className:"tabular-nums text-text-secondary",children:[r.bearing.toFixed(0),""]})]})]})]})]}):l.jsxs("div",{ref:y,className:"flex flex-col items-center justify-center h-full text-text-muted",children:[l.jsx(g,{className:"w-8 h-8 mb-2 opacity-50"}),l.jsx("p",{children:"Local node coordinates not configured"}),l.jsx("p",{className:"text-xs mt-1",children:"Set latitude/longitude in config to enable"})]});var ne,se});function Ea(e,t){if(0===e.length)return 0;const n=t/100*(e.length-1),s=Math.floor(n),l=Math.ceil(n);return s===l?e[s]:e[s]+(e[l]-e[s])*(n-s)}const $a=a.memo(function({timestamps:e,values:t,onStatsChange:n}){var s,i;const r=le(),[o,c]=a.useState(!0),u=a.useMemo(()=>{if(0===t.length)return null;const e=Math.min(...t),n=Math.max(...t),s=t.reduce((e,t)=>e+t,0)/t.length,l=[...t].sort((e,t)=>e-t);return{min:e,max:n,avg:s,p5:Ea(l,5),p95:Ea(l,95)}},[t]);a.useEffect(()=>{null==n||n(u)},[u]);const d=a.useCallback(()=>{c(e=>!e)},[]),{heatmapData:m,xLabels:h,yLabels:f}=a.useMemo(()=>{if(0===e.length||0===t.length||!u)return{heatmapData:null,xLabels:[],yLabels:[]};let n,s;if(o){const e=.1*(u.p95-u.p5||1);n=u.p5-e,s=u.p95+e}else{const e=.1*(u.max-u.min||1);n=u.min-e,s=u.max+e}const l=s-n,a=e[0],i=e[e.length-1]-a||1,r=new Float32Array(2*e.length);for(let o=0;o<e.length;o++){const c=(e[o]-a)/i,u=1-(Math.max(n,Math.min(s,t[o]))-n)/l;r[2*o]=c,r[2*o+1]=u}const c=[];for(let e=0;e<=5;e++){const t=a+i*e/5;c.push({pos:e/5*100,label:new Date(1e3*t).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})}const d=[];for(let e=0;e<=4;e++){const t=n+l*e/4;d.push({pos:100*(1-e/4),label:`${Math.round(t)}`})}return{heatmapData:{points:r,count:e.length},xLabels:c,yLabels:d}},[e,t,u,o]),p=a.useRef(null),x=a.useRef(null),[g,y]=a.useState({width:0,height:0}),w=r.critical,j=a.useMemo(()=>ce(w)??{r:225,g:38,b:114},[w]);return a.useEffect(()=>{const e=x.current;if(!e)return;const t=new ResizeObserver(e=>{for(const t of e){const{width:e,height:n}=t.contentRect;e>0&&n>0&&y({width:e,height:n})}});t.observe(e);const n=e.getBoundingClientRect();return n.width>0&&n.height>0&&y({width:n.width,height:n.height}),()=>t.disconnect()},[]),a.useEffect(()=>{const e=p.current;if(!e||!m||0===g.width)return;const t=e.getContext("2d");if(!t)return;const{width:n,height:s}=g,l=window.devicePixelRatio||1;e.width=n*l,e.height=s*l,e.style.width=`${n}px`,e.style.height=`${s}px`,t.scale(l,l),t.clearRect(0,0,n,s);const{points:a,count:i}=m,{r:r,g:o,b:c}=j,u=Math.max(3,Math.min(8,n/i*4));t.globalCompositeOperation="source-over";for(let d=0;d<i;d++){const e=a[2*d]*n,l=a[2*d+1]*s,i=t.createRadialGradient(e,l,0,e,l,u);i.addColorStop(0,`rgba(${r}, ${o}, ${c}, 0.8)`),i.addColorStop(.19,`rgba(${r}, ${o}, ${c}, 0.8)`),i.addColorStop(.2,`rgba(${r}, ${o}, ${c}, 0.1)`),i.addColorStop(1,`rgba(${r}, ${o}, ${c}, 0)`),t.fillStyle=i,t.beginPath(),t.arc(e,l,u,0,2*Math.PI),t.fill()}},[m,g,j]),m?l.jsxs("div",{className:"relative w-full h-full",role:"img","aria-label":`RF noise floor heatmap showing values from ${(null==(s=null==u?void 0:u.min)?void 0:s.toFixed(0))??"N/A"} to ${(null==(i=null==u?void 0:u.max)?void 0:i.toFixed(0))??"N/A"} dBm`,children:[l.jsx("div",{className:"absolute top-0 left-0 flex flex-col justify-between",style:{width:32,bottom:20},"aria-hidden":"true",children:f.map((e,t)=>l.jsx("span",{className:"type-data-xs text-text-muted tabular-nums text-right pr-1.5",style:{position:"absolute",top:`${e.pos}%`,transform:"translateY(-50%)",right:0},children:e.label},t))}),l.jsxs("div",{ref:x,className:"absolute overflow-hidden",style:{left:32,right:0,top:0,bottom:20},children:[l.jsx("svg",{className:"absolute inset-0 w-full h-full",preserveAspectRatio:"none","aria-hidden":"true",children:[0,25,50,75,100].map(e=>l.jsx("line",{x1:"0",y1:`${e}%`,x2:"100%",y2:`${e}%`,stroke:"rgba(255,255,255,0.06)",strokeDasharray:"3 3"},e))}),l.jsx("canvas",{ref:p,className:"absolute inset-0 w-full h-full","aria-hidden":"true"}),l.jsx("button",{type:"button",onClick:d,className:"absolute bottom-1 right-1 p-1.5 rounded bg-tooltip-bg/80 hover:bg-tooltip-bg active:bg-tooltip-bg transition-colors touch-manipulation",title:o?"Show full range (min/max)":"Show trimmed range (P5-P95)","aria-label":o?"Expand to show full data range":"Shrink to show trimmed percentile range","aria-pressed":!o,children:o?l.jsx(b,{className:"w-3.5 h-3.5 text-text-muted","aria-hidden":"true"}):l.jsx(v,{className:"w-3.5 h-3.5 text-text-muted","aria-hidden":"true"})})]}),l.jsx("div",{className:"absolute left-0 right-0 bottom-0",style:{left:32,height:20},"aria-hidden":"true",children:h.map((e,t)=>l.jsx("span",{className:"type-data-xs text-text-muted tabular-nums absolute top-1",style:{left:`${e.pos}%`,transform:"translateX(-50%)"},children:e.label},t))})]}):l.jsx("div",{className:"h-full flex items-center justify-center text-text-muted",children:"No noise floor data available"})}),Fa={repeater:"var(--signal-critical)",companion:"var(--accent-tertiary)",room_server:"var(--accent-secondary)"};function La(e){if(e.contact_type){const t=e.contact_type.toLowerCase();if("repeater"===t||"rep"===t)return"repeater";if("room server"===t||"room_server"===t||"room"===t||"server"===t)return"room_server";if("companion"===t||"client"===t||"cli"===t)return"companion"}return e.is_repeater?"repeater":"companion"}const za=a.memo(function({neighbors:e}){const t=a.useMemo(()=>{const t={repeater:0,companion:0,room_server:0};for(const s of Object.values(e)){const e=La(s);t[e]=(t[e]||0)+1}const n=Object.values(t).reduce((e,t)=>e+t,0);return{items:[{label:"Repeaters",count:t.repeater,percent:0,color:Fa.repeater},{label:"Companions",count:t.companion,percent:0,color:Fa.companion},{label:"Room Servers",count:t.room_server,percent:0,color:Fa.room_server}].map(e=>({...e,percent:n>0?e.count/n*100:0})).filter(e=>e.count>0).sort((e,t)=>t.count-e.count),total:n}},[e]);return 0===t.total?l.jsx("div",{className:"h-full flex items-center justify-center text-text-muted type-body-sm",children:"No neighbors discovered yet"}):l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsx("div",{className:"flex-1 flex flex-col justify-evenly",children:t.items.map(e=>l.jsxs("div",{className:"flex flex-col gap-1.5",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"type-data-sm text-text-secondary",children:e.label}),l.jsxs("span",{className:"type-data-sm text-text-muted tabular-nums",children:[e.count," ",l.jsxs("span",{className:"text-text-muted/60",children:["(",e.percent.toFixed(0),"%)"]})]})]}),l.jsx("div",{className:"h-2.5 bg-bg-elevated rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full rounded-full transition-all duration-500 ease-out",style:{width:`${e.percent}%`,backgroundColor:e.color,minWidth:e.count>0?"4px":"0"}})})]},e.label))}),l.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-border-subtle",children:[l.jsx("span",{className:"type-data-xs text-text-muted",children:"Total Nodes"}),l.jsx("span",{className:"type-data-sm text-text-primary font-medium tabular-nums",children:t.total})]})]})});function Wa({children:e,minHeight:t="100%",rootMargin:n="200px 0px",keepMounted:s=!0,className:i=""}){const r=a.useRef(null),[o,c]=a.useState(!1),[u,d]=a.useState(!1);a.useEffect(()=>{const e=r.current;if(!e)return;const t=new IntersectionObserver(([e])=>{const t=e.isIntersecting;d(t),t&&c(!0)},{rootMargin:n,threshold:0});return t.observe(e),()=>{t.disconnect()}},[n]);const m=u||s&&o;return l.jsx("div",{ref:r,className:`h-full w-full ${i}`,style:{minHeight:t},children:m?e:l.jsx("div",{className:"h-full w-full flex items-center justify-center text-text-muted/50",children:l.jsx("div",{className:"animate-pulse text-xs",children:"Loading chart..."})})})}const Ha={excellent:"text-signal-excellent",good:"text-signal-good",fair:"text-signal-fair",poor:"text-signal-critical"},Ba={excellent:"bg-signal-excellent/10",good:"bg-signal-good/10",fair:"bg-signal-fair/10",poor:"bg-signal-critical/10"};function Oa({value:e,status:t}){const n={excellent:"bg-signal-excellent",good:"bg-signal-good",fair:"bg-signal-fair",poor:"bg-signal-critical"}[t];return l.jsx("div",{className:"w-full h-2 bg-surface-elevated rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full ${n} transition-all duration-300`,style:{width:`${Math.min(100,Math.max(0,e))}%`}})})}function Ga(){const e=W(),t=H(),[n,s]=a.useState(null),i=a.useCallback((e,t)=>{s({prefix:e,candidateHashes:t})},[]),r=a.useCallback(()=>{s(null)},[]);if(!t)return l.jsxs(ve,{children:[l.jsx(ye,{icon:l.jsx(y,{}),title:"Prefix Conflicts",largeTitle:!0}),l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsxs("div",{className:"text-center text-text-muted",children:[l.jsx(w,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),l.jsx("p",{className:"type-data-xs",children:"No topology data available"}),l.jsx("p",{className:"type-data-xs opacity-70",children:"Run deep analysis to see stats"})]})})]});const o=(c=e.avgConfidence)>=.9?"excellent":c>=.7?"good":c>=.5?"fair":"poor";var c;const u=(d=e.collisionRate)<=10?"excellent":d<=25?"good":"poor";var d;const m="poor"===o||"poor"===u?"poor":"fair"===o||"fair"===u?"fair":"good"===o||"good"===u?"good":"excellent",h="excellent"===m||"good"===m?j:k;return l.jsxs(ve,{className:"flex flex-col overflow-hidden",children:[l.jsx(ye,{icon:l.jsx(y,{}),title:"Prefix Conflicts",largeTitle:!0,actions:l.jsxs("div",{className:`flex items-center gap-1.5 px-2.5 py-1 rounded-full ${Ba[m]}`,children:[l.jsx(h,{className:`w-3.5 h-3.5 ${Ha[m]}`}),l.jsx("span",{className:`type-data-xs font-medium ${Ha[m]}`,children:"excellent"===m?"Excellent":"good"===m?"Good":"fair"===m?"Fair":"Needs Attention"})]})}),l.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[l.jsxs("div",{className:"cursor-help",title:"Average confidence score across all disambiguated prefixes. Higher = more certain node identification. Based on geographic proximity, co-occurrence patterns, and observation recency.",children:[l.jsxs("div",{className:"flex items-baseline justify-between mb-1",children:[l.jsx("span",{className:"type-data-xs text-text-muted",children:"Avg Confidence"}),l.jsxs("span",{className:`type-data-lg font-semibold ${Ha[o]}`,children:[(100*e.avgConfidence).toFixed(1),"%"]})]}),l.jsx(Oa,{value:100*e.avgConfidence,status:o})]}),l.jsxs("div",{className:"cursor-help",title:"Percentage of 2-character prefixes that match multiple known nodes. Lower is better. Collisions require disambiguation to determine the correct node.",children:[l.jsxs("div",{className:"flex items-baseline justify-between mb-1",children:[l.jsx("span",{className:"type-data-xs text-text-muted",children:"Collision Rate"}),l.jsxs("span",{className:`type-data-lg font-semibold ${Ha[u]}`,children:[e.collisionRate.toFixed(1),"%"]})]}),l.jsx(Oa,{value:e.collisionRate,status:u})]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3 py-2 border-t border-b border-border-subtle",children:[l.jsxs("div",{className:"text-center cursor-help",title:"Total unique 2-character prefixes observed in packet paths. Each prefix represents the first 2 hex digits of a node's full hash.",children:[l.jsx("div",{className:"type-data-lg font-semibold text-text-primary",children:e.totalPrefixes}),l.jsx("div",{className:"type-data-xs text-text-muted",children:"Prefixes"})]}),l.jsxs("div",{className:"text-center cursor-help",title:"Prefixes that map to exactly one known node. No disambiguation neededthese are definitive identifications.",children:[l.jsx("div",{className:"type-data-lg font-semibold text-signal-good",children:e.unambiguousPrefixes}),l.jsx("div",{className:"type-data-xs text-text-muted",children:"Unique"})]}),l.jsxs("div",{className:"text-center cursor-help",title:"Prefixes matching multiple known nodes. Click a prefix below to explore candidates and see how disambiguation scores them.",children:[l.jsx("div",{className:"type-data-lg font-semibold "+(e.collisionPrefixes>0?"text-signal-critical":"text-text-primary"),children:e.collisionPrefixes}),l.jsx("div",{className:"type-data-xs "+(e.collisionPrefixes>0?"text-signal-critical":"text-text-muted"),children:"Collisions"})]})]}),e.highCollisionPrefixes.length>0&&l.jsxs("div",{className:"mb-2",children:[l.jsx("div",{className:"type-data-xs text-text-muted mb-1.5",children:"Highest Collisions"}),l.jsx("div",{className:"flex flex-wrap gap-1",children:e.highCollisionPrefixes.map(({prefix:e,candidateCount:t,candidateHashes:n})=>l.jsxs("button",{type:"button",onClick:()=>i(e,n),className:"inline-flex items-center gap-1 px-1.5 py-0.5 min-h-[24px] rounded bg-surface-elevated text-text-secondary type-data-xs font-mono hover:bg-signal-critical/20 hover:text-signal-critical focus:outline-none focus:ring-2 focus:ring-signal-critical/50 transition-colors cursor-pointer touch-manipulation",title:`Click to explore ${t} candidates matching this prefix`,"aria-label":`Explore prefix ${e} with ${t} colliding candidates`,children:[e,l.jsxs("span",{className:"text-signal-critical",children:["",t]})]},e))})]}),e.lowConfidencePrefixes.length>0&&l.jsx("div",{className:"mt-auto pt-2 border-t border-border-subtle",children:l.jsxs("div",{className:"flex items-start gap-1.5",children:[l.jsx(k,{className:"w-3.5 h-3.5 text-signal-critical mt-0.5 flex-shrink-0"}),l.jsxs("div",{className:"min-w-0",children:[l.jsxs("div",{className:"type-data-xs text-signal-critical font-medium",children:[l.jsx("span",{className:"text-signal-critical",children:e.lowConfidencePrefixes.length})," prefix",1!==e.lowConfidencePrefixes.length?"es":""," with low confidence"]}),l.jsxs("div",{className:"type-data-xs text-text-muted font-mono truncate",children:[e.lowConfidencePrefixes.slice(0,5).join(", "),e.lowConfidencePrefixes.length>5&&l.jsxs("span",{className:"text-signal-critical",children:[" +",e.lowConfidencePrefixes.length-5," more"]})]})]})]})}),0===e.lowConfidencePrefixes.length&&0===e.collisionPrefixes&&l.jsx("div",{className:"mt-auto pt-2 border-t border-border-subtle",children:l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(j,{className:"w-3.5 h-3.5 text-signal-excellent"}),l.jsx("span",{className:"type-data-xs text-signal-excellent",children:"All prefixes uniquely identified"})]})})]}),l.jsx(ke,{isOpen:!!n,prefix:(null==n?void 0:n.prefix)||"",candidateHashes:(null==n?void 0:n.candidateHashes)||[],onClose:r})]})}function Va({icon:e,label:t,value:n,sublabel:s,highlight:a,tooltip:i}){return l.jsxs("div",{className:"flex items-center justify-between py-2 "+(i?"cursor-help":""),title:i,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"icon-xs text-icon-widget",children:e}),l.jsx("span",{className:"type-label text-text-secondary",children:t})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("span",{className:"type-data-sm "+(a?"text-accent-tertiary":"text-text-primary"),children:n}),s&&l.jsx("span",{className:"type-data-xs text-text-muted ml-1",children:s})]})]})}function Ia(){const e=B(),t=O().length;if(!e||0===e.totalPaths)return null;const{totalPaths:n,pathsWithGhosts:s,observationOverrideCount:a,tracePacketsProcessed:i,pathPacketsProcessed:r,distantEdgesDiscovered:o,duplicateGroupsFound:c,duplicatePathsUnique:u,echolocationEdgesInferred:d}=e,m=n-s,f=n>0?(m/n*100).toFixed(1):"0",p=n>0?(s/n*100).toFixed(1):"0",x=n>0?(a/n*100).toFixed(1):"0",g=i+r,b=g>0||o>0,v=c>0||d>0;return l.jsxs(ve,{children:[l.jsx(ye,{title:"Viterbi HMM",icon:l.jsx(N,{}),largeTitle:!0,badge:t>0?`${t} GHOSTS`:void 0}),l.jsxs(Te,{children:[l.jsxs("div",{className:"divide-y divide-white/5",children:[l.jsx(Va,{icon:l.jsx(N,{className:"w-3.5 h-3.5"}),label:"Paths Decoded",value:n.toLocaleString(),tooltip:"Total packet paths analyzed by the Viterbi HMM algorithm. Each path is a sequence of node prefixes extracted from received packets."}),l.jsx(Va,{icon:l.jsx(M,{className:"w-3.5 h-3.5"}),label:"Paths with Ghosts",value:s.toLocaleString(),sublabel:`(${p}%)`,highlight:s>0,tooltip:"Paths containing prefixes that don't match any known node. These 'ghost' prefixes may represent repeaters not yet discovered via direct ADVERT."}),l.jsx(Va,{icon:l.jsx(T,{className:"w-3.5 h-3.5"}),label:"Observation Override",value:`${x}%`,sublabel:"of paths",tooltip:"Percentage of paths where real-world observations (signal strength, co-occurrence patterns) overrode the expected geographic transition model. Higher values indicate the algorithm is learning from actual mesh behavior."}),l.jsx(Va,{icon:l.jsx(S,{className:"w-3.5 h-3.5"}),label:"Fully Resolved",value:`${f}%`,sublabel:`(${m.toLocaleString()} paths)`,highlight:parseFloat(f)>=90,tooltip:"Percentage of paths where all node prefixes were successfully matched to known nodes. Higher values indicate better mesh visibility - the algorithm can identify every hop in the packet's journey."})]}),b&&l.jsxs("div",{className:"mt-3 pt-3 border-t border-border-subtle",children:[l.jsx("p",{className:"type-micro mb-2",children:"Distant Topology"}),l.jsxs("div",{className:"divide-y divide-white/5",children:[l.jsx(Va,{icon:l.jsx(C,{className:"w-3.5 h-3.5"}),label:"TRACE/PATH Packets",value:g.toLocaleString(),sublabel:i>0?`(${i} TRACE)`:void 0,tooltip:"TRACE and PATH packets contain pre-computed routes between distant nodes. These reveal mesh topology beyond what we can directly observe - edges between nodes that may never communicate with us."}),l.jsx(Va,{icon:l.jsx(_,{className:"w-3.5 h-3.5"}),label:"Distant Edges",value:o.toLocaleString(),highlight:o>0,tooltip:"Edges discovered from TRACE/PATH packet route data. These represent links between distant nodes that we wouldn't see from normal packet forwarding - revealing deeper mesh structure."})]})]}),v&&l.jsxs("div",{className:"mt-3 pt-3 border-t border-border-subtle",children:[l.jsx("p",{className:"type-micro mb-2",children:"Echolocation"}),l.jsxs("div",{className:"divide-y divide-white/5",children:[l.jsx(Va,{icon:l.jsx(P,{className:"w-3.5 h-3.5"}),label:"Duplicate Groups",value:c.toLocaleString(),sublabel:u>0?`(${u} paths)`:void 0,tooltip:"Packets received multiple times via different paths. Each duplicate is an 'echo' that reveals alternate routing through the mesh - like sonar mapping the network structure."}),l.jsx(Va,{icon:l.jsx(h,{className:"w-3.5 h-3.5"}),label:"Echo Edges",value:d.toLocaleString(),highlight:d>0,tooltip:"Edges inferred from echolocation analysis. When the same packet arrives via different forwarders, those forwarders are likely within RF range of each other - revealing hidden mesh connectivity."})]})]}),l.jsx("div",{className:"mt-3 pt-3 border-t border-border-subtle cursor-help",title:"Ghost nodes are high-confidence unknown repeaters inferred from path analysis. They appear frequently in packet paths (10+ observations), have consistent neighbor relationships (2+ common neighbors), confidence score 30%, and have reasonable location estimates. Check the Contacts page to see them on the map.",children:l.jsxs("p",{className:"type-label text-text-muted",children:[l.jsx("span",{className:"text-accent-tertiary type-data-sm",children:t})," ","unknown repeater",1!==t?"s":""," discovered via HMM analysis"]})})]})]})}function Ya(){var e,t,n,s,i,r,o,c,u,d,m,h,f,x,b,v,y;const w=G(),j=V(),k=I(),N=Y(),M=q(),[T,S]=a.useState(null),[C,_]=a.useState([]),[$,F]=a.useState(null),[L,z]=a.useState(null),[W,H]=a.useState(!0),[B,O]=a.useState(null),[te,ne]=a.useState(3),[se,le]=a.useState("airtime"),[ae,ie]=a.useState("smooth"),[re,oe]=a.useState(!1),[ce,ue]=a.useState(!1),[de,me]=a.useState(zl),he=N.length,fe=a.useCallback(e=>{a.startTransition(()=>{ne(e)})},[]),pe=U[te].hours,xe=60*pe,ge=X(pe),be=a.useMemo(()=>{var e;if(!(null==(e=null==w?void 0:w.config)?void 0:e.radio))return null;const t=w.config.radio;return{sf:t.spreading_factor??10,bw:t.bandwidth??25e4,cr:t.coding_rate??5,preamble:t.preamble_length??8}},[null==(t=null==(e=null==w?void 0:w.config)?void 0:e.radio)?void 0:t.spreading_factor,null==(s=null==(n=null==w?void 0:w.config)?void 0:n.radio)?void 0:s.bandwidth,null==(r=null==(i=null==w?void 0:w.config)?void 0:i.radio)?void 0:r.coding_rate,null==(c=null==(o=null==w?void 0:w.config)?void 0:o.radio)?void 0:c.preamble_length]),ke=a.useMemo(()=>0===he?null:Se.getBucketedStats(xe,ge,N,w),[he,xe,ge,be]),{utilSamples:Te,startTs:Ce,endTs:Pe}=a.useMemo(()=>{if(!ke)return{utilSamples:[],startTs:0,endTs:0};const{received:e,transmitted:t,forwarded:n,bucket_duration_seconds:s,start_time:l,end_time:a}=ke,i=function(e,t){const n=new Map;for(const s of e)n.set(s.start,{...s});for(const s of t){const e=n.get(s.start);e?(e.airtime_ms+=s.airtime_ms,e.count+=s.count):n.set(s.start,{...s})}return Array.from(n.values()).sort((e,t)=>e.start-t.start)}(t,n);return{utilSamples:_e(e,i),startTs:l,endTs:a}},[ke]),Ae=a.useMemo(()=>0===Te.length?{peak:0,mean:0}:{peak:Math.max(...Te.map(e=>e.rxUtilW)),mean:Te.reduce((e,t)=>e+t.rxUtilW,0)/Te.length},[Te]);a.useEffect(()=>{!async function(){var e;O(null);try{const[t,n]=await Promise.all([K(pe),J(pe)]);t.success&&t.data&&S(t.data),n.success&&(null==(e=n.data)?void 0:e.history)&&_(n.data.history)}catch(t){O(t instanceof Error?t.message:"Failed to load chart data")}finally{H(!1)}}()},[pe]);const Re=a.useMemo(()=>{switch(pe){case 72:return 6e5;case 168:return 18e5;default:return 3e5}},[pe]),De=a.useCallback(async()=>{try{const e=await K(pe);e.success&&e.data&&S(e.data)}catch{}},[pe]),Ee=a.useCallback(async()=>{var e;try{const t=await J(pe);t.success&&(null==(e=t.data)?void 0:e.history)&&_(t.data.history)}catch{}},[pe]);ee(De,Re,!0,!0),ee(Ee,Re,!0,!0);const $e=a.useMemo(()=>T&&T.series?T.series.map(e=>({name:e.name,value:e.data.reduce((e,t)=>e+(t[1]??0),0)})).filter(e=>e.value>0):[],[T]),Fe=a.useMemo(()=>0===C.length?{timestamps:[],values:[]}:{timestamps:C.map(e=>e.timestamp),values:C.map(e=>e.noise_floor_dbm)},[C]),Le=a.useMemo(()=>{if(C.length<10)return{anomalies:[],debug:void 0};const e=function(e,t={}){const n={...zl,...t};if(e.length<10)return{anomalies:[],thresholds:Hl([]),totalSamples:e.length,anomalySamples:0};const s=e.map(e=>e.noise_floor_dbm),l=Hl(s),a=[...s].sort((e,t)=>e-t);let i,r;n.useAbsoluteThresholds?(i=n.baselineDbm,r=n.spikeDbm):(i=Wl(a,n.baselinePercentile),r=Wl(a,n.spikePercentile));const o=[...e].sort((e,t)=>e.timestamp-t.timestamp),c=[];let u=null,d=0;for(const m of o)if(m.noise_floor_dbm>i&&m.noise_floor_dbm<r)if(d++,u){const e=Math.abs(m.noise_floor_dbm-u.rollingAvg)<=n.similarityToleranceDbm,t=m.timestamp-u.endTs<=n.mergeGapSeconds;e&&t?(u.endTs=m.timestamp,u.values.push(m.noise_floor_dbm),u.timestamps.push(m.timestamp),u.rollingAvg=u.values.reduce((e,t)=>e+t,0)/u.values.length):(u.values.length>=n.minSequenceLength&&c.push(u),u={startTs:m.timestamp,endTs:m.timestamp,values:[m.noise_floor_dbm],timestamps:[m.timestamp],rollingAvg:m.noise_floor_dbm})}else u={startTs:m.timestamp,endTs:m.timestamp,values:[m.noise_floor_dbm],timestamps:[m.timestamp],rollingAvg:m.noise_floor_dbm};else u&&u.values.length>=n.minSequenceLength&&c.push(u),u=null;return u&&u.values.length>=n.minSequenceLength&&c.push(u),0===c.length?{anomalies:[],thresholds:l,totalSamples:e.length,anomalySamples:d,debug:{baselineCutoff:i,spikeCutoff:r,midBandSamples:d}}:{anomalies:c.map(e=>{const t=Math.max(...e.values),n=e.values.reduce((e,t)=>e+t,0)/e.values.length;return{startTs:e.startTs,endTs:e.endTs,peakValue:t,avgValue:n,severity:Bl(n,i,r),sampleCount:e.values.length}}),thresholds:l,totalSamples:e.length,anomalySamples:d,debug:{baselineCutoff:i,spikeCutoff:r,midBandSamples:d}}}(C,de);return{anomalies:e.anomalies,debug:e.debug}},[C,de]),ze=Le.anomalies,We=U[te],He=a.useMemo(()=>{const e=(null==w?void 0:w.neighbors)??{};return Object.fromEntries(Object.entries(e).filter(([e])=>!j.has(e)))},[null==w?void 0:w.neighbors,j]),Be=a.useMemo(()=>{const e=Date.now()/1e3-3600*pe;return Object.fromEntries(Object.entries(He).filter(([,t])=>t.last_seen>=e))},[He,pe]),Oe=Z(pe),Ge=a.useMemo(()=>{const e=60*xe/Oe,t=Math.floor(Date.now()/1e3),n=Math.floor(t/e)*e;return{start:n-60*xe,end:n}},[xe,Oe]);return l.jsxs(we,{children:[l.jsx(je,{title:"Statistics",icon:l.jsx(A,{}),controls:l.jsx(Q,{ranges:U,selectedIndex:te,onSelect:fe})}),B&&l.jsx(ve,{className:"border border-accent-red/50 bg-accent-red/10",children:l.jsx("p",{className:"text-accent-red",children:B})}),re&&ce&&l.jsxs(ve,{className:"border border-accent-purple/30 bg-glass-surface/50",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"type-label",children:"Anomaly Detection Tuning"}),l.jsxs("span",{className:"type-data-xs text-text-muted",children:["(",We.label,")"]})]}),l.jsx("button",{onClick:()=>me(e=>({...e,useAbsoluteThresholds:!e.useAbsoluteThresholds})),className:"type-data-xs px-2 py-1 rounded transition-colors "+(de.useAbsoluteThresholds?"bg-accent-purple/30 text-accent-purple":"bg-glass-elevated text-text-muted hover:text-text-secondary"),children:de.useAbsoluteThresholds?"Absolute dBm":"Percentile"})]}),l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"type-micro",children:"Baseline"}),l.jsxs("span",{className:"ml-2 type-data-sm text-status-warning",children:[(null==(d=null==(u=Le.debug)?void 0:u.baselineCutoff)?void 0:d.toFixed(1))??""," dBm"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"type-micro",children:"Spike"}),l.jsxs("span",{className:"ml-2 type-data-sm text-status-warning",children:[(null==(h=null==(m=Le.debug)?void 0:m.spikeCutoff)?void 0:h.toFixed(1))??""," dBm"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"type-micro",children:"Mid-band"}),l.jsx("span",{className:"ml-2 type-data-sm text-accent-purple",children:(null==(f=Le.debug)?void 0:f.midBandSamples)??0})]}),l.jsxs("div",{children:[l.jsx("span",{className:"type-micro",children:"Anomalies"}),l.jsx("span",{className:"ml-2 type-data-sm text-status-danger",children:ze.length})]})]}),l.jsxs("div",{className:"mt-4 pt-4 border-t border-border-subtle",children:[de.useAbsoluteThresholds?l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"type-micro block mb-1",children:["Baseline (",de.baselineDbm," dBm)"]}),l.jsx("input",{type:"range",min:"-120",max:"-60",value:de.baselineDbm,onChange:e=>me(t=>({...t,baselineDbm:Number(e.target.value)})),className:"w-full accent-accent-purple"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"type-micro block mb-1",children:["Spike (",de.spikeDbm," dBm)"]}),l.jsx("input",{type:"range",min:"-100",max:"-20",value:de.spikeDbm,onChange:e=>me(t=>({...t,spikeDbm:Number(e.target.value)})),className:"w-full accent-accent-purple"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"type-micro block mb-1",children:["Merge Gap (",de.mergeGapSeconds,"s)"]}),l.jsx("input",{type:"range",min:"5",max:"120",step:"5",value:de.mergeGapSeconds,onChange:e=>me(t=>({...t,mergeGapSeconds:Number(e.target.value)})),className:"w-full accent-accent-purple"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"type-micro block mb-1",children:["Min Sequence (",de.minSequenceLength,")"]}),l.jsx("input",{type:"range",min:"2",max:"20",value:de.minSequenceLength,onChange:e=>me(t=>({...t,minSequenceLength:Number(e.target.value)})),className:"w-full accent-accent-purple"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"type-micro block mb-1",children:["Similarity (",de.similarityToleranceDbm," dBm)"]}),l.jsx("input",{type:"range",min:"1",max:"15",value:de.similarityToleranceDbm,onChange:e=>me(t=>({...t,similarityToleranceDbm:Number(e.target.value)})),className:"w-full accent-accent-purple"})]})]}):l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"type-micro block mb-1",children:["Baseline (P",de.baselinePercentile,")"]}),l.jsx("input",{type:"range",min:"1",max:"50",value:de.baselinePercentile,onChange:e=>me(t=>({...t,baselinePercentile:Number(e.target.value)})),className:"w-full accent-accent-purple"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"type-micro block mb-1",children:["Spike (P",de.spikePercentile,")"]}),l.jsx("input",{type:"range",min:"50",max:"99",value:de.spikePercentile,onChange:e=>me(t=>({...t,spikePercentile:Number(e.target.value)})),className:"w-full accent-accent-purple"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"type-micro block mb-1",children:["Merge Gap (",de.mergeGapSeconds,"s)"]}),l.jsx("input",{type:"range",min:"5",max:"120",step:"5",value:de.mergeGapSeconds,onChange:e=>me(t=>({...t,mergeGapSeconds:Number(e.target.value)})),className:"w-full accent-accent-purple"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"type-micro block mb-1",children:["Min Sequence (",de.minSequenceLength,")"]}),l.jsx("input",{type:"range",min:"2",max:"20",value:de.minSequenceLength,onChange:e=>me(t=>({...t,minSequenceLength:Number(e.target.value)})),className:"w-full accent-accent-purple"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"type-micro block mb-1",children:["Similarity (",de.similarityToleranceDbm," dBm)"]}),l.jsx("input",{type:"range",min:"1",max:"15",value:de.similarityToleranceDbm,onChange:e=>me(t=>({...t,similarityToleranceDbm:Number(e.target.value)})),className:"w-full accent-accent-purple"})]})]}),l.jsxs("div",{className:"mt-4 p-3 bg-glass-elevated rounded-lg",children:[l.jsx("div",{className:"type-micro mb-1",children:"Config output"}),l.jsxs("div",{className:"type-data-sm text-status-success",children:[de.useAbsoluteThresholds?`useAbsoluteThresholds: true, baselineDbm: ${de.baselineDbm}, spikeDbm: ${de.spikeDbm}`:`useAbsoluteThresholds: false, baselinePercentile: ${de.baselinePercentile}, spikePercentile: ${de.spikePercentile}`,", mergeGapSeconds: ",de.mergeGapSeconds,", minSequenceLength: ",de.minSequenceLength,", similarityToleranceDbm: ",de.similarityToleranceDbm]})]})]})]}),W?l.jsx(Ne,{template:"auto",children:l.jsx(ve,{className:"text-center py-12",children:l.jsx("div",{className:"animate-pulse text-text-muted",children:"Loading statistics..."})})}):l.jsxs(l.Fragment,{children:[l.jsx(Ne,{template:"hero-auto",children:l.jsxs(ve,{isLoaded:M,skeletonType:"chart",children:[l.jsx(ye,{icon:l.jsx(p,{}),title:"Packet Analyzer",badge:We.label,largeTitle:!0,actions:l.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:["stats"===ae&&l.jsx(fa,{enabled:re,onChange:oe,anomalyCount:ze.length,showTuning:ce,onTuningChange:ue}),l.jsx(pa,{smoothing:ae,onChange:ie}),l.jsx(ha,{mode:se,onChange:le})]})}),l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx(xa,{packets:N,startTs:Ge.start,endTs:Ge.end,bucketCount:Oe,radioConfig:be??void 0,mode:se,smoothing:ae,noiseFloorAnomalies:ze,showNoiseFloorOverlay:re})})]})}),l.jsxs(Ne,{template:"panel",children:[l.jsx(Me,{span:12,md:6,children:l.jsxs(ve,{isLoaded:M,skeletonType:"chart",children:[l.jsx(ye,{icon:l.jsx(R,{}),title:"Airtime Utilization",badge:`${Math.round(5)}m window`,largeTitle:!0,actions:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{className:"type-data-xs text-text-muted",children:["Peak ",l.jsxs("span",{className:"text-text-secondary tabular-nums font-medium",children:[Ae.peak.toFixed(2),"%"]})]}),l.jsxs("span",{className:"type-data-xs text-text-muted",children:["Mean ",l.jsxs("span",{className:"text-text-secondary tabular-nums font-medium",children:[Ae.mean.toFixed(2),"%"]})]})]})}),l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx(Wa,{children:l.jsx(Ta,{samples:Te,startTs:Ce,endTs:Pe})})})]})}),l.jsx(Me,{span:12,md:6,children:l.jsxs(ve,{isLoaded:M,skeletonType:"chart",children:[l.jsx(ye,{icon:l.jsx(g,{}),title:"Link Quality",badge:We.label,largeTitle:!0,actions:L?l.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 type-data-xs text-text-muted",children:[l.jsxs("span",{children:[l.jsx("span",{className:"text-text-secondary tabular-nums font-medium",children:L.zeroHopCount})," nbr"]}),l.jsxs("span",{children:[l.jsx("span",{className:"text-text-secondary tabular-nums font-medium",children:L.totalCount})," obs"]}),l.jsxs("span",{children:[l.jsx("span",{className:"text-text-secondary tabular-nums font-medium",children:L.maxDistanceKm.toFixed(0)})," km"]})]}):null}),l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx(Wa,{children:l.jsx(Da,{neighbors:Be,quickNeighbors:k,localLat:(null==(b=null==(x=null==w?void 0:w.config)?void 0:x.repeater)?void 0:b.latitude)??0,localLon:(null==(y=null==(v=null==w?void 0:w.config)?void 0:v.repeater)?void 0:y.longitude)??0,onStatsChange:z})})})]})})]}),l.jsxs(Ne,{template:"panel",children:[l.jsx(Me,{span:12,md:6,children:l.jsxs(ve,{isLoaded:M,skeletonType:"chart",children:[l.jsx(ye,{icon:l.jsx(D,{}),title:"Packet Types",largeTitle:!0}),l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx(Wa,{children:$e.length>0?l.jsx(ya,{data:$e}):l.jsx("div",{className:"h-full flex items-center justify-center text-text-muted",children:"No packet type data available"})})})]})}),l.jsx(Me,{span:12,md:6,children:l.jsxs(ve,{isLoaded:M,skeletonType:"chart",children:[l.jsx(ye,{icon:l.jsx(E,{}),title:"Network Composition",badge:We.label,largeTitle:!0}),l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx(Wa,{children:l.jsx(za,{neighbors:Be})})})]})})]}),l.jsxs(Ne,{template:"panel",children:[l.jsx(Me,{span:12,md:6,children:l.jsx(Ga,{})}),l.jsx(Me,{span:12,md:6,children:l.jsx(Ia,{})})]}),l.jsx(Ne,{template:"panel",children:l.jsx(Me,{span:12,children:l.jsxs(ve,{isLoaded:M,skeletonType:"chart",children:[l.jsx(ye,{icon:l.jsx(P,{}),title:"RF Noise Floor",largeTitle:!0,actions:$?l.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 md:gap-3",children:[l.jsxs("span",{className:"type-data-xs text-text-muted whitespace-nowrap",children:["min ",l.jsx("span",{className:"text-text-secondary tabular-nums",children:$.min.toFixed(0)})]}),l.jsxs("span",{className:"type-data-xs text-text-muted whitespace-nowrap",children:["avg ",l.jsx("span",{className:"text-text-secondary tabular-nums",children:$.avg.toFixed(0)})]}),l.jsxs("span",{className:"type-data-xs text-text-muted whitespace-nowrap",children:["max ",l.jsx("span",{className:"text-text-secondary tabular-nums",children:$.max.toFixed(0)})]}),l.jsx("span",{className:"type-data-xs text-text-muted",children:"dBm"})]}):l.jsx("span",{className:"type-data-xs text-text-muted",children:"dBm"})}),l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx(Wa,{children:l.jsx($a,{timestamps:Fe.timestamps,values:Fe.values,onStatsChange:F})})})]})})})]})]})}export{Ya as default};
