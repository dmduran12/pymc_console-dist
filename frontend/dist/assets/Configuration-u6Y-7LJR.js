const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/latin-400-BcR6IdUc.css","assets/latin-500-DCnAHIrw.css","assets/latin-600-CnkPk-vb.css","assets/latin-700-UC1i-VSI.css"])))=>i.map(i=>d[i]);
import{d as ue,r as t,j as e,c as l,L as $,w as B,bc as J,ae as Ss,dF as Ee,dG as es,dH as Je,bo as Se,T as ie,M as Zs,S as et,dI as st,F as X,ce as Qe,bQ as tt,v as at,dJ as Ts,dK as nt,dL as lt,dM as rt,R as it,B as F,dN as $e,I as ot,x as ct}from"./index-CLIbpHvY.js";import{g as dt,a as ut,c as mt,r as xt,s as ft,b as ht,u as pt,d as yt}from"./system-DM3mfcRt.js";import{T as Ps,C as gt}from"./ConfirmModal-DeWu6kFs.js";import{N as bt}from"./NodeInformationCard-BEL_UTIo.js";import{i as jt,g as vt,s as Nt,a as kt,k as wt}from"./keycap-sfx-ByZp-njj.js";import{C as Y,P as Ct,a as St,B as Tt}from"./PageLayout-9SoN_daN.js";import{R as te,C as Te}from"./Grid-Di163a6N.js";import{A as _t}from"./antenna-CYx4bVye.js";import{P as _s}from"./plus-C2Nq-iqX.js";import{K as qe}from"./key-round-iBXtesax.js";import{C as Ft}from"./circle-check-BA0O7QIB.js";import{T as Ge}from"./triangle-alert-BPXHBOYA.js";import{R as Et}from"./refresh-cw-D45udn5T.js";import{C as Rt}from"./chevron-right-tyotcuUX.js";import"./DataBox-ChuBU2q7.js";/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Pt=ue("external-link",It);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=[["circle",{cx:"16",cy:"20",r:"2",key:"1vifvg"}],["path",{d:"M10 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v2",key:"3hgo9p"}],["path",{d:"m22 14-4.5 4.5",key:"1ef6z8"}],["path",{d:"m21 15 1 1",key:"1ejcpy"}]],Mt=ue("folder-key",Dt);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=[["rect",{width:"8",height:"5",x:"14",y:"17",rx:"1",key:"19aais"}],["path",{d:"M10 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v2.5",key:"1w6v7t"}],["path",{d:"M20 17v-2a2 2 0 1 0-4 0v2",key:"pwaxnr"}]],Fs=ue("folder-lock",At);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],Lt=ue("monitor",Kt);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Ze=ue("pencil",zt);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["path",{d:"M10.17 4.193a2 2 0 0 1 3.666.013",key:"pltmmw"}],["path",{d:"M14 21h2",key:"v4qezv"}],["path",{d:"m15.874 7.743 1 1.732",key:"10m0iw"}],["path",{d:"m18.849 12.952 1 1.732",key:"zadnam"}],["path",{d:"M21.824 18.18a2 2 0 0 1-1.835 2.824",key:"fvwuk4"}],["path",{d:"M4.024 21a2 2 0 0 1-1.839-2.839",key:"1e1kah"}],["path",{d:"m5.136 12.952-1 1.732",key:"1u4ldi"}],["path",{d:"M8 21h2",key:"i9zjee"}],["path",{d:"m8.102 7.743-1 1.732",key:"1zzo4u"}]],Vt=ue("triangle-dashed",Ot),Fe=1500,oe={stacked:"h-[38px]",inline:"h-[32px]"},ce={stacked:"px-3",inline:"px-2.5"},de="rounded-lg";function H({label:a,value:c,editValue:r,onSave:p,type:i="text",suffix:d,placeholder:v,readOnly:u=!1,layout:o="stacked",min:n,max:h,step:k,maxLength:E,description:y,className:w}){const[C,j]=t.useState(!1),[S,I]=t.useState(""),[g,A]=t.useState("idle"),O=t.useRef(null),x=t.useRef(!0),P=t.useRef(null),_=!u&&!!p;t.useEffect(()=>(x.current=!0,()=>{x.current=!1,P.current&&clearTimeout(P.current)}),[]);const L=t.useCallback(()=>{_&&(I(r??c),j(!0),A("idle"),requestAnimationFrame(()=>{var N;return(N=O.current)==null?void 0:N.select()}))},[_,r,c]),T=t.useCallback(()=>{j(!1),I(""),A("idle")},[]),m=t.useCallback(async()=>{if(!p||g==="loading")return;if(S===(r??c)){T();return}P.current&&clearTimeout(P.current),A("loading");try{if(await p(S),!x.current)return;A("success"),j(!1),P.current=setTimeout(()=>{x.current&&A("idle")},Fe)}catch{if(!x.current)return;A("error"),P.current=setTimeout(()=>{x.current&&A("idle")},Fe)}},[p,S,r,c,T,g]),z=t.useCallback(N=>{N.key==="Enter"?(N.preventDefault(),m()):N.key==="Escape"&&(N.preventDefault(),T())},[m,T]);return o==="inline"?e.jsxs("div",{className:l("group flex items-center justify-between gap-3",w),children:[e.jsx("label",{className:"type-label text-fg-muted truncate",children:a}),C?e.jsxs("div",{className:l(oe.inline,de,ce.inline,"flex items-center transition-all","bg-transparent border border-sys-blue/50 ring-1 ring-sys-blue/20","min-w-[100px]"),children:[e.jsx("input",{ref:O,type:i,value:S,onChange:N=>I(N.target.value),onKeyDown:z,placeholder:v,min:n,max:h,step:k,maxLength:E,disabled:g==="loading",className:l("bg-transparent text-fg-primary focus:outline-none type-data flex-1 min-w-0",d?"w-12 text-right":"w-full")}),d&&e.jsx("span",{className:"text-fg-muted type-data ml-1 shrink-0",children:d}),e.jsx("div",{className:"flex items-center gap-0.5 ml-2 shrink-0",children:g==="loading"?e.jsx($,{className:"w-3.5 h-3.5 text-fg-muted animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:m,className:"p-0.5 rounded hover:bg-sys-green/15 text-sys-green transition-colors",title:"Save (Enter)",children:e.jsx(B,{className:"w-3 h-3"})}),e.jsx("button",{onClick:T,className:"p-0.5 rounded hover:bg-sys-red/15 text-fg-muted hover:text-sys-red transition-colors",title:"Cancel (Esc)",children:e.jsx(J,{className:"w-3 h-3"})})]})})]}):e.jsxs("div",{className:l(oe.inline,de,ce.inline,"flex items-center justify-end transition-all min-w-[80px]","bg-input-bg border border-input-border",_&&"cursor-pointer hover:border-edge-strong"),onClick:_?L:void 0,children:[e.jsx("span",{className:"type-data text-fg-primary",children:c}),g==="success"&&e.jsx(B,{className:"w-3 h-3 text-sys-green ml-1.5 shrink-0"}),g==="error"&&e.jsx(J,{className:"w-3 h-3 text-sys-red ml-1.5 shrink-0"}),g==="idle"&&_&&e.jsx(Ze,{className:"w-3 h-3 text-fg-muted ml-1.5 opacity-0 group-hover:opacity-100 transition-opacity shrink-0"})]})]}):e.jsxs("div",{className:l("group",w),children:[e.jsx("label",{className:"type-label text-fg-muted block mb-1",children:a}),C?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:l(oe.stacked,de,ce.stacked,"flex items-center transition-all","bg-transparent border border-sys-blue/50 ring-1 ring-sys-blue/20"),children:[e.jsx("input",{ref:O,type:i,value:S,onChange:N=>I(N.target.value),onKeyDown:z,placeholder:v,min:n,max:h,step:k,maxLength:E,disabled:g==="loading",className:"w-full bg-transparent text-fg-primary focus:outline-none type-data flex-1 min-w-0"}),d&&e.jsx("span",{className:"text-fg-muted type-data ml-1 shrink-0",children:d}),e.jsx("div",{className:"flex items-center gap-0.5 ml-2 shrink-0",children:g==="loading"?e.jsx($,{className:"w-3.5 h-3.5 text-fg-muted animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:m,className:"p-1 rounded hover:bg-sys-green/15 text-sys-green transition-colors",title:"Save (Enter)",children:e.jsx(B,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-sys-red/15 text-fg-muted hover:text-sys-red transition-colors",title:"Cancel (Esc)",children:e.jsx(J,{className:"w-3.5 h-3.5"})})]})})]}),y&&e.jsx("p",{className:"type-data-xs text-fg-muted mt-1 ml-3",children:y})]}):e.jsxs("div",{className:l(oe.stacked,de,ce.stacked,"flex items-center transition-all","bg-input-bg border border-input-border",_&&"cursor-pointer hover:border-edge-strong"),onClick:_?L:void 0,children:[e.jsx("span",{className:"type-data text-fg-primary flex-1 whitespace-nowrap",children:c}),g==="success"&&e.jsx(B,{className:"w-3.5 h-3.5 text-sys-green shrink-0"}),g==="error"&&e.jsx(J,{className:"w-3.5 h-3.5 text-sys-red shrink-0"}),g==="idle"&&_&&e.jsx(Ze,{className:"w-3.5 h-3.5 text-fg-muted opacity-0 group-hover:opacity-100 transition-opacity shrink-0"})]})]})}function Be({label:a,value:c,editValue:r,options:p,onSave:i,readOnly:d=!1,layout:v="stacked",className:u}){const[o,n]=t.useState(!1),[h,k]=t.useState(""),[E,y]=t.useState("idle"),w=t.useRef(null),C=t.useRef(!0),j=t.useRef(null),S=!d&&!!i;t.useEffect(()=>(C.current=!0,()=>{C.current=!1,j.current&&clearTimeout(j.current)}),[]);const I=t.useCallback(()=>{S&&(k(String(r)),n(!0),y("idle"),requestAnimationFrame(()=>{var m;return(m=w.current)==null?void 0:m.focus()}))},[S,r]),g=t.useCallback(()=>{n(!1),k(""),y("idle")},[]),A=t.useCallback(async()=>{if(!(!i||E==="loading")){if(h===String(r)){g();return}j.current&&clearTimeout(j.current),y("loading");try{if(await i(h),!C.current)return;y("success"),n(!1),j.current=setTimeout(()=>{C.current&&y("idle")},Fe)}catch{if(!C.current)return;y("error"),j.current=setTimeout(()=>{C.current&&y("idle")},Fe)}}},[i,h,r,g,E]),O=t.useCallback(m=>{m.key==="Escape"&&(m.preventDefault(),g())},[g]),x=v==="inline",P=x?oe.inline:oe.stacked,_=x?ce.inline:ce.stacked,L=e.jsxs("div",{className:l(P,de,_,"flex items-center transition-all relative","bg-transparent border border-sys-blue/50 ring-1 ring-sys-blue/20",x&&"min-w-[100px]"),children:[e.jsx("select",{ref:w,value:h,onChange:m=>k(m.target.value),onKeyDown:O,disabled:E==="loading",className:l("bg-transparent text-fg-primary focus:outline-none appearance-none cursor-pointer type-data flex-1 min-w-0","pr-6"),children:p.map(m=>e.jsx("option",{value:m.value,children:m.label},String(m.value)))}),e.jsx(Ss,{className:"absolute right-auto w-3.5 h-3.5 text-fg-muted pointer-events-none",style:{right:E==="loading"?"2rem":"3.5rem"}}),e.jsx("div",{className:"flex items-center gap-0.5 ml-1 shrink-0",children:E==="loading"?e.jsx($,{className:l("text-fg-muted animate-spin",x?"w-3 h-3":"w-3.5 h-3.5")}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:A,className:l("rounded hover:bg-sys-green/15 text-sys-green transition-colors",x?"p-0.5":"p-1"),title:"Save",children:e.jsx(B,{className:x?"w-3 h-3":"w-3.5 h-3.5"})}),e.jsx("button",{onClick:g,className:l("rounded hover:bg-sys-red/15 text-fg-muted hover:text-sys-red transition-colors",x?"p-0.5":"p-1"),title:"Cancel (Esc)",children:e.jsx(J,{className:x?"w-3 h-3":"w-3.5 h-3.5"})})]})})]}),T=e.jsxs("div",{className:l(P,de,_,"flex items-center transition-all","bg-input-bg border border-input-border",S&&"cursor-pointer hover:border-edge-strong",x?"justify-end min-w-[80px]":""),onClick:S?I:void 0,children:[e.jsx("span",{className:l("type-data text-fg-primary",!x&&"flex-1"),children:c}),E==="success"&&e.jsx(B,{className:l("text-sys-green shrink-0",x?"w-3 h-3 ml-1.5":"w-3.5 h-3.5")}),E==="error"&&e.jsx(J,{className:l("text-sys-red shrink-0",x?"w-3 h-3 ml-1.5":"w-3.5 h-3.5")}),E==="idle"&&S&&e.jsx(Ss,{className:l("text-fg-muted opacity-0 group-hover:opacity-100 transition-opacity shrink-0",x?"w-3 h-3 ml-1.5":"w-3.5 h-3.5")})]});return x?e.jsxs("div",{className:l("group flex items-center justify-between",u),children:[e.jsx("label",{className:"type-label text-fg-muted shrink-0",children:a}),o?L:T]}):e.jsxs("div",{className:l("group",u),children:[e.jsx("label",{className:"type-label text-fg-muted block mb-1",children:a}),o?L:T]})}async function Ht(){try{return await Ee("/api/auth/tokens")}catch{return{tokens:[]}}}async function $t(a){return Ee("/api/auth/tokens",{method:"POST",body:JSON.stringify({name:a})})}async function qt(a){return Ee(`/api/auth/tokens/${a}`,{method:"DELETE"})}async function Es(a){return Ee("/api/update_web_config",{method:"POST",body:JSON.stringify(a)})}t.memo(function(){const{theme:c}=es(),{themeId:r}=c,p=Je.find(i=>i.meta.id===r)??Je[0];return e.jsx("div",{className:"h-10 flex items-center justify-center",children:e.jsx("span",{className:"font-medium transition-all duration-300 leading-none text-center text-fg-secondary",style:{fontFamily:"Inter, system-ui, sans-serif",fontSize:"clamp(0.75rem, 0.6rem + 1.5vw, 1.1rem)",letterSpacing:"-0.02em"},children:p.meta.name})})});const Ue=t.memo(function({compact:c=!1}){const{theme:r,setTheme:p}=es(),{themeId:i}=r;return e.jsx("div",{className:l("grid grid-cols-2 gap-2",c?"w-full min-w-0 self-stretch":"w-full"),children:[...Je].reverse().map(d=>{const v=i===d.meta.id,u=d.meta.isDark;return e.jsxs("button",{type:"button",title:d.meta.name,className:l("flex flex-row items-stretch radius-inner transition-all duration-200 ease-out overflow-hidden cursor-pointer",c&&"h-6",v?"ring-2 ring-sys-blue scale-[1.02]":"opacity-70 hover:opacity-100"),onClick:()=>p(d.meta.id),children:[e.jsx("div",{className:l("flex-1 h-full",u?"bg-[#18181b]":"bg-[#EFF0F1]")}),e.jsx("div",{className:"flex flex-col h-full",children:d.display.palette.map((o,n)=>e.jsx("div",{className:"flex flex-1",children:o.map((h,k)=>e.jsx("div",{className:"w-2 h-full",style:{backgroundColor:h}},k))},n))})]},d.meta.id)})})});let Rs=!1,_e=null;async function Gt(){if(!Rs)return _e||(_e=(async()=>{try{await Promise.all([Se(()=>Promise.resolve({}),__vite__mapDeps([0])),Se(()=>Promise.resolve({}),__vite__mapDeps([1])),Se(()=>Promise.resolve({}),__vite__mapDeps([2])),Se(()=>Promise.resolve({}),__vite__mapDeps([3]))]),Rs=!0}catch(a){console.warn("Failed to load theme fonts:",a)}})(),_e)}const We=t.memo(function(){const{theme:c,setTheme:r}=es(),{themeId:p}=c,i=p==="breeze dark",d=t.useCallback(v=>{r(v?"breeze dark":"breeze light")},[r]);return e.jsx(ie,{enabled:i,onChange:d,label:e.jsxs(e.Fragment,{children:["Dark Mode: ",i?e.jsx(Zs,{className:"w-3.5 h-3.5 text-sys-blue inline"}):e.jsx(et,{className:"w-3.5 h-3.5 text-[#e8a517] inline"})]}),tooltip:"Switch between dark and light mode",size:"md"})}),Bt=t.memo(function({layout:c="horizontal"}){return t.useEffect(()=>{Gt()},[]),c==="toggle-only"?e.jsx(We,{}):c==="thumbnails-only"?e.jsx(Ue,{}):c==="vertical"?e.jsxs("div",{className:"flex flex-col items-start gap-3",children:[e.jsx(We,{}),e.jsx(Ue,{})]}):e.jsxs("div",{className:"flex items-stretch gap-4",children:[e.jsx("div",{className:"flex-shrink-0 flex items-start",children:e.jsx(We,{})}),e.jsx(Ue,{compact:!0})]})}),Ut=1e4,Xe=2e3;function Ye(a,c,r){const[p,i]=t.useState("idle"),[d,v]=t.useState(null),u=t.useRef(!0),o=t.useRef(null),n=t.useRef(null),h=t.useRef(!1),k=t.useRef("idle"),E=t.useRef(a),y=t.useRef(c),w=t.useRef(r);k.current=p,E.current=a,y.current=c,w.current=r,t.useEffect(()=>(u.current=!0,()=>{u.current=!1,o.current&&clearTimeout(o.current),n.current&&clearTimeout(n.current)}),[]);const C=t.useCallback(async S=>{if(k.current==="loading")return;const I=E.current;o.current&&clearTimeout(o.current),n.current&&clearTimeout(n.current),h.current=!1,v(S),i("loading"),o.current=setTimeout(()=>{h.current||!u.current||(v(I),i("error"),n.current=setTimeout(()=>{u.current&&(i("idle"),v(null))},Xe))},Ut);try{if(await y.current(S),h.current=!0,o.current&&clearTimeout(o.current),!u.current)return;i("success"),n.current=setTimeout(()=>{var g;u.current&&(i("idle"),v(null),(g=w.current)==null||g.call(w))},Xe)}catch{if(h.current=!0,o.current&&clearTimeout(o.current),!u.current)return;v(I),i("error"),n.current=setTimeout(()=>{u.current&&(i("idle"),v(null))},Xe)}},[]);return{enabled:d!==null?d:a,status:p,toggle:C}}function Wt(){const{latitude:a,longitude:c,enabled:r,setLocation:p,enable:i,disable:d,clear:v}=st(),[u,o]=t.useState(!1),[n,h]=t.useState(""),[k,E]=t.useState(""),[y,w]=t.useState("idle"),[C,j]=t.useState(null),S=t.useRef(null),I=t.useRef(null),g=t.useRef(!0);t.useEffect(()=>(g.current=!0,()=>{g.current=!1,I.current&&clearTimeout(I.current)}),[]);const A=()=>{h((a==null?void 0:a.toFixed(6))??""),E((c==null?void 0:c.toFixed(6))??""),j(null),o(!0)},O=()=>{o(!1),j(null)};t.useEffect(()=>{if(!u)return;const m=z=>{y!=="loading"&&S.current&&!S.current.contains(z.target)&&O()};return document.addEventListener("mouseup",m),()=>document.removeEventListener("mouseup",m)},[u,y]);const x=(m,z)=>{const N=parseFloat(m),G=parseFloat(z);return isNaN(N)||isNaN(G)?"Please enter valid numbers":N<-90||N>90?"Latitude must be between -90 and 90":G<-180||G>180?"Longitude must be between -180 and 180":N===0&&G===0?"Coordinates (0, 0) are invalid":null},P=()=>{if(y==="loading")return;I.current&&clearTimeout(I.current);const m=x(n,k);if(m){j(m);return}w("loading"),j(null);const z=parseFloat(n),N=parseFloat(k);p(z,N),r||i(),w("success"),I.current=setTimeout(()=>{g.current&&(w("idle"),o(!1))},1e3)},_=()=>{r?d():i()},L=()=>{v(),o(!1)},T=a!==null&&c!==null;return e.jsx(Y,{children:e.jsxs("div",{ref:S,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(X,{icon:e.jsx(Vt,{}),title:"Stealth"}),e.jsxs("div",{className:"flex items-center gap-1",children:[T&&!u&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:_,className:l("relative inline-flex h-6 w-11 items-center rounded-full transition-colors border-2 mr-2",r?"bg-toggle-on border-toggle-on":"bg-toggle-off border-edge-subtle"),title:r?"Disable stealth location":"Enable stealth location",children:e.jsx("span",{className:l("inline-block h-4 w-4 transform rounded-full bg-white transition-transform shadow-lg",r?"translate-x-5":"translate-x-0.5")})}),e.jsx("button",{onClick:L,className:"p-2 rounded-lg transition-colors text-fg-muted hover:text-sys-red hover:bg-sys-red/10",title:"Clear stealth location",children:e.jsx(Ps,{className:"w-4 h-4"})})]}),u?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:O,disabled:y==="loading",className:l("p-2 rounded-lg transition-colors",y==="loading"?"text-fg-muted cursor-not-allowed":"text-fg-muted hover:text-sys-red hover:bg-sys-red/10"),title:"Cancel",children:e.jsx(J,{className:"w-4 h-4"})}),e.jsx("button",{onClick:P,disabled:y==="loading",className:l("p-2 rounded-lg transition-colors",y==="loading"?"text-sys-blue cursor-wait":y==="success"?"text-sys-green":y==="error"?"text-sys-red":"text-sys-green hover:bg-sys-green/10"),title:"Save",children:y==="loading"?e.jsx($,{className:"w-4 h-4 animate-spin"}):y==="success"?e.jsx(B,{className:"w-4 h-4"}):y==="error"?e.jsx(J,{className:"w-4 h-4"}):e.jsx(B,{className:"w-4 h-4"})})]}):e.jsx("button",{onClick:A,className:"p-2 rounded-lg transition-colors text-fg-muted hover:text-fg-primary hover:bg-subtle",title:T?"Edit stealth location":"Set stealth location",children:e.jsx(Ze,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"bg-sys-cyan/5 rounded-xl p-3 mb-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Qe,{className:"w-4 h-4 text-sys-cyan flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"type-body-sm text-fg-muted",children:[e.jsx("span",{className:"text-fg-secondary",children:"Stealth mode"})," allows you to appear on the map and in topology analysis without broadcasting your location. Coordinates are stored locally in your browser only — ",e.jsx("span",{className:"text-sys-cyan",children:"never sent to config.yaml or the mesh"}),"."]})]})}),C&&e.jsx("div",{className:"text-xs mb-3 px-2 py-1.5 rounded-md text-sys-red bg-sys-red/10",children:C}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"type-label text-fg-muted block mb-1",children:u?"Latitude (°)":"Latitude"}),e.jsx("div",{className:l("h-[38px] rounded-full px-4 flex items-center transition-colors","bg-subtle-fill"),children:u?e.jsx("input",{type:"number",value:n,onChange:m=>h(m.target.value),step:"0.000001",min:"-90",max:"90",placeholder:"e.g. 34.052234",className:"w-full bg-transparent text-fg-primary focus:outline-none type-data placeholder:text-fg-muted/50"}):e.jsx("span",{className:l("type-data",T&&r?"text-fg-primary":"text-fg-muted"),children:T?a.toFixed(6):"Not set"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"type-label text-fg-muted block mb-1",children:u?"Longitude (°)":"Longitude"}),e.jsx("div",{className:l("h-[38px] rounded-full px-4 flex items-center transition-colors","bg-subtle-fill"),children:u?e.jsx("input",{type:"number",value:k,onChange:m=>E(m.target.value),step:"0.000001",min:"-180",max:"180",placeholder:"e.g. -118.243685",className:"w-full bg-transparent text-fg-primary focus:outline-none type-data placeholder:text-fg-muted/50"}):e.jsx("span",{className:l("type-data",T&&r?"text-fg-primary":"text-fg-muted"),children:T?c.toFixed(6):"Not set"})})]})]}),T&&!u&&e.jsx("div",{className:"mt-3 pt-3 border-t border-edge-subtle",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:l("w-2 h-2 rounded-full",r?"bg-sys-green":"bg-fg-muted")}),e.jsx("span",{className:"type-body-sm text-fg-muted",children:r?"Stealth location active — you appear on maps with these coordinates":"Stealth location disabled — coordinates saved but not in use"})]})})]})})}const Xt=[{value:7.8,label:"7.8 kHz"},{value:10.4,label:"10.4 kHz"},{value:15.6,label:"15.6 kHz"},{value:20.8,label:"20.8 kHz"},{value:31.25,label:"31.25 kHz"},{value:41.7,label:"41.7 kHz"},{value:62.5,label:"62.5 kHz"},{value:125,label:"125 kHz"},{value:250,label:"250 kHz"},{value:500,label:"500 kHz"}],Yt=[5,6,7,8,9,10,11,12],Jt=[{value:5,label:"4/5"},{value:6,label:"4/6"},{value:7,label:"4/7"},{value:8,label:"4/8"}],Is={RADIO_CONFIG:"radioConfig"};function Qt(a){if(!a)return"Never";const r=Date.now()-a*1e3,p=Math.floor(r/6e4),i=Math.floor(r/36e5),d=Math.floor(r/864e5);return p<1?"Just now":p<60?`${p}m ago`:i<24?`${i}h ago`:d<365?`${d}d ago`:`${Math.floor(d/365)}y ago`}function Ds({node:a,level:c,expandedKeys:r,selectedKeyId:p,globalFloodPolicy:i,onSelect:d,onToggle:v}){const u=r.has(a.id),o=p===a.id,n=a.children&&a.children.length>0,h=i==="allow";return e.jsxs("div",{children:[e.jsxs("div",{className:l("flex items-center gap-2 h-[36px] px-3 rounded-full cursor-pointer transition-colors",o?"bg-sys-blue/15":"hover:bg-subtle-fill",h&&"opacity-50 cursor-not-allowed"),style:{marginLeft:`${c*16}px`},onClick:()=>!h&&d(a.id),children:[n?e.jsx("button",{onClick:k=>{k.stopPropagation(),v(a.id)},className:"p-1 hover:bg-subtle-fill-hover rounded-full transition-colors",children:e.jsx(Rt,{className:l("w-3.5 h-3.5 text-fg-muted transition-transform",u&&"rotate-90")})}):e.jsx("span",{className:"w-5"}),e.jsx(Mt,{className:"w-4 h-4 text-sys-blue flex-shrink-0"}),e.jsx("span",{className:"type-data text-fg-primary flex-1 truncate",children:a.name}),e.jsx("span",{className:"type-data-xs text-fg-muted hidden sm:inline",title:a.last_used?new Date(a.last_used*1e3).toLocaleString():void 0,children:Qt(a.last_used)}),e.jsx("span",{className:l("type-data-xs px-2 py-0.5 rounded-full",a.floodPolicy==="allow"?"bg-sys-green/15 text-sys-green":"bg-sys-red/15 text-sys-red"),children:a.floodPolicy==="allow"?"Allow":"Deny"})]}),n&&u&&e.jsx("div",{children:a.children.map(k=>e.jsx(Ds,{node:k,level:c+1,expandedKeys:r,selectedKeyId:p,globalFloodPolicy:i,onSelect:d,onToggle:v},k.id))})]})}function Zt(){const[a,c]=t.useState(jt),[r,p]=t.useState(vt),[i,d]=t.useState(!1),v=t.useCallback(n=>{c(n),Nt(n)},[]),u=t.useCallback(n=>{const h=parseFloat(n.target.value);p(h),kt(h)},[]),o=t.useCallback(async()=>{i||(d(!0),await wt(),d(!1))},[i]);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx(ie,{enabled:a,onChange:v,label:e.jsxs(e.Fragment,{children:["Sound: ",e.jsx("span",{className:a?"text-sys-green":"text-sys-red",children:a?"On":"Off"})]}),tooltip:"Enable or disable UI sound effects and haptic audio feedback",size:"md"}),e.jsx(F,{color:"primary",outline:!0,onClick:o,disabled:!a||i,className:"w-16 justify-center",children:i?"…":"Test"})]}),e.jsxs("div",{className:l("flex items-center gap-3",!a&&"opacity-40 pointer-events-none"),children:[e.jsx("span",{className:"type-label text-fg-muted w-14 shrink-0",children:"Volume"}),e.jsx("input",{type:"range",min:0,max:1,step:.05,value:r,onChange:u,className:"flex-1 accent-sys-blue h-1.5 cursor-pointer"}),e.jsxs("span",{className:"data-box w-16 justify-center",children:[Math.round(r*100),"%"]})]})]})}function ha(){var js,vs,Ns,ks,ws,Cs;const{stats:a,setMode:c,clearModeMutation:r,setDutyCycleConfig:p,clearDutyCycleMutation:i,fetchStats:d,startMutation:v,clearMutation:u}=tt(),o=(js=a==null?void 0:a.config)==null?void 0:js.radio,n=(vs=a==null?void 0:a.config)==null?void 0:vs.repeater,h=(Ns=a==null?void 0:a.config)==null?void 0:Ns.duty_cycle,k=(a==null?void 0:a.node_name)||((ks=a==null?void 0:a.config)==null?void 0:ks.node_name)||"Unknown Node",E=(n==null?void 0:n.mode)??"forward",y=(h==null?void 0:h.enforcement_enabled)??!1,w=(ws=a==null?void 0:a.config)==null?void 0:ws.delays,C=t.useRef(!0);t.useEffect(()=>(C.current=!0,()=>{C.current=!1}),[]);const j=(Cs=a==null?void 0:a.config)==null?void 0:Cs.web,[S,I]=t.useState([]),[g,A]=t.useState(!1),[O,x]=t.useState(null),[P,_]=t.useState(!1),[L,T]=t.useState(""),[m,z]=t.useState(null),[N,G]=t.useState(!1),[ae,Re]=t.useState(null),[Ie,ss]=t.useState(!1),[ts,as]=t.useState(!1),[ns,ls]=t.useState(!1),[U,Ms]=t.useState([]),[As,rs]=t.useState(!1),[is,D]=t.useState(null),[Q,Ks]=t.useState(()=>localStorage.getItem("pymc:globalFloodPolicy")==="allow"?"allow":"deny"),os=t.useCallback(s=>{Ks(s),localStorage.setItem("pymc:globalFloodPolicy",s)},[]),[cs,ds]=t.useState(!1),[K,Pe]=t.useState(null),[Ls,zs]=t.useState(new Set),[ge,me]=t.useState(!1),[be,ne]=t.useState(!1),[je,le]=t.useState(!1),[M,W]=t.useState(null),[Z,xe]=t.useState(null),[ve,Ne]=t.useState(""),[De,fe]=t.useState("allow"),[q,re]=t.useState(!1),[ke,us]=t.useState(!0),[he,Me]=t.useState(!1),[Os,ms]=t.useState(!0),[pe,ee]=t.useState("idle"),[Vs,Ae]=t.useState(!1),[Ke,Hs]=t.useState(!1),xs=t.useCallback(()=>{const s=w==null?void 0:w.tx_delay_factor;return s&&typeof s=="object"&&"parsedValue"in s?s.parsedValue??1:typeof s=="number"?s:1},[w]),fs=t.useCallback(()=>{const s=w==null?void 0:w.direct_tx_delay_factor;return typeof s=="number"?s:.5},[w]),Le=t.useCallback(()=>{const s=h==null?void 0:h.max_airtime_percent;return typeof s=="number"?s:s&&typeof s=="object"&&"parsedValue"in s?s.parsedValue??6:6},[h]),ze=Ye(E==="forward",async s=>{await c(s?"forward":"monitor")},r),Oe=Ye(y,async s=>{await p({max_airtime_percent:Le(),enforcement_enabled:s})},i),Ve=Ye((j==null?void 0:j.cors_enabled)??!1,async s=>{var b;const f=await Es({web:{cors_enabled:s}});if(!f.success&&!((b=f.data)!=null&&b.persisted))throw new Error("CORS update failed");await d()}),V=t.useCallback(async s=>{v(Is.RADIO_CONFIG);try{const f=await at(s);if(!f.success)throw new Error(f.error||"Failed to save");await d({force:!0}).catch(()=>{})}finally{u(Is.RADIO_CONFIG)}},[v,u,d]);t.useEffect(()=>{(async()=>{ms(!0);try{const f=await mt();f.success&&f.data?Me(f.data.exists):Me(!1);const b=j==null?void 0:j.web_path;us(!b||b==="")}catch{Me(!1)}finally{ms(!1)}})()},[j==null?void 0:j.web_path]);const hs=async s=>{var f;if(pe!=="loading"){ee("loading");try{const b=await Es({web:{web_path:s?null:"/opt/pymc_console/web/html"}});if(!C.current)return;b.success||(f=b.data)!=null&&f.persisted?(us(s),ee("success"),Ae(!0),setTimeout(()=>{C.current&&ee("idle")},2e3)):(ee("error"),setTimeout(()=>{C.current&&ee("idle")},2e3))}catch{if(!C.current)return;ee("error"),setTimeout(()=>{C.current&&ee("idle")},2e3)}}},$s=async()=>{if(!Ke){Hs(!0);try{await xt(),Ae(!1),setTimeout(()=>{window.location.reload()},2e3)}catch{Ae(!1),setTimeout(()=>{window.location.reload()},3e3)}}},we=t.useCallback(async()=>{A(!0),x(null);try{const s=await Ht();I(s.tokens||[])}catch(s){x(s instanceof Error?s.message:"Failed to fetch tokens")}finally{A(!1)}},[]);t.useEffect(()=>{we()},[we]);const ps=async()=>{if(!L.trim()){x("Token name is required");return}ss(!0),x(null);try{const s=await $t(L.trim());z(s.token||null),_(!1),G(!0),T(""),await we()}catch(s){x(s instanceof Error?s.message:"Failed to create token")}finally{ss(!1)}},qs=async()=>{if(ae){as(!0),x(null);try{await qt(ae.id),await we(),Re(null)}catch(s){x(s instanceof Error?s.message:"Failed to revoke token")}finally{as(!1)}}},Gs=()=>{m&&(navigator.clipboard.writeText(m),ls(!0),setTimeout(()=>ls(!1),2e3))},ys=s=>s?new Date(s*1e3).toLocaleString():"Never",gs=t.useCallback(s=>{const f=new Map,b=[];return s.forEach(R=>{const Ce={id:R.id,name:R.name,floodPolicy:R.flood_policy,transport_key:R.transport_key,last_used:R.last_used,parent_id:R.parent_id,children:[]};f.set(R.id,Ce)}),f.forEach(R=>{R.parent_id&&f.has(R.parent_id)?f.get(R.parent_id).children.push(R):b.push(R)}),b},[]),ye=t.useCallback(async()=>{rs(!0),D(null);try{const s=await dt();if(s.success&&s.data){const f=gs(s.data);Ms(f),Pe(b=>{if(b===null)return null;const R=Ce=>{for(const He of Ce)if(He.id===b||He.children&&R(He.children))return!0;return!1};return R(f)?b:null})}else D(s.error||"Failed to load transport keys")}catch(s){D(s instanceof Error?s.message:"Unknown error occurred")}finally{rs(!1)}},[gs]);t.useEffect(()=>{ye(),ut().then(s=>{s.success&&s.data&&os(s.data.global_flood_allow?"allow":"deny")}).catch(()=>{})},[ye]);const se=t.useCallback((s,f)=>{for(const b of s){if(b.id===f)return b;if(b.children){const R=se(b.children,f);if(R)return R}}return null},[]),Bs=t.useCallback(()=>{if(!K)return;const s=se(U,K);return s==null?void 0:s.name},[K,U,se]),Us=t.useCallback(s=>{zs(f=>{const b=new Set(f);return b.has(s)?b.delete(s):b.add(s),b})},[]),Ws=async s=>{ds(!0),D(null);try{const f=await ft(s==="allow");f.success?os(s):D(f.error||"Failed to update global flood policy")}catch(f){D(f instanceof Error?f.message:"Failed to update global flood policy")}finally{ds(!1)}},bs=async()=>{if(!ve.trim()){D("Key name is required");return}re(!0),D(null);try{const s=await ht({name:ve.trim(),flood_policy:De,parent_id:K??void 0});s.success?(await ye(),me(!1),Ne(""),fe("allow")):D(s.error||"Failed to add transport key")}catch(s){D(s instanceof Error?s.message:"Failed to add transport key")}finally{re(!1)}},Xs=async()=>{if(M){re(!0),D(null);try{const s=await pt(M.id,{name:M.name,flood_policy:M.floodPolicy});s.success?(await ye(),ne(!1),W(null)):D(s.error||"Failed to update transport key")}catch(s){D(s instanceof Error?s.message:"Failed to update transport key")}finally{re(!1)}}},Ys=async()=>{if(Z){re(!0),D(null);try{const s=await yt(Z.id);s.success?(await ye(),le(!1),xe(null),Pe(null)):D(s.error||"Failed to delete transport key")}catch(s){D(s instanceof Error?s.message:"Failed to delete transport key")}finally{re(!1)}}},Js=t.useCallback(()=>{if(!K)return;const s=se(U,K);s&&(W({...s}),ne(!0))},[K,U,se]);t.useEffect(()=>{const s=b=>{b.key==="Escape"&&(ge&&(me(!1),Ne(""),fe("allow")),be&&(ne(!1),W(null)),je&&(le(!1),xe(null)),P&&(_(!1),T("")),N&&(G(!1),z(null)))};if(ge||be||je||P||N)return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[ge,be,je,P,N]);const Qs=t.useCallback(()=>{if(!K)return;const s=se(U,K);s&&(xe(s),le(!0))},[K,U,se]);return e.jsxs(Ct,{children:[e.jsx(St,{title:"Configuration",icon:e.jsx(Ts,{})}),e.jsxs(Tt,{children:[e.jsxs(te,{template:"standard",children:[e.jsx(Te,{span:12,md:6,children:e.jsxs(Y,{neomorphic:!0,children:[e.jsx(X,{icon:e.jsx(nt,{}),title:"Repeater Settings"}),n?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsx(H,{label:"Node Name",value:k,onSave:async s=>V({node_name:s}),placeholder:"Enter node name",maxLength:50})}),e.jsx(H,{label:"Latitude",value:n.latitude!==0?n.latitude.toFixed(6):"Not set",editValue:String(n.latitude),type:"number",suffix:"°",step:1e-6,min:-90,max:90,onSave:async s=>V({latitude:parseFloat(s)})}),e.jsx(H,{label:"Longitude",value:n.longitude!==0?n.longitude.toFixed(6):"Not set",editValue:String(n.longitude),type:"number",suffix:"°",step:1e-6,min:-180,max:180,onSave:async s=>V({longitude:parseFloat(s)})}),e.jsx(H,{label:"Advert Interval",value:n.send_advert_interval_hours>0?`${n.send_advert_interval_hours}h`:"Disabled",editValue:String(n.send_advert_interval_hours),type:"number",suffix:"hours",min:0,max:48,description:"0 = disabled, 3-48 hours",onSave:async s=>V({flood_advert_interval_hours:parseInt(s,10)})}),e.jsx(H,{label:"Score-based TX",value:n.use_score_for_tx?"Enabled":"Disabled",readOnly:!0})]}):e.jsx("p",{className:"text-fg-muted",children:"Loading repeater settings..."})]})}),e.jsx(Te,{span:12,md:6,children:e.jsxs(Y,{neomorphic:!0,children:[e.jsx(X,{icon:e.jsx(_t,{}),title:"Radio Configuration"}),o?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(H,{label:"Frequency",value:lt(o.frequency),editValue:(o.frequency/1e6).toFixed(3),type:"number",suffix:"MHz",step:.001,min:400,max:930,onSave:async s=>V({frequency_mhz:parseFloat(s)})}),e.jsx(H,{label:"TX Power",value:`${o.tx_power} dBm`,editValue:String(o.tx_power),type:"number",suffix:"dBm",min:2,max:30,onSave:async s=>V({tx_power:parseInt(s,10)})}),e.jsx(Be,{label:"Bandwidth",value:rt(o.bandwidth),editValue:o.bandwidth/1e3,options:Xt,onSave:async s=>V({bandwidth_khz:parseFloat(s)})}),e.jsx(Be,{label:"Spreading Factor",value:`SF${o.spreading_factor}`,editValue:o.spreading_factor,options:Yt.map(s=>({value:s,label:`SF${s}`})),onSave:async s=>V({spreading_factor:parseInt(s,10)})}),e.jsx(Be,{label:"Coding Rate",value:`4/${o.coding_rate}`,editValue:o.coding_rate,options:Jt,onSave:async s=>V({coding_rate:parseInt(s,10)})}),e.jsx(H,{label:"Preamble",value:`${o.preamble_length} symbols`,readOnly:!0})]}):e.jsx("p",{className:"text-fg-muted",children:"Loading radio configuration..."})]})})]}),e.jsxs(te,{template:"standard",children:[e.jsx(Te,{span:12,md:6,children:e.jsxs(Y,{neomorphic:!0,children:[e.jsx(X,{icon:e.jsx(it,{}),title:"Operating Mode"}),e.jsx("p",{className:"type-label text-fg-muted mb-3",children:"Control how the repeater handles packets"}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(ie,{enabled:ze.enabled,onChange:ze.toggle,label:"Repeat",tooltip:"Toggles repeater or monitor mode. In monitor mode, the repeater will not repeat packets from the mesh.",status:ze.status,size:"md"}),e.jsx(ie,{enabled:Oe.enabled,onChange:Oe.toggle,label:"Duty Cycle",tooltip:"Limit transmission time to comply with airtime utilization regulations",status:Oe.status,size:"md"}),e.jsx(H,{label:"Max Airtime",layout:"inline",value:`${Le().toFixed(1)}%`,editValue:String(Le()),type:"number",suffix:"%",step:.5,min:.1,max:100,onSave:async s=>{await p({max_airtime_percent:parseFloat(s),enforcement_enabled:y}),i()}})]}),e.jsx("div",{className:"hidden lg:block w-px bg-border-subtle"}),e.jsxs("div",{className:"flex-1 pt-4 lg:pt-0 border-t lg:border-t-0 border-edge-subtle",children:[e.jsx("label",{className:"type-label text-fg-muted block mb-3",children:"TX Delays"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(H,{label:"Flood",layout:"inline",value:`${xs().toFixed(2)}x`,editValue:String(xs()),type:"number",suffix:"x",step:.1,min:0,max:5,onSave:async s=>V({tx_delay_factor:parseFloat(s)})}),e.jsx(H,{label:"Direct",layout:"inline",value:`${fs().toFixed(2)}s`,editValue:String(fs()),type:"number",suffix:"s",step:.1,min:0,max:5,onSave:async s=>V({direct_tx_delay_factor:parseFloat(s)})})]})]})]})]})}),e.jsx(Te,{span:12,md:6,children:e.jsxs(Y,{neomorphic:!0,children:[e.jsx(X,{icon:e.jsx(Ts,{}),title:"App Settings"}),e.jsx("p",{className:"type-body-sm text-fg-muted mb-4",children:"Appearance and web server options."}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ie,{enabled:Ve.enabled,onChange:Ve.toggle,label:"Enable CORS",tooltip:"Allow cross-origin API access",status:Ve.status,size:"md"}),e.jsx("div",{children:e.jsx(Bt,{})}),e.jsx(Zt,{})]})]})})]}),e.jsx(te,{template:"auto",children:e.jsxs(Y,{neomorphic:!0,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[e.jsx(X,{icon:e.jsx(Fs,{}),title:"Regions Transport Keys",subtitle:"Manage regional key hierarchy for flood control"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(F,{color:"primary",outline:!0,onClick:()=>me(!0),disabled:Q==="allow",children:[e.jsx(_s,{"data-slot":"icon"}),"Add"]}),e.jsx(F,{color:"primary",outline:!0,onClick:Js,disabled:!K||Q==="allow",children:"Edit"}),e.jsx(F,{color:"danger",outline:!0,onClick:Qs,disabled:!K||Q==="allow",children:"Delete"})]})]}),e.jsx("div",{className:"bg-subtle-fill radius-inner p-4 mb-4",children:e.jsx(ie,{enabled:Q==="deny",onChange:s=>Ws(s?"deny":"allow"),label:e.jsxs(e.Fragment,{children:["Require Transport Keys: ",e.jsx("span",{className:Q==="deny"?"text-sys-green":"text-sys-red",children:Q==="deny"?"On":"Off"})]}),tooltip:"When enabled, only packets with matching transport keys are forwarded. When disabled, all packets flood freely.",status:cs?"loading":"idle",disabled:cs,dangerOff:!0,size:"md",className:"flex-row-reverse justify-between w-full"})}),is&&e.jsx("div",{className:"type-body-sm mb-3 px-3 py-2 rounded-full text-sys-red bg-sys-red/10",children:is}),e.jsx("div",{className:"bg-subtle-fill radius-inner p-4 min-h-[120px]",children:As?e.jsxs("div",{className:"flex items-center justify-center py-6",children:[e.jsx($,{className:"w-5 h-5 animate-spin text-sys-blue mr-2"}),e.jsx("span",{className:"type-body-sm text-fg-muted",children:"Loading transport keys..."})]}):U.length===0?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-subtle-fill mx-auto mb-3 flex items-center justify-center",children:e.jsx(Fs,{className:"w-6 h-6 text-fg-muted/50"})}),e.jsx("p",{className:"type-body text-fg-muted",children:"No transport keys found"}),e.jsx("p",{className:"type-body-sm text-fg-muted/70 mt-1",children:"Add your first transport key to get started"})]}):e.jsx("div",{className:"space-y-1",children:U.map(s=>e.jsx(Ds,{node:s,level:0,expandedKeys:Ls,selectedKeyId:K,globalFloodPolicy:Q,onSelect:Pe,onToggle:Us},s.id))})})]})}),e.jsx(te,{template:"auto",children:e.jsxs(Y,{neomorphic:!0,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[e.jsx(X,{icon:e.jsx(qe,{}),title:"API Tokens",subtitle:"Manage API tokens for machine-to-machine authentication"}),e.jsxs(F,{color:"primary",outline:!0,onClick:()=>_(!0),children:[e.jsx(_s,{"data-slot":"icon"}),"Create Token"]})]}),e.jsx("div",{className:"bg-sys-blue/5 radius-inner p-4 mb-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-sys-blue/20 flex items-center justify-center flex-shrink-0",children:e.jsx(Qe,{className:"w-4 h-4 text-sys-blue"})}),e.jsxs("div",{className:"type-body-sm text-fg-muted",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-fg-secondary",children:"API tokens"})," are used for machine-to-machine authentication. Include the token in the ",e.jsx("code",{className:"type-code bg-sys-blue/20 px-1.5 py-0.5 rounded-full text-sys-blue",children:"X-API-Key"})," header when making API requests."]}),e.jsx("p",{className:"mt-1 text-fg-muted/70",children:"Tokens are only shown once at creation. Store them securely."})]})]})}),O&&e.jsx("div",{className:"type-body-sm mb-3 px-3 py-2 rounded-full text-sys-red bg-sys-red/10",children:O}),g&&S.length===0?e.jsxs("div",{className:"flex items-center justify-center py-6",children:[e.jsx($,{className:"w-5 h-5 animate-spin text-sys-blue mr-2"}),e.jsx("span",{className:"type-body-sm text-fg-muted",children:"Loading tokens..."})]}):S.length>0?e.jsx("div",{className:"space-y-2",children:S.map(s=>e.jsx("div",{className:"bg-subtle-fill hover:bg-subtle-fill-strong radius-inner p-4 transition-base",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-sys-blue/10 flex items-center justify-center flex-shrink-0",children:e.jsx(qe,{className:"w-5 h-5 text-sys-blue"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"type-body text-fg-primary font-medium truncate",children:s.name}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:gap-4 mt-0.5",children:[e.jsxs("span",{className:"type-data-sm text-fg-muted truncate",children:["Created: ",ys(s.created_at)]}),e.jsxs("span",{className:"type-data-sm text-fg-muted truncate",children:["Last used: ",ys(s.last_used)]})]})]})]}),e.jsxs(F,{color:"danger",outline:!0,onClick:()=>Re({id:s.id,name:s.name}),disabled:ts,children:[e.jsx(Ps,{"data-slot":"icon"}),"Revoke"]})]})},s.id))}):e.jsxs("div",{className:"bg-subtle-fill radius-inner p-6 text-center",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-subtle-fill mx-auto mb-4 flex items-center justify-center",children:e.jsx(qe,{className:"w-7 h-7 text-fg-muted/50"})}),e.jsx("h3",{className:"type-body text-fg-primary font-medium mb-1",children:"No API Tokens"}),e.jsx("p",{className:"type-body-sm text-fg-muted mb-4",children:"Create a token to enable API access"}),e.jsx(F,{color:"primary",outline:!0,onClick:()=>_(!0),children:"Create Your First Token"})]})]})}),e.jsx(te,{template:"auto",children:e.jsxs(Y,{neomorphic:!0,children:[e.jsx(X,{icon:e.jsx(Lt,{}),title:"Web Frontend",subtitle:"Choose which web interface to use",className:"mb-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:l("flex items-start gap-3 p-4 bg-subtle-fill radius-card border-2 cursor-pointer transition-base",ke?"border-sys-blue bg-sys-blue/5":"border-transparent hover:border-sys-blue/30",pe==="loading"&&"opacity-50 pointer-events-none"),children:[e.jsx("input",{type:"radio",name:"frontend",checked:ke,onChange:()=>hs(!0),disabled:pe==="loading",className:"mt-1 h-4 w-4 text-sys-blue focus:ring-sys-blue focus:ring-offset-bg-elevated"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"type-body text-fg-primary font-medium",children:"Default Frontend"}),e.jsx("a",{href:"https://github.com/rightup/pyMC_Repeater",target:"_blank",rel:"noopener noreferrer",onClick:s=>s.stopPropagation(),className:"type-data-xs bg-sys-cyan/15 text-sys-cyan px-2.5 py-0.5 rounded-full font-medium hover:bg-sys-cyan/25 transition-colors",children:"@RightUp"})]}),e.jsx("div",{className:"type-body-sm text-fg-muted mt-1",children:"Built-in pyMC Repeater web interface"}),e.jsx("div",{className:"type-data-xs text-fg-muted/60 mt-1",children:"/opt/pymc_repeater/repeater/web/html"})]})]}),e.jsxs("label",{className:l("flex items-start gap-3 p-4 bg-subtle-fill radius-card border-2 cursor-pointer transition-base",ke?"border-transparent hover:border-sys-blue/30":"border-sys-blue bg-sys-blue/5",pe==="loading"&&"opacity-50 pointer-events-none"),children:[e.jsx("input",{type:"radio",name:"frontend",checked:!ke,onChange:()=>hs(!1),disabled:pe==="loading",className:"mt-1 h-4 w-4 text-sys-blue focus:ring-sys-blue focus:ring-offset-bg-elevated"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"type-body text-fg-primary font-medium",children:"PyMC Console"}),e.jsx("span",{className:"type-data-xs bg-sys-indigo/15 text-sys-indigo px-2.5 py-0.5 rounded-full font-medium",children:"@Treehouse ⚡"})]}),e.jsx("div",{className:"type-body-sm text-fg-muted mt-1",children:"Alternative web interface for pyMC Repeater"}),e.jsx("div",{className:"type-data-xs text-fg-muted/60 mt-1",children:"/opt/pymc_console/web/html"})]})]})]}),!Os&&e.jsx("div",{className:l("bg-subtle-fill radius-card p-4",he?"border border-sys-green/20":"border border-sys-cyan/20"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:l("w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",he?"bg-sys-green/20":"bg-sys-cyan/20"),children:he?e.jsx(Ft,{className:"w-4 h-4 text-sys-green"}):e.jsx(Qe,{className:"w-4 h-4 text-sys-cyan"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"type-body text-fg-primary font-medium",children:he?"PyMC Console has been detected":"PyMC Console Not Installed"}),he?e.jsxs("p",{className:"type-body-sm text-fg-muted mt-1",children:["PyMC Console is installed at ",e.jsx("code",{className:"type-code bg-sys-green/10 px-1.5 py-0.5 rounded-full text-sys-green",children:"/opt/pymc_console/web/html"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"type-body-sm text-fg-muted mt-1 mb-3",children:["PyMC Console must be installed at ",e.jsx("code",{className:"type-code bg-sys-cyan/10 px-1.5 py-0.5 rounded-full text-sys-cyan",children:"/opt/pymc_console/web/html"})," before selecting this option."]}),e.jsxs(F,{color:"primary",outline:!0,href:"https://github.com/dmduran12/pymc_console-dist",children:[e.jsx(Pt,{"data-slot":"icon"}),"PyMC Console Install Instructions"]})]})]})]})}),Vs&&e.jsx("div",{className:"bg-subtle-fill radius-card p-4 border border-sys-indigo/30",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-sys-indigo/20 flex items-center justify-center flex-shrink-0",children:e.jsx(Ge,{className:"w-4 h-4 text-sys-indigo"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"type-body text-fg-primary font-medium",children:"Service restart required"}),e.jsx("p",{className:"type-body-sm text-fg-muted mt-1",children:"Web frontend changes will take effect after restarting the pymc-repeater service."})]})]}),e.jsx(F,{color:"warning",outline:!0,onClick:$s,disabled:Ke,children:Ke?e.jsxs(e.Fragment,{children:[e.jsx($,{"data-slot":"icon",className:"animate-spin"}),"Restarting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Et,{"data-slot":"icon"}),"Restart Now"]})})]})})]})]})}),a&&e.jsx(te,{template:"auto",children:e.jsx(bt,{nodeName:k,repeaterVersion:a.version,coreVersion:a.core_version,localHash:a.local_hash,publicKey:a.public_key})}),a&&((n==null?void 0:n.latitude)===0||!(n!=null&&n.latitude))&&((n==null?void 0:n.longitude)===0||!(n!=null&&n.longitude))&&e.jsx(te,{template:"auto",children:e.jsx(Wt,{})})]}),P&&e.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s=>s.target===s.currentTarget&&_(!1),role:"dialog","aria-modal":"true","aria-labelledby":"create-token-modal-title",children:e.jsxs("div",{className:"surface-modal radius-card p-6 max-w-md w-full",children:[e.jsx("h3",{id:"create-token-modal-title",className:"type-micro mb-4",children:"Create API Token"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx($e,{label:"Token Name",type:"text",value:L,onChange:s=>T(s.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",description:"Give your token a descriptive name to identify its purpose",onKeyDown:s=>s.key==="Enter"&&ps(),autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(F,{color:"muted",outline:!0,onClick:()=>{_(!1),T(""),x(null)},disabled:Ie,children:"Cancel"}),e.jsx(F,{color:"primary",onClick:ps,disabled:Ie||!L.trim(),children:Ie?e.jsxs(e.Fragment,{children:[e.jsx($,{"data-slot":"icon",className:"animate-spin"}),"Creating..."]}):"Create Token"})]})]})]})}),N&&m&&e.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s=>s.target===s.currentTarget&&G(!1),role:"dialog","aria-modal":"true","aria-labelledby":"show-token-modal-title",children:e.jsxs("div",{className:"surface-modal radius-card p-6 max-w-lg w-full",children:[e.jsx("h3",{id:"show-token-modal-title",className:"type-micro mb-4",children:"Token Created Successfully"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-sys-indigo/10 border border-sys-indigo/30 radius-inner p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ge,{className:"w-4 h-4 text-sys-indigo flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-fg-secondary",children:[e.jsx("strong",{children:"Save this token now!"})," For security reasons, it will not be shown again."]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"type-label text-fg-primary block mb-1.5",children:"Your API Token"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ot,{value:m,readOnly:!0,className:"flex-1 font-mono"}),e.jsxs(F,{color:"primary",outline:!0,onClick:Gs,children:[ns?e.jsx(B,{"data-slot":"icon",className:"text-sys-green"}):e.jsx(ct,{"data-slot":"icon"}),ns?"Copied!":"Copy"]})]})]}),e.jsxs("div",{className:"bg-sys-cyan/10 border border-sys-cyan/30 radius-inner p-3",children:[e.jsx("p",{className:"text-sm text-fg-secondary mb-2",children:e.jsx("strong",{children:"Usage Example:"})}),e.jsxs("code",{className:"block bg-sys-cyan/20 px-3 py-2 rounded type-code text-sys-cyan overflow-x-auto",children:['curl -H "X-API-Key: ',m.slice(0,12),'..." ',window.location.origin,"/api/stats"]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx(F,{color:"primary",onClick:()=>{G(!1),z(null)},children:"Done"})})]})]})}),e.jsx(gt,{isOpen:!!ae,title:"Revoke API Token",message:`Are you sure you want to revoke the token '${ae==null?void 0:ae.name}'? This action cannot be undone.`,confirmLabel:ts?"Revoking...":"Revoke",cancelLabel:"Cancel",variant:"danger",onConfirm:qs,onCancel:()=>Re(null)}),ge&&e.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s=>s.target===s.currentTarget&&me(!1),role:"dialog","aria-modal":"true","aria-labelledby":"add-key-modal-title",children:e.jsxs("div",{className:"surface-modal radius-card p-6 max-w-md w-full",children:[e.jsx("h3",{id:"add-key-modal-title",className:"type-micro mb-4",children:"Add Transport Key"}),e.jsxs("div",{className:"space-y-4",children:[K&&e.jsxs("div",{className:"bg-sys-cyan/10 border border-sys-cyan/30 radius-inner p-3 text-sm text-fg-secondary",children:["Adding as child of: ",e.jsx("strong",{className:"text-fg-primary",children:Bs()})]}),e.jsx($e,{label:"Key Name",type:"text",value:ve,onChange:s=>Ne(s.target.value),placeholder:"e.g., Region Name, Group Key",onKeyDown:s=>s.key==="Enter"&&bs(),autoFocus:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"type-label text-fg-muted block mb-2",children:"Flood Policy"}),e.jsxs("div",{className:"toggle-group w-full",children:[e.jsx("button",{onClick:()=>fe("deny"),className:l("toggle-group-item flex-1",De==="deny"&&"active !text-sys-red"),children:"Deny"}),e.jsx("button",{onClick:()=>fe("allow"),className:l("toggle-group-item flex-1",De==="allow"&&"active !text-sys-green"),children:"Allow"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(F,{color:"muted",outline:!0,onClick:()=>{me(!1),Ne(""),fe("allow")},disabled:q,children:"Cancel"}),e.jsx(F,{color:"primary",onClick:bs,disabled:q||!ve.trim(),children:q?e.jsxs(e.Fragment,{children:[e.jsx($,{"data-slot":"icon",className:"animate-spin"}),"Adding..."]}):"Add Key"})]})]})]})}),be&&M&&e.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s=>s.target===s.currentTarget&&ne(!1),role:"dialog","aria-modal":"true","aria-labelledby":"edit-key-modal-title",children:e.jsxs("div",{className:"surface-modal radius-card p-6 max-w-md w-full",children:[e.jsx("h3",{id:"edit-key-modal-title",className:"type-micro mb-4",children:"Edit Transport Key"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx($e,{label:"Key Name",type:"text",value:M.name,onChange:s=>W({...M,name:s.target.value}),autoFocus:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"type-label text-fg-muted block mb-2",children:"Flood Policy"}),e.jsxs("div",{className:"toggle-group w-full",children:[e.jsx("button",{onClick:()=>W({...M,floodPolicy:"deny"}),className:l("toggle-group-item flex-1",M.floodPolicy==="deny"&&"active !text-sys-red"),children:"Deny"}),e.jsx("button",{onClick:()=>W({...M,floodPolicy:"allow"}),className:l("toggle-group-item flex-1",M.floodPolicy==="allow"&&"active !text-sys-green"),children:"Allow"})]})]}),M.transport_key&&e.jsxs("div",{children:[e.jsx("label",{className:"type-label text-fg-muted block mb-2",children:"Transport Key"}),e.jsx("code",{className:"block bg-input-bg px-3 py-2 radius-inner border border-input-border type-code text-fg-muted overflow-x-auto",children:M.transport_key})]}),e.jsxs("div",{className:"flex justify-between gap-3 mt-6",children:[e.jsx(F,{color:"danger",outline:!0,onClick:()=>{ne(!1),xe(M),le(!0),W(null)},disabled:q,children:"Delete"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(F,{color:"muted",outline:!0,onClick:()=>{ne(!1),W(null)},disabled:q,children:"Cancel"}),e.jsx(F,{color:"primary",onClick:Xs,disabled:q||!M.name.trim(),children:q?e.jsxs(e.Fragment,{children:[e.jsx($,{"data-slot":"icon",className:"animate-spin"}),"Saving..."]}):"Save"})]})]})]})]})}),je&&Z&&e.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s=>s.target===s.currentTarget&&le(!1),role:"dialog","aria-modal":"true","aria-labelledby":"delete-key-modal-title",children:e.jsxs("div",{className:"surface-modal radius-card p-6 max-w-md w-full",children:[e.jsx("h3",{id:"delete-key-modal-title",className:"type-micro mb-4",children:"Delete Transport Key"}),e.jsxs("p",{className:"text-fg-secondary mb-4",children:["Are you sure you want to delete ",e.jsxs("strong",{className:"text-fg-primary",children:["'",Z.name,"'"]}),"?"]}),Z.children&&Z.children.length>0&&e.jsx("div",{className:"bg-sys-indigo/10 border border-sys-indigo/30 radius-inner p-3 mb-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ge,{className:"w-4 h-4 text-sys-indigo flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-fg-secondary",children:["This key has ",Z.children.length," child key(s). Deleting will also remove all children."]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(F,{color:"muted",outline:!0,onClick:()=>{le(!1),xe(null)},disabled:q,children:"Cancel"}),e.jsx(F,{color:"danger",onClick:Ys,disabled:q,children:q?e.jsxs(e.Fragment,{children:[e.jsx($,{"data-slot":"icon",className:"animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})}export{ha as default};
