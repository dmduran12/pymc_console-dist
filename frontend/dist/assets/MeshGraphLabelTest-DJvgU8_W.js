import{r as e,j as l,m as t,i as s}from"./vendor-react-BKIq8k5U.js";import{L as o}from"./loader-circle-Cs0buZAu.js";import"./deckgl-DTsmDcfs.js";import"./index-B11lY9-1.js";import"./vendor-core-D1aqi_5O.js";const a=[{id:"node-1",label:"Alpha Hub",color:"#FFFFFF",size:20},{id:"node-2",label:"Beta Gateway",color:"#E0E0E0",size:15},{id:"node-3",label:"Gamma Relay",color:"#C0C0C0",size:12},{id:"node-4",label:"Delta Edge",color:"#A0A0A0",size:10},{id:"node-5",label:"Epsilon Leaf",color:"#808080",size:8}],n=[{source:"node-1",target:"node-2",color:"#666666",width:2},{source:"node-1",target:"node-3",color:"#666666",width:2},{source:"node-2",target:"node-4",color:"#444444",width:1},{source:"node-3",target:"node-5",color:"#444444",width:1}];function i(){const[i,r]=e.useState(null),[c,d]=e.useState(null),[m,p]=e.useState({}),[u,h]=e.useState([]),b=e.useRef(null),g=e.useCallback(e=>{h(l=>[...l.slice(-20),`${(new Date).toISOString().slice(11,19)} ${e}`])},[]);e.useEffect(()=>{(async()=>{var e,l,t;g("Starting data preparation..."),g(`Input nodes: ${JSON.stringify(a.map(e=>({id:e.id,label:e.label})))}`);try{const o=await s({points:{pointIdBy:"id",pointLabelBy:"label",pointColorBy:"color",pointColorStrategy:"direct",pointSizeBy:"size",pointSizeStrategy:"direct",pointDefaultSize:10,pointDefaultColor:"#FFFFFF",pointGreyoutOpacity:.3,pointSizeScale:1},links:{linkSourceBy:"source",linkTargetsBy:["target"],linkColorBy:"color",linkColorStrategy:"direct",linkWidthBy:"width",linkWidthStrategy:"direct",linkDefaultWidth:1,linkDefaultColor:"#444444",linkGreyoutOpacity:.1,linkWidthScale:1}},a,n);if(!o)return void g("ERROR: prepareCosmographData returned undefined");if(g("Preparation complete!"),g("result.points: "+(o.points?"present":"null")),g("result.links: "+(o.links?"present":"null")),g(`result.cosmographConfig keys: ${Object.keys(o.cosmographConfig??{}).join(", ")}`),o.points){const s=(null==(l=null==(e=o.points.schema)?void 0:e.fields)?void 0:l.map(e=>e.name))??[];g(`Arrow table columns: ${s.join(", ")}`);const a=s.includes("label");g("Has 'label' column in Arrow table: "+(a?"YES ✓":"NO ✗"));const n=null==(t=o.cosmographConfig)?void 0:t.pointLabelBy;g(`pointLabelBy in cosmographConfig: ${n??"NOT SET"}`)}r(o.points??null),d(o.links??null),p(o.cosmographConfig??{})}catch(o){g(`ERROR: ${o}`)}})()},[g]);const f=e.useCallback(e=>{b.current=e,g("Cosmograph mounted"),setTimeout(()=>{const e=document.querySelector(".css-label--labels-container"),l=document.querySelectorAll('[class*="css-label"]'),t=document.querySelectorAll('[class*="cosmograph"][class*="label"]');g("Label containers found: "+(e?"YES":"NO")),g(`Elements with css-label class: ${l.length}`),g(`Elements with cosmograph+label class: ${t.length}`),l.forEach((e,l)=>{});const s=document.querySelector(".cosmograph");if(s){const e=Array.from(s.children);g(`Cosmograph container children: ${e.map(e=>e.tagName+"."+e.className.split(" ")[0]).join(", ")}`)}},2e3)},[g]),x=e.useCallback(()=>{var e,l,t,s,o;g("Simulation ended"),null==(e=b.current)||e.fitView(500);const a=null==(l=b.current)?void 0:l._internalApi;if(a){g("Attempting to initialize labels via internal API...");try{null==(t=a.initializeLabels)||t.call(a),null==(o=null==(s=a.labels)?void 0:s.update)||o.call(s),g("Labels API called successfully")}catch(n){g(`Labels init error: ${n}`)}}else g("No internal API access")},[g]);return i?l.jsxs("div",{className:"h-screen flex flex-col bg-black text-white",children:[l.jsxs("div",{className:"px-4 py-2 border-b border-gray-800 flex items-center justify-between",children:[l.jsx("h1",{className:"text-lg font-semibold",children:"Label Rendering Test"}),l.jsxs("span",{className:"text-sm text-gray-400",children:[a.length," nodes • Check if labels appear below"]})]}),l.jsxs("div",{className:"flex-1 flex",children:[l.jsx("div",{className:"flex-1 relative",children:l.jsx(t,{className:"absolute inset-0",points:i,links:c,...m,backgroundColor:"#000000",fitViewOnInit:!0,showLabels:!0,showDynamicLabels:!0,showTopLabels:!0,showTopLabelsLimit:10,showHoveredPointLabel:!0,pointLabelColor:"#FFFF00",pointLabelFontSize:14,onMount:f,onSimulationEnd:x})}),l.jsxs("div",{className:"w-80 border-l border-gray-800 p-4 overflow-auto",children:[l.jsx("h2",{className:"text-sm font-semibold mb-2",children:"Debug Log"}),l.jsx("div",{className:"space-y-1 text-xs font-mono text-gray-400",children:u.map((e,t)=>l.jsx("div",{children:e},t))}),l.jsx("h2",{className:"text-sm font-semibold mt-4 mb-2",children:"Config from prepareCosmographData"}),l.jsx("pre",{className:"text-xs font-mono text-gray-400 whitespace-pre-wrap",children:JSON.stringify(m,null,2)}),l.jsx("h2",{className:"text-sm font-semibold mt-4 mb-2",children:"Expected Labels"}),l.jsx("ul",{className:"text-xs space-y-1",children:a.map(e=>l.jsxs("li",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),l.jsx("span",{children:e.label})]},e.id))})]})]})]}):l.jsx("div",{className:"h-screen flex items-center justify-center bg-black",children:l.jsx(o,{className:"w-8 h-8 animate-spin text-white"})})}export{i as default};
