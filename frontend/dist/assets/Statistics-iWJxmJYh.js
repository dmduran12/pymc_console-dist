var kt=Object.defineProperty;var Mt=(t,n,s)=>n in t?kt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s;var xe=(t,n,s)=>Mt(t,typeof n!="symbol"?n+"":n,s);import{r as c,j as e}from"./vendor-react-CHg3w57L.js";import{c as Ce,a3 as gt,aH as bt,aI as Qe,aJ as ve,aK as Ct,h as Oe,aL as At,aM as Rt,u as _t,aN as Dt,aO as Lt,aP as Tt,aQ as Et,aR as It,ag as Pt,aS as He,ai as Ot,aT as Ft,aU as Ht,q as Ne,aV as Bt,aW as $t,p as zt,t as Wt,r as Ut,m as Gt,a0 as Vt,a1 as qt,v as Kt,W as Yt,aX as Xt,aY as Be,aZ as st,a_ as Zt}from"./index-B4woLUMa.js";import{c as nt}from"./vendor-core-CgllfypI.js";import{a4 as Se,aB as Qt,u as Jt,aC as es,aD as ts,aE as ss,aF as ns,aG as $e,H as at,I as as,a3 as Xe,aH as rt,a7 as rs,g as is,ak as os,R as ls}from"./vendor-icons-rRVc_l7g.js";import{u as Je,h as cs,r as et}from"./consumer-registry-CWCmZQuW.js";import{e as ms}from"./easing-DOExzd0X.js";import{T as us}from"./TimeRangeStepper-CHvn0Aaa.js";import{C as le,P as ds,a as hs,B as xs}from"./PageLayout-vzO_WRlt.js";import{D as ps}from"./DataBox-CbYpEKKd.js";import{A as Pe}from"./AnimatedNumber-HEq8i9Ws.js";import{C as fs}from"./CollisionExplorerModal-CSqahLo8.js";import{L as gs}from"./LightSparkline-Cju8m-oY.js";import{c as bs,a as ys,A as js}from"./AnalyzerFilterPanel-BlxSmIeb.js";import{a as Ns}from"./usePipelineStore-CW29AYoP.js";import{R as ge,C as ke}from"./Grid-C8oPbJfP.js";import"./cosmograph-RBQGoH9-.js";import"./vendor-charts-DuSK2RSZ.js";import"./vendor-motion-CXybMqb1.js";import"./vendor-fonts-CgDm-k6O.js";import"./maplibre-gl-B21pqYGi.js";import"./BasemapLayer-VM7R8hCP.js";import"./node-types-CTinVm-W.js";import"./geo-utils-BP1zBK9h.js";const yt={useAbsoluteThresholds:!0,baselinePercentile:6,spikePercentile:50,baselineDbm:-107,spikeDbm:-100,mergeGapSeconds:45,minSequenceLength:16,similarityToleranceDbm:5};function je(t,n){if(t.length===0)return 0;const s=n/100*(t.length-1),a=Math.floor(s),i=Math.ceil(s);return a===i?t[a]:t[a]+(t[i]-t[a])*(s-a)}function it(t){if(t.length===0)return{median:0,p90:0,p95:0,p99:0,max:0,min:0};const n=[...t].sort((s,a)=>s-a);return{median:je(n,50),p90:je(n,90),p95:je(n,95),p99:je(n,99),max:n[n.length-1],min:n[0]}}function vs(t,n={}){const s={...yt,...n};if(t.length<10)return{anomalies:[],thresholds:it([]),totalSamples:t.length,anomalySamples:0};const a=t.map(g=>g.noise_floor_dbm),i=it(a),r=[...a].sort((g,j)=>g-j);let l,x;s.useAbsoluteThresholds?(l=s.baselineDbm,x=s.spikeDbm):(l=je(r,s.baselinePercentile),x=je(r,s.spikePercentile));const o=[...t].sort((g,j)=>g.timestamp-j.timestamp),p=[];let u=null,h=0;for(const g of o)if(g.noise_floor_dbm>l&&g.noise_floor_dbm<x)if(h++,!u)u={startTs:g.timestamp,endTs:g.timestamp,values:[g.noise_floor_dbm],timestamps:[g.timestamp],rollingAvg:g.noise_floor_dbm};else{const w=Math.abs(g.noise_floor_dbm-u.rollingAvg)<=s.similarityToleranceDbm,D=g.timestamp-u.endTs<=s.mergeGapSeconds;w&&D?(u.endTs=g.timestamp,u.values.push(g.noise_floor_dbm),u.timestamps.push(g.timestamp),u.rollingAvg=u.values.reduce((P,z)=>P+z,0)/u.values.length):(u.values.length>=s.minSequenceLength&&p.push(u),u={startTs:g.timestamp,endTs:g.timestamp,values:[g.noise_floor_dbm],timestamps:[g.timestamp],rollingAvg:g.noise_floor_dbm})}else u&&u.values.length>=s.minSequenceLength&&p.push(u),u=null;return u&&u.values.length>=s.minSequenceLength&&p.push(u),p.length===0?{anomalies:[],thresholds:i,totalSamples:t.length,anomalySamples:h,debug:{baselineCutoff:l,spikeCutoff:x,midBandSamples:h}}:{anomalies:p.map(g=>{const j=Math.max(...g.values),y=g.values.reduce((w,D)=>w+D,0)/g.values.length;return{startTs:g.startTs,endTs:g.endTs,peakValue:j,avgValue:y,severity:Ss(y,l,x),sampleCount:g.values.length}}),thresholds:i,totalSamples:t.length,anomalySamples:h,debug:{baselineCutoff:l,spikeCutoff:x,midBandSamples:h}}}function Ss(t,n,s){const a=s-n;if(a===0)return"moderate";const i=(t-n)/a;return i>.66?"critical":i>.33?"severe":"moderate"}const ws=Object.entries(gt).map(([t,n])=>{const s=parseInt(t,10);return{typeNum:s,key:`TYPE_${s}`,label:n}});function tt({sortedTypes:t,highlightedType:n,onTypeHover:s,aggregateShares:a,hoverData:i}){const r=c.useMemo(()=>{if(!i)return null;const o=new Map;for(const p of i.items)o.set(p.key,p.value);return o},[i]),l=r!==null,x=c.useMemo(()=>{const o=new Set(t.map(h=>h.key)),p=t.map(h=>({typeNum:h.typeNum,key:h.key,label:h.label})),u=ws.filter(h=>!o.has(h.key));return[...p,...u]},[t]);return e.jsxs("div",{className:"flex-shrink-0 pt-2 sm:pt-3 mt-1 sm:mt-2 px-0 sm:pr-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mx-0 sm:ml-9 sm:mr-0 mb-1 sm:mb-1.5 type-data-xs",children:[e.jsx("span",{className:"text-fg-muted",children:"Packet Types"}),l&&(i==null?void 0:i.timeLabel)&&e.jsx("span",{className:"text-sys-indigo tabular-nums",children:i.timeLabel})]}),e.jsx("div",{className:"flex flex-wrap gap-x-3 sm:gap-x-4 gap-y-1 type-data-xs mx-0 sm:ml-9 sm:mr-0",onMouseLeave:()=>s(null),children:x.map(o=>{const p=Ce(o.typeNum),u=(r==null?void 0:r.get(o.key))??0,h=a.get(o.key)??0,k=l?u:h,g=k>1e-4,j=a.has(o.key),y=n===o.key,w=n&&!y||l&&u<=1e-4||!l&&!n&&!j;return e.jsxs("div",{className:nt("flex items-center gap-1.5 transition-opacity cursor-pointer hover:opacity-80",w&&"opacity-30"),onMouseEnter:()=>s(o.key),children:[e.jsx("div",{className:"shrink-0 w-3 h-3 rounded-xs",style:{backgroundColor:p}}),e.jsx("span",{className:"text-fg-secondary whitespace-nowrap",children:o.label}),g&&e.jsxs("span",{className:nt("tabular-nums",l?"text-fg-primary":"text-fg-muted"),children:[(k*100).toFixed(1),"%"]})]},o.key)})})]})}const ot='ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace',ks=2,Ms=3,Cs=32,As=20,Rs=80;function lt(t,n,s,a,i){const r=t.reduce((p,u)=>p+u,0);if(r<=0||t.length===0)return[];const l=t.map((p,u)=>u).sort((p,u)=>t[u]-t[p]),x=l.map(p=>t[p]),o=new Array(t.length);return Ze(x,l,r,n,s,a,i,o),o}function Ze(t,n,s,a,i,r,l,x){if(t.length===0)return;if(t.length===1){x[n[0]]={x:a,y:i,w:r,h:l,index:n[0]};return}const o=r*l/s,p=r>=l,u=p?l:r;let h=0,k=1/0,g=0;for(let z=0;z<t.length;z++){const H=h+t[z],q=H*o/u;if(q<=0){g=z+1,h=H;continue}const O=t[0]*o/q,N=t[z]*o/q,m=Math.max(O>q?O/q:q/O,N>q?N/q:q/N);if(m<=k)k=m,g=z+1,h=H;else break}const j=u>0?h*o/u:0;let y=0;for(let z=0;z<g;z++){const q=(h>0?t[z]/h:0)*u;p?x[n[z]]={x:a,y:i+y,w:j,h:q,index:n[z]}:x[n[z]]={x:a+y,y:i,w:q,h:j,index:n[z]},y+=q}const w=t.slice(g),D=n.slice(g),P=s-h;p?Ze(w,D,P,a+j,i,r-j,l,x):Ze(w,D,P,a,i+j,r,l-j,x)}function ct(t,n,s,a,i,r){for(const l of n){const x=s[l.index];if(!x)continue;const o=ks*r,p=l.x*r+o/2,u=l.y*r+o/2,h=l.w*r-o,k=l.h*r-o;if(h<=0||k<=0)continue;const g=Ce(x.typeNum),j=i!==null&&i!==l.index;t.save(),t.globalAlpha=j?.4:1;const y=Ms*r;t.beginPath(),t.moveTo(p+y,u),t.lineTo(p+h-y,u),t.quadraticCurveTo(p+h,u,p+h,u+y),t.lineTo(p+h,u+k-y),t.quadraticCurveTo(p+h,u+k,p+h-y,u+k),t.lineTo(p+y,u+k),t.quadraticCurveTo(p,u+k,p,u+k-y),t.lineTo(p,u+y),t.quadraticCurveTo(p,u,p+y,u),t.closePath(),t.fillStyle=g,t.fill(),t.strokeStyle="rgba(0,0,0,0.2)",t.lineWidth=1*r,t.stroke();const w=4*r,D=l.w>36&&l.h>20,P=l.w>36&&l.h>32;if(D){const z=11*r;if(P){const H=a>0?x.size/a*100:0;t.font=`500 ${8*r}px ${ot}`,t.fillStyle="rgba(0,0,0,0.6)",t.textBaseline="alphabetic",t.textAlign="left",t.fillText(`${H.toFixed(1)}%`,p+w,u+k-w-z)}t.font=`600 ${9*r}px ${ot}`,t.fillStyle="rgba(0,0,0,0.85)",t.textBaseline="alphabetic",t.textAlign="left",t.fillText(x.name,p+w,u+k-w)}t.restore()}}function _s(t,n,s){for(const a of t)if(n>=a.x&&n<=a.x+a.w&&s>=a.y&&s<=a.y+a.h)return a.index;return null}function Ds({data:t,total:n,color:s,position:a,containerWidth:i,isAirtime:r}){if(!t||!a)return null;const l=(t.value/n*100).toFixed(1),x=160,u=i-a.x<x+24?Math.max(8,a.x-x-8):a.x+16;return e.jsx("div",{className:"absolute z-50 pointer-events-none",style:{left:u,top:Math.max(8,a.y-60)},children:e.jsxs("div",{className:"bg-tooltip-bg border border-edge-subtle rounded-lg px-3 py-2 shadow-xl min-w-[140px]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-sm flex-shrink-0",style:{backgroundColor:s}}),e.jsx("span",{className:"type-data-sm font-semibold text-fg-primary",children:t.name})]}),e.jsxs("div",{className:"space-y-0.5 type-data-xs text-fg-muted",children:[e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{children:r?"Airtime":"Count"}),e.jsx("span",{className:"text-fg-primary tabular-nums font-medium",children:r?mt(t.value):t.value.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{children:"Share"}),e.jsxs("span",{className:"text-fg-primary tabular-nums font-medium",children:[l,"%"]})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"text-fg-primary tabular-nums font-medium",children:r?mt(n):n.toLocaleString()})]})]})]})})}function mt(t){return t>=6e4?`${(t/6e4).toFixed(1)}m`:t>=1e3?`${(t/1e3).toFixed(1)}s`:`${Math.round(t)}ms`}function Ls({sortedTypes:t,aggregateShares:n,mode:s="share"}){var O,N,m;const[a,i]=c.useState(null),[r,l]=c.useState(null),[x,o]=c.useState(0),[p,u]=c.useState(null),h=c.useRef(null),k=c.useRef(null),g=c.useRef([]),j=s==="airtime",y=c.useMemo(()=>t.reduce((f,v)=>f+(j?v.totalAirtime:v.totalCount),0),[t,j]),w=c.useMemo(()=>t.map((f,v)=>({name:f.label,size:j?f.totalAirtime:f.totalCount,index:v,typeNum:f.typeNum,key:f.key})),[t,j]);c.useEffect(()=>{const f=k.current;if(!f)return;const v=f.parentElement;if(!v)return;const E=v.getBoundingClientRect(),B=E.width,_=E.height;if(B<=0||_<=0)return;const W=window.devicePixelRatio||1;f.width=Math.floor(B*W),f.height=Math.floor(_*W),f.style.width=`${B}px`,f.style.height=`${_}px`;const V=w.map(U=>U.size),te=lt(V,0,0,B,_);g.current=te;const J=f.getContext("2d");J&&(J.clearRect(0,0,f.width,f.height),ct(J,te,w,y,a,W))},[w,y,a]),c.useEffect(()=>{const f=h.current;if(!f)return;const v=new ResizeObserver(()=>{const E=k.current;if(!E)return;const B=f.getBoundingClientRect(),_=B.width,W=B.height;if(_<=0||W<=0)return;const V=window.devicePixelRatio||1;E.width=Math.floor(_*V),E.height=Math.floor(W*V),E.style.width=`${_}px`,E.style.height=`${W}px`;const te=w.map(L=>L.size),J=lt(te,0,0,_,W);g.current=J;const U=E.getContext("2d");U&&(U.clearRect(0,0,E.width,E.height),ct(U,J,w,y,a,V))});return v.observe(f),()=>v.disconnect()},[w,y]);const D=c.useCallback(f=>{const v=h.current;if(!v)return;const E=v.getBoundingClientRect(),B=f.clientX-E.left,_=f.clientY-E.top,W=_s(g.current,B,_);i(W),W!==null?(o(E.width),l({x:B,y:_})):l(null)},[]),P=c.useCallback(()=>{i(null),l(null)},[]),z=c.useCallback(f=>{if(u(f),f){const v=w.findIndex(E=>E.key===f);i(v>=0?v:null)}else i(null)},[w]),H=a!==null?{name:((O=w[a])==null?void 0:O.name)??"",value:((N=w[a])==null?void 0:N.size)??0}:null,q=a!==null?Ce((m=w[a])==null?void 0:m.typeNum):"";return t.length===0||y===0?e.jsxs("div",{className:"h-full flex items-center justify-center text-fg-muted",children:[e.jsx(Se,{className:"w-6 h-6 mr-2 opacity-50"}),e.jsx("span",{children:"No packet type data available"})]}):e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex-1 min-h-0 relative",children:e.jsxs("div",{className:"absolute overflow-hidden radius-inner ring-1 ring-inset ring-edge-subtle bg-chart-inner",style:{left:Cs,right:0,top:0,bottom:As},ref:h,onMouseMove:D,onMouseLeave:P,children:[e.jsx("canvas",{ref:k,className:"absolute inset-0",style:{cursor:"default"}}),e.jsx(Ds,{data:H,total:y,color:q,position:r,containerWidth:x,isAirtime:j})]})}),e.jsx("div",{style:{minHeight:Rs},children:e.jsx(tt,{sortedTypes:t,highlightedType:p,onTypeHover:z,aggregateShares:n})})]})}const ze=32,We=20,Ts=300;function ye(t){return t>=1e9?`${(t/1e9).toFixed(1)} Gb`:t>=1e6?`${(t/1e6).toFixed(1)} Mb`:t>=1e3?`${(t/1e3).toFixed(1)} Kb`:`${t.toFixed(0)} B`}function Es({packets:t,mode:n,startTs:s,endTs:a,radioConfig:i,bucketCount:r,lockedYMax:l,legendMinH:x}){const o=c.useMemo(()=>bt(),[]),p=o.blue,u=o.red,h=o.yellow,[k,g]=c.useState(null),{trendData:j,totals:y}=c.useMemo(()=>{if(t.length===0)return{trendData:[],totals:{rxBytes:0,txBytes:0,rxAirtime:0,txAirtime:0}};const N=a-s,m=Math.min(Math.ceil(N/Ts),r),f=N/m,v=[];let E=0,B=0,_=0,W=0;for(const $ of t){const b=$.timestamp;if(b<s||b>=a)continue;const S=Qe($),A=ve($,{spreadingFactor:i.sf,bandwidthHz:i.bw,codingRate:i.cr,preambleLength:i.preamble}),I={timestamp:b,rxAirtime:0,txAirtime:0,rxBytes:0,txBytes:0};$.transmitted?(I.txAirtime=A,I.txBytes=S,B+=S,W+=A):(I.rxAirtime=A,I.rxBytes=S,E+=S,_+=A),v.push(I)}v.sort(($,b)=>$.timestamp-b.timestamp);const V=new Float64Array(v.length+1),te=new Float64Array(v.length+1),J=new Float64Array(v.length+1),U=new Float64Array(v.length+1),L=new Float64Array(v.length);for(let $=0;$<v.length;$++)V[$+1]=V[$]+v[$].rxAirtime,te[$+1]=te[$]+v[$].txAirtime,J[$+1]=J[$]+v[$].rxBytes,U[$+1]=U[$]+v[$].txBytes,L[$]=v[$].timestamp;const Y=$=>{let b=0,S=L.length;for(;b<S;){const A=b+S>>>1;L[A]<$?b=A+1:S=A}return b},se=[],re=f*1e3;for(let $=0;$<m;$++){const b=s+$*f,S=b+f,A=Y(b),I=Y(S);if(n==="share"){const Q=J[I]-J[A],de=U[I]-U[A];se.push({timestamp:b,rx:Q>0?Q:null,tx:de>0?de:null})}else{const Q=V[I]-V[A],de=te[I]-te[A],pe=Q/re*100,fe=de/re*100;se.push({timestamp:b,rx:pe>0?pe:null,tx:fe>0?fe:null})}}const ae=2/31;let ne=null;return{trendData:se.map($=>{const b=$.rx;return b!==null&&b>0&&(ne===null?ne=b:ne=ae*b+(1-ae)*ne),{...$,rxSmooth:ne!==null&&ne>0?ne:null}}),totals:{rxBytes:E,txBytes:B,rxAirtime:_,txAirtime:W}}},[t,s,a,r,n,i]),w=c.useMemo(()=>{if(j.length===0)return n==="share"?100:10;let N=0;for(const f of j){const v=f.rx??0,E=f.tx??0;v>N&&(N=v),E>N&&(N=E)}const m=N*1.1;return n==="share"?m<=100?100:m<=500?Math.ceil(m/100)*100:m<=1e3?Math.ceil(m/200)*200:m<=5e3?Math.ceil(m/500)*500:m<=1e4?Math.ceil(m/1e3)*1e3:Math.ceil(m/5e3)*5e3:Math.max(1,Math.ceil(m))},[j,n]),D=l??w,P=c.useMemo(()=>{if(k!==null&&j[k]){const N=j[k],m=N.rx??0,f=N.tx??0;return n==="share"?{rx:ye(m),tx:ye(f),total:ye(m+f),isHovered:!0}:{rx:`${m.toFixed(2)}%`,tx:`${f.toFixed(2)}%`,total:`${(m+f).toFixed(2)}%`,isHovered:!0}}if(n==="share")return{rx:ye(y.rxBytes),tx:ye(y.txBytes),total:ye(y.rxBytes+y.txBytes),isHovered:!1};{let N=0,m=0,f=0;for(const B of j)(B.rx!==null||B.tx!==null)&&(N+=B.rx??0,m+=B.tx??0,f++);const v=f>0?N/f:0,E=f>0?m/f:0;return{rx:`${v.toFixed(2)}%`,tx:`${E.toFixed(2)}%`,total:`${(v+E).toFixed(2)}%`,isHovered:!1}}},[k,j,y,n]),z=c.useMemo(()=>{const N=a-s,m=N/3600;return[0,.25,.5,.75,1].map(v=>{const E=s+N*v,B=new Date(E*1e3),_=B.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}),W=B.toLocaleDateString([],{weekday:"short"}),V=v===.25||v===.75;return{pct:v,label:m>=24?`${W} ${_}`:_,mobileHidden:V}})},[s,a]),H=c.useCallback(N=>{g(N)},[]);if(j.length===0)return e.jsxs("div",{className:"h-full flex items-center justify-center text-fg-muted",children:[e.jsx(Se,{className:"w-6 h-6 mr-2 opacity-50"}),e.jsx("span",{children:"No packet data available"})]});const q=c.useMemo(()=>n==="airtime"?D<=5?1:D<=10?2:D<=20?5:Math.ceil(D/5):D<=100?25:D<=500?100:D<=1e3?200:D<=5e3?1e3:D<=1e4?2e3:Math.ceil(D/5e3)*1e3,[D,n]),O=c.useMemo(()=>{const N=[];for(let m=0;m<=D;m+=q){const f=(1-m/D)*100;let v;n==="airtime"?v=`${m}%`:m>=1e6?v=`${(m/1e6).toFixed(1)}M`:m>=1e3?v=`${(m/1e3).toFixed(0)}K`:v=`${m}`,N.push({pos:f,label:v})}return N},[D,q,n]);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 min-h-0 relative",children:[e.jsx("div",{className:"absolute top-0 left-0 flex flex-col justify-between",style:{width:ze,bottom:We},children:O.map((N,m)=>e.jsx("span",{className:"type-data-xs text-fg-secondary text-right pr-1.5",style:{position:"absolute",top:`${N.pos}%`,transform:m===0?"translateY(-100%)":m===O.length-1?"none":"translateY(-50%)",right:0},children:N.label},m))}),e.jsx("div",{className:"absolute overflow-hidden radius-inner ring-1 ring-inset ring-edge-subtle bg-chart-inner",style:{left:ze,right:0,top:0,bottom:We},children:e.jsx(Ct,{data:j,yAxisMode:n==="share"?"share":"airtime",yMax:D,onHover:H,startTs:s,endTs:a,externalAxes:!0})}),e.jsx("div",{className:"absolute left-0 right-0 bottom-0 flex items-center pointer-events-none",style:{left:ze,height:We,paddingTop:4},children:z.map((N,m)=>e.jsx("span",{className:`absolute type-data-xs text-fg-muted/60 tabular-nums ${N.mobileHidden?"hidden sm:inline":""}`,style:{left:`${N.pct*100}%`,transform:N.pct===0?"translateX(0)":N.pct===1?"translateX(-100%)":"translateX(-50%)"},children:N.label},m))})]}),e.jsxs("div",{className:"flex items-end justify-between pb-1",style:{minHeight:x},children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-5 type-data-sm pl-2 sm:pl-11",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-4 sm:w-5 h-[2px] rounded-full",style:{backgroundColor:p}}),e.jsx("span",{className:"text-fg-secondary",children:"RX"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-4 sm:w-5 h-[2px] rounded-full",style:{backgroundColor:u}}),e.jsx("span",{className:"text-fg-secondary",children:"TX"})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-1.5",children:[e.jsx("div",{className:"w-5 h-[2px] rounded-full",style:{backgroundColor:h}}),e.jsx("span",{className:"text-fg-secondary",children:"Avg"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 sm:gap-8",children:[e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("div",{className:"type-data-xl text-fg-primary",children:P.rx}),e.jsx(Oe,{color:"zinc",className:"mb-0.5 sm:mb-1",children:"RX"})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("div",{className:"type-data-xl text-fg-primary",children:P.tx}),e.jsx(Oe,{color:"zinc",className:"mb-0.5 sm:mb-1",children:"TX"})]})]})]})]})}const ut=At;class Is{constructor(){xe(this,"worker",null);xe(this,"listeners",new Set);xe(this,"currentResult",null);xe(this,"isComputing",!1);xe(this,"debounceTimer",null);xe(this,"debounceMs",250);xe(this,"lastCacheKey",null)}ensureWorker(){if(this.worker)return this.worker;if(typeof window>"u")return null;try{this.worker=new Worker(new URL("/assets/bucketing.worker-D2Fn452R.js",import.meta.url),{type:"module"}),this.worker.onmessage=n=>{this.handleWorkerMessage(n.data)},this.worker.onerror=n=>{console.error("[BucketingService] Worker error:",n),this.isComputing=!1,this.notifyListeners()}}catch(n){console.error("[BucketingService] Failed to initialize worker:",n)}return this.worker}handleWorkerMessage(n){if(this.isComputing=!1,n.type==="error"){this.currentResult=null,this.notifyListeners();return}const s=n.payload;this.currentResult={points:s.points,rawValues:s.rawValues,packetTypes:s.packetTypes,timestamps:s.timestamps,count:s.count,minTime:s.minTime,maxTime:s.maxTime,minValue:s.minValue,maxValue:s.maxValue,rawMinValue:s.rawMinValue,rawMaxValue:s.rawMaxValue,unit:"%",stats:{p5:s.p5,p50:s.p50,p95:s.p95,uniqueValues:s.uniqueValues,topValues:s.topValues}},this.notifyListeners()}notifyListeners(){for(const n of this.listeners)try{n(this.currentResult,this.isComputing)}catch(s){console.error("[BucketingService] Listener error:",s)}}isCacheHit(n){return!this.lastCacheKey||!this.currentResult?!1:this.lastCacheKey.startTs===n.startTs&&this.lastCacheKey.endTs===n.endTs&&this.lastCacheKey.mode===n.mode&&this.lastCacheKey.packetCount===n.packetCount}compute(n,s,a,i,r){if(n.length===0||!r){this.currentResult=null,this.notifyListeners();return}const l={startTs:s,endTs:a,mode:i,packetCount:n.length};this.isCacheHit(l)||(this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.debounceTimer=null,this.computeInternal(n,s,a,i,r,l)},this.debounceMs))}computeInternal(n,s,a,i,r,l){const x=this.ensureWorker();if(!x)return;const o=n.length,p=new Float64Array(o),u=new Float64Array(o),h=new Uint16Array(o),k=new Uint8Array(o),g={spreadingFactor:r.sf,bandwidthHz:r.bw,codingRate:r.cr,preambleLength:r.preamble};for(let y=0;y<o;y++){const w=n[y];p[y]=w.timestamp??0,k[y]=(w.type??w.payload_type??255)&255,h[y]=Math.min(Qe(w),65535),i==="airtime"?u[y]=ve(w,g):u[y]=1}this.isComputing=!0,this.lastCacheKey=l,this.notifyListeners();const j={type:"compute",payload:{timestamps:p,airtimeMs:u,byteSizes:h,packetTypes:k,startTs:s,endTs:a,mode:i}};x.postMessage(j,[p.buffer,u.buffer,h.buffer,k.buffer])}getResult(){return this.currentResult}isWorking(){return this.isComputing}subscribe(n){return this.listeners.add(n),n(this.currentResult,this.isComputing),()=>{this.listeners.delete(n)}}clear(){this.currentResult=null,this.lastCacheKey=null,this.notifyListeners()}terminate(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.worker&&(this.worker.terminate(),this.worker=null),this.listeners.clear()}}const Ue=new Is;function Ps(t,n,s,a,i){const[r,l]=c.useState(()=>Ue.getResult());return c.useEffect(()=>Ue.subscribe(x=>{l(x)}),[]),c.useEffect(()=>{Ue.compute(t,n,s,a,i)},[t,n,s,a,i]),r}function Os({mode:t,packets:n,startTs:s,endTs:a,radioConfig:i,sortedTypes:r,aggregateShares:l,noiseFloorAnomalies:x,showNoiseFloorOverlay:o,overlayOpacity:p=.5,startLabel:u,endLabel:h,lockedYMax:k,legendMinH:g,dotSize:j,dotOpacity:y}){const[w,D]=c.useState(null),[P,z]=c.useState(null),H=c.useMemo(()=>(a-s)/3600,[s,a]),q=c.useCallback(U=>{z(U)},[]),N=Ps(n,s,a,t==="share"?"share":"airtime",i),[m,f]=c.useState(null),v=c.useCallback((U,L)=>{D(U),f(L??null)},[]),E=c.useMemo(()=>{if(m===null||!N||N.count===0)return null;const U=s+m*(a-s);let L;H>=168?L=75:H>=72?L=35:H>=24?L=15:H>=3?L=10:L=5;const Y=L*60/2;return{start:U-Y,end:U+Y}},[m,N,s,a,H]),B=c.useMemo(()=>E?new Date((E.start+E.end)/2*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}):null,[E]),_=c.useMemo(()=>{if(w===null||!E)return null;const U=B??"",{start:L,end:Y}=E,se=n.filter(b=>b.timestamp>=L&&b.timestamp<Y);if(se.length===0)return{timestamp:(L+Y)/2,timeLabel:U,items:r.map(b=>({key:b.key,label:b.label,value:0,color:ut(b.typeNum)}))};const re=new Map,ae=new Map;let ne=0,ce=0;for(const b of se){const A=`TYPE_${b.type??b.payload_type??-1}`;if(re.set(A,(re.get(A)??0)+1),ne++,i){const I=ve(b,{spreadingFactor:i.sf,bandwidthHz:i.bw,codingRate:i.cr,preambleLength:i.preamble});ae.set(A,(ae.get(A)??0)+I),ce+=I}}const $=r.map(b=>{let S;return t==="airtime"?S=ce>0?(ae.get(b.key)??0)/ce:0:S=ne>0?(re.get(b.key)??0)/ne:0,{key:b.key,label:b.label,value:S,color:ut(b.typeNum)}});return{timestamp:(L+Y)/2,timeLabel:U,items:$}},[w,E,B,n,r,t,i]),W=t==="share",V=k??(N==null?void 0:N.maxValue)??(W?200:10),te=c.useMemo(()=>{if(!W)return 5;const U=[10,20,25,50,100,200,250,500,1e3],L=V/4.5;for(const Y of U)if(Y>=L)return Y;return V>5e3?Math.ceil(L/1e3)*1e3:Math.ceil(L/100)*100},[V,W]),J=c.useMemo(()=>{const U=[];for(let L=0;L<=V;L+=te){const Y=(1-L/V)*100;U.push({pos:Y,label:W?`${L}B`:`${L}%`})}return U},[V,te,W]);return!N||N.count===0?e.jsxs("div",{className:"h-full flex items-center justify-center text-fg-muted",children:[e.jsx(Se,{className:"w-6 h-6 mr-2 opacity-50"}),e.jsx("span",{children:"No packet data available"})]}):e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 min-h-0 relative",children:[e.jsx("div",{className:"absolute top-0 left-0 flex flex-col justify-between",style:{width:32,bottom:20},children:J.map((U,L)=>e.jsx("span",{className:"type-data-xs text-fg-secondary text-right pr-1.5",style:{position:"absolute",top:`${U.pos}%`,transform:L===0?"translateY(-100%)":L===J.length-1?"none":"translateY(-50%)",right:0},children:U.label},L))}),e.jsxs("div",{className:"absolute overflow-hidden radius-inner ring-1 ring-inset ring-edge-subtle bg-chart-inner",style:{left:32,right:0,top:0,bottom:20},children:[e.jsx(Rt,{scatterData:N,yAxisMode:t==="share"?"share":"airtime",onHover:v,noiseFloorAnomalies:x,showNoiseFloorOverlay:o,overlayOpacity:p,highlightedType:P,timeRangeHours:H,yAxisMaxOverride:k,dotSize:j,dotOpacity:y,startTs:s,endTs:a,externalAxes:!0}),B&&e.jsx("div",{className:"absolute top-1 right-1 px-2 py-0.5 bg-elevated/90 rounded type-data-xs text-sys-indigo pointer-events-none z-10",children:B})]}),u&&h&&e.jsxs("div",{className:"absolute left-0 right-0 bottom-0 flex justify-between pointer-events-none type-data-xs text-fg-muted/60",style:{left:32,height:20,paddingTop:4},children:[e.jsx("span",{children:u}),e.jsx("span",{children:h})]})]}),e.jsx("div",{style:{minHeight:g},children:e.jsx(tt,{sortedTypes:r,highlightedType:P,onTypeHover:q,aggregateShares:l,hoverData:_})})]})}function Fs({mode:t,onChange:n}){return e.jsxs("div",{className:"toggle-group toggle-group-sm",children:[e.jsx("button",{onClick:()=>n("share"),className:`toggle-group-item ${t==="share"?"active":""}`,children:"Total"}),e.jsx("button",{onClick:()=>n("airtime"),className:`toggle-group-item ${t==="airtime"?"active":""}`,children:"Airtime"})]})}function Hs({smoothing:t,onChange:n}){return e.jsxs("div",{className:"toggle-group toggle-group-sm",children:[e.jsx("button",{onClick:()=>n("stats"),className:`toggle-group-item ${t==="stats"?"active":""}`,title:"Statistics view (scatter plot)",children:e.jsx(es,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>n("trend"),className:`toggle-group-item ${t==="trend"?"active":""}`,title:"Trend line chart",children:e.jsx(ts,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>n("ema"),className:`toggle-group-item ${t==="ema"?"active":""}`,title:"Stacked area (moderate smoothing)",children:e.jsx(Se,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>n("ultra"),className:`toggle-group-item ${t==="ultra"?"active":""}`,title:"Stacked area (heavy smoothing)",children:e.jsx(ss,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>n("mosaic"),className:`toggle-group-item ${t==="mosaic"?"active":""}`,title:"Mosaic view (treemap)",children:e.jsx(ns,{className:"w-3.5 h-3.5"})})]})}function Bs({enabled:t,onChange:n,anomalyCount:s=0,showTuning:a=!1,onTuningChange:i}){return e.jsxs("div",{className:"relative inline-flex items-center gap-1",children:[t&&i&&e.jsx("button",{onClick:()=>i(!a),className:`toggle-group toggle-group-sm ${a?"active":""}`,title:a?"Hide tuning panel":"Show tuning panel",children:e.jsx("span",{className:`toggle-group-item ${a?"active":""}`,children:e.jsx(Qt,{className:"w-3.5 h-3.5"})})}),e.jsx("button",{onClick:()=>n(!t),className:`toggle-group toggle-group-sm ${t?"active":""}`,title:t?"Hide noise floor anomalies":"Show noise floor anomalies",children:e.jsx("span",{className:`toggle-group-item ${t?"active":""}`,children:e.jsx(Jt,{className:"w-3.5 h-3.5"})})}),s>0&&e.jsx("span",{className:"absolute -top-2 -right-2 min-w-[18px] h-[18px] px-1 rounded-full bg-sys-red text-white text-xs font-bold flex items-center justify-center pointer-events-none z-10",children:s>99?"99+":s})]})}const jt=[{target:"PacketAnalyzer",fn:"type",minStage:1},{target:"PacketAnalyzer",fn:"airtime",minStage:1,when:cs}];et(jt);const dt=360,$s=500,zs={sf:10,bw:25e4,cr:5,preamble:8},Ge=32;function ht(t,n){const s=new Date(t*1e3),a=l=>l.toString().padStart(2,"0"),i=`${a(s.getHours())}:${a(s.getMinutes())}`;return n<24?i:`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s.getMonth()]} ${s.getDate()} ${i}`}function Ws(t){return gt[t]??`TYPE_${t.toString(16).toUpperCase()}`}function Us(t,n){const s=new Map;for(const i of t){const r=i.type??i.payload_type??-1,l=ve(i,{spreadingFactor:n.sf,bandwidthHz:n.bw,codingRate:n.cr,preambleLength:n.preamble}),x=s.get(r)??{count:0,airtime:0};s.set(r,{count:x.count+1,airtime:x.airtime+l})}const a=[];for(const[i,r]of s)a.push({typeNum:i,key:`TYPE_${i}`,label:Ws(i),totalCount:r.count,totalAirtime:r.airtime});return a.sort((i,r)=>r.totalCount-i.totalCount)}function Gs(t,n,s,a,i,r,l=0){const x=s-n,o=x/a,p=o*1e3,u=x/3600,h=n-l*o,k=s+l*o,g=a+2*l,j=[];for(let y=0;y<g;y++){const w=h+y*o,D=new Date(w*1e3),P=u>=24?D.toLocaleDateString([],{weekday:"short",hour:"2-digit",minute:"2-digit",hour12:!1}):D.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}),z={timestamp:w,time:P,counts:{},shares:{},airtimes:{},total:0,totalAirtime:0,bucketDurationMs:p};for(const H of r)z.counts[H.key]=0,z.airtimes[H.key]=0;j.push(z)}for(const y of t){const w=y.timestamp;if(w<h||w>=k)continue;const D=Math.min(Math.floor((w-h)/o),g-1),P=`TYPE_${y.type??y.payload_type??-1}`;j[D].counts[P]=(j[D].counts[P]??0)+1,j[D].total++;const z=ve(y,{spreadingFactor:i.sf,bandwidthHz:i.bw,codingRate:i.cr,preambleLength:i.preamble});j[D].airtimes[P]=(j[D].airtimes[P]??0)+z,j[D].totalAirtime+=z}for(const y of j)for(const w of r)y.shares[w.key]=y.total>0?y.counts[w.key]/y.total*100:0;return{buckets:j,visibleStart:l,visibleEnd:l+a}}function Vs(t,n){const s=t.length;if(s===0)return[];if(n<.5)return[...t];const a=Math.sqrt(12*n*n/3+1);let i=Math.floor(a);i%2===0&&i--;const r=i+2,l=(12*n*n-3*i*i-12*i-9)/(-4*i-4),x=Math.round(l),o=[x>0?i:r,x>1?i:r,x>2?i:r];let p=new Float32Array(t);const u=new Float32Array(s);for(const h of o){const k=(h-1)/2;qs(p,u,s,k);const g=p;p=u,u.set(g)}return Array.from(p)}function qs(t,n,s,a){const i=a*2+1;let r=0;for(let l=0;l<=a;l++)r+=t[Math.min(l,s-1)];for(let l=0;l<a;l++)r+=t[0];for(let l=0;l<s;l++){n[l]=r/i;const x=l-a,o=l+a+1;r-=t[Math.max(0,Math.min(x,s-1))],r+=t[Math.max(0,Math.min(o,s-1))]}}function Ks(t,n){if(t.length===0)return[];if(n<=1)return[...t];const s=t.length,a=new Float32Array(s),i=Math.floor(n/2);let r=0,l=0;for(let x=0;x<=Math.min(i,s-1);x++)r+=t[x],l++;for(let x=0;x<s;x++){a[x]=r/l;const o=x-i,p=x+i+1;o>=0&&(r-=t[o],l--),p<s&&(r+=t[p],l++)}return Array.from(a)}const Ys={ema:1800,ultra:14400},Xs={ema:"sma",ultra:"gaussian"};function Nt(t,n,s){const a=Ys[t],i=Xs[t]??"sma";if(!a)return{sigma:0,window:1,handleSize:0};let r=Math.round(a/n);r=Math.max(3,Math.min(r,Math.floor(s/3))),r%2===0&&(r+=1);const l=Math.ceil(i==="gaussian"?r*Math.sqrt(4/12)*3:r/2);return i==="gaussian"?{sigma:r*Math.sqrt(.3333333333333333),window:r,handleSize:l}:{sigma:0,window:r,handleSize:l}}function Zs(t,n,s,a="ultra",i,r,l){var q;const{buckets:x,visibleStart:o,visibleEnd:p}=t,u=x.length,h=s.length,k=p-o;if(u===0||h===0)return[];const g=l&&i!==void 0&&r!==void 0?(r-i)/l:(q=x[0])!=null&&q.bucketDurationMs?x[0].bucketDurationMs/1e3:240,j=Array.from({length:h},()=>new Array(u).fill(0));for(let O=0;O<u;O++){const N=x[O];if(n==="share"){if(N.total>0)for(let m=0;m<h;m++)j[m][O]=(N.counts[s[m].key]??0)/N.total}else{let m=0;for(let f=0;f<h;f++)m+=N.airtimes[s[f].key]??0;if(m>0)for(let f=0;f<h;f++)j[f][O]=(N.airtimes[s[f].key]??0)/m}}const{sigma:y,window:w}=Nt(a,g,k);let D;y>0?D=j.map(O=>Vs(O,y)):D=j.map(O=>Ks(O,w));for(let O=0;O<u;O++){let N=0;for(let m=0;m<h;m++)D[m][O]=Math.max(0,D[m][O]),N+=D[m][O];if(N>0){const m=1/N;for(let f=0;f<h;f++)D[f][O]*=m}}const P=k>dt?Math.ceil(k/dt):1,z=Math.ceil(k/P),H=[];for(let O=0;O<z;O++){const N=o+O*P,m=Math.min(o+(O+1)*P,p),f=m-N,v=new Array(h).fill(0);for(let _=N;_<m;_++)for(let W=0;W<h;W++)v[W]+=D[W][_];for(let _=0;_<h;_++)v[_]/=f;let E=0;for(let _=0;_<h;_++)E+=v[_];if(E>0){const _=1/E;for(let W=0;W<h;W++)v[W]*=_}const B={timestamp:x[N].timestamp,time:x[N].time};for(let _=0;_<h;_++)B[s[_].key]=v[_];H.push(B)}return H}const Ve=80;function Qs(t,n,s,a,i){const x=Math.max(1,Math.ceil((s-n)/300));if(a==="airtime"){const o=new Float64Array(x);for(const u of t){const h=u.timestamp;if(h<n||h>=s)continue;const k=Math.min(Math.floor((h-n)/300),x-1);o[k]+=ve(u,{spreadingFactor:i.sf,bandwidthHz:i.bw,codingRate:i.cr,preambleLength:i.preamble})}let p=0;for(let u=0;u<x;u++){const h=o[u]/3e5*100;h>p&&(p=h)}return Math.max(1,Math.ceil(p*1.1))}else{let o=0;for(const p of t){const u=p.timestamp;if(u<n||u>=s)continue;const h=Qe(p);h>o&&(o=h)}return o<=200?200:Math.ceil(o*1.1/50)*50}}function Js({packets:t,allPackets:n,startTs:s,endTs:a,parentStartTs:i,parentEndTs:r,bucketCount:l,radioConfig:x=zs,mode:o="share",smoothing:p="stats",noiseFloorAnomalies:u=null,showNoiseFloorOverlay:h=!1,overlayOpacity:k=.5,dotSize:g,dotOpacity:j}){Je(jt);const y=_t(),[w,D]=c.useState(null),[P,z]=c.useState(null),[H,q]=c.useState([]),O=c.useRef(null),N=c.useRef(0);c.useEffect(()=>{const b=Math.abs(t.length-N.current);if(b===0&&H.length>0)return;O.current&&clearTimeout(O.current);const S=b>100?50:$s;return O.current=setTimeout(()=>{N.current=t.length,q(t)},S),()=>{O.current&&clearTimeout(O.current)}},[t,H.length]);const m=c.useMemo(()=>Us(H,x),[H,x]),f=c.useMemo(()=>{if(p!=="ema"&&p!=="ultra")return 0;const S=(a-s)/l,{handleSize:A}=Nt(p,S,l);return A},[p,s,a,l]),v=c.useMemo(()=>Gs(H,s,a,l,x,m,f),[H,s,a,l,x,m,f]),E=c.useMemo(()=>m.reduce((b,S)=>b+S.totalCount,0),[m]),B=c.useMemo(()=>m.reduce((b,S)=>b+S.totalAirtime,0),[m]),{sortedTypes:_,aggregateShares:W}=c.useMemo(()=>{const b=new Map,S=o==="share"?E:B;if(S>0)for(const I of m){const Q=o==="share"?I.totalCount:I.totalAirtime;b.set(I.key,Q/S)}return{sortedTypes:[...m].sort((I,Q)=>(b.get(Q.key)??0)-(b.get(I.key)??0)),aggregateShares:b}},[m,E,B,o]),V=c.useMemo(()=>Zs(v,o,_,p,s,a,l),[v,o,_,p,s,a,l]),te=c.useCallback(b=>D(b),[]),J=c.useCallback(b=>z(b),[]),U=c.useCallback(b=>D(b),[]),L=c.useMemo(()=>{if(P===null||!V[P])return null;const b=V[P];return{timestamp:b.timestamp,timeLabel:b.time,items:_.map(S=>({key:S.key,label:S.label,value:b[S.key]??0,color:Ce(S.typeNum)}))}},[P,V,_]),Y=c.useMemo(()=>{const b=V.map(A=>A.timestamp),S=_.map(A=>({key:A.key,label:A.label,color:Ce(A.typeNum),values:V.map(I=>I[A.key]??0)}));return{timestamps:b,series:S}},[V,_]),se=null,re=n&&i!==void 0&&r!==void 0&&(s!==i||a!==r),ae=c.useMemo(()=>{if(!(!re||!n||i===void 0||r===void 0))return Qs(n,i,r,o,x)},[re,n,i,r,o,x]);if(H.length===0)return t.length===0?e.jsxs("div",{className:"h-full flex items-center justify-center text-fg-muted",children:[e.jsx(Se,{className:"w-6 h-6 mr-2 opacity-50"}),e.jsx("span",{children:"No packet data available"})]}):null;if(p==="mosaic")return e.jsx(Ls,{sortedTypes:_,aggregateShares:W,mode:o});const ne=(a-s)/3600,ce=ht(s,ne),$=ht(a,ne);return p==="stats"?e.jsx(Os,{mode:o,packets:H,startTs:s,endTs:a,radioConfig:x,sortedTypes:_,aggregateShares:W,noiseFloorAnomalies:u,showNoiseFloorOverlay:h,overlayOpacity:k,startLabel:ce,endLabel:$,lockedYMax:ae,legendMinH:Ve,dotSize:g,dotOpacity:j}):p==="trend"?e.jsx(Es,{packets:H,mode:o,startTs:s,endTs:a,radioConfig:x,bucketCount:l,lockedYMax:ae,legendMinH:Ve}):e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 min-h-0 relative",children:[e.jsx("div",{className:"absolute top-0 left-0 flex flex-col justify-between",style:{width:Ge,bottom:20},children:[0,20,40,60,80,100].map((b,S,A)=>e.jsxs("span",{className:"type-data-xs text-fg-secondary text-right pr-1.5",style:{position:"absolute",top:`${(1-b/100)*100}%`,transform:S===0?"translateY(-100%)":S===A.length-1?"none":"translateY(-50%)",right:0},children:[b,"%"]},b))}),e.jsx("div",{className:"absolute overflow-hidden radius-inner ring-1 ring-inset ring-edge-subtle bg-chart-inner",style:{left:Ge,right:0,top:0,bottom:20},children:e.jsx(Dt,{timestamps:Y.timestamps,series:Y.series,highlightedKey:w,cursorColor:y.cursor,onHover:J,onSeriesHover:U,overlayLine:se,startTs:s,endTs:a,externalAxes:!0})}),e.jsxs("div",{className:"absolute left-0 right-0 bottom-0 flex justify-between pointer-events-none type-data-xs text-fg-muted/60",style:{left:Ge,height:20,paddingTop:4},children:[e.jsx("span",{children:ce}),e.jsx("span",{children:$})]})]}),e.jsx("div",{style:{minHeight:Ve},children:e.jsx(tt,{sortedTypes:_,highlightedType:w,onTypeHover:te,aggregateShares:W,hoverData:L})})]})}const en=c.memo(Js),qe={ZOOM_DURATION:400,BLINK_DURATION:600},oe={PADDING:6,DOT_RADIUS:5,DOT_RADIUS_HOVERED:7,LOCAL_DOT_RADIUS:5,CARDINAL_FONT_SIZE:10,INTERCARDINAL_FONT_SIZE:9,LABEL_INSET:8,DATA_HEADROOM:1.08},tn={"1x":1,"2x":2,"4x":4,"8x":8,"16x":16,"36x":36},sn=[1,5,10,25,50,100,150],nn=22.5,vt=nn*Math.PI/180,xt=Math.sin(vt),pt=Math.cos(vt);function an(t,n,s,a){const i=Math.PI/180,r=(a-n)*i,l=t*i,x=s*i,o=Math.sin(r)*Math.cos(x),p=Math.cos(l)*Math.sin(x)-Math.sin(l)*Math.cos(x)*Math.cos(r);return(Math.atan2(o,p)*180/Math.PI+360)%360}function rn(t,n,s,a){const r=Math.PI/180,l=(s-t)*r,x=(a-n)*r,o=Math.sin(l/2)**2+Math.cos(t*r)*Math.cos(s*r)*Math.sin(x/2)**2;return 6371*2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}const on=[{min:10,label:"Excellent"},{min:7,label:"Very Good"},{min:4,label:"Good"},{min:1,label:"Fair+"},{min:-2,label:"Fair"},{min:-5,label:"Fair-"},{min:-8,label:"Poor"},{min:-11,label:"Bad"},{min:-1/0,label:"Critical"}];function ln(t){var n;return((n=on.find(s=>t>=s.min))==null?void 0:n.label)??"Critical"}function ft(t,n,s){const a=Ot(t,s);return n[a]||"#808080"}function cn({neighbors:t,quickNeighbors:n,localLat:s,localLon:a,onStatsChange:i,title:r,badge:l,stats:x}){const[o,p]=c.useState(null),[u,h]=c.useState(new Set),[k,g]=c.useState({width:0,height:0}),[j,y]=c.useState("1x"),[w,D]=c.useState(1),P=c.useRef(null),z=c.useRef({}),H=c.useRef(null),q=c.useRef(w);q.current=w;const O=Lt(),N=Tt(),m=Et(),f=It(),v=bt(),E=Pt(),B=f?m.primary:m.secondary,_=f?.15:.4,W=f?.08:.25,V=f?v.blue:m.primary;c.useEffect(()=>{const d=H.current;if(!d)return;const T=new ResizeObserver(R=>{for(const F of R){const{width:X,height:K}=F.contentRect;X>0&&K>0&&g({width:X,height:K})}});T.observe(d);const C=d.getBoundingClientRect();return C.width>0&&C.height>0&&g({width:C.width,height:C.height}),()=>T.disconnect()},[]);const te=c.useMemo(()=>{const d=new Set;if(n)for(const T of n)d.add(T.hash);return d},[n]),J=c.useMemo(()=>{const d=new Map;if(n)for(const T of n)d.set(T.hash,{snr:T.avgSnr,rssi:T.avgRssi});return d},[n]),{processedNeighbors:U,maxDistance:L,totalNeighbors:Y,zeroHopCount:se}=c.useMemo(()=>{const d=[];for(const[R,F]of Object.entries(t)){if(!F.latitude||!F.longitude||F.latitude===0||F.longitude===0||!te.has(R))continue;const K=an(s,a,F.latitude,F.longitude),ee=rn(s,a,F.latitude,F.longitude),Z=J.get(R);d.push({hash:R.slice(0,8),name:F.node_name||F.name||"Unknown",snr:(Z==null?void 0:Z.snr)??F.snr??null,rssi:(Z==null?void 0:Z.rssi)??F.rssi??null,bearing:K,distance:ee,normalizedDistance:0,lastSeen:F.last_seen,isZeroHop:!0})}const C=(d.length>0?Math.max(...d.map(R=>R.distance)):0)*oe.DATA_HEADROOM;return d.sort((R,F)=>(R.snr??-1/0)-(F.snr??-1/0)),{processedNeighbors:d,maxDistance:C,totalNeighbors:d.length,zeroHopCount:d.length}},[t,s,a,te,J]);c.useEffect(()=>{i==null||i({zeroHopCount:se,totalCount:Y,maxDistanceKm:L})},[se,Y,L]),c.useEffect(()=>{const d=tn[j],T=q.current;P.current&&cancelAnimationFrame(P.current);const C=performance.now(),R=F=>{const X=F-C,K=Math.min(X/qe.ZOOM_DURATION,1),ee=ms(K),Z=T+(d-T)*ee;D(Z),K<1?P.current=requestAnimationFrame(R):P.current=null};return P.current=requestAnimationFrame(R),()=>{P.current&&cancelAnimationFrame(P.current)}},[j]);const re=L/w,ae=c.useMemo(()=>sn.filter(d=>d<=re*1.1),[re]);c.useEffect(()=>{const d=[];for(const C of U){const R=z.current[C.hash];R!==void 0&&R!==C.lastSeen&&d.push(C.hash),z.current[C.hash]=C.lastSeen}if(d.length===0)return;queueMicrotask(()=>{h(C=>new Set([...C,...d]))});const T=setTimeout(()=>{h(C=>{const R=new Set(C);return d.forEach(F=>R.delete(F)),R})},qe.BLINK_DURATION);return()=>clearTimeout(T)},[U]);const ne=s!==0&&a!==0,ce=c.useMemo(()=>{const{width:d,height:T}=k,C=d/2,R=T/2,F=Math.min(d,T),X=Math.max(10,F/2-oe.PADDING),K=Math.max(10,X-oe.LABEL_INSET);return{width:d,height:T,centerX:C,centerY:R,radius:K,labelRadius:X}},[k]),{width:$,height:b,centerX:S,centerY:A,radius:I,labelRadius:Q}=ce,de=c.useId(),pe=c.useCallback((d,T)=>{const C=d*Math.PI/180;return{x:S+I*T*Math.sin(C),y:A-I*T*Math.cos(C)}},[S,A,I]),fe=c.useCallback(d=>{const C={N:0,NE:45,E:90,SE:135,S:180,SW:225,W:270,NW:315}[d]*Math.PI/180;return{x:S+Q*Math.sin(C),y:A-Q*Math.cos(C)}},[S,A,Q]),Ae=c.useCallback(d=>{p(d)},[]),Re=c.useCallback(d=>{y(d)},[]),_e=c.useCallback(d=>L<=0?0:d/L*w,[L,w]),De=d=>`${d}km`,we=28,Le=c.useMemo(()=>{const d=[{x:S,y:A-Q},{x:S+Q*Math.SQRT1_2,y:A-Q*Math.SQRT1_2}],T=ae.map(R=>{const F=R/L*w,X=S+I*F*xt,K=A-I*F*pt;return{km:R,scale:F,lx:X,ly:K}}).filter(R=>R.scale<=1.05&&R.scale>=.02).sort((R,F)=>F.km-R.km),C=[];for(const R of T){const F=C.some(K=>{const ee=K.lx-R.lx,Z=K.ly-R.ly;return Math.sqrt(ee*ee+Z*Z)<we}),X=d.some(K=>{const ee=K.x-R.lx,Z=K.y-R.ly;return Math.sqrt(ee*ee+Z*Z)<we});!F&&!X&&C.push(R)}return C},[ae,L,w,S,A,I,Q]),Te=k.width>0&&k.height>0;return ne?Y===0?e.jsxs("div",{ref:H,className:"flex flex-col items-center justify-center h-full text-fg-secondary",children:[e.jsx($e,{className:"w-8 h-8 mb-2 opacity-50"}),e.jsx("p",{children:"No nodes with location data"})]}):e.jsxs("div",{className:"flex h-full w-full overflow-visible",children:[e.jsxs("div",{ref:H,className:"relative flex-1 min-w-0 h-full overflow-visible -ml-4 sm:-ml-5",children:[Te&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute depth-raised",style:{left:S-I-oe.LABEL_INSET-4,top:A-I-oe.LABEL_INSET-4,width:(I+oe.LABEL_INSET)*2+8,height:(I+oe.LABEL_INSET)*2+8,borderRadius:"50%",padding:4,boxSizing:"border-box",backgroundColor:f?"var(--zinc-925)":"var(--zinc-75)"}}),e.jsxs("svg",{width:$,height:b,className:"absolute inset-0 z-0",style:{overflow:"visible"},children:[e.jsxs("defs",{children:[e.jsx("style",{children:`
                @keyframes neighbor-blink-scale {
                  0%, 100% {
                    transform: scale(1);
                    opacity: 0;
                  }
                  50% {
                    transform: scale(1.3);
                    opacity: 0.8;
                  }
                }
                .neighbor-blink-ring {
                  transform-origin: center;
                  animation: neighbor-blink-scale ${qe.BLINK_DURATION}ms ease-out forwards;
                }
              `}),e.jsx("clipPath",{id:de,children:e.jsx("circle",{cx:S,cy:A,r:I})})]}),(()=>{const d=I+oe.LABEL_INSET+12,T=f?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.15)",C=f?"rgba(59, 130, 246, 0.4)":"rgba(59, 130, 246, 0.5)",R=6,F=16,X=4,K=[0,90,180,270],ee=[45,135,225,315];return e.jsxs("g",{className:"radar-frame","aria-hidden":"true",children:[e.jsx("circle",{cx:S,cy:A,r:d,fill:"none",stroke:T,strokeWidth:1,strokeDasharray:"2 6"}),ee.map(Z=>{const ie=Z*Math.PI/180,me=Math.cos(ie),ue=Math.sin(ie),he=d+X,M=d+X+F,G=S+he*ue,be=A-he*me,Ee=S+M*ue,Fe=A-M*me;return e.jsxs("g",{children:[e.jsx("line",{x1:G,y1:be,x2:Ee,y2:Fe,stroke:C,strokeWidth:1}),e.jsx("line",{x1:Ee-4*me,y1:Fe-4*ue,x2:Ee+4*me,y2:Fe+4*ue,stroke:C,strokeWidth:1})]},`corner-${Z}`)}),K.map(Z=>{const ie=Z*Math.PI/180,me=S+(d-R)*Math.sin(ie),ue=A-(d-R)*Math.cos(ie),he=S+(d+2)*Math.sin(ie),M=A-(d+2)*Math.cos(ie);return e.jsx("line",{x1:me,y1:ue,x2:he,y2:M,stroke:T,strokeWidth:1},`tick-cardinal-${Z}`)}),ee.map(Z=>{const ie=Z*Math.PI/180,me=S+(d-4)*Math.sin(ie),ue=A-(d-4)*Math.cos(ie),he=S+(d+1)*Math.sin(ie),M=A-(d+1)*Math.cos(ie);return e.jsx("line",{x1:me,y1:ue,x2:he,y2:M,stroke:T,strokeWidth:1},`tick-intercardinal-${Z}`)})]})})(),(()=>{const T=[(I+oe.LABEL_INSET+4)/I,...ae.map(C=>_e(C)).filter(C=>C>.02&&C<=1.05).sort((C,R)=>R-C),0];return T.slice(0,-1).map((C,R)=>{const F=T[R+1],X=I*C,K=I*F,ee=X-K;return ee<=0||R%2!==0?null:e.jsx("circle",{cx:S,cy:A,r:(X+K)/2,fill:"none",stroke:"var(--subtle-fill)",strokeWidth:ee,opacity:.8},`band-${R}`)})})(),ae.map(d=>{const T=_e(d);if(T>1.05||T<.02)return null;const C=Le.some(X=>X.km===d),R=S+I*T*xt,F=A-I*T*pt;return e.jsxs("g",{children:[e.jsx("circle",{cx:S,cy:A,r:I*T,fill:"none",stroke:B,strokeOpacity:_,strokeWidth:1}),C&&e.jsx("text",{x:R+4,y:F-2,textAnchor:"start",dominantBaseline:"auto",fill:m.secondary,fontSize:10,fontFamily:He,children:De(d)})]},`ring-${d}`)}),["N","E","S","W"].map(d=>{const C={N:0,E:90,S:180,W:270}[d]*Math.PI/180;return e.jsx("line",{x1:S,y1:A,x2:S+I*Math.sin(C),y2:A-I*Math.cos(C),stroke:B,strokeOpacity:_,strokeWidth:1,strokeDasharray:"4 4"},d)}),["NE","SE","SW","NW"].map(d=>{const C={NE:45,SE:135,SW:225,NW:315}[d]*Math.PI/180;return e.jsx("line",{x1:S,y1:A,x2:S+I*Math.sin(C),y2:A-I*Math.cos(C),stroke:B,strokeOpacity:W,strokeWidth:1,strokeDasharray:"4 4"},`diag-${d}`)}),["N","E","S","W"].map(d=>{const T=fe(d),C=d==="E"?"end":d==="W"?"start":"middle",R=d==="N"?"hanging":d==="S"?"auto":"middle";return e.jsx("text",{x:T.x,y:T.y,textAnchor:C,dominantBaseline:R,fill:V,fontSize:oe.CARDINAL_FONT_SIZE,fontWeight:700,fontFamily:He,"aria-hidden":"true",children:d},d)}),["NE","SE","SW","NW"].map(d=>{const T=fe(d),C=d==="NE"||d==="SE"?"end":"start",R=d==="NE"||d==="NW"?"hanging":"auto";return e.jsx("text",{x:T.x,y:T.y,textAnchor:C,dominantBaseline:R,fill:V,fontSize:oe.INTERCARDINAL_FONT_SIZE,fontWeight:600,fontFamily:He,"aria-hidden":"true",children:d},d)}),e.jsx("circle",{cx:S,cy:A,r:oe.LOCAL_DOT_RADIUS,fill:N.chart6,stroke:f?"rgba(255,255,255,0.3)":"rgba(0,0,0,0.2)",strokeWidth:1,role:"img","aria-label":"Local node"}),e.jsx("g",{clipPath:`url(#${de})`,children:U.map(d=>{const T=L>0?d.distance/L*w:0;if(T>1)return null;const{x:C,y:R}=pe(d.bearing,T),F=d.snr!==null?ft(d.snr,O,E):"#808080",X=(o==null?void 0:o.hash)===d.hash,K=u.has(d.hash),ee=oe.DOT_RADIUS_HOVERED*1.5;return e.jsxs("g",{role:"img","aria-label":`${d.name}: ${d.distance.toFixed(1)}km ${d.bearing.toFixed(0)}°`,children:[K&&e.jsx("circle",{cx:C,cy:R,r:ee,fill:"none",stroke:f?"rgba(255,255,255,0.9)":"rgba(0,0,0,0.7)",strokeWidth:2,className:"neighbor-blink-ring"}),X&&e.jsx("circle",{cx:C,cy:R,r:ee,fill:F,opacity:.3}),e.jsx("circle",{cx:C,cy:R,r:X?oe.DOT_RADIUS_HOVERED:oe.DOT_RADIUS,fill:F,stroke:f?"rgba(0,0,0,0.5)":"rgba(0,0,0,0.25)",strokeWidth:1,style:{cursor:"pointer",transition:"r 0.15s"},onMouseEnter:()=>Ae(d),onMouseLeave:()=>Ae(null)})]},d.hash)})})]})]}),o&&e.jsxs("div",{className:"absolute bg-tooltip-bg border border-edge-subtle rounded-lg px-3 py-2 text-sm pointer-events-none z-10 shadow-xl",style:{left:"50%",bottom:8,transform:"translateX(-50%)"},children:[e.jsx("div",{className:"font-medium text-fg-primary",children:o.name}),e.jsx("div",{className:"type-data-xs text-fg-secondary",children:o.hash}),o.snr!==null?e.jsx("div",{className:"flex gap-3 mt-1 text-xs",children:e.jsxs("span",{children:[e.jsx("span",{className:"text-fg-secondary",children:"SNR:"})," ",e.jsxs("span",{className:"tabular-nums",style:{color:ft(o.snr,O,E)},children:[o.snr.toFixed(1)," dB"]}),e.jsxs("span",{className:"text-fg-secondary ml-1",children:["(",ln(o.snr),")"]})]})}):e.jsx("div",{className:"text-xs text-fg-secondary mt-1",children:"No SNR data"}),e.jsxs("div",{className:"flex gap-3 text-xs",children:[e.jsxs("span",{children:[e.jsx("span",{className:"text-fg-secondary",children:"Distance:"})," ",e.jsxs("span",{className:"tabular-nums text-fg-primary",children:[o.distance.toFixed(2)," km"]})]}),e.jsxs("span",{children:[e.jsx("span",{className:"text-fg-secondary",children:"Bearing:"})," ",e.jsxs("span",{className:"tabular-nums text-fg-primary",children:[o.bearing.toFixed(0),"°"]})]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 px-1.5 py-2 flex-shrink-0 depth-raised radius-inset self-stretch",style:{width:"calc(100% / 6)"},children:[r&&e.jsxs("div",{className:"flex flex-col items-center gap-1 pb-2 border-b border-edge-subtle mb-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"icon-md flex items-center justify-center text-icon-card-title",children:e.jsx($e,{className:"w-3.5 h-3.5"})}),l&&e.jsx(Oe,{color:"zinc",children:l})]}),e.jsx("span",{className:"type-micro text-center text-[10px] leading-tight",children:r})]}),e.jsx("div",{className:"flex flex-col gap-1 flex-1",role:"group","aria-label":"Zoom level",children:["1x","2x","4x","8x","16x","36x"].map(d=>e.jsx("button",{onClick:()=>Re(d),"aria-pressed":j===d,className:`flex flex-1 items-center justify-center min-w-[44px] sm:min-w-[32px] text-xs font-medium radius-inner depth-stroke-raised transition-colors ${j===d?"bg-sys-blue/20 text-sys-blue":"bg-subtle-fill/80 text-fg-secondary hover:bg-subtle-fill-strong hover:text-fg-primary"}`,children:d},d))})]})]}):e.jsxs("div",{ref:H,className:"flex flex-col items-center justify-center h-full text-fg-secondary",children:[e.jsx($e,{className:"w-8 h-8 mb-2 opacity-50"}),e.jsx("p",{children:"Local node coordinates not configured"}),e.jsx("p",{className:"text-xs mt-1",children:"Set latitude/longitude in config to enable"})]})}const mn=c.memo(cn),Ke={repeater:"var(--sys-blue)",companion:"var(--sys-cyan)",room_server:"var(--sys-indigo)"};function un(t){if(t.contact_type){const n=t.contact_type.toLowerCase();if(n==="repeater"||n==="rep")return"repeater";if(n==="room server"||n==="room_server"||n==="room"||n==="server")return"room_server";if(n==="companion"||n==="client"||n==="cli")return"companion"}return t.is_repeater?"repeater":"companion"}function dn({neighbors:t}){const n=c.useMemo(()=>{const s={repeater:0,companion:0,room_server:0};for(const r of Object.values(t)){const l=un(r);s[l]=(s[l]||0)+1}const a=Object.values(s).reduce((r,l)=>r+l,0);return{items:[{label:"Repeaters",count:s.repeater,percent:0,color:Ke.repeater},{label:"Companions",count:s.companion,percent:0,color:Ke.companion},{label:"Room Servers",count:s.room_server,percent:0,color:Ke.room_server}].map(r=>({...r,percent:a>0?r.count/a*100:0})).filter(r=>r.count>0).sort((r,l)=>l.count-r.count),total:a}},[t]);return n.total===0?e.jsx("div",{className:"h-full flex items-center justify-center text-fg-muted type-body-sm",children:"No neighbors discovered yet"}):e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"flex-1 flex flex-col justify-evenly",children:n.items.map(s=>e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"type-data-sm text-fg-secondary",children:s.label}),e.jsxs("span",{className:"type-data-sm text-fg-secondary tabular-nums",children:[s.count," ",e.jsxs("span",{className:"text-fg-secondary/60",children:["(",s.percent.toFixed(0),"%)"]})]})]}),e.jsx("div",{className:"h-2.5 bg-subtle-fill/80 overflow-hidden rounded-full depth-stroke-inset",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-500 ease-out",style:{width:`${s.percent}%`,backgroundColor:s.color,minWidth:s.count>0?"4px":"0"}})})]},s.label))}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-edge-subtle",children:[e.jsx("span",{className:"type-data-xs text-fg-secondary",children:"Total Nodes"}),e.jsx("span",{className:"type-data-sm text-fg-primary font-medium tabular-nums",children:n.total})]})]})}const hn=c.memo(dn);function Ye({children:t,minHeight:n="100%",rootMargin:s="200px 0px",keepMounted:a=!0,className:i=""}){const r=c.useRef(null),[l,x]=c.useState(!1),[o,p]=c.useState(!1);c.useEffect(()=>{const h=r.current;if(!h)return;const k=new IntersectionObserver(([g])=>{const j=g.isIntersecting;p(j),j&&x(!0)},{rootMargin:s,threshold:0});return k.observe(h),()=>{k.disconnect()}},[s]);const u=o||a&&l;return e.jsx("div",{ref:r,className:`h-full w-full ${i}`,style:{minHeight:n},children:u?t:e.jsx("div",{className:"h-full w-full flex items-center justify-center text-fg-muted/50",children:e.jsx("div",{className:"animate-pulse text-xs",children:"Loading chart..."})})})}const St=[{target:"DisambiguationCard",fn:"disambiguation.collisions",minStage:2}];et(St);const xn=.9,pn=.7,fn=.5,gn=10,bn=25,Ie={excellent:"text-signal-excellent",good:"text-signal-good",fair:"text-signal-fair",poor:"text-sys-blue"},yn={excellent:"bg-signal-excellent/10",good:"bg-signal-good/10",fair:"bg-signal-fair/10",poor:"bg-sys-blue/10"};function jn(t){return t>=xn?"excellent":t>=pn?"good":t>=fn?"fair":"poor"}function Nn(t){return t<=gn?"excellent":t<=bn?"good":"poor"}function vn(){Je(St);const t=Ft(),n=Ht(),[s,a]=c.useState(null),i=c.useCallback((u,h)=>{a({prefix:u,candidateHashes:h})},[]),r=c.useCallback(()=>{a(null)},[]);if(!n)return e.jsxs(le,{neomorphic:!0,children:[e.jsx(Ne,{icon:e.jsx(at,{}),title:"Prefix Conflicts"}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-fg-secondary",children:[e.jsx(as,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"type-data-xs",children:"No topology data available"}),e.jsx("p",{className:"type-data-xs opacity-70",children:"Run deep analysis to see stats"})]})})]});const l=jn(t.avgConfidence),x=Nn(t.collisionRate),o=l==="poor"||x==="poor"?"poor":l==="fair"||x==="fair"?"fair":l==="good"||x==="good"?"good":"excellent",p=o==="excellent"||o==="good"?rt:Xe;return e.jsxs(le,{neomorphic:!0,className:"flex flex-col overflow-hidden",children:[e.jsx(Ne,{icon:e.jsx(at,{}),title:"Prefix Conflicts",badgeColor:"zinc",actions:o==="poor"?e.jsxs(Oe,{color:"red",children:[e.jsx(Xe,{className:"w-3 h-3"}),"Needs Attention"]}):e.jsxs("div",{className:`flex items-center gap-1.5 px-2.5 py-1 rounded-full ${yn[o]}`,children:[e.jsx(p,{className:`w-3.5 h-3.5 ${Ie[o]}`}),e.jsx("span",{className:`type-data-xs font-medium ${Ie[o]}`,children:o==="excellent"?"Excellent":o==="good"?"Good":"Fair"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsxs("div",{className:"flex gap-2 sm:gap-3 py-3 sm:py-4",children:[e.jsxs("div",{className:"flex-1 flex flex-col radius-inner depth-stroke-raised bg-subtle-fill/80 px-3 py-2.5 sm:py-3 cursor-help",title:"Total unique 2-character prefixes observed in packet paths.",children:[e.jsx("span",{className:"type-data-xl text-fg-primary",children:e.jsx(Pe,{value:t.totalPrefixes,priority:"low"})}),e.jsx("span",{className:"type-micro text-fg-muted mt-0.5 sm:mt-1",children:"Prefixes"})]}),e.jsxs("div",{className:"flex-1 flex flex-col radius-inner depth-stroke-raised bg-subtle-fill/80 px-3 py-2.5 sm:py-3 cursor-help",title:"Prefixes that map to exactly one known node. No disambiguation needed.",children:[e.jsx("span",{className:"type-data-xl text-fg-primary",children:e.jsx(Pe,{value:t.unambiguousPrefixes,priority:"low"})}),e.jsx("span",{className:"type-micro text-fg-muted mt-0.5 sm:mt-1",children:"Unique"})]}),e.jsxs("div",{className:"flex-1 flex flex-col radius-inner depth-stroke-raised bg-subtle-fill/80 px-3 py-2.5 sm:py-3 cursor-help",title:"Prefixes matching multiple known nodes. Click a prefix below to explore candidates.",children:[e.jsx("span",{className:`type-data-xl ${t.collisionPrefixes>0?"text-sys-blue":"text-fg-primary"}`,children:e.jsx(Pe,{value:t.collisionPrefixes,priority:"low"})}),e.jsx("span",{className:`type-micro mt-0.5 sm:mt-1 ${t.collisionPrefixes>0?"text-sys-blue":"text-fg-muted"}`,children:"Conflicts"})]})]}),t.highCollisionPrefixes.length>0&&e.jsxs("div",{className:"pt-2",children:[e.jsx("div",{className:"type-data-xs text-fg-secondary mb-1.5",children:"Problem Prefixes"}),e.jsx("div",{className:"flex flex-wrap gap-1.5 content-start",children:t.highCollisionPrefixes.map(({prefix:u,candidateCount:h,candidateHashes:k})=>e.jsxs("button",{type:"button",onClick:()=>i(u,k),className:"inline-flex items-center gap-0.5 group",title:`${h} candidates - click to explore`,children:[e.jsx(ps,{children:u}),e.jsxs("span",{className:"text-fg-muted type-data-xs group-hover:text-fg-secondary transition-colors",children:["×",h]})]},u))})]}),t.lowConfidencePrefixes.length===0&&t.collisionPrefixes===0&&e.jsx("div",{className:"flex-1 flex items-center",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(rt,{className:"w-3.5 h-3.5 text-signal-excellent"}),e.jsx("span",{className:"type-data-xs text-signal-excellent",children:"All prefixes uniquely identified"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 mt-auto pt-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2 cursor-help",title:"Average confidence score across all disambiguated prefixes. Higher = more certain node identification.",children:[e.jsx("span",{className:"type-data-xs text-fg-secondary",children:"Confidence"}),e.jsxs("span",{className:`data-box ${Ie[l]}`,children:[(t.avgConfidence*100).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-2 cursor-help",title:"Percentage of 2-character prefixes that match multiple known nodes. Lower is better.",children:[e.jsx("span",{className:"type-data-xs text-fg-secondary",children:"Collisions"}),e.jsxs("span",{className:`data-box ${Ie[x]}`,children:[t.collisionRate.toFixed(1),"%"]})]})]})]}),e.jsx(fs,{isOpen:!!s,prefix:(s==null?void 0:s.prefix)||"",candidateHashes:(s==null?void 0:s.candidateHashes)||[],onClose:r})]})}const wt=[{target:"PacketHealth",fn:"type",minStage:1},{target:"PacketHealth",fn:"duplicates",minStage:1}];et(wt);const Sn=new Set(["Duplicate","Empty payload","Path too long","Unknown"]),Me=24;function wn(t,n){const s=Date.now()/1e3,a=n*60,i=s-a,r=a/Me,l=new Array(Me).fill(0),x=new Array(Me).fill(0);let o=0,p=0,u=0,h=0;for(const g of t){if(g.packet_origin==="tx_local")continue;const j=g.timestamp;if(j<i||j>s)continue;o++;const y=Math.min(Me-1,Math.floor((j-i)/r));x[y]++,g.transmitted||g.packet_origin==="tx_forward"?(p++,l[y]++):(g.is_duplicate||g.drop_reason==="Duplicate")&&u++,g.drop_reason&&Sn.has(g.drop_reason)&&h++}const k=[];for(let g=0;g<Me;g++){const j=x[g],y=l[g];k.push({count:j>0?Math.round(y/j*100):0,timestamp:(i+g*r)*1e3})}return{totalRx:o,forwarded:p,duplicates:u,waste:h,efficiency:o>0?p/o*100:0,duplicateRate:o>0?u/o*100:0,wasteRate:o>0?h/o*100:0,sparkline:k}}function kn(t){return t>=90?"excellent":t>=75?"good":t>=60?"fair":"poor"}const Mn={excellent:"bg-status-success",good:"bg-sys-blue",fair:"bg-status-warning",poor:"bg-status-danger"};function Cn({packets:t,rangeMinutes:n,rangeHours:s,timeRangeLabel:a,isLoaded:i=!0}){Je(wt);const r=c.useMemo(()=>wn(t,n),[t,n]),[l,x]=c.useState(null),o=c.useCallback(async()=>{try{const h=await Bt(s);h.success&&h.data&&x(h.data.count)}catch{}},[s]);c.useEffect(()=>{o()},[o]);const p=kn(r.efficiency),u=r.totalRx>0;return e.jsx(le,{neomorphic:!0,isLoaded:i,skeletonType:"chart",children:i&&e.jsxs(e.Fragment,{children:[e.jsx(Ne,{icon:e.jsx(rs,{}),title:"Packet Health",badge:a,badgeColor:"zinc"}),e.jsx($t,{children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("div",{className:"type-data-xl text-fg-primary",children:[u?e.jsx(Pe,{value:Math.round(r.efficiency*10)/10,className:"font-mono tabular-nums",priority:"medium",format:{minimumFractionDigits:1,maximumFractionDigits:1}}):e.jsx("span",{className:"opacity-30",children:"—"}),e.jsx("span",{className:"type-data-sm text-fg-muted ml-0.5",children:"%"})]}),u&&e.jsx("div",{className:`w-2 h-2 rounded-full ${Mn[p]}`})]}),e.jsx("div",{className:"type-micro mb-2 cursor-help",title:"Forwarded packets / total received. CRC failures, garbled packets, and RF collisions that destroy packets before reaching software are not included in this ratio — see CRC Errors for hardware-level failures.",children:"FORWARDING RATE"}),e.jsx("div",{className:"flex-1 min-h-[28px] max-h-[48px] mb-2",children:e.jsx(gs,{data:r.sparkline,width:9999,height:36,color:"var(--sys-blue)",className:"w-full"})}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 mt-auto",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"data-box-label",children:"Dupes"}),e.jsx("div",{className:"data-box data-box-fill data-box-left",children:u?`${r.duplicateRate.toFixed(1)}%`:"—"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"data-box-label",children:"Waste"}),e.jsx("div",{className:"data-box data-box-fill data-box-left",children:u?`${r.wasteRate.toFixed(1)}%`:"—"})]}),l!==null&&l>0&&e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"data-box-label flex items-center gap-1",children:[e.jsx(Xe,{className:"w-3 h-3 text-status-warning"}),"CRC"]}),e.jsx("div",{className:"data-box data-box-fill data-box-left text-status-warning",children:l})]})]})]})})]})})}function Qn(){var De,we,Le,Te,d,T,C,R,F,X,K,ee,Z,ie,me,ue,he;const t=zt(),n=Wt(),s=Ut(),a=Gt(),i=Vt(),r=qt(),l=t!==null&&i,x=c.useRef(!1);l&&!x.current&&(x.current=!0);const o=x.current,p=Kt(),u=Yt(),h=Xt(),[k,g]=c.useState(null),[,j]=c.useState(null),[y]=c.useState(null),[w,D]=c.useState(()=>{const M=localStorage.getItem("statistics-view-mode");return M==="share"||M==="airtime"?M:"airtime"});c.useEffect(()=>{localStorage.setItem("statistics-view-mode",w)},[w]);const[P,z]=c.useState(()=>{const M=localStorage.getItem("statistics-smoothing-mode");return["ema","ultra","mosaic","stats","trend"].includes(M)?M:"stats"});c.useEffect(()=>{localStorage.setItem("statistics-smoothing-mode",P)},[P]);const[H,q]=c.useState(!1),[O,N]=c.useState(!1),[m,f]=c.useState(yt),[v,E]=c.useState(.5),[B,_]=c.useState(bs),[W,V]=c.useState(.8),[te,J]=c.useState(50),U=c.useMemo(()=>({0:0,1:0,2:1,3:2,4:3,5:4,6:5,7:6,8:7,9:8,10:9})[p]??3,[p]),L=Be[U].hours,Y=L*60,se=Be[U],re=st(L),ae=r.isBackgroundLoading,ne=c.useCallback(M=>{const be={0:1,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:9,9:10}[M]??4;u(be)},[u]),ce=c.useMemo(()=>{var G;if(!((G=t==null?void 0:t.config)!=null&&G.radio))return null;const M=t.config.radio;return{sf:M.spreading_factor??10,bw:M.bandwidth??25e4,cr:M.coding_rate??5,preamble:M.preamble_length??8}},[(we=(De=t==null?void 0:t.config)==null?void 0:De.radio)==null?void 0:we.spreading_factor,(Te=(Le=t==null?void 0:t.config)==null?void 0:Le.radio)==null?void 0:Te.bandwidth,(T=(d=t==null?void 0:t.config)==null?void 0:d.radio)==null?void 0:T.coding_rate,(R=(C=t==null?void 0:t.config)==null?void 0:C.radio)==null?void 0:R.preamble_length]),$=c.useMemo(()=>h.length===0?{timestamps:[],values:[]}:{timestamps:h.map(M=>M.timestamp),values:h.map(M=>M.noise_floor_dbm)},[h]),b=c.useMemo(()=>{if(h.length<10)return{anomalies:[],debug:void 0};const M=vs(h,m);return{anomalies:M.anomalies,debug:M.debug}},[h,m]),S=b.anomalies,A=c.useMemo(()=>{const M=(t==null?void 0:t.neighbors)??{};return Object.fromEntries(Object.entries(M).filter(([G])=>!n.has(G)))},[t==null?void 0:t.neighbors,n]),I=c.useMemo(()=>{const M=Date.now()/1e3-L*3600;return Object.fromEntries(Object.entries(A).filter(([,G])=>G.last_seen>=M))},[A,L]),Q=c.useMemo(()=>{const M=Y*60/re,G=Math.floor(Date.now()/1e3),be=Math.floor(G/M)*M;return{start:be-Y*60,end:be}},[Y,re]),de=B.timeStart??Q.start,pe=B.timeEnd??Q.end,fe=(pe-de)/3600,Ae=st(fe),Re=Ns(),_e=c.useMemo(()=>ys(a,B,Re,Q),[a,B,Re,Q]);return e.jsxs(ds,{children:[e.jsx(hs,{title:"Statistics",icon:e.jsx(is,{}),controls:e.jsx(us,{ranges:Be,selectedIndex:U,onSelect:ne,isPending:ae})}),y&&e.jsx(le,{className:"border border-sys-red/50 bg-sys-red/10",children:e.jsx("p",{className:"text-sys-red",children:y})}),H&&O&&e.jsxs(le,{className:"border border-sys-indigo/30 bg-surface/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"type-label",children:"Anomaly Detection Tuning"}),e.jsxs("span",{className:"type-data-xs text-fg-muted",children:["(",se.label,")"]})]}),e.jsx("button",{onClick:()=>f(M=>({...M,useAbsoluteThresholds:!M.useAbsoluteThresholds})),className:`type-data-xs px-2 py-1 rounded transition-colors ${m.useAbsoluteThresholds?"bg-sys-indigo/30 text-sys-indigo":"bg-elevated text-fg-muted hover:text-fg-secondary"}`,children:m.useAbsoluteThresholds?"Absolute dBm":"Percentile"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"type-micro",children:"Baseline"}),e.jsxs("span",{className:"ml-2 type-data-sm text-status-warning",children:[((X=(F=b.debug)==null?void 0:F.baselineCutoff)==null?void 0:X.toFixed(1))??"—"," dBm"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"type-micro",children:"Spike"}),e.jsxs("span",{className:"ml-2 type-data-sm text-status-warning",children:[((ee=(K=b.debug)==null?void 0:K.spikeCutoff)==null?void 0:ee.toFixed(1))??"—"," dBm"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"type-micro",children:"Mid-band"}),e.jsx("span",{className:"ml-2 type-data-sm text-sys-indigo",children:((Z=b.debug)==null?void 0:Z.midBandSamples)??0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"type-micro",children:"Anomalies"}),e.jsx("span",{className:"ml-2 type-data-sm text-status-danger",children:S.length})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-edge-subtle space-y-4",children:[m.useAbsoluteThresholds?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"type-micro block mb-1",children:["Baseline (",m.baselineDbm," dBm)"]}),e.jsx("input",{type:"range",min:"-120",max:"-60",value:m.baselineDbm,onChange:M=>f(G=>({...G,baselineDbm:Number(M.target.value)})),className:"w-full accent-sys-indigo"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"type-micro block mb-1",children:["Spike (",m.spikeDbm," dBm)"]}),e.jsx("input",{type:"range",min:"-100",max:"-20",value:m.spikeDbm,onChange:M=>f(G=>({...G,spikeDbm:Number(M.target.value)})),className:"w-full accent-sys-indigo"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"type-micro block mb-1",children:["Merge Gap (",m.mergeGapSeconds,"s)"]}),e.jsx("input",{type:"range",min:"5",max:"120",step:"5",value:m.mergeGapSeconds,onChange:M=>f(G=>({...G,mergeGapSeconds:Number(M.target.value)})),className:"w-full accent-sys-indigo"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"type-micro block mb-1",children:["Min Sequence (",m.minSequenceLength,")"]}),e.jsx("input",{type:"range",min:"2",max:"20",value:m.minSequenceLength,onChange:M=>f(G=>({...G,minSequenceLength:Number(M.target.value)})),className:"w-full accent-sys-indigo"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"type-micro block mb-1",children:["Similarity (±",m.similarityToleranceDbm," dBm)"]}),e.jsx("input",{type:"range",min:"1",max:"15",value:m.similarityToleranceDbm,onChange:M=>f(G=>({...G,similarityToleranceDbm:Number(M.target.value)})),className:"w-full accent-sys-indigo"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"type-micro block mb-1",children:["Opacity (",Math.round(v*100),"%)"]}),e.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.05",value:v,onChange:M=>E(Number(M.target.value)),className:"w-full accent-sys-indigo"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"type-micro block mb-1",children:["Baseline (P",m.baselinePercentile,")"]}),e.jsx("input",{type:"range",min:"1",max:"50",value:m.baselinePercentile,onChange:M=>f(G=>({...G,baselinePercentile:Number(M.target.value)})),className:"w-full accent-sys-indigo"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"type-micro block mb-1",children:["Spike (P",m.spikePercentile,")"]}),e.jsx("input",{type:"range",min:"50",max:"99",value:m.spikePercentile,onChange:M=>f(G=>({...G,spikePercentile:Number(M.target.value)})),className:"w-full accent-sys-indigo"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"type-micro block mb-1",children:["Merge Gap (",m.mergeGapSeconds,"s)"]}),e.jsx("input",{type:"range",min:"5",max:"120",step:"5",value:m.mergeGapSeconds,onChange:M=>f(G=>({...G,mergeGapSeconds:Number(M.target.value)})),className:"w-full accent-sys-indigo"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"type-micro block mb-1",children:["Min Sequence (",m.minSequenceLength,")"]}),e.jsx("input",{type:"range",min:"2",max:"20",value:m.minSequenceLength,onChange:M=>f(G=>({...G,minSequenceLength:Number(M.target.value)})),className:"w-full accent-sys-indigo"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"type-micro block mb-1",children:["Similarity (±",m.similarityToleranceDbm," dBm)"]}),e.jsx("input",{type:"range",min:"1",max:"15",value:m.similarityToleranceDbm,onChange:M=>f(G=>({...G,similarityToleranceDbm:Number(M.target.value)})),className:"w-full accent-sys-indigo"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"type-micro block mb-1",children:["Opacity (",Math.round(v*100),"%)"]}),e.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.05",value:v,onChange:M=>E(Number(M.target.value)),className:"w-full accent-sys-indigo"})]})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-elevated radius-inner",children:[e.jsx("div",{className:"type-micro mb-1",children:"Config output"}),e.jsxs("div",{className:"type-data-sm text-status-success",children:[m.useAbsoluteThresholds?`useAbsoluteThresholds: true, baselineDbm: ${m.baselineDbm}, spikeDbm: ${m.spikeDbm}`:`useAbsoluteThresholds: false, baselinePercentile: ${m.baselinePercentile}, spikePercentile: ${m.spikePercentile}`,", mergeGapSeconds: ",m.mergeGapSeconds,", minSequenceLength: ",m.minSequenceLength,", similarityToleranceDbm: ",m.similarityToleranceDbm]})]})]})]}),e.jsxs(xs,{children:[e.jsx("div",{className:"sm:hidden",children:ae&&e.jsx(ge,{template:"auto",children:e.jsx(le,{className:"border border-sys-blue/30 bg-sys-blue/5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative flex h-3 w-3",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-sys-blue opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-sys-blue"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"type-body-sm text-fg-primary",children:["Loading ",se.label," data..."]}),r.loadProgress&&e.jsxs("p",{className:"type-data-xs text-fg-muted mt-0.5",children:[r.loadProgress.loaded.toLocaleString()," packets (",r.loadProgress.percent,"%)"]})]})]})})})}),o?e.jsxs(e.Fragment,{children:[e.jsx(ge,{template:"hero-auto",children:e.jsx(le,{neomorphic:!0,isLoaded:o,skeletonType:"chart",children:o&&e.jsxs(e.Fragment,{children:[e.jsx(Ne,{icon:e.jsx(Se,{}),title:"Packet Analyzer",badge:se.label,badgeColor:"zinc",stackActionsOnMobile:!0,actions:e.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[P==="stats"&&e.jsx(Bs,{enabled:H,onChange:q,anomalyCount:S.length,showTuning:O,onTuningChange:N}),e.jsx(Hs,{smoothing:P,onChange:z}),e.jsx(Fs,{mode:w,onChange:D})]})}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(en,{packets:_e,allPackets:a,startTs:de,endTs:pe,parentStartTs:Q.start,parentEndTs:Q.end,bucketCount:Ae,radioConfig:ce??void 0,mode:w,smoothing:P,noiseFloorAnomalies:S,showNoiseFloorOverlay:H,overlayOpacity:v,dotSize:W,dotOpacity:te/100})})]})})}),e.jsx(ge,{template:"auto",className:"relative z-10",children:e.jsx(le,{neomorphic:!0,noPadding:!0,isLoaded:o,className:"overflow-visible",children:o&&e.jsx(js,{parentStartTs:Q.start,parentEndTs:Q.end,neighbors:A,filter:B,onChange:_,...P==="stats"?{scatterDotSize:W,onScatterDotSizeChange:V,scatterOpacity:te,onScatterOpacityChange:J}:{}})})}),e.jsxs(ge,{template:"panel",children:[e.jsx(ke,{span:12,md:6,children:e.jsx(le,{neomorphic:!1,isLoaded:o,skeletonType:"chart",noPadding:o,className:"!bg-transparent !ring-0 !shadow-none !overflow-visible -mx-4 sm:mx-0 !px-0 !pr-0",children:o&&e.jsx(Ye,{children:e.jsx(mn,{neighbors:I,quickNeighbors:s,localLat:((me=(ie=t==null?void 0:t.config)==null?void 0:ie.repeater)==null?void 0:me.latitude)??0,localLon:((he=(ue=t==null?void 0:t.config)==null?void 0:ue.repeater)==null?void 0:he.longitude)??0,onStatsChange:j,title:"Link Quality",badge:se.label})})})}),e.jsx(ke,{span:12,md:6,children:e.jsx(le,{neomorphic:!0,isLoaded:o,skeletonType:"chart",children:o&&e.jsxs(e.Fragment,{children:[e.jsx(Ne,{icon:e.jsx(os,{}),title:"Network Composition",badge:se.label,badgeColor:"zinc"}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(Ye,{children:e.jsx(hn,{neighbors:I})})})]})})})]}),e.jsxs(ge,{template:"panel",children:[e.jsx(ke,{span:12,md:6,children:e.jsx(vn,{})}),e.jsx(ke,{span:12,md:6,children:e.jsx(Cn,{packets:a,rangeMinutes:Y,rangeHours:L,timeRangeLabel:se.label,isLoaded:o})})]}),e.jsx(ge,{template:"panel",children:e.jsx(ke,{span:12,children:e.jsx(le,{neomorphic:!0,isLoaded:o,skeletonType:"chart",children:o&&e.jsxs(e.Fragment,{children:[e.jsx(Ne,{icon:e.jsx(ls,{}),title:"NOISE FLOOR dBm",stackActionsOnMobile:!0,actions:k?e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("span",{className:"type-data-xs text-fg-muted whitespace-nowrap",children:["min ",e.jsx("span",{className:"data-box",children:k.min.toFixed(0)})]}),e.jsxs("span",{className:"type-data-xs text-fg-muted whitespace-nowrap",children:["avg ",e.jsx("span",{className:"data-box",children:k.avg.toFixed(0)})]}),e.jsxs("span",{className:"type-data-xs text-fg-muted whitespace-nowrap",children:["max ",e.jsx("span",{className:"data-box",children:k.max.toFixed(0)})]})]}):null}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(Ye,{children:e.jsx(Zt,{timestamps:$.timestamps,values:$.values,onStatsChange:g})})})]})})})})]}):e.jsx(ge,{template:"auto",children:e.jsx(le,{neomorphic:!0,className:"text-center py-12",children:e.jsx("div",{className:"animate-pulse text-fg-muted",children:"Loading statistics..."})})})]})]})}export{Qn as default};
