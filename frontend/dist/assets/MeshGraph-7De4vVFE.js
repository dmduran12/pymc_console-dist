import{r as e,j as t,p as s,q as a}from"./vendor-react-54o2BuWt.js";import{c as n,Q as i,aU as r,U as o,aV as l,aW as c,q as d,aE as u,aP as h,B as x,T as m,A as p,m as g,_ as f,R as b,aX as y,Z as v,aY as j,aZ as w}from"./index-C00I5uLb.js";import{D as N,M as k,E as C,a as S}from"./DeepAnalysisModal-DsUAal9l.js";import{D as M}from"./DataBox-xzsNqHsO.js";import{L}from"./loader-circle-OPDY_oz3.js";import{S as F,T as D,E}from"./target-C0jn52FX.js";import{C as H,Z as P}from"./zap-CEBjZ69G.js";import{G as B}from"./git-branch-C9iCvIac.js";import{H as $}from"./house-BuxWjthy.js";import{N as z}from"./network-GyvX6P5b.js";import{C as R}from"./chevron-right-Fyy5vf6_.js";import"./deckgl-DTsmDcfs.js";import"./vendor-core-dnrJb0w-.js";const I=n("arrow-down-up",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]),T=n("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),G=n("focus",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]),A=n("move",[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]]),Z=n("tally-5",[["path",{d:"M4 4v16",key:"6qkkli"}],["path",{d:"M9 4v16",key:"81ygyz"}],["path",{d:"M14 4v16",key:"12vmem"}],["path",{d:"M19 4v16",key:"8ij5ei"}],["path",{d:"M22 6 2 18",key:"h9moai"}]]);function O(t,s=1e3){const[a,n]=e.useState(t),i=e.useRef(Date.now()),r=e.useRef(null);return e.useEffect(()=>{const e=Date.now(),a=s-(e-i.current);return a<=0?(n(t),i.current=e):(r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{n(t),i.current=Date.now()},a)),()=>{r.current&&clearTimeout(r.current)}},[t,s]),a}const W=Math.PI/180;let V=null,q=null,K=0;function _(){const e=Date.now();if(V&&e-K<1e3)return V;K=e;const t=getComputedStyle(document.documentElement).getPropertyValue("--accent-primary").trim();if(t.startsWith("color(display-p3")){const e=t.match(/color\(display-p3\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)/);if(e){const t=Math.round(255*parseFloat(e[1])),s=Math.round(255*parseFloat(e[2])),a=Math.round(255*parseFloat(e[3]));return V=`#${t.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}`,V}}if(t.startsWith("rgb")){const e=t.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(e){const t=parseInt(e[1]),s=parseInt(e[2]),a=parseInt(e[3]);return V=`#${t.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}`,V}}return V=t.startsWith("#")?t:"#719CDF",V}function U(){const e=Date.now();if(q&&e-K<1e3)return q;K=e;const t=getComputedStyle(document.documentElement).getPropertyValue("--bg-body").trim();return q=t.startsWith("#")?t:"#171717",q}function X(e,t){if(e<=0)return 0;const s=t-e;if(s>1209600)return 0;if(s<0)return 1;const a=s/3600;return Math.exp(-a/12)}const Y={spaceSize:4096,simulationRepulsion:1.2,simulationLinkDistance:30,simulationGravity:.2,simulationCenter:.5,simulationFriction:.92,simulationDecay:600,simulationLinkSpring:.6,simulationClusterStrength:.5,simulationRepulsionTheta:1.5};function J(e,t,s,a,n=3){const i=e<=0?0:Math.log10(e+1),r=Math.log10(5001),o=Math.min(1,i/r),l=6+18*Math.pow(o,n);if(a)return l;const c=s-t;return c>=ae?Math.max(6,.5*l):c>=se?Math.max(6,.7*l):l}const Q={local:"#FFFFFF",hub:"#E0E0E0",gateway:"#C8C8C8",backbone:"#B0B0B0",neighbor:"#F0F0F0",mobile:"#A0A0A0",ghost:"#505050",standard:"#808080"},ee={local:"Local Node",hub:"Hub (≥10% traffic)",gateway:"Gateway (7-10%)",backbone:"Backbone",neighbor:"Direct RF Neighbor",mobile:"Mobile/Volatile",ghost:"Discovered (unconfirmed)",standard:"Standard Node"},te={local:$,hub:P,gateway:B,backbone:B,neighbor:b,mobile:A,ghost:H,standard:T},se=432e3,ae=864e3;function ne(e,t,s,a,n={x:0,y:0}){const i=e*W,r=s*W,o=(t-a)*W,l=(e-s)*W,c=637100;return n.x=o*Math.cos(.5*(i+r))*c,n.y=l*c,n}const ie={background:`linear-gradient(to right, ${["#2A2A2A","#3D3D3D","#505050","#636363","#767676","#898989","#9C9C9C","#AFAFAF","#C2C2C2","#D5D5D5","#E8E8E8","#F5F5F5","#FFFFFF"].join(", ")})`},re=["#FBBF24","#F97316","#EF4444","#A855F7","#3B82F6","#6366F1","#6B7280"],oe=["Local","1","2","3","4","5","6+"];function le({isOpen:s,onToggle:a,children:n,className:i=""}){const[r,o]=e.useState(356),l=e.useRef(null);return e.useEffect(()=>{if(!l.current)return;const e=()=>{var e;const t=(null==(e=l.current)?void 0:e.offsetWidth)??380;o(t-24)};e();const t=new ResizeObserver(e);return t.observe(l.current),()=>t.disconnect()},[]),e.useEffect(()=>{},[s,r]),t.jsx(g.div,{className:i||void 0,initial:!1,animate:{x:s?0:r},transition:{duration:.25,ease:[.4,0,.2,1]},style:{willChange:"transform"},children:t.jsxs("div",{ref:l,className:"surface-control radius-inset flex items-stretch w-[240px] sm:w-[320px] lg:w-[380px] ring-1 ring-white/10",children:[t.jsxs("button",{onClick:a,className:"relative flex items-center justify-center w-6 shrink-0 border-r border-border-subtle/50 hover:bg-white/5 transition-base group",title:s?"Hide panel":"Show panel",children:[t.jsx("span",{className:"absolute -inset-y-0 -left-2 right-0 min-h-[44px]","aria-hidden":"true"}),t.jsx(g.div,{initial:!1,animate:{rotate:s?0:180},transition:{duration:.25,ease:[.4,0,.2,1]},children:t.jsx(R,{className:"w-3.5 h-3.5 text-text-muted group-hover:text-text-secondary"})})]}),t.jsx(g.div,{className:"flex-1 min-w-0 overflow-hidden",initial:!1,animate:{opacity:s?1:0},transition:{duration:.15},children:n})]})})}const ce="▁▂▃▄▅▆▇█",de=[-5,0,4,7],ue=[-115,-105,-95,-80],he=["text-signal-critical","text-signal-poor","text-accent-secondary","text-accent-secondary","text-accent-success"],xe=["text-signal-critical","text-signal-poor","text-accent-secondary","text-accent-success","text-accent-success"],me=["░░░░","▂░░░","▂▃░░","▂▄▅░","▂▄▆█"],pe={active:{color:"green",label:"Active"},recent:{color:"yellow",label:"Recent"},stale:{color:"orange",label:"Stale"},inactive:{color:"zinc",label:"Offline"}},ge=(e,t,s=6)=>{const a=t?Math.min(1,e/t):0,n=Math.floor(a*s),i=Math.floor(8*(a*s-n));return ce[7].repeat(n)+(n<s&&i?ce[i-1]:"")+" ".repeat(Math.max(0,s-n-(i?1:0)))},fe=(e,t=10)=>"●".repeat(Math.round(e*t))+"○".repeat(t-Math.round(e*t)),be=(e,t)=>{const s=t?he:xe,a=(t?de:ue).findIndex(t=>e<t);return[me[a<0?4:a],s[a<0?4:a]]},ye=e.memo(function({c:e,maxPkts:s}){const[a,n]=(e=>e.isZeroHop?["◉","text-sys-amber"]:e.isDirectPath?["→","text-sys-cyan"]:e.isLoopEdge?["↺","text-sys-purple"]:["─","text-text-muted"])(e);return t.jsxs("li",{className:"flex items-center gap-1.5 py-0.5 px-1 radius-badge hover:bg-subtle-fill/30 transition-base",children:[t.jsx("span",{className:`w-3 text-center shrink-0 ${n}`,children:a}),t.jsx("span",{className:"size-1.5 shrink-0 rounded-full",style:{backgroundColor:Q[e.nodeClass]}}),t.jsx("code",{className:"shrink-0 text-text-primary",children:e.prefix}),t.jsx("span",{className:"flex-1 min-w-0 truncate text-text-muted",children:e.name||""}),t.jsx("span",{className:"text-accent-secondary tracking-tighter shrink-0",children:ge(e.packetCount,s,4)}),t.jsx("span",{className:"tabular-nums text-text-secondary shrink-0 w-8 text-right",children:e.packetCount>=1e3?`${(e.packetCount/1e3).toFixed(1)}k`:e.packetCount})]})}),ve=e.memo(function({node:s,connections:a,onClose:n}){const i=e.useMemo(()=>Math.max(s.packetCount,...a.map(e=>e.packetCount),1),[s.packetCount,a]),r=e.useMemo(()=>[...a].sort((e,t)=>e.isZeroHop!==t.isZeroHop?e.isZeroHop?-1:1:e.isDirectPath!==t.isDirectPath?e.isDirectPath?-1:1:t.packetCount-e.packetCount),[a]),o=pe[s.activityLevel]??{color:"zinc",label:s.activityLevel};return t.jsxs(g.div,{variants:y,initial:"hidden",animate:"visible",exit:"exit",className:"absolute inset-x-3 bottom-3 z-20 surface-elevated radius-inset shadow-xl",children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-border-subtle/50",children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[t.jsx("span",{className:"size-2 shrink-0 rounded-full",style:{backgroundColor:Q[s.nodeClass]}}),t.jsx("code",{className:"text-sm font-semibold text-text-primary shrink-0",children:s.prefix}),s.name&&t.jsx("span",{className:"text-sm text-text-secondary truncate",children:s.name}),t.jsxs("div",{className:"flex gap-1 shrink-0",children:[s.isLocal&&t.jsx(x,{color:"yellow",compact:!0,children:"LOCAL"}),void 0!==s.hopDistance&&!s.isLocal&&t.jsxs(x,{color:1===s.hopDistance?"orange":2===s.hopDistance?"red":s.hopDistance<=3?"violet":"sky",compact:!0,children:[s.hopDistance,"-HOP"]}),s.isHub&&t.jsx(x,{color:"indigo",compact:!0,children:"HUB"}),s.isGateway&&t.jsx(x,{color:"violet",compact:!0,children:"GW"}),s.isBackbone&&t.jsx(x,{color:"emerald",compact:!0,children:"BONE"}),s.isMobile&&t.jsx(x,{color:"orange",compact:!0,children:"MOB"}),s.isZeroHop&&t.jsx(x,{color:"amber",compact:!0,children:"RF"})]})]}),t.jsx(v,{plain:!0,onClick:n,title:"Close",className:"shrink-0",children:t.jsx(f,{className:"size-4"})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-3 font-mono text-[11px]",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsx(x,{color:o.color,compact:!0,children:o.label}),t.jsx("span",{className:"text-text-muted",children:"•"}),t.jsx("span",{className:"text-text-secondary",children:ee[s.nodeClass]}),s.hasGeo&&t.jsx(x,{color:"cyan",compact:!0,children:"GPS"}),s.hasCollision&&t.jsx(x,{color:"red",compact:!0,children:"⚠ COLLISION"})]}),t.jsx(M,{copy:!0,size:"compact",truncate:[10,6],className:"w-full",children:s.hash}),t.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-[9px] text-text-muted uppercase",children:"Packets"}),t.jsx("div",{className:"text-text-primary tabular-nums",children:s.packetCount.toLocaleString()}),t.jsx("div",{className:"text-accent-primary tracking-tighter",children:ge(s.packetCount,i,6)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-[9px] text-text-muted uppercase",children:"Degree"}),t.jsx("div",{className:"text-text-primary tabular-nums",children:s.degree}),t.jsx("div",{className:"text-accent-secondary tracking-tighter",children:ge(s.degree,Math.max(s.degree,10),6)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-[9px] text-text-muted uppercase",children:"Central"}),t.jsxs("div",{className:"text-text-primary tabular-nums",children:[(100*s.betweenness).toFixed(0),"%"]}),t.jsx("div",{className:"text-accent-primary tracking-tighter",children:fe(s.betweenness,6)})]})]}),s.isZeroHop&&(null!==s.avgRssi||null!==s.avgSnr)&&t.jsxs("div",{className:"flex gap-4 pt-2 border-t border-border-subtle/30",children:[null!==s.avgRssi&&(()=>{const[e,a]=be(s.avgRssi,!1);return t.jsxs("div",{children:[t.jsx("div",{className:"text-[9px] text-text-muted uppercase",children:"RSSI"}),t.jsxs("div",{className:"flex items-baseline gap-1",children:[t.jsx("span",{className:`${a} tracking-tight`,children:e}),t.jsx("span",{className:"tabular-nums text-text-secondary",children:s.avgRssi.toFixed(0)}),t.jsx("span",{className:"text-[9px] text-text-muted",children:"dBm"})]})]})})(),null!==s.avgSnr&&(()=>{const[e,a]=be(s.avgSnr,!0);return t.jsxs("div",{children:[t.jsx("div",{className:"text-[9px] text-text-muted uppercase",children:"SNR"}),t.jsxs("div",{className:"flex items-baseline gap-1",children:[t.jsx("span",{className:`${a} tracking-tight`,children:e}),t.jsx("span",{className:"tabular-nums text-text-secondary",children:s.avgSnr.toFixed(1)}),t.jsx("span",{className:"text-[9px] text-text-muted",children:"dB"})]})]})})()]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-[9px] text-text-muted uppercase",children:"Connections"}),t.jsx(x,{color:"zinc",compact:!0,children:a.length})]}),r.length>0?t.jsxs("ul",{className:"max-h-32 overflow-y-auto space-y-0.5 scrollbar-thin",children:[r.slice(0,20).map(e=>t.jsx(ye,{c:e,maxPkts:i},e.hash)),r.length>20&&t.jsxs("li",{className:"text-center text-text-muted py-1",children:["+",r.length-20," more"]})]}):t.jsx("p",{className:"text-text-muted italic",children:"No connections"})]}),t.jsxs("div",{className:"hidden lg:flex lg:flex-col lg:gap-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:[void 0!==s.hopDistance&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-text-muted",children:"Hop Dist"}),t.jsx("span",{className:"tabular-nums",style:{color:re[Math.min(s.hopDistance,re.length-1)]},children:0===s.hopDistance?"Local":`${s.hopDistance} hop${s.hopDistance>1?"s":""}`})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-text-muted",children:"Cluster"}),t.jsxs("span",{className:"text-text-secondary",children:["#",s.communityId]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-text-muted",children:"Edges"}),t.jsx("span",{className:"text-text-secondary",children:s.edgeCount})]}),s.hasCollision&&t.jsxs("div",{className:"flex justify-between col-span-2",children:[t.jsx("span",{className:"text-signal-poor",children:"Prefix Conf."}),t.jsxs("span",{className:"text-signal-poor tabular-nums",children:[(100*s.prefixConfidence).toFixed(0),"%"]})]})]}),t.jsxs("div",{className:"mt-auto pt-2 border-t border-border-subtle/30",children:[t.jsx("div",{className:"text-[9px] text-text-muted uppercase mb-1.5",children:"Edge Types"}),t.jsxs("div",{className:"grid grid-cols-3 gap-1 text-[10px]",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-sys-amber",children:"◉"}),t.jsx("span",{className:"text-text-muted",children:"RF"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-sys-cyan",children:"→"}),t.jsx("span",{className:"text-text-muted",children:"Direct"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-sys-purple",children:"↺"}),t.jsx("span",{className:"text-text-muted",children:"Loop"})]})]})]})]})]})]})});function je(){return t.jsxs("div",{className:"flex flex-col items-center justify-center gap-6 text-center px-8",children:[t.jsx("div",{className:"p-4 radius-pill bg-subtle-fill",children:t.jsx(z,{className:"w-8 h-8 text-text-muted"})}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h2",{className:"type-subheading text-text-primary",children:"No Topology Data"}),t.jsx("p",{className:"type-body text-text-muted max-w-sm",children:"The mesh topology will appear here once packets are received and processed. This typically takes a few minutes after starting."})]}),t.jsxs("div",{className:"flex items-center gap-2 type-data-xs text-text-muted",children:[t.jsx(b,{className:"w-4 h-4 animate-pulse"}),t.jsx("span",{children:"Waiting for mesh traffic..."})]})]})}function we(){var n;const b=i(),[y,v]=e.useState(!1),M=r(),H=o(),[P,B]=e.useState(!1),[$,z]=e.useState("fetching"),[R,T]=e.useState(0),A=e.useRef(!1);e.useEffect(()=>{b&&!A.current&&(A.current=!0,(async()=>{B(!0),z("fetching"),T(0),await M(),z("analyzing"),await new Promise(e=>setTimeout(e,200)),z("building");const e=Date.now(),t=Date.now()-e;t<600&&await new Promise(e=>setTimeout(e,600-t)),z("discovering"),await new Promise(e=>setTimeout(e,400)),z("complete"),await new Promise(e=>setTimeout(e,800)),B(!1),v(!0)})())},[b,M]),e.useEffect(()=>{"fetching"===$&&(H.loadProgress?T(H.loadProgress.loaded):H.packetCount>0&&T(H.packetCount))},[$,H.loadProgress,H.packetCount]);const W=l(),V=O(c(),2e3),q=d(),K=u(),[ee,se]=e.useState(!0),[ae,ce]=e.useState(null),de=e.useRef(void 0),[ue,he]=e.useState(""),[xe,me]=e.useState(!1),pe=e.useRef(null),[ge]=e.useState(1),[fe]=e.useState(.15),[be]=e.useState(2.75),[ye]=e.useState(3),we=O(be,300),Ne=O(ye,300),ke=e.useRef(ge),Ce=e.useRef(fe);e.useEffect(()=>{ke.current=ge},[ge]),e.useEffect(()=>{Ce.current=fe},[fe]);const Se=e.useRef({node:null,x:0,y:0}),Me=e.useRef(null),[Le,Fe]=e.useState(!1),[De,Ee]=e.useState("force"),[He,Pe]=e.useState(!0);e.useEffect(()=>{const e=e=>{var t,s;if(!(e.target instanceof HTMLInputElement))switch(e.key.toLowerCase()){case"f":e.metaKey||e.ctrlKey||(e.preventDefault(),null==(t=st.current)||t.fitView(800));break;case"escape":xe?(me(!1),he("")):ae&&(de.current=void 0,ce(null),null==(s=st.current)||s.unselectAllPoints());break;case"/":xe||(e.preventDefault(),me(!0),setTimeout(()=>{var e;return null==(e=pe.current)?void 0:e.focus()},50));break;case" ":e.preventDefault();{const e=st.current;e&&(ee?e.pause():e.start(),se(e=>!e))}}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[xe,ae,ee]);const Be=(null==K?void 0:K.latitude)??0,$e=(null==K?void 0:K.longitude)??0,ze=null!==K,[Re,Ie]=e.useState(Math.floor(Date.now()/1e3));e.useEffect(()=>{const e=setInterval(()=>{Ie(Math.floor(Date.now()/1e3))},3e5);return()=>clearInterval(e)},[]);const Te=e.useMemo(()=>{var e;if(!V||0===V.size||!y)return[];const t=[],s=(null==q?void 0:q.node_name)??(null==(e=null==q?void 0:q.config)?void 0:e.node_name)??null,a={x:0,y:0},n=[];for(const i of V.values()){const e=i.isLocal?1:X(i.lastSeen,Re);if(0===e&&!i.isLocal)continue;i.isLocal||n.push(i.packetCount);const r=i.packetCount>0?Math.log10(i.packetCount+1):0,o=Math.log10(5001),l=Math.min(1,r/o);let c;c=i.isLocal?4:l<.2?0:l<.4?1:l<.6?2:l<.8?3:4;const d="#FFFFFF",u=J(i.packetCount,i.lastSeen,Re,i.isLocal,be),h=i.isLocal?s??i.name:i.name;let x,m,p=!1;ze&&(i.isLocal?(x=0,m=0,p=!0):i.latitude&&i.longitude&&(ne(i.latitude,i.longitude,Be,$e,a),x=a.x,m=a.y,p=!0)),t.push({id:i.hash,label:h?`${i.prefix} ${h}`:i.prefix,color:d,trafficCategory:c,size:u,x:x,y:m,recencyWeight:e,nodeClass:i.nodeClass,name:h,prefix:i.prefix,packetCount:i.packetCount,betweenness:i.betweenness,communityId:i.communityId,isLocal:i.isLocal,isHub:i.isHub,isGateway:i.isGateway,isBackbone:i.isBackbone,isMobile:i.isMobile,isGhost:i.isGhost,isInLoop:i.isInLoop,isZeroHop:i.isZeroHop,hasGeo:p,avgRssi:i.avgRssi,avgSnr:i.avgSnr,degree:i.degree,activityLevel:i.activityLevel,prefixConfidence:i.prefixConfidence,hasCollision:i.hasCollision,lastSeen:i.lastSeen})}if(n.length>0){n.sort((e,t)=>e-t);const e=n[Math.floor(.99*n.length)]??n[n.length-1]??1/0;for(const s of t)!s.isLocal&&s.packetCount>=e&&(s.trafficCategory=5)}return t},[V,y,ze,Be,$e,null==q?void 0:q.node_name,null==(n=null==q?void 0:q.config)?void 0:n.node_name,Re,be]),Ge=e.useMemo(()=>{const e=new Set;for(const t of Te)e.add(t.id);return e},[Te]),{rawLinks:Ae}=e.useMemo(()=>{const e=(null==W?void 0:W.edges)??[];if(!e||0===e.length||!y)return{rawLinks:[],maxCertainCount:0,hasZeroHopEdges:!1,hasLoopEdges:!1,hasDirectPathEdges:!1};const t=_(),s=[];let a=!1,n=!1,i=!1;const r=[],o=5-4*Math.min(1,Math.max(0,(ye-.05)/2.95));for(const l of e){if(!Ge.has(l.fromHash)||!Ge.has(l.toHash))continue;s.push(l.certainCount),a=a||!0===l.isZeroHop,n=n||!0===l.isLoopEdge,i=i||!0===l.isDirectPathEdge;const e=l.avgRecency,t=e<0,o=null==V?void 0:V.get(l.fromHash),c=null==V?void 0:V.get(l.toHash),d=(null==o?void 0:o.isHub)||(null==o?void 0:o.isGateway)||(null==o?void 0:o.isBackbone)||(null==o?void 0:o.isLocal),u=(null==c?void 0:c.isHub)||(null==c?void 0:c.isGateway)||(null==c?void 0:c.isBackbone)||(null==c?void 0:c.isLocal);let h=0,x=300;t||(d&&u?(h=.8,x=250):d||u?(h=.4,x=50):(h=.1,x=300)),r.push({source:l.fromHash,target:l.toHash,color:t?"#1E293B":"#808080",width:t?.1:1,strength:h,distance:x,arrow:!t,trafficCategory:t?0:2,recencyWeight:e,packetCount:l.packetCount,certainCount:l.certainCount,isZeroHop:l.isZeroHop??!1,isLoopEdge:l.isLoopEdge??!1,isDirectPath:l.isDirectPathEdge,avgConfidence:l.avgConfidence})}if(s.length>0){s.sort((e,t)=>e-t);const e=s[Math.floor(.98*s.length)]??s[s.length-1]??1,a=Math.max(1,e),n=Math.log10(a+1),i=s[Math.floor(.99*s.length)]??s[s.length-1]??1/0;for(const s of r){if(0===s.trafficCategory)continue;const e=s.certainCount>0?Math.log10(s.certainCount+1):0,a=Math.min(1,e/n),r=Math.pow(a,ye),l=Math.pow(a,fe);if(s.width=.1+r*(o-.1),s.certainCount>=i)s.color=t,s.trafficCategory=5;else{const e=Math.round(80+144*l).toString(16).padStart(2,"0");s.color=`#${e}${e}${e}`,s.trafficCategory=a<.25?1:a<.5?2:a<.75?3:4}}}return{rawLinks:r,maxCertainCount:s.length>0?Math.max(...s):0,hasZeroHopEdges:a,hasLoopEdges:n,hasDirectPathEdges:i}},[null==W?void 0:W.edges,y,Ge,V,ye,fe]),Ze=e.useMemo(()=>{const e=new Map;for(const t of Ae)e.set(t.source,(e.get(t.source)??0)+1),e.set(t.target,(e.get(t.target)??0)+1);return e},[Ae]),Oe=e.useMemo(()=>{const e=new Map;for(const t of Te)e.set(t.id,t);return e},[Te]),We=e.useMemo(()=>{const e=new Map;for(const t of Ae)e.has(t.source)||e.set(t.source,[]),e.get(t.source).push({link:t,otherHash:t.target,direction:"outbound"}),e.has(t.target)||e.set(t.target,[]),e.get(t.target).push({link:t,otherHash:t.source,direction:"inbound"});return e},[Ae]),Ve=e.useMemo(()=>{if(!ae)return[];const e=We.get(ae.hash);if(!e)return[];const t=[];for(const{link:s,otherHash:a,direction:n}of e){const e=Oe.get(a);e&&t.push({hash:a,prefix:e.prefix,name:e.name,nodeClass:e.nodeClass,packetCount:s.packetCount,certainCount:s.certainCount,isZeroHop:s.isZeroHop,isDirectPath:s.isDirectPath,isLoopEdge:s.isLoopEdge,direction:n})}return t},[ae,We,Oe]),qe=e.useMemo(()=>{const e=new Map;for(const t of Te)e.set(t.label,t.trafficCategory),e.set(t.prefix,t.trafficCategory);return e},[Te]),Ke=e.useMemo(()=>{if(0===Ae.length||0===Te.length)return null;const e=new Map;for(const l of Ae)e.has(l.source)||e.set(l.source,new Set),e.has(l.target)||e.set(l.target,new Set),e.get(l.source).add(l.target),e.get(l.target).add(l.source);const t=Te.find(e=>e.isLocal);if(!t)return null;const s=new Map,a=[t.id];s.set(t.id,0);let n=0;for(;a.length>0;){const t=a.shift(),i=s.get(t),r=e.get(t);if(r)for(const e of r)if(!s.has(e)){const t=i+1;s.set(e,t),n=Math.max(n,t),a.push(e)}}for(const l of Te)s.has(l.id)||s.set(l.id,n+1);const i=new Map;for(const l of s.values())i.set(l,(i.get(l)??0)+1);const r=new Set;for(const[l,c]of s)c<=2&&r.add(l);const o=new Set;for(const l of Ae)r.has(l.source)&&r.has(l.target)&&(o.add(`${l.source}-${l.target}`),o.add(`${l.target}-${l.source}`));return{hopDistance:s,maxHops:n,nodesPerHop:i,backboneSet:r,backboneEdgeSet:o,localNodeId:t.id}},[Ae,Te]),_e=Ke,Ue=e.useCallback(()=>{const e=document.querySelectorAll(".css-label--label");if(0===e.length||0===qe.size)return;const t=["meshgraph-label-cat-0","meshgraph-label-cat-1","meshgraph-label-cat-2","meshgraph-label-cat-3","meshgraph-label-cat-4","meshgraph-label-cat-5"];e.forEach(e=>{var s;const a=(null==(s=e.textContent)?void 0:s.trim())??"",n=qe.get(a);void 0!==n&&(e.classList.remove(...t),e.classList.add(`meshgraph-label-cat-${n}`))})},[qe]),[Xe,Ye]=e.useState(null),[Je,Qe]=e.useState(null),[et,tt]=e.useState({}),st=e.useRef(null);e.useEffect(()=>()=>{var e;try{null==(e=st.current)||e.destroy()}catch{}st.current=null},[]);const at=e.useRef(!1),nt=e.useRef(!1),it=e.useRef(!1),rt=e.useRef(""),ot=e.useRef(!1),[lt,ct]=e.useState(!0),[dt,ut]=e.useState(0),ht=e.useCallback(()=>{const e=st.current;e&&(it.current=!1,ot.current=!1,ct(!0),se(!0),e.start())},[]),xt=e.useRef(De);e.useEffect(()=>{if(0===Te.length)return Ye(null),Qe(null),void(rt.current="");const e=xt.current!==De;e&&(xt.current=De);const t=`${Te.length}-${Ae.length}-${we.toFixed(2)}-${Ne.toFixed(2)}-${De}`,s=rt.current;if(!e&&s&&nt.current){const[e,t]=s.split("-").map(Number),a=Math.abs(Te.length-e)/Math.max(e,1),n=Math.abs(Ae.length-t)/Math.max(t,1),i=!s.includes(`${we.toFixed(2)}-${Ne.toFixed(2)}`);if(a<.05&&n<.05&&!i)return}let n=!1,i=null;return e&&(at.current=!1),i=setTimeout(async()=>{if(!at.current){at.current=!0,nt.current=!0,ct(!0);try{const i=(e,t)=>"number"==typeof e&&Number.isFinite(e)?e:t,r=186,o=255,l=92,c=ke.current;let d;d=c<=1?o-c*(o-r):r-(c-1)*(r-l);const u=e=>{const t=Math.max(0,Math.min(255,Math.round(e))).toString(16).padStart(2,"0");return`#${t}${t}${t}`},h=e=>u(d+(o-d)*e),x=_(),m=document.documentElement;m.style.setProperty("--meshgraph-label-0",h(0)),m.style.setProperty("--meshgraph-label-1",h(.33)),m.style.setProperty("--meshgraph-label-2",h(.66)),m.style.setProperty("--meshgraph-label-3",h(1)),m.style.setProperty("--meshgraph-label-4","#FFFFFF"),m.style.setProperty("--meshgraph-label-5",x);const p=e=>{if(g&&Ke){const t=Ke.hopDistance.get(e.id)??99;return 0===t?"Local":1===t?"Hop-1":2===t?"Hop-2":3===t?"Hop-3":"Hop-4+"}return e.isLocal?"Local":e.isHub?"Hub":e.isGateway?"Gateway":e.isBackbone?"Backbone":"Node"},g="backbone"===De&&Ke,f=(null==Ke?void 0:Ke.maxHops)??5,b=["#FBBF24","#F97316","#EF4444","#A855F7","#3B82F6","#6366F1","#6B7280"],y=[...Te].sort((e,t)=>{if(g){const s=Ke.hopDistance.get(e.id)??f+1,a=Ke.hopDistance.get(t.id)??f+1;if(s!==a)return a-s}const s=5===e.trafficCategory,a=5===t.trafficCategory;return s&&!a?1:!s&&a?-1:e.size-t.size}).map(e=>{const t=(null==Ke?void 0:Ke.hopDistance.get(e.id))??99,s=t<=2;let a,n;if(g){if(5===e.trafficCategory)a=x;else if(e.isLocal)a=b[0];else{const e=Math.min(t,b.length-1);a=b[e]}n=(e.isLocal?32:s?20:12)*(.8+e.trafficCategory/4*.4)}else{if(5===e.trafficCategory)a=x;else{const t=100+e.trafficCategory/4*140,s=Math.round(t).toString(16).padStart(2,"0");a=`#${s}${s}${s}`}n=i(e.size,8)}return{id:e.id,label:e.label,color:a,trafficCategory:e.trafficCategory,size:n,groupLabel:p(e)}}),v=[...Ae].sort((e,t)=>(t.certainCount??t.packetCount??0)-(e.certainCount??e.packetCount??0)),j=Math.floor(1*v.length),w=new Set(v.slice(0,Math.max(j,10)).map(e=>`${e.source}-${e.target}`)),N=Math.max(1,...Ae.map(e=>e.certainCount)),k=new Map;for(const e of(null==W?void 0:W.edges)??[]){const t=`${e.fromHash}-${e.toHash}`,s=`${e.toHash}-${e.fromHash}`,a={symmetryRatio:e.symmetryRatio??.5,forwardCount:e.forwardCount??0,reverseCount:e.reverseCount??0};k.set(t,a),k.set(s,a)}const C=Ae.filter(e=>w.has(`${e.source}-${e.target}`)).sort((e,t)=>{if(g&&Ke){const s=Ke.backboneEdgeSet.has(`${e.source}-${e.target}`),a=Ke.backboneEdgeSet.has(`${t.source}-${t.target}`);if(s&&!a)return 1;if(!s&&a)return-1}const s=5===e.trafficCategory,a=5===t.trafficCategory;return s&&!a?1:!s&&a?-1:e.width-t.width}).map(e=>{const t=(null==Ke?void 0:Ke.hopDistance.get(e.source))??f,s=(null==Ke?void 0:Ke.hopDistance.get(e.target))??f,a=Math.min(t,s),n=Math.max(t,s)-a,r=k.get(`${e.source}-${e.target}`),o=(null==r?void 0:r.symmetryRatio)??.5,l=Math.log10(e.certainCount+1)/Math.log10(N+1);let c,d,u,h;if(g){0===n?(d=40+30*(1-l),c=.8):(d=120*n*(1+.2*a),c=.15/n);const e=(t+s)/2;e<=1.5?(u="#FB923C",h=2+4*o):e<=2.5?(u="#F87171",h=1.5+2.5*o):e<=3.5?(u="#C084FC",h=1+2*o):(u="#60A5FA",h=.5+1.5*o)}else{const t=l*(.3+.7*o);c=.1+1.9*t,d=20+180*(1-t),u=e.color,h=i(e.width,1)}return{source:e.source,target:e.target,color:u,trafficCategory:e.trafficCategory,width:h,strength:c,distance:d}}),S=y,M=C,L=S.length>0,F=new Set(M.map(e=>e.width)),D=M.length>0,E=1===F.size?F.values().next().value:null,H=new Set(M.map(e=>e.strength)),P=M.length>=2&&H.size>=2,B=new Set(M.map(e=>e.distance)),$=M.length>=2&&B.size>=2,z=new Set(S.map(e=>e.groupLabel)).size>=2,R=(e=!1)=>({points:{pointIdBy:"id",pointColorBy:"color",pointColorStrategy:"direct",pointDefaultColor:"#FFFFFF",pointLabelBy:"label",pointGreyoutOpacity:.5,pointDefaultSize:8,pointSizeScale:1,...e?{}:{pointMass:e=>1+((e.size??8)-6)/18*10},...!e&&L?{pointSizeBy:"size",pointSizeStrategy:"direct"}:{},...!e&&z?{pointClusterBy:"groupLabel"}:{},...!e&&D?{linkWidthBy:"width",linkWidthStrategy:"direct"}:{},...!e&&P?{linkStrengthBy:"strength",linkStrengthStrategy:"direct"}:{}},links:{linkSourceBy:"source",linkTargetsBy:["target"],linkColorBy:"color",linkColorStrategy:"direct",linkDefaultWidth:null!==E?E:1,linkWidthScale:1,linkDefaultColor:"#505050",linkGreyoutOpacity:.15,...!e&&D?{linkWidthBy:"width",linkWidthStrategy:"direct"}:{},...!e&&$?{linkDistanceBy:"distance",linkDistanceStrategy:"direct"}:{}}});let I;try{I=await a(R(!1),S,M)}catch(s){I=await a(R(!0),S,M)}if(n||!I)return;const T=I.points??null,G=I.links??null,A=I.cosmographConfig;Ye(T),Qe(G),tt({...A,fitViewOnInit:!1,...Y}),rt.current=t,e&&ut(e=>e+1)}catch(i){ct(!1)}finally{at.current=!1}}},500),()=>{n=!0,i&&clearTimeout(i)}},[Te,Ae,!1,null,we,Ne,De,_e,null==W?void 0:W.edges]);const mt=e.useCallback(e=>{e&&(st.current=e,ht())},[ht]),pt=e.useCallback(()=>{var e;null==(e=st.current)||e.fitView(800)},[]),gt=e.useCallback(()=>{var e,t,s;const a=st.current;if(a){if(it.current||(it.current=!0,a.fitView(800)),ct(!1),!ot.current){ot.current=!0;try{const n=a._internalApi;null==(e=null==n?void 0:n.initializeLabels)||e.call(n),null==(s=null==(t=null==n?void 0:n.labels)?void 0:t.update)||s.call(t),setTimeout(()=>Ue(),100)}catch{}}se(!1)}},[Ue]),ft=e.useCallback(()=>{const e=st.current;e&&(ee?e.pause():e.start(),se(!ee))},[ee]),bt=e.useCallback(async e=>{const t=st.current;if(t)try{const s=await t.getPointIndicesByIds([e]);s&&s.length>0&&void 0!==s[0]&&t.zoomToPoint(s[0],400,2.5)}catch{}},[]),yt=e.useMemo(()=>{if(!xe||!ue.trim())return[];const e=ue.toLowerCase();return Te.filter(t=>{var s;return t.prefix.toLowerCase().includes(e)||(null==(s=t.name)?void 0:s.toLowerCase().includes(e))||t.id.toLowerCase().includes(e)}).slice(0,8)},[Te,ue,xe]),vt=e.useCallback(e=>{bt(e.id),me(!1),he(""),ce({hash:e.id,name:e.name,prefix:e.prefix,nodeClass:e.nodeClass,packetCount:e.packetCount,edgeCount:Ze.get(e.id)??0,betweenness:e.betweenness,communityId:e.communityId,degree:e.degree,hasGeo:e.hasGeo,isLocal:e.isLocal,isHub:e.isHub,isGateway:e.isGateway,isBackbone:e.isBackbone,isMobile:e.isMobile,isInLoop:e.isInLoop,isZeroHop:e.isZeroHop,avgRssi:e.avgRssi,avgSnr:e.avgSnr,activityLevel:e.activityLevel,prefixConfidence:e.prefixConfidence,hasCollision:e.hasCollision,hopDistance:null==Ke?void 0:Ke.hopDistance.get(e.id)})},[bt,Ze,Ke]),jt=e.useRef(void 0),wt=e.useRef(0),Nt=e.useCallback(async(e,t,s)=>{const a=Date.now();if(s&&a-wt.current>=16&&(wt.current=a,Se.current.x=s.clientX,Se.current.y=s.clientY,Se.current.node&&window.dispatchEvent(new CustomEvent("meshgraph:hover"))),e===jt.current)return;jt.current=e,Me.current&&(clearTimeout(Me.current),Me.current=null);const n=st.current;if(n)if(void 0!==e)try{const t=await n.getPointIdsByIndices([e]);if(!t||0===t.length)return;const s=t[0],a=Oe.get(s);if(!a)return;Se.current.node=a,window.dispatchEvent(new CustomEvent("meshgraph:hover")),n.selectPoint(e,!1,!0)}catch{Se.current.node=null,window.dispatchEvent(new CustomEvent("meshgraph:hover"))}else Me.current=setTimeout(()=>{Se.current.node=null,window.dispatchEvent(new CustomEvent("meshgraph:hover")),void 0!==de.current?n.selectPoint(de.current,!1,!0):n.unselectAllPoints()},100)},[Oe,ae]),kt=e.useCallback(()=>{Fe(e=>!e)},[]),Ct=e.useCallback(async(e,t,s)=>{var a;if(Se.current.node=null,window.dispatchEvent(new CustomEvent("meshgraph:hover")),jt.current=void 0,void 0===e)return de.current=void 0,ce(null),void(null==(a=st.current)||a.unselectAllPoints());const n=st.current;if(n)try{const t=await n.getPointIdsByIndices([e]);if(!t||0===t.length)return;const s=t[0],a=Oe.get(s);if(!a)return;de.current=e,n.selectPoint(e,!1,!0),ce({hash:s,name:a.name,prefix:a.prefix,nodeClass:a.nodeClass,packetCount:a.packetCount,edgeCount:Ze.get(s)??0,betweenness:a.betweenness,communityId:a.communityId,degree:a.degree,hasGeo:a.hasGeo,isLocal:a.isLocal,isHub:a.isHub,isGateway:a.isGateway,isBackbone:a.isBackbone,isMobile:a.isMobile,isInLoop:a.isInLoop,isZeroHop:a.isZeroHop,avgRssi:a.avgRssi,avgSnr:a.avgSnr,activityLevel:a.activityLevel,prefixConfidence:a.prefixConfidence,hasCollision:a.hasCollision,hopDistance:null==Ke?void 0:Ke.hopDistance.get(s)})}catch{}},[Oe,Ze]),[St,Mt]=e.useState(!0),[Lt,Ft]=e.useState(!0),Dt=St&&!ae,Et=Lt&&!ae,Ht=()=>t.jsx("div",{className:"px-2 py-1.5 sm:px-2.5 sm:py-2",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] sm:text-[11px] text-text-secondary tabular-nums whitespace-nowrap",children:[t.jsx("span",{children:Te.length}),t.jsx("span",{className:"text-text-muted",children:"•"}),t.jsx("span",{children:Ae.length}),lt&&t.jsx(L,{className:"w-3 h-3 animate-spin text-accent-primary ml-0.5"})]}),t.jsx("div",{className:"w-px h-4 bg-border-subtle/50"}),t.jsxs("div",{className:"flex items-center gap-0.5 shrink-0",children:[t.jsx(m,{content:"force"===De?"Backbone view":"Force layout",children:t.jsx("button",{onClick:()=>Ee(e=>"force"===e?"backbone":"force"),className:"p-1.5 radius-inner transition-base "+("backbone"===De?"bg-accent-primary/30 text-accent-primary":"hover:bg-white/10 text-text-secondary"),children:"force"===De?t.jsx(Z,{className:"w-4 h-4"}):t.jsx(I,{className:"w-4 h-4"})})}),t.jsx(m,{content:He?"Hide labels":"Show labels",children:t.jsx("button",{onClick:()=>Pe(e=>!e),className:"p-1.5 radius-inner transition-base "+(He?"hover:bg-white/10 text-text-secondary":"bg-white/5 text-text-muted"),children:He?t.jsx(E,{className:"w-4 h-4"}):t.jsx(C,{className:"w-4 h-4"})})}),t.jsx(m,{content:"Search (/)",children:t.jsx("button",{onClick:()=>{me(!0),setTimeout(()=>{var e;return null==(e=pe.current)?void 0:e.focus()},50)},className:"p-1.5 radius-inner transition-base "+(xe?"bg-accent-primary/30 text-accent-primary":"hover:bg-white/10 text-text-secondary"),children:t.jsx(F,{className:"w-4 h-4"})})}),t.jsx(m,{content:ee?"Pause (Space)":"Play (Space)",children:t.jsx("button",{onClick:ft,className:"p-1.5 radius-inner hover:bg-white/10 transition-base",children:ee?t.jsx(j,{className:"w-4 h-4 text-accent-success"}):t.jsx(w,{className:"w-4 h-4 text-text-secondary"})})}),t.jsx(m,{content:"Fit view (F)",children:t.jsx("button",{onClick:pt,className:"p-1.5 radius-inner hover:bg-white/10 transition-base",children:t.jsx(G,{className:"w-4 h-4 text-text-secondary"})})}),t.jsx(m,{content:Le?"Exit fullscreen":"Fullscreen",children:t.jsx("button",{onClick:kt,className:"p-1.5 radius-inner hover:bg-white/10 transition-base",children:Le?t.jsx(k,{className:"w-4 h-4 text-text-secondary"}):t.jsx(S,{className:"w-4 h-4 text-text-secondary"})})})]})]})}),Pt=()=>{const e="backbone"===De,s=Math.min(((null==Ke?void 0:Ke.maxHops)??3)+2,7);return t.jsx("div",{className:"p-1.5 sm:p-2",children:e?t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-[9px] font-medium text-text-muted uppercase tracking-wide mr-0.5 hidden sm:inline",children:"Hops"}),re.slice(0,s).map((e,s)=>{const a=(null==Ke?void 0:Ke.nodesPerHop.get(s))??0;return t.jsxs("div",{className:"flex items-center gap-0.5 px-1 py-0.5 radius-badge bg-white/10 shrink-0",title:`${oe[s]}: ${a} nodes`,children:[t.jsx("div",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:e}}),t.jsx("span",{className:"text-[9px] text-text-secondary tabular-nums",children:oe[s]})]},s)}),t.jsxs("div",{className:"flex items-center gap-0.5 px-1 py-0.5 radius-badge bg-white/10 shrink-0 ml-auto",children:[t.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-accent-primary"}),t.jsx("span",{className:"text-[9px] text-text-secondary",children:"p99"})]})]}):t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-[9px] text-text-secondary tabular-nums shrink-0",children:"0"}),t.jsx("div",{className:"flex-1 min-w-0 h-2 rounded-sm",style:ie}),t.jsx("span",{className:"text-[9px] text-text-secondary tabular-nums shrink-0",children:"10K+"}),t.jsxs("div",{className:"flex items-center gap-0.5 px-1 py-0.5 radius-badge bg-white/10 shrink-0 ml-1",children:[t.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-accent-primary"}),t.jsx("span",{className:"text-[9px] text-text-secondary",children:"p99"})]})]})})},Bt=()=>t.jsxs("div",{className:"absolute top-10 sm:top-11 right-2 sm:right-3 z-10 flex flex-col gap-1.5 sm:gap-2 pointer-events-auto",children:[t.jsx(le,{isOpen:Dt,onToggle:()=>Mt(e=>!e),children:t.jsx(Ht,{})}),t.jsx(le,{isOpen:Et,onToggle:()=>Ft(e=>!e),children:t.jsx(Pt,{})})]}),$t=()=>t.jsx("div",{className:"absolute top-0 left-0 z-20 px-4 py-3 pointer-events-none",children:t.jsxs("h1",{className:"type-title text-text-primary flex items-center gap-2 sm:gap-3 pointer-events-auto",children:[t.jsx(h,{className:"w-5 h-5 sm:w-6 sm:h-6 text-icon-page-title"}),t.jsx("span",{children:"MeshGraph"}),t.jsx(x,{color:"sky",compact:!0,children:"Beta"})]})});return y?0===Te.length?t.jsxs("div",{className:"relative h-[calc(100dvh-56px)] lg:h-dvh min-h-[500px] -mx-4 sm:-mx-6 lg:-mx-8 -mt-5 -mb-4 sm:-mb-6 lg:-mb-8 overflow-hidden",children:[t.jsx($t,{}),t.jsx("div",{className:"absolute inset-0 bg-bg-body flex items-center justify-center",children:t.jsx(je,{})})]}):Xe?Le?t.jsxs("div",{className:"fixed inset-0 z-50 bg-bg-body flex flex-col overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 surface-header z-10",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(h,{className:"w-5 h-5 text-icon-page-title"}),t.jsxs("h1",{className:"type-title text-text-primary flex items-center gap-2",children:["MeshGraph",t.jsx(x,{color:"sky",compact:!0,children:"Beta"})]}),t.jsxs("span",{className:"text-[10px] text-text-muted tabular-nums hidden sm:inline",children:[Te.length," nodes • ",Ae.length," edges"]}),lt&&t.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-accent-primary",children:[t.jsx(L,{className:"w-3 h-3 animate-spin"}),t.jsx("span",{className:"hidden sm:inline",children:"Stabilizing"})]})]}),t.jsx(m,{content:"Exit fullscreen",children:t.jsx("button",{onClick:kt,className:"p-1.5 radius-inner hover-bg transition-base",children:t.jsx(k,{className:"w-4 h-4 text-text-muted"})})})]}),t.jsxs("div",{className:"flex-1 relative min-h-0 m-2 surface-base radius-inset overflow-hidden border border-border-subtle",children:[t.jsx(s,{className:"absolute inset-0",points:Xe,links:Je,...et,backgroundColor:U(),fitViewOnInit:!1,initialZoomLevel:10,simulationClusterStrength:.8,showLabels:He,showDynamicLabels:He,showTopLabels:He,showTopLabelsLimit:100,showHoveredPointLabel:!0,pointLabelFontSize:11,showClusterLabels:!1,onClick:Ct,onMouseMove:Nt,onMount:mt,onSimulationEnd:gt,renderHoveredPointRing:!0,hoveredPointRingColor:"#FBBF24",hoveredPointCursor:"pointer",pointGreyoutOpacity:.2,linkGreyoutOpacity:.15},dt),t.jsx(p,{children:xe&&t.jsx(g.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.15},className:"absolute top-4 left-1/2 -translate-x-1/2 z-30 w-80",children:t.jsxs("div",{className:"surface-elevated radius-inset shadow-2xl overflow-hidden",children:[t.jsxs("div",{className:"flex items-center gap-2 px-3 py-2.5 border-b border-border-subtle",children:[t.jsx(F,{className:"w-4 h-4 text-text-muted shrink-0"}),t.jsx("input",{ref:pe,type:"text",value:ue,onChange:e=>he(e.target.value),placeholder:"Search by name or prefix...",className:"flex-1 bg-transparent text-sm text-text-primary placeholder:text-text-muted focus:outline-none",onKeyDown:e=>{"Escape"===e.key?(me(!1),he("")):"Enter"===e.key&&yt.length>0&&vt(yt[0])}}),ue&&t.jsx("button",{onClick:()=>he(""),className:"p-0.5 radius-badge hover-bg transition-base",children:t.jsx(f,{className:"w-3 h-3 text-text-muted"})})]}),yt.length>0&&t.jsx("div",{className:"max-h-64 overflow-y-auto",children:yt.map((e,s)=>{const a=te[e.nodeClass];return t.jsxs("button",{onClick:()=>vt(e),className:"w-full flex items-center gap-3 px-3 py-2 text-left hover:bg-subtle-fill transition-base "+(0===s?"bg-subtle-fill/50":""),children:[t.jsx("span",{className:"w-2.5 h-2.5 rounded-full shrink-0",style:{backgroundColor:Q[e.nodeClass]}}),t.jsx(a,{className:"w-3.5 h-3.5 text-text-muted shrink-0"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"text-sm text-text-primary truncate",children:e.name||e.prefix}),e.name&&t.jsx("div",{className:"text-[10px] text-text-muted",children:e.prefix})]}),t.jsx(D,{className:"w-3 h-3 text-text-muted shrink-0"})]},e.id)})}),ue&&0===yt.length&&t.jsx("div",{className:"px-3 py-4 text-center text-sm text-text-muted",children:"No nodes found"}),!ue&&t.jsx("div",{className:"px-3 py-2 text-[10px] text-text-muted",children:"Type to search • Enter to select • Esc to close"})]})})}),t.jsx(Bt,{}),t.jsxs(g.div,{className:"absolute right-4 z-10 hidden lg:flex items-center gap-3 type-data-xs text-text-muted/60",initial:!1,animate:{bottom:ae?280:16},transition:{type:"spring",stiffness:400,damping:30},children:[t.jsxs("span",{children:[t.jsx("kbd",{className:"px-1 py-0.5 radius-badge bg-subtle-fill/50 font-mono",children:"/"})," Search"]}),t.jsxs("span",{children:[t.jsx("kbd",{className:"px-1 py-0.5 radius-badge bg-subtle-fill/50 font-mono",children:"F"})," Fit"]}),t.jsxs("span",{children:[t.jsx("kbd",{className:"px-1 py-0.5 radius-badge bg-subtle-fill/50 font-mono",children:"Space"})," Pause"]}),t.jsxs("span",{children:[t.jsx("kbd",{className:"px-1 py-0.5 radius-badge bg-subtle-fill/50 font-mono",children:"Esc"})," Clear"]})]}),t.jsx(p,{children:ae&&t.jsx(ve,{node:ae,connections:Ve,onClose:()=>{var e;de.current=void 0,ce(null),null==(e=st.current)||e.unselectAllPoints()}})})]})]}):t.jsxs("div",{className:"relative h-[calc(100dvh-56px)] lg:h-dvh min-h-[500px] -mx-4 sm:-mx-6 lg:-mx-8 -mt-5 -mb-4 sm:-mb-6 lg:-mb-8 overflow-hidden",children:[t.jsx($t,{}),t.jsxs("div",{className:"absolute inset-0",children:[t.jsx(s,{className:"absolute inset-0",points:Xe,links:Je,...et,backgroundColor:U(),fitViewOnInit:!1,initialZoomLevel:10,simulationClusterStrength:.8,showLabels:He,showDynamicLabels:He,showTopLabels:He,showTopLabelsLimit:100,showHoveredPointLabel:!0,pointLabelFontSize:11,showClusterLabels:!1,onClick:Ct,onMouseMove:Nt,onMount:mt,onSimulationEnd:gt,renderHoveredPointRing:!0,hoveredPointRingColor:"#FBBF24",hoveredPointCursor:"pointer",pointGreyoutOpacity:.2,linkGreyoutOpacity:.15},dt),t.jsx(p,{children:xe&&t.jsx(g.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.15},className:"absolute top-4 left-1/2 -translate-x-1/2 z-30 w-80",children:t.jsxs("div",{className:"surface-elevated radius-inset shadow-2xl overflow-hidden",children:[t.jsxs("div",{className:"flex items-center gap-2 px-3 py-2.5 border-b border-border-subtle",children:[t.jsx(F,{className:"w-4 h-4 text-text-muted shrink-0"}),t.jsx("input",{ref:pe,type:"text",value:ue,onChange:e=>he(e.target.value),placeholder:"Search by name or prefix...",className:"flex-1 bg-transparent text-sm text-text-primary placeholder:text-text-muted focus:outline-none",onKeyDown:e=>{"Escape"===e.key?(me(!1),he("")):"Enter"===e.key&&yt.length>0&&vt(yt[0])}}),ue&&t.jsx("button",{onClick:()=>he(""),className:"p-0.5 radius-badge hover-bg transition-base",children:t.jsx(f,{className:"w-3 h-3 text-text-muted"})})]}),yt.length>0&&t.jsx("div",{className:"max-h-64 overflow-y-auto",children:yt.map((e,s)=>{const a=te[e.nodeClass];return t.jsxs("button",{onClick:()=>vt(e),className:"w-full flex items-center gap-3 px-3 py-2 text-left hover-bg transition-base "+(0===s?"bg-subtle-fill/50":""),children:[t.jsx("span",{className:"w-2.5 h-2.5 rounded-full shrink-0",style:{backgroundColor:Q[e.nodeClass]}}),t.jsx(a,{className:"w-3.5 h-3.5 text-text-muted shrink-0"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"text-sm text-text-primary truncate",children:e.name||e.prefix}),e.name&&t.jsx("div",{className:"text-[10px] text-text-muted",children:e.prefix})]}),t.jsx(D,{className:"w-3 h-3 text-text-muted shrink-0"})]},e.id)})}),ue&&0===yt.length&&t.jsx("div",{className:"px-3 py-4 text-center text-sm text-text-muted",children:"No nodes found"}),!ue&&t.jsx("div",{className:"px-3 py-2 type-data-xs text-text-muted",children:"Type to search • Enter to select • Esc to close"})]})})}),t.jsx(Bt,{}),t.jsxs(g.div,{className:"absolute right-4 z-10 hidden lg:flex items-center gap-3 type-data-xs text-text-muted/60",initial:!1,animate:{bottom:ae?280:16},transition:{type:"spring",stiffness:400,damping:30},children:[t.jsxs("span",{children:[t.jsx("kbd",{className:"px-1 py-0.5 radius-badge bg-subtle-fill/50 font-mono",children:"/"})," Search"]}),t.jsxs("span",{children:[t.jsx("kbd",{className:"px-1 py-0.5 radius-badge bg-subtle-fill/50 font-mono",children:"F"})," Fit"]}),t.jsxs("span",{children:[t.jsx("kbd",{className:"px-1 py-0.5 radius-badge bg-subtle-fill/50 font-mono",children:"Space"})," Pause"]}),t.jsxs("span",{children:[t.jsx("kbd",{className:"px-1 py-0.5 radius-badge bg-subtle-fill/50 font-mono",children:"Esc"})," Clear"]})]}),t.jsx(p,{children:ae&&t.jsx(ve,{node:ae,connections:Ve,onClose:()=>{var e;de.current=void 0,ce(null),null==(e=st.current)||e.unselectAllPoints()}})})]})]}):t.jsxs("div",{className:"relative h-[calc(100dvh-56px)] lg:h-dvh min-h-[500px] -mx-4 sm:-mx-6 lg:-mx-8 -mt-5 -mb-4 sm:-mb-6 lg:-mb-8 overflow-hidden",children:[t.jsx($t,{}),t.jsxs("div",{className:"absolute inset-0 bg-bg-body flex flex-col items-center justify-center gap-3",children:[t.jsx(L,{className:"w-8 h-8 text-accent-primary animate-spin"}),t.jsx("span",{className:"type-body text-text-muted",children:"Preparing graph..."})]})]}):t.jsxs("div",{className:"relative h-[calc(100dvh-56px)] lg:h-dvh min-h-[500px] -mx-4 sm:-mx-6 lg:-mx-8 -mt-5 -mb-4 sm:-mb-6 lg:-mb-8 overflow-hidden",children:[t.jsx($t,{}),t.jsxs("div",{className:"absolute inset-0 bg-bg-body flex items-center justify-center",children:[t.jsx(N,{isOpen:P,currentStep:$,packetCount:R}),!P&&t.jsx(L,{className:"w-8 h-8 text-accent-primary animate-spin"})]})]})}export{we as default};
