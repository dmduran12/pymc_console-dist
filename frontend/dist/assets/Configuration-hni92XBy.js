import{r as e,j as t,c as a}from"./vendor-react-j_fHog8x.js";import{c as s,Y as l,k as n,a4 as r,X as i,cC as c,cD as o,cE as d,T as u,cF as m,a$ as x,aE as p,bE as h,cG as y,cH as b,cI as f,cJ as g,R as j,B as v,cK as N,I as k}from"./index-D2kasICP.js";import{g as w,c as C,r as S,s as _,a as F,u as T,d as E}from"./system-C49CUlZI.js";import{T as P,P as M,C as z}from"./ConfirmModal-BQ5EKSgN.js";import{l as R}from"./font-loader-BQzEmDrZ.js";import{M as D,S as A}from"./sun-BxtwlvF-.js";import{N as I}from"./NodeInformationCard-Cw4QMD4D.js";import{i as L,g as K,s as V,a as H,k as q}from"./keycap-sfx-CAsrNe23.js";import{a as O,P as $,b as B,B as X}from"./PageLayout-BfBDoTq2.js";import{C as G}from"./Card-CRBu83RM.js";import{R as J,C as U}from"./Grid-OFJ4oe0a.js";import{K as Y}from"./key-round-BXdWb403.js";import{C as W}from"./circle-check-BMomLE9u.js";import{T as Q}from"./triangle-alert-Dwx2ngba.js";import{R as Z}from"./refresh-cw-B_LAzaHh.js";import{C as ee}from"./copy-B1mGiPO3.js";import{C as te}from"./chevron-right-B2UT4sUK.js";import"./maplibre-gl-b91ci4Kr.js";import"./vendor-core-CmkNwW1A.js";import"./DataBox-RRlaLll7.js";const ae=s("antenna",[["path",{d:"M2 12 7 2",key:"117k30"}],["path",{d:"m7 12 5-10",key:"1tvx22"}],["path",{d:"m12 12 5-10",key:"ev1o1a"}],["path",{d:"m17 12 5-10",key:"1e4ti3"}],["path",{d:"M4.5 7h15",key:"vlsxkz"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]),se=s("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),le=s("folder-key",[["circle",{cx:"16",cy:"20",r:"2",key:"1vifvg"}],["path",{d:"M10 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v2",key:"3hgo9p"}],["path",{d:"m22 14-4.5 4.5",key:"1ef6z8"}],["path",{d:"m21 15 1 1",key:"1ejcpy"}]]),ne=s("folder-lock",[["rect",{width:"8",height:"5",x:"14",y:"17",rx:"1",key:"19aais"}],["path",{d:"M10 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v2.5",key:"1w6v7t"}],["path",{d:"M20 17v-2a2 2 0 1 0-4 0v2",key:"pwaxnr"}]]),re=s("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),ie=s("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),ce=s("triangle-dashed",[["path",{d:"M10.17 4.193a2 2 0 0 1 3.666.013",key:"pltmmw"}],["path",{d:"M14 21h2",key:"v4qezv"}],["path",{d:"m15.874 7.743 1 1.732",key:"10m0iw"}],["path",{d:"m18.849 12.952 1 1.732",key:"zadnam"}],["path",{d:"M21.824 18.18a2 2 0 0 1-1.835 2.824",key:"fvwuk4"}],["path",{d:"M4.024 21a2 2 0 0 1-1.839-2.839",key:"1e1kah"}],["path",{d:"m5.136 12.952-1 1.732",key:"1u4ldi"}],["path",{d:"M8 21h2",key:"i9zjee"}],["path",{d:"m8.102 7.743-1 1.732",key:"1zzo4u"}]]),oe=s("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),de=1500,ue="h-[38px]",me="h-[32px]",xe="px-3",pe="px-2.5",he="rounded-lg";function ye({label:s,value:i,editValue:c,onSave:o,type:d="text",suffix:u,placeholder:m,readOnly:x=!1,layout:p="stacked",min:h,max:y,step:b,maxLength:f,description:g,className:j}){const[v,N]=e.useState(!1),[k,w]=e.useState(""),[C,S]=e.useState("idle"),_=e.useRef(null),F=e.useRef(!0),T=e.useRef(null),E=!x&&!!o;e.useEffect(()=>(F.current=!0,()=>{F.current=!1,T.current&&clearTimeout(T.current)}),[]);const P=e.useCallback(()=>{E&&(w(c??i),N(!0),S("idle"),requestAnimationFrame(()=>{var e;return null==(e=_.current)?void 0:e.select()}))},[E,c,i]),M=e.useCallback(()=>{N(!1),w(""),S("idle")},[]),z=e.useCallback(async()=>{if(o&&"loading"!==C)if(k!==(c??i)){T.current&&clearTimeout(T.current),S("loading");try{if(await o(k),!F.current)return;S("success"),N(!1),T.current=setTimeout(()=>{F.current&&S("idle")},de)}catch{if(!F.current)return;S("error"),T.current=setTimeout(()=>{F.current&&S("idle")},de)}}else M()},[o,k,c,i,M,C]),R=e.useCallback(e=>{"Enter"===e.key?(e.preventDefault(),z()):"Escape"===e.key&&(e.preventDefault(),M())},[z,M]);return"inline"===p?t.jsxs("div",{className:a("group flex items-center justify-between",j),children:[t.jsx("label",{className:"type-label text-text-muted shrink-0",children:s}),v?t.jsxs("div",{className:a(me,he,pe,"flex items-center transition-all","bg-transparent border border-accent-primary/50 ring-1 ring-accent-primary/20","min-w-[100px]"),children:[t.jsx("input",{ref:_,type:d,value:k,onChange:e=>w(e.target.value),onKeyDown:R,placeholder:m,min:h,max:y,step:b,maxLength:f,disabled:"loading"===C,className:a("bg-transparent text-text-primary focus:outline-none type-data flex-1 min-w-0",u?"w-12 text-right":"w-full")}),u&&t.jsx("span",{className:"text-text-muted type-data ml-1 shrink-0",children:u}),t.jsx("div",{className:"flex items-center gap-0.5 ml-2 shrink-0",children:"loading"===C?t.jsx(l,{className:"w-3.5 h-3.5 text-text-muted animate-spin"}):t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:z,className:"p-0.5 rounded hover:bg-accent-success/15 text-accent-success transition-colors",title:"Save (Enter)",children:t.jsx(n,{className:"w-3 h-3"})}),t.jsx("button",{onClick:M,className:"p-0.5 rounded hover:bg-accent-danger/15 text-text-muted hover:text-accent-danger transition-colors",title:"Cancel (Esc)",children:t.jsx(r,{className:"w-3 h-3"})})]})})]}):t.jsxs("div",{className:a(me,he,pe,"flex items-center justify-end transition-all min-w-[80px]","bg-input-bg border border-input-border",E&&"cursor-pointer hover:border-border-strong"),onClick:E?P:void 0,children:[t.jsx("span",{className:"type-data text-text-primary",children:i}),"success"===C&&t.jsx(n,{className:"w-3 h-3 text-accent-success ml-1.5 shrink-0"}),"error"===C&&t.jsx(r,{className:"w-3 h-3 text-accent-danger ml-1.5 shrink-0"}),"idle"===C&&E&&t.jsx(ie,{className:"w-3 h-3 text-text-muted ml-1.5 opacity-0 group-hover:opacity-100 transition-opacity shrink-0"})]})]}):t.jsxs("div",{className:a("group",j),children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:s}),v?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:a(ue,he,xe,"flex items-center transition-all","bg-transparent border border-accent-primary/50 ring-1 ring-accent-primary/20"),children:[t.jsx("input",{ref:_,type:d,value:k,onChange:e=>w(e.target.value),onKeyDown:R,placeholder:m,min:h,max:y,step:b,maxLength:f,disabled:"loading"===C,className:"w-full bg-transparent text-text-primary focus:outline-none type-data flex-1 min-w-0"}),u&&t.jsx("span",{className:"text-text-muted type-data ml-1 shrink-0",children:u}),t.jsx("div",{className:"flex items-center gap-0.5 ml-2 shrink-0",children:"loading"===C?t.jsx(l,{className:"w-3.5 h-3.5 text-text-muted animate-spin"}):t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:z,className:"p-1 rounded hover:bg-accent-success/15 text-accent-success transition-colors",title:"Save (Enter)",children:t.jsx(n,{className:"w-3.5 h-3.5"})}),t.jsx("button",{onClick:M,className:"p-1 rounded hover:bg-accent-danger/15 text-text-muted hover:text-accent-danger transition-colors",title:"Cancel (Esc)",children:t.jsx(r,{className:"w-3.5 h-3.5"})})]})})]}),g&&t.jsx("p",{className:"type-data-xs text-text-muted mt-1 ml-3",children:g})]}):t.jsxs("div",{className:a(ue,he,xe,"flex items-center transition-all","bg-input-bg border border-input-border",E&&"cursor-pointer hover:border-border-strong"),onClick:E?P:void 0,children:[t.jsx("span",{className:"type-data text-text-primary flex-1",children:i}),"success"===C&&t.jsx(n,{className:"w-3.5 h-3.5 text-accent-success shrink-0"}),"error"===C&&t.jsx(r,{className:"w-3.5 h-3.5 text-accent-danger shrink-0"}),"idle"===C&&E&&t.jsx(ie,{className:"w-3.5 h-3.5 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity shrink-0"})]})]})}function be({label:s,value:c,editValue:o,options:d,onSave:u,readOnly:m=!1,layout:x="stacked",className:p}){const[h,y]=e.useState(!1),[b,f]=e.useState(""),[g,j]=e.useState("idle"),v=e.useRef(null),N=e.useRef(!0),k=e.useRef(null),w=!m&&!!u;e.useEffect(()=>(N.current=!0,()=>{N.current=!1,k.current&&clearTimeout(k.current)}),[]);const C=e.useCallback(()=>{w&&(f(String(o)),y(!0),j("idle"),requestAnimationFrame(()=>{var e;return null==(e=v.current)?void 0:e.focus()}))},[w,o]),S=e.useCallback(()=>{y(!1),f(""),j("idle")},[]),_=e.useCallback(async()=>{if(u&&"loading"!==g)if(b!==String(o)){k.current&&clearTimeout(k.current),j("loading");try{if(await u(b),!N.current)return;j("success"),y(!1),k.current=setTimeout(()=>{N.current&&j("idle")},de)}catch{if(!N.current)return;j("error"),k.current=setTimeout(()=>{N.current&&j("idle")},de)}}else S()},[u,b,o,S,g]),F=e.useCallback(e=>{"Escape"===e.key&&(e.preventDefault(),S())},[S]),T="inline"===x,E=T?me:ue,P=T?pe:xe,M=t.jsxs("div",{className:a(E,he,P,"flex items-center transition-all relative","bg-transparent border border-accent-primary/50 ring-1 ring-accent-primary/20",T&&"min-w-[100px]"),children:[t.jsx("select",{ref:v,value:b,onChange:e=>f(e.target.value),onKeyDown:F,disabled:"loading"===g,className:a("bg-transparent text-text-primary focus:outline-none appearance-none cursor-pointer type-data flex-1 min-w-0","pr-6"),children:d.map(e=>t.jsx("option",{value:e.value,children:e.label},String(e.value)))}),t.jsx(i,{className:"absolute right-auto w-3.5 h-3.5 text-text-muted pointer-events-none",style:{right:"loading"===g?"2rem":"3.5rem"}}),t.jsx("div",{className:"flex items-center gap-0.5 ml-1 shrink-0",children:"loading"===g?t.jsx(l,{className:a("text-text-muted animate-spin",T?"w-3 h-3":"w-3.5 h-3.5")}):t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:_,className:a("rounded hover:bg-accent-success/15 text-accent-success transition-colors",T?"p-0.5":"p-1"),title:"Save",children:t.jsx(n,{className:T?"w-3 h-3":"w-3.5 h-3.5"})}),t.jsx("button",{onClick:S,className:a("rounded hover:bg-accent-danger/15 text-text-muted hover:text-accent-danger transition-colors",T?"p-0.5":"p-1"),title:"Cancel (Esc)",children:t.jsx(r,{className:T?"w-3 h-3":"w-3.5 h-3.5"})})]})})]}),z=t.jsxs("div",{className:a(E,he,P,"flex items-center transition-all","bg-input-bg border border-input-border",w&&"cursor-pointer hover:border-border-strong",T?"justify-end min-w-[80px]":""),onClick:w?C:void 0,children:[t.jsx("span",{className:a("type-data text-text-primary",!T&&"flex-1"),children:c}),"success"===g&&t.jsx(n,{className:a("text-accent-success shrink-0",T?"w-3 h-3 ml-1.5":"w-3.5 h-3.5")}),"error"===g&&t.jsx(r,{className:a("text-accent-danger shrink-0",T?"w-3 h-3 ml-1.5":"w-3.5 h-3.5")}),"idle"===g&&w&&t.jsx(i,{className:a("text-text-muted opacity-0 group-hover:opacity-100 transition-opacity shrink-0",T?"w-3 h-3 ml-1.5":"w-3.5 h-3.5")})]});return T?t.jsxs("div",{className:a("group flex items-center justify-between",p),children:[t.jsx("label",{className:"type-label text-text-muted shrink-0",children:s}),h?M:z]}):t.jsxs("div",{className:a("group",p),children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:s}),h?M:z]})}async function fe(e){return c("/api/update_web_config",{method:"POST",body:JSON.stringify(e)})}e.memo(function(){const{theme:e}=o(),{themeId:a}=e,s=d.find(e=>e.meta.id===a)??d[0];return t.jsx("div",{className:"h-10 flex items-center justify-center",children:t.jsx("span",{className:"font-medium transition-all duration-300 leading-none text-center text-text-secondary",style:{fontFamily:"Inter, system-ui, sans-serif",fontSize:"clamp(0.75rem, 0.6rem + 1.5vw, 1.1rem)",letterSpacing:"-0.02em"},children:s.meta.name})})});const ge=e.memo(function({compact:e=!1}){const{theme:s,setTheme:l}=o(),{themeId:n}=s;return t.jsx("div",{className:a("grid grid-cols-2 gap-2",e?"w-full min-w-0 self-stretch":"w-full"),children:[...d].reverse().map(s=>{const r=n===s.meta.id,i=s.meta.isDark;return t.jsxs("button",{type:"button",title:s.meta.name,className:a("flex flex-row items-stretch radius-inner transition-all duration-200 ease-out overflow-hidden cursor-pointer",e&&"h-6",r?"ring-2 ring-accent-primary scale-[1.02]":"opacity-70 hover:opacity-100"),onClick:()=>l(s.meta.id),children:[t.jsx("div",{className:a("flex-1 h-full",i?"bg-[#18181b]":"bg-[#EFF0F1]")}),t.jsx("div",{className:"flex flex-col h-full",children:s.display.palette.map((e,a)=>t.jsx("div",{className:"flex flex-1",children:e.map((e,a)=>t.jsx("div",{className:"w-2 h-full",style:{backgroundColor:e}},a))},a))})]},s.meta.id)})})}),je=e.memo(function(){const{theme:a,setTheme:s}=o(),{themeId:l}=a,n="breeze dark"===l,r=e.useCallback(e=>{s(e?"breeze dark":"breeze light")},[s]);return t.jsx(u,{enabled:n,onChange:r,label:t.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[n?t.jsx(D,{className:"w-3.5 h-3.5 text-accent-primary"}):t.jsx(A,{className:"w-3.5 h-3.5 text-[#e8a517]"}),"Dark Mode"]}),tooltip:"Switch between Breeze Dark and Breeze Light themes",size:"md"})}),ve=e.memo(function({layout:a="horizontal"}){return e.useEffect(()=>{R()},[]),"toggle-only"===a?t.jsx(je,{}):"thumbnails-only"===a?t.jsx(ge,{}):"vertical"===a?t.jsxs("div",{className:"flex flex-col items-start gap-3",children:[t.jsx(je,{}),t.jsx(ge,{})]}):t.jsxs("div",{className:"flex items-stretch gap-4",children:[t.jsx("div",{className:"flex-shrink-0 flex items-start",children:t.jsx(je,{})}),t.jsx(ge,{compact:!0})]})}),Ne=2e3;function ke(t,a,s){const[l,n]=e.useState("idle"),[r,i]=e.useState(null),c=e.useRef(!0),o=e.useRef(null),d=e.useRef(null),u=e.useRef(!1),m=e.useRef("idle"),x=e.useRef(t),p=e.useRef(a),h=e.useRef(s);return m.current=l,x.current=t,p.current=a,h.current=s,e.useEffect(()=>(c.current=!0,()=>{c.current=!1,o.current&&clearTimeout(o.current),d.current&&clearTimeout(d.current)}),[]),{enabled:null!==r?r:t,status:l,toggle:e.useCallback(async e=>{if("loading"===m.current)return;const t=x.current;o.current&&clearTimeout(o.current),d.current&&clearTimeout(d.current),u.current=!1,i(e),n("loading"),o.current=setTimeout(()=>{!u.current&&c.current&&(i(t),n("error"),d.current=setTimeout(()=>{c.current&&(n("idle"),i(null))},Ne))},1e4);try{if(await p.current(e),u.current=!0,o.current&&clearTimeout(o.current),!c.current)return;n("success"),d.current=setTimeout(()=>{var e;c.current&&(n("idle"),i(null),null==(e=h.current)||e.call(h))},Ne)}catch{if(u.current=!0,o.current&&clearTimeout(o.current),!c.current)return;i(t),n("error"),d.current=setTimeout(()=>{c.current&&(n("idle"),i(null))},Ne)}},[])}}function we(){const{latitude:s,longitude:i,enabled:c,setLocation:o,enable:d,disable:u,clear:p}=m(),[h,y]=e.useState(!1),[b,f]=e.useState(""),[g,j]=e.useState(""),[v,N]=e.useState("idle"),[k,w]=e.useState(null),C=e.useRef(null),S=e.useRef(null),_=e.useRef(!0);e.useEffect(()=>(_.current=!0,()=>{_.current=!1,S.current&&clearTimeout(S.current)}),[]);const F=()=>{y(!1),w(null)};e.useEffect(()=>{if(!h)return;const e=e=>{"loading"!==v&&C.current&&!C.current.contains(e.target)&&F()};return document.addEventListener("mouseup",e),()=>document.removeEventListener("mouseup",e)},[h,v]);const T=null!==s&&null!==i;return t.jsx(O,{children:t.jsxs("div",{ref:C,children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx(G,{icon:t.jsx(ce,{}),title:"Stealth"}),t.jsxs("div",{className:"flex items-center gap-1",children:[T&&!h&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>{c?u():d()},className:a("relative inline-flex h-6 w-11 items-center rounded-full transition-colors border-2 mr-2",c?"bg-toggle-on border-toggle-on":"bg-toggle-off border-border-subtle"),title:c?"Disable stealth location":"Enable stealth location",children:t.jsx("span",{className:a("inline-block h-4 w-4 transform rounded-full bg-white transition-transform shadow-lg",c?"translate-x-5":"translate-x-0.5")})}),t.jsx("button",{onClick:()=>{p(),y(!1)},className:"p-2 rounded-lg transition-colors text-text-muted hover:text-accent-danger hover:bg-accent-danger/10",title:"Clear stealth location",children:t.jsx(P,{className:"w-4 h-4"})})]}),h?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:F,disabled:"loading"===v,className:a("p-2 rounded-lg transition-colors","loading"===v?"text-text-muted cursor-not-allowed":"text-text-muted hover:text-accent-danger hover:bg-accent-danger/10"),title:"Cancel",children:t.jsx(r,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>{if("loading"===v)return;S.current&&clearTimeout(S.current);const e=((e,t)=>{const a=parseFloat(e),s=parseFloat(t);return isNaN(a)||isNaN(s)?"Please enter valid numbers":a<-90||a>90?"Latitude must be between -90 and 90":s<-180||s>180?"Longitude must be between -180 and 180":0===a&&0===s?"Coordinates (0, 0) are invalid":null})(b,g);if(e)return void w(e);N("loading"),w(null);const t=parseFloat(b),a=parseFloat(g);o(t,a),c||d(),N("success"),S.current=setTimeout(()=>{_.current&&(N("idle"),y(!1))},1e3)},disabled:"loading"===v,className:a("p-2 rounded-lg transition-colors","loading"===v?"text-accent-primary cursor-wait":"success"===v?"text-accent-success":"error"===v?"text-accent-danger":"text-accent-success hover:bg-accent-success/10"),title:"Save",children:"loading"===v?t.jsx(l,{className:"w-4 h-4 animate-spin"}):"success"===v?t.jsx(n,{className:"w-4 h-4"}):"error"===v?t.jsx(r,{className:"w-4 h-4"}):t.jsx(n,{className:"w-4 h-4"})})]}):t.jsx("button",{onClick:()=>{f((null==s?void 0:s.toFixed(6))??""),j((null==i?void 0:i.toFixed(6))??""),w(null),y(!0)},className:"p-2 rounded-lg transition-colors text-text-muted hover:text-text-primary hover:bg-bg-subtle",title:T?"Edit stealth location":"Set stealth location",children:t.jsx(ie,{className:"w-4 h-4"})})]})]}),t.jsx("div",{className:"bg-accent-tertiary/5 rounded-xl p-3 mb-4",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(x,{className:"w-4 h-4 text-accent-tertiary flex-shrink-0 mt-0.5"}),t.jsxs("p",{className:"type-body-sm text-text-muted",children:[t.jsx("span",{className:"text-text-secondary",children:"Stealth mode"})," allows you to appear on the map and in topology analysis without broadcasting your location. Coordinates are stored locally in your browser only — ",t.jsx("span",{className:"text-accent-tertiary",children:"never sent to config.yaml or the mesh"}),"."]})]})}),k&&t.jsx("div",{className:"text-xs mb-3 px-2 py-1.5 rounded-md text-accent-danger bg-accent-danger/10",children:k}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:h?"Latitude (°)":"Latitude"}),t.jsx("div",{className:a("h-[38px] rounded-full px-4 flex items-center transition-colors","bg-subtle-fill"),children:h?t.jsx("input",{type:"number",value:b,onChange:e=>f(e.target.value),step:"0.000001",min:"-90",max:"90",placeholder:"e.g. 34.052234",className:"w-full bg-transparent text-text-primary focus:outline-none type-data placeholder:text-text-muted/50"}):t.jsx("span",{className:a("type-data",T&&c?"text-text-primary":"text-text-muted"),children:T?s.toFixed(6):"Not set"})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-1",children:h?"Longitude (°)":"Longitude"}),t.jsx("div",{className:a("h-[38px] rounded-full px-4 flex items-center transition-colors","bg-subtle-fill"),children:h?t.jsx("input",{type:"number",value:g,onChange:e=>j(e.target.value),step:"0.000001",min:"-180",max:"180",placeholder:"e.g. -118.243685",className:"w-full bg-transparent text-text-primary focus:outline-none type-data placeholder:text-text-muted/50"}):t.jsx("span",{className:a("type-data",T&&c?"text-text-primary":"text-text-muted"),children:T?i.toFixed(6):"Not set"})})]})]}),T&&!h&&t.jsx("div",{className:"mt-3 pt-3 border-t border-border-subtle",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:a("w-2 h-2 rounded-full",c?"bg-accent-success":"bg-text-muted")}),t.jsx("span",{className:"type-body-sm text-text-muted",children:c?"Stealth location active — you appear on maps with these coordinates":"Stealth location disabled — coordinates saved but not in use"})]})})]})})}const Ce=[{value:7.8,label:"7.8 kHz"},{value:10.4,label:"10.4 kHz"},{value:15.6,label:"15.6 kHz"},{value:20.8,label:"20.8 kHz"},{value:31.25,label:"31.25 kHz"},{value:41.7,label:"41.7 kHz"},{value:62.5,label:"62.5 kHz"},{value:125,label:"125 kHz"},{value:250,label:"250 kHz"},{value:500,label:"500 kHz"}],Se=[5,6,7,8,9,10,11,12],_e=[{value:5,label:"4/5"},{value:6,label:"4/6"},{value:7,label:"4/7"},{value:8,label:"4/8"}],Fe="radioConfig";function Te({node:e,level:s,expandedKeys:l,selectedKeyId:n,globalFloodPolicy:r,onSelect:i,onToggle:c}){const o=l.has(e.id),d=n===e.id,u=e.children&&e.children.length>0,m="allow"===r;return t.jsxs("div",{children:[t.jsxs("div",{className:a("flex items-center gap-2 h-[36px] px-3 rounded-full cursor-pointer transition-colors",d?"bg-accent-primary/15":"hover:bg-subtle-fill",m&&"opacity-50 cursor-not-allowed"),style:{marginLeft:16*s+"px"},onClick:()=>!m&&i(e.id),children:[u?t.jsx("button",{onClick:t=>{t.stopPropagation(),c(e.id)},className:"p-1 hover:bg-subtle-fill-hover rounded-full transition-colors",children:t.jsx(te,{className:a("w-3.5 h-3.5 text-text-muted transition-transform",o&&"rotate-90")})}):t.jsx("span",{className:"w-5"}),t.jsx(le,{className:"w-4 h-4 text-accent-primary flex-shrink-0"}),t.jsx("span",{className:"type-data text-text-primary flex-1 truncate",children:e.name}),t.jsx("span",{className:a("type-data-xs px-2 py-0.5 rounded-full","allow"===e.floodPolicy?"bg-accent-success/15 text-accent-success":"bg-accent-danger/15 text-accent-danger"),children:"allow"===e.floodPolicy?"Allow":"Deny"})]}),u&&o&&t.jsx("div",{children:e.children.map(e=>t.jsx(Te,{node:e,level:s+1,expandedKeys:l,selectedKeyId:n,globalFloodPolicy:r,onSelect:i,onToggle:c},e.id))})]})}function Ee(){const[s,l]=e.useState(L),[n,r]=e.useState(K),[i,c]=e.useState(!1),o=e.useCallback(e=>{l(e),V(e)},[]),d=e.useCallback(e=>{const t=parseFloat(e.target.value);r(t),H(t)},[]),m=e.useCallback(async()=>{i||(c(!0),await q(),c(!1))},[i]);return t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2 text-text-muted mb-1",children:[t.jsx(oe,{className:"w-3.5 h-3.5"}),t.jsx("span",{className:"type-label",children:"Sound"})]}),t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsx(u,{enabled:s,onChange:o,label:"Key Sounds",tooltip:"Keycap press & release SFX",size:"md"}),t.jsx(v,{color:"primary",outline:!0,onClick:m,disabled:!s||i,children:i?"Playing…":"Test"})]}),t.jsxs("div",{className:a("flex items-center gap-3",!s&&"opacity-40 pointer-events-none"),children:[t.jsx("span",{className:"type-label text-text-muted w-14 shrink-0",children:"Volume"}),t.jsx("input",{type:"range",min:0,max:1,step:.05,value:n,onChange:d,className:"flex-1 accent-accent-primary h-1.5 cursor-pointer"}),t.jsxs("span",{className:"type-data-xs text-text-muted w-10 text-right",children:[Math.round(100*n),"%"]})]})]})}function Pe(){var s,r,i,o,d,m;const{stats:R,setMode:D,clearModeMutation:A,setDutyCycleConfig:L,clearDutyCycleMutation:K,fetchStats:V,startMutation:H,clearMutation:q}=p(),te=null==(s=null==R?void 0:R.config)?void 0:s.radio,le=null==(r=null==R?void 0:R.config)?void 0:r.repeater,ie=null==(i=null==R?void 0:R.config)?void 0:i.duty_cycle,ce=(null==R?void 0:R.node_name)||(null==(o=null==R?void 0:R.config)?void 0:o.node_name)||"Unknown Node",oe=(null==le?void 0:le.mode)??"forward",de=(null==ie?void 0:ie.enforcement_enabled)??!1,ue=null==(d=null==R?void 0:R.config)?void 0:d.delays,me=e.useRef(!0);e.useEffect(()=>(me.current=!0,()=>{me.current=!1}),[]);const xe=null==(m=null==R?void 0:R.config)?void 0:m.web,[pe,he]=e.useState([]),[ge,je]=e.useState(!1),[Ne,Pe]=e.useState(null),[Me,ze]=e.useState(!1),[Re,De]=e.useState(""),[Ae,Ie]=e.useState(null),[Le,Ke]=e.useState(!1),[Ve,He]=e.useState(null),[qe,Oe]=e.useState(!1),[$e,Be]=e.useState(!1),[Xe,Ge]=e.useState(!1),[Je,Ue]=e.useState([]),[Ye,We]=e.useState(!1),[Qe,Ze]=e.useState(null),[et,tt]=e.useState("deny"),[at,st]=e.useState(!1),[lt,nt]=e.useState(null),[rt,it]=e.useState(new Set),[ct,ot]=e.useState(!1),[dt,ut]=e.useState(!1),[mt,xt]=e.useState(!1),[pt,ht]=e.useState(null),[yt,bt]=e.useState(null),[ft,gt]=e.useState(""),[jt,vt]=e.useState("deny"),[Nt,kt]=e.useState(!1),[wt,Ct]=e.useState(!0),[St,_t]=e.useState(!1),[Ft,Tt]=e.useState(!0),[Et,Pt]=e.useState("idle"),[Mt,zt]=e.useState(!1),[Rt,Dt]=e.useState(!1),At=e.useCallback(()=>{const e=null==ue?void 0:ue.tx_delay_factor;return e&&"object"==typeof e&&"parsedValue"in e?e.parsedValue??1:"number"==typeof e?e:1},[ue]),It=e.useCallback(()=>{const e=null==ue?void 0:ue.direct_tx_delay_factor;return"number"==typeof e?e:.5},[ue]),Lt=e.useCallback(()=>{const e=null==ie?void 0:ie.max_airtime_percent;return"number"==typeof e?e:e&&"object"==typeof e&&"parsedValue"in e?e.parsedValue??6:6},[ie]),Kt=ke("forward"===oe,async e=>{await D(e?"forward":"monitor")},A),Vt=ke(de,async e=>{await L({max_airtime_percent:Lt(),enforcement_enabled:e})},K),Ht=ke((null==xe?void 0:xe.cors_enabled)??!1,async e=>{var t;const a=await fe({web:{cors_enabled:e}});if(!a.success&&!(null==(t=a.data)?void 0:t.persisted))throw new Error("CORS update failed");await V()}),qt=e.useCallback(async e=>{H(Fe);try{const t=await h(e);if(!t.success)throw new Error(t.error||"Failed to save");await V({force:!0}).catch(()=>{})}finally{q(Fe)}},[H,q,V]);e.useEffect(()=>{(async()=>{Tt(!0);try{const e=await C();e.success&&e.data?_t(e.data.exists):_t(!1);const t=null==xe?void 0:xe.web_path;Ct(!t||""===t)}catch{_t(!1)}finally{Tt(!1)}})()},[null==xe?void 0:xe.web_path]);const Ot=async e=>{var t;if("loading"!==Et){Pt("loading");try{const a=await fe({web:{web_path:e?null:"/opt/pymc_console/web/html"}});if(!me.current)return;a.success||(null==(t=a.data)?void 0:t.persisted)?(Ct(e),Pt("success"),zt(!0),setTimeout(()=>{me.current&&Pt("idle")},2e3)):(Pt("error"),setTimeout(()=>{me.current&&Pt("idle")},2e3))}catch{if(!me.current)return;Pt("error"),setTimeout(()=>{me.current&&Pt("idle")},2e3)}}},$t=e.useCallback(async()=>{je(!0),Pe(null);try{const e=await async function(){return c("/auth/tokens")}();he(e.tokens||[])}catch(e){Pe(e instanceof Error?e.message:"Failed to fetch tokens")}finally{je(!1)}},[]);e.useEffect(()=>{$t()},[$t]);const Bt=async()=>{if(Re.trim()){Oe(!0),Pe(null);try{const e=await async function(e){return c("/auth/tokens",{method:"POST",body:JSON.stringify({name:e})})}(Re.trim());Ie(e.token||null),ze(!1),Ke(!0),De(""),await $t()}catch(e){Pe(e instanceof Error?e.message:"Failed to create token")}finally{Oe(!1)}}else Pe("Token name is required")},Xt=e=>e?new Date(1e3*e).toLocaleString():"Never",Gt=e.useCallback(e=>{const t=new Map,a=[];return e.forEach(e=>{const a={id:e.id,name:e.name,floodPolicy:e.flood_policy,transport_key:e.transport_key,last_used:e.last_used,parent_id:e.parent_id,children:[]};t.set(e.id,a)}),t.forEach(e=>{e.parent_id&&t.has(e.parent_id)?t.get(e.parent_id).children.push(e):a.push(e)}),a},[]),Jt=e.useCallback(async()=>{We(!0),Ze(null);try{const e=await w();e.success&&e.data?Ue(Gt(e.data)):Ze(e.error||"Failed to load transport keys")}catch(e){Ze(e instanceof Error?e.message:"Unknown error occurred")}finally{We(!1)}},[Gt]);e.useEffect(()=>{Jt()},[Jt]);const Ut=e.useCallback((e,t)=>{for(const a of e){if(a.id===t)return a;if(a.children){const e=Ut(a.children,t);if(e)return e}}return null},[]),Yt=e.useCallback(()=>{if(!lt)return;const e=Ut(Je,lt);return null==e?void 0:e.name},[lt,Je,Ut]),Wt=e.useCallback(e=>{it(t=>{const a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},[]),Qt=async()=>{if(ft.trim()){kt(!0),Ze(null);try{const e=await F({name:ft.trim(),flood_policy:jt,parent_id:lt??void 0});e.success?(await Jt(),ot(!1),gt(""),vt("deny")):Ze(e.error||"Failed to add transport key")}catch(e){Ze(e instanceof Error?e.message:"Failed to add transport key")}finally{kt(!1)}}else Ze("Key name is required")},Zt=e.useCallback(()=>{if(!lt)return;const e=Ut(Je,lt);e&&(ht({...e}),ut(!0))},[lt,Je,Ut]);e.useEffect(()=>{const e=e=>{"Escape"===e.key&&(ct&&(ot(!1),gt(""),vt("deny")),dt&&(ut(!1),ht(null)),mt&&(xt(!1),bt(null)),Me&&(ze(!1),De("")),Le&&(Ke(!1),Ie(null)))};if(ct||dt||mt||Me||Le)return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[ct,dt,mt,Me,Le]);const ea=e.useCallback(()=>{if(!lt)return;const e=Ut(Je,lt);e&&(bt(e),xt(!0))},[lt,Je,Ut]);return t.jsxs($,{children:[t.jsx(B,{title:"Configuration",icon:t.jsx(y,{})}),t.jsxs(X,{children:[t.jsxs(J,{template:"standard",children:[t.jsx(U,{span:12,md:6,children:t.jsxs(O,{neomorphic:!0,children:[t.jsx(G,{icon:t.jsx(b,{}),title:"Repeater Settings"}),le?t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx("div",{className:"col-span-2",children:t.jsx(ye,{label:"Node Name",value:ce,onSave:async e=>qt({node_name:e}),placeholder:"Enter node name",maxLength:50})}),t.jsx(ye,{label:"Latitude",value:0!==le.latitude?le.latitude.toFixed(6):"Not set",editValue:String(le.latitude),type:"number",suffix:"°",step:1e-6,min:-90,max:90,onSave:async e=>qt({latitude:parseFloat(e)})}),t.jsx(ye,{label:"Longitude",value:0!==le.longitude?le.longitude.toFixed(6):"Not set",editValue:String(le.longitude),type:"number",suffix:"°",step:1e-6,min:-180,max:180,onSave:async e=>qt({longitude:parseFloat(e)})}),t.jsx(ye,{label:"Advert Interval",value:le.send_advert_interval_hours>0?`${le.send_advert_interval_hours}h`:"Disabled",editValue:String(le.send_advert_interval_hours),type:"number",suffix:"hours",min:0,max:48,description:"0 = disabled, 3-48 hours",onSave:async e=>qt({flood_advert_interval_hours:parseInt(e,10)})}),t.jsx(ye,{label:"Score-based TX",value:le.use_score_for_tx?"Enabled":"Disabled",readOnly:!0})]}):t.jsx("p",{className:"text-text-muted",children:"Loading repeater settings..."})]})}),t.jsx(U,{span:12,md:6,children:t.jsxs(O,{neomorphic:!0,children:[t.jsx(G,{icon:t.jsx(ae,{}),title:"Radio Configuration"}),te?t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(ye,{label:"Frequency",value:f(te.frequency),editValue:(te.frequency/1e6).toFixed(3),type:"number",suffix:"MHz",step:.001,min:400,max:930,onSave:async e=>qt({frequency_mhz:parseFloat(e)})}),t.jsx(ye,{label:"TX Power",value:`${te.tx_power} dBm`,editValue:String(te.tx_power),type:"number",suffix:"dBm",min:2,max:30,onSave:async e=>qt({tx_power:parseInt(e,10)})}),t.jsx(be,{label:"Bandwidth",value:g(te.bandwidth),editValue:te.bandwidth/1e3,options:Ce,onSave:async e=>qt({bandwidth_khz:parseFloat(e)})}),t.jsx(be,{label:"Spreading Factor",value:`SF${te.spreading_factor}`,editValue:te.spreading_factor,options:Se.map(e=>({value:e,label:`SF${e}`})),onSave:async e=>qt({spreading_factor:parseInt(e,10)})}),t.jsx(be,{label:"Coding Rate",value:`4/${te.coding_rate}`,editValue:te.coding_rate,options:_e,onSave:async e=>qt({coding_rate:parseInt(e,10)})}),t.jsx(ye,{label:"Preamble",value:`${te.preamble_length} symbols`,readOnly:!0})]}):t.jsx("p",{className:"text-text-muted",children:"Loading radio configuration..."})]})})]}),t.jsxs(J,{template:"standard",children:[t.jsx(U,{span:12,md:6,children:t.jsxs(O,{neomorphic:!0,children:[t.jsx(G,{icon:t.jsx(j,{}),title:"Operating Mode"}),t.jsx("p",{className:"type-label text-text-muted mb-3",children:"Control how the repeater handles packets"}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[t.jsxs("div",{className:"flex-1 space-y-4",children:[t.jsx(u,{enabled:Kt.enabled,onChange:Kt.toggle,label:"Repeat",tooltip:"Toggles repeater or monitor mode. In monitor mode, the repeater will not repeat packets from the mesh.",status:Kt.status,size:"md"}),t.jsx(u,{enabled:Vt.enabled,onChange:Vt.toggle,label:"Duty Cycle",tooltip:"Limit transmission time to comply with airtime utilization regulations",status:Vt.status,size:"md"}),t.jsx(ye,{label:"Max Airtime",layout:"inline",value:`${Lt().toFixed(1)}%`,editValue:String(Lt()),type:"number",suffix:"%",step:.5,min:.1,max:100,onSave:async e=>{await L({max_airtime_percent:parseFloat(e),enforcement_enabled:de}),K()}})]}),t.jsx("div",{className:"hidden sm:block w-px bg-border-subtle"}),t.jsxs("div",{className:"flex-1 pt-4 sm:pt-0 border-t sm:border-t-0 border-border-subtle",children:[t.jsx("label",{className:"type-label text-text-muted block mb-3",children:"TX Delays"}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(ye,{label:"Flood",layout:"inline",value:`${At().toFixed(2)}x`,editValue:String(At()),type:"number",suffix:"x",step:.1,min:0,max:5,onSave:async e=>qt({tx_delay_factor:parseFloat(e)})}),t.jsx(ye,{label:"Direct",layout:"inline",value:`${It().toFixed(2)}s`,editValue:String(It()),type:"number",suffix:"s",step:.1,min:0,max:5,onSave:async e=>qt({direct_tx_delay_factor:parseFloat(e)})})]})]})]})]})}),t.jsx(U,{span:12,md:6,children:t.jsxs(O,{neomorphic:!0,children:[t.jsx(G,{icon:t.jsx(y,{}),title:"App Settings"}),t.jsx("p",{className:"type-body-sm text-text-muted mb-4",children:"Appearance and web server options."}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(u,{enabled:Ht.enabled,onChange:Ht.toggle,label:"Enable CORS",tooltip:"Allow cross-origin API access",status:Ht.status,size:"md"}),t.jsx("div",{children:t.jsx(ve,{})}),t.jsx(Ee,{})]})]})})]}),t.jsx(J,{template:"auto",children:t.jsxs(O,{neomorphic:!0,children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[t.jsx(G,{icon:t.jsx(ne,{}),title:"Regions Transport Keys",subtitle:"Manage regional key hierarchy for flood control"}),t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.jsxs(v,{color:"primary",outline:!0,onClick:()=>ot(!0),disabled:"allow"===et,children:[t.jsx(M,{"data-slot":"icon"}),"Add"]}),t.jsx(v,{color:"primary",outline:!0,onClick:Zt,disabled:!lt||"allow"===et,children:"Edit"}),t.jsx(v,{color:"danger",outline:!0,onClick:ea,disabled:!lt||"allow"===et,children:"Delete"})]})]}),t.jsx("div",{className:"bg-subtle-fill radius-inner p-4 mb-4",children:t.jsx(u,{enabled:"allow"===et,onChange:e=>(async e=>{st(!0),Ze(null);try{const t=await _("allow"===e);t.success?tt(e):Ze(t.error||"Failed to update global flood policy")}catch(t){Ze(t instanceof Error?t.message:"Failed to update global flood policy")}finally{st(!1)}})(e?"allow":"deny"),label:"allow"===et?"Regions ON":"Regions OFF",status:at?"loading":"idle",disabled:at,size:"md"})}),Qe&&t.jsx("div",{className:"type-body-sm mb-3 px-3 py-2 rounded-full text-accent-danger bg-accent-danger/10",children:Qe}),t.jsx("div",{className:"bg-subtle-fill radius-inner p-4 min-h-[120px]",children:Ye?t.jsxs("div",{className:"flex items-center justify-center py-6",children:[t.jsx(l,{className:"w-5 h-5 animate-spin text-accent-primary mr-2"}),t.jsx("span",{className:"type-body-sm text-text-muted",children:"Loading transport keys..."})]}):0===Je.length?t.jsxs("div",{className:"text-center py-6",children:[t.jsx("div",{className:"w-12 h-12 rounded-full bg-subtle-fill mx-auto mb-3 flex items-center justify-center",children:t.jsx(ne,{className:"w-6 h-6 text-text-muted/50"})}),t.jsx("p",{className:"type-body text-text-muted",children:"No transport keys found"}),t.jsx("p",{className:"type-body-sm text-text-muted/70 mt-1",children:"Add your first transport key to get started"})]}):t.jsx("div",{className:"space-y-1",children:Je.map(e=>t.jsx(Te,{node:e,level:0,expandedKeys:rt,selectedKeyId:lt,globalFloodPolicy:et,onSelect:nt,onToggle:Wt},e.id))})})]})}),t.jsx(J,{template:"auto",children:t.jsxs(O,{neomorphic:!0,children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[t.jsx(G,{icon:t.jsx(Y,{}),title:"API Tokens",subtitle:"Manage API tokens for machine-to-machine authentication"}),t.jsxs(v,{color:"primary",outline:!0,onClick:()=>ze(!0),children:[t.jsx(M,{"data-slot":"icon"}),"Create Token"]})]}),t.jsx("div",{className:"bg-accent-tertiary/5 radius-inner p-4 mb-4",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-tertiary/20 flex items-center justify-center flex-shrink-0",children:t.jsx(x,{className:"w-4 h-4 text-accent-tertiary"})}),t.jsxs("div",{className:"type-body-sm text-text-muted",children:[t.jsxs("p",{children:[t.jsx("span",{className:"text-text-secondary",children:"API tokens"})," are used for machine-to-machine authentication. Include the token in the ",t.jsx("code",{className:"type-code bg-accent-tertiary/20 px-1.5 py-0.5 rounded-full text-accent-tertiary",children:"X-API-Key"})," header when making API requests."]}),t.jsx("p",{className:"mt-1 text-text-muted/70",children:"Tokens are only shown once at creation. Store them securely."})]})]})}),Ne&&t.jsx("div",{className:"type-body-sm mb-3 px-3 py-2 rounded-full text-accent-danger bg-accent-danger/10",children:Ne}),ge&&0===pe.length?t.jsxs("div",{className:"flex items-center justify-center py-6",children:[t.jsx(l,{className:"w-5 h-5 animate-spin text-accent-primary mr-2"}),t.jsx("span",{className:"type-body-sm text-text-muted",children:"Loading tokens..."})]}):pe.length>0?t.jsx("div",{className:"space-y-2",children:pe.map(e=>t.jsx("div",{className:"bg-subtle-fill hover:bg-subtle-fill-strong radius-inner p-4 transition-base",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-accent-primary/10 flex items-center justify-center flex-shrink-0",children:t.jsx(Y,{className:"w-5 h-5 text-accent-primary"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("h3",{className:"type-body text-text-primary font-medium truncate",children:e.name}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:gap-4 mt-0.5",children:[t.jsxs("span",{className:"type-data-sm text-text-muted truncate",children:["Created: ",Xt(e.created_at)]}),t.jsxs("span",{className:"type-data-sm text-text-muted truncate",children:["Last used: ",Xt(e.last_used)]})]})]})]}),t.jsxs(v,{color:"danger",outline:!0,onClick:()=>He({id:e.id,name:e.name}),disabled:$e,children:[t.jsx(P,{"data-slot":"icon"}),"Revoke"]})]})},e.id))}):t.jsxs("div",{className:"bg-subtle-fill radius-inner p-6 text-center",children:[t.jsx("div",{className:"w-14 h-14 rounded-full bg-subtle-fill mx-auto mb-4 flex items-center justify-center",children:t.jsx(Y,{className:"w-7 h-7 text-text-muted/50"})}),t.jsx("h3",{className:"type-body text-text-primary font-medium mb-1",children:"No API Tokens"}),t.jsx("p",{className:"type-body-sm text-text-muted mb-4",children:"Create a token to enable API access"}),t.jsx(v,{color:"primary",outline:!0,onClick:()=>ze(!0),children:"Create Your First Token"})]})]})}),t.jsx(J,{template:"auto",children:t.jsxs(O,{neomorphic:!0,children:[t.jsx(G,{icon:t.jsx(re,{}),title:"Web Frontend",subtitle:"Choose which web interface to use",className:"mb-4"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:a("flex items-start gap-3 p-4 bg-subtle-fill radius-card border-2 cursor-pointer transition-base",wt?"border-accent-primary bg-accent-primary/5":"border-transparent hover:border-accent-primary/30","loading"===Et&&"opacity-50 pointer-events-none"),children:[t.jsx("input",{type:"radio",name:"frontend",checked:wt,onChange:()=>Ot(!0),disabled:"loading"===Et,className:"mt-1 h-4 w-4 text-accent-primary focus:ring-accent-primary focus:ring-offset-bg-elevated"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"type-body text-text-primary font-medium",children:"Default Frontend"}),t.jsx("a",{href:"https://github.com/rightup/pyMC_Repeater",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"type-data-xs bg-accent-tertiary/15 text-accent-tertiary px-2.5 py-0.5 rounded-full font-medium hover:bg-accent-tertiary/25 transition-colors",children:"@RightUp"})]}),t.jsx("div",{className:"type-body-sm text-text-muted mt-1",children:"Built-in pyMC Repeater web interface"}),t.jsx("div",{className:"type-data-xs text-text-muted/60 mt-1",children:"/opt/pymc_repeater/repeater/web/html"})]})]}),t.jsxs("label",{className:a("flex items-start gap-3 p-4 bg-subtle-fill radius-card border-2 cursor-pointer transition-base",wt?"border-transparent hover:border-accent-primary/30":"border-accent-primary bg-accent-primary/5","loading"===Et&&"opacity-50 pointer-events-none"),children:[t.jsx("input",{type:"radio",name:"frontend",checked:!wt,onChange:()=>Ot(!1),disabled:"loading"===Et,className:"mt-1 h-4 w-4 text-accent-primary focus:ring-accent-primary focus:ring-offset-bg-elevated"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"type-body text-text-primary font-medium",children:"PyMC Console"}),t.jsx("span",{className:"type-data-xs bg-accent-secondary/15 text-accent-secondary px-2.5 py-0.5 rounded-full font-medium",children:"@Treehouse ⚡"})]}),t.jsx("div",{className:"type-body-sm text-text-muted mt-1",children:"Alternative web interface for pyMC Repeater"}),t.jsx("div",{className:"type-data-xs text-text-muted/60 mt-1",children:"/opt/pymc_console/web/html"})]})]})]}),!Ft&&t.jsx("div",{className:a("bg-subtle-fill radius-card p-4",St?"border border-accent-success/20":"border border-accent-tertiary/20"),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:a("w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",St?"bg-accent-success/20":"bg-accent-tertiary/20"),children:St?t.jsx(W,{className:"w-4 h-4 text-accent-success"}):t.jsx(x,{className:"w-4 h-4 text-accent-tertiary"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"type-body text-text-primary font-medium",children:St?"PyMC Console has been detected":"PyMC Console Not Installed"}),St?t.jsxs("p",{className:"type-body-sm text-text-muted mt-1",children:["PyMC Console is installed at ",t.jsx("code",{className:"type-code bg-accent-success/10 px-1.5 py-0.5 rounded-full text-accent-success",children:"/opt/pymc_console/web/html"})]}):t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"type-body-sm text-text-muted mt-1 mb-3",children:["PyMC Console must be installed at ",t.jsx("code",{className:"type-code bg-accent-tertiary/10 px-1.5 py-0.5 rounded-full text-accent-tertiary",children:"/opt/pymc_console/web/html"})," before selecting this option."]}),t.jsxs(v,{color:"primary",outline:!0,href:"https://github.com/dmduran12/pymc_console-dist",children:[t.jsx(se,{"data-slot":"icon"}),"PyMC Console Install Instructions"]})]})]})]})}),Mt&&t.jsx("div",{className:"bg-subtle-fill radius-card p-4 border border-accent-secondary/30",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-secondary/20 flex items-center justify-center flex-shrink-0",children:t.jsx(Q,{className:"w-4 h-4 text-accent-secondary"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"type-body text-text-primary font-medium",children:"Service restart required"}),t.jsx("p",{className:"type-body-sm text-text-muted mt-1",children:"Web frontend changes will take effect after restarting the pymc-repeater service."})]})]}),t.jsx(v,{color:"warning",outline:!0,onClick:async()=>{if(!Rt){Dt(!0);try{await S(),zt(!1),setTimeout(()=>{window.location.reload()},2e3)}catch{zt(!1),setTimeout(()=>{window.location.reload()},3e3)}}},disabled:Rt,children:Rt?t.jsxs(t.Fragment,{children:[t.jsx(l,{"data-slot":"icon",className:"animate-spin"}),"Restarting..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Z,{"data-slot":"icon"}),"Restart Now"]})})]})})]})]})}),R&&t.jsx(J,{template:"auto",children:t.jsx(I,{nodeName:ce,repeaterVersion:R.version,coreVersion:R.core_version,localHash:R.local_hash,publicKey:R.public_key})}),R&&(0===(null==le?void 0:le.latitude)||!(null==le?void 0:le.latitude))&&(0===(null==le?void 0:le.longitude)||!(null==le?void 0:le.longitude))&&t.jsx(J,{template:"auto",children:t.jsx(we,{})})]}),Me&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&ze(!1),role:"dialog","aria-modal":"true","aria-labelledby":"create-token-modal-title",children:t.jsxs("div",{className:"surface-modal radius-card p-6 max-w-md w-full",children:[t.jsx("h3",{id:"create-token-modal-title",className:"type-micro mb-4",children:"Create API Token"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(N,{label:"Token Name",type:"text",value:Re,onChange:e=>De(e.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",description:"Give your token a descriptive name to identify its purpose",onKeyDown:e=>"Enter"===e.key&&Bt(),autoFocus:!0}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx(v,{color:"muted",outline:!0,onClick:()=>{ze(!1),De(""),Pe(null)},disabled:qe,children:"Cancel"}),t.jsx(v,{color:"primary",onClick:Bt,disabled:qe||!Re.trim(),children:qe?t.jsxs(t.Fragment,{children:[t.jsx(l,{"data-slot":"icon",className:"animate-spin"}),"Creating..."]}):"Create Token"})]})]})]})}),Le&&Ae&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&Ke(!1),role:"dialog","aria-modal":"true","aria-labelledby":"show-token-modal-title",children:t.jsxs("div",{className:"surface-modal radius-card p-6 max-w-lg w-full",children:[t.jsx("h3",{id:"show-token-modal-title",className:"type-micro mb-4",children:"Token Created Successfully"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-accent-secondary/10 border border-accent-secondary/30 radius-inner p-3",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Q,{className:"w-4 h-4 text-accent-secondary flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-text-secondary",children:[t.jsx("strong",{children:"Save this token now!"})," For security reasons, it will not be shown again."]})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-primary block mb-1.5",children:"Your API Token"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(k,{value:Ae,readOnly:!0,className:"flex-1 font-mono"}),t.jsxs(v,{color:"primary",outline:!0,onClick:()=>{Ae&&(navigator.clipboard.writeText(Ae),Ge(!0),setTimeout(()=>Ge(!1),2e3))},children:[Xe?t.jsx(n,{"data-slot":"icon",className:"text-accent-success"}):t.jsx(ee,{"data-slot":"icon"}),Xe?"Copied!":"Copy"]})]})]}),t.jsxs("div",{className:"bg-accent-tertiary/10 border border-accent-tertiary/30 radius-inner p-3",children:[t.jsx("p",{className:"text-sm text-text-secondary mb-2",children:t.jsx("strong",{children:"Usage Example:"})}),t.jsxs("code",{className:"block bg-accent-tertiary/20 px-3 py-2 rounded type-code text-accent-tertiary overflow-x-auto",children:['curl -H "X-API-Key: ',Ae.slice(0,12),'..." ',window.location.origin,"/api/stats"]})]}),t.jsx("div",{className:"flex justify-end mt-6",children:t.jsx(v,{color:"primary",onClick:()=>{Ke(!1),Ie(null)},children:"Done"})})]})]})}),t.jsx(z,{isOpen:!!Ve,title:"Revoke API Token",message:`Are you sure you want to revoke the token '${null==Ve?void 0:Ve.name}'? This action cannot be undone.`,confirmLabel:$e?"Revoking...":"Revoke",cancelLabel:"Cancel",variant:"danger",onConfirm:async()=>{if(Ve){Be(!0),Pe(null);try{await async function(e){return c(`/auth/tokens/${e}`,{method:"DELETE"})}(Ve.id),await $t(),He(null)}catch(e){Pe(e instanceof Error?e.message:"Failed to revoke token")}finally{Be(!1)}}},onCancel:()=>He(null)}),ct&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&ot(!1),role:"dialog","aria-modal":"true","aria-labelledby":"add-key-modal-title",children:t.jsxs("div",{className:"surface-modal radius-card p-6 max-w-md w-full",children:[t.jsx("h3",{id:"add-key-modal-title",className:"type-micro mb-4",children:"Add Transport Key"}),t.jsxs("div",{className:"space-y-4",children:[lt&&t.jsxs("div",{className:"bg-accent-tertiary/10 border border-accent-tertiary/30 radius-inner p-3 text-sm text-text-secondary",children:["Adding as child of: ",t.jsx("strong",{className:"text-text-primary",children:Yt()})]}),t.jsx(N,{label:"Key Name",type:"text",value:ft,onChange:e=>gt(e.target.value),placeholder:"e.g., Region Name, Group Key",onKeyDown:e=>"Enter"===e.key&&Qt(),autoFocus:!0}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Flood Policy"}),t.jsxs("div",{className:"toggle-group w-full",children:[t.jsx("button",{onClick:()=>vt("deny"),className:a("toggle-group-item flex-1","deny"===jt&&"active !text-accent-danger"),children:"Deny"}),t.jsx("button",{onClick:()=>vt("allow"),className:a("toggle-group-item flex-1","allow"===jt&&"active !text-accent-success"),children:"Allow"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx(v,{color:"muted",outline:!0,onClick:()=>{ot(!1),gt(""),vt("deny")},disabled:Nt,children:"Cancel"}),t.jsx(v,{color:"primary",onClick:Qt,disabled:Nt||!ft.trim(),children:Nt?t.jsxs(t.Fragment,{children:[t.jsx(l,{"data-slot":"icon",className:"animate-spin"}),"Adding..."]}):"Add Key"})]})]})]})}),dt&&pt&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&ut(!1),role:"dialog","aria-modal":"true","aria-labelledby":"edit-key-modal-title",children:t.jsxs("div",{className:"surface-modal radius-card p-6 max-w-md w-full",children:[t.jsx("h3",{id:"edit-key-modal-title",className:"type-micro mb-4",children:"Edit Transport Key"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(N,{label:"Key Name",type:"text",value:pt.name,onChange:e=>ht({...pt,name:e.target.value}),autoFocus:!0}),t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Flood Policy"}),t.jsxs("div",{className:"toggle-group w-full",children:[t.jsx("button",{onClick:()=>ht({...pt,floodPolicy:"deny"}),className:a("toggle-group-item flex-1","deny"===pt.floodPolicy&&"active !text-accent-danger"),children:"Deny"}),t.jsx("button",{onClick:()=>ht({...pt,floodPolicy:"allow"}),className:a("toggle-group-item flex-1","allow"===pt.floodPolicy&&"active !text-accent-success"),children:"Allow"})]})]}),pt.transport_key&&t.jsxs("div",{children:[t.jsx("label",{className:"type-label text-text-muted block mb-2",children:"Transport Key"}),t.jsx("code",{className:"block bg-input-bg px-3 py-2 radius-inner border border-input-border type-code text-text-muted overflow-x-auto",children:pt.transport_key})]}),t.jsxs("div",{className:"flex justify-between gap-3 mt-6",children:[t.jsx(v,{color:"danger",outline:!0,onClick:()=>{ut(!1),bt(pt),xt(!0),ht(null)},disabled:Nt,children:"Delete"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx(v,{color:"muted",outline:!0,onClick:()=>{ut(!1),ht(null)},disabled:Nt,children:"Cancel"}),t.jsx(v,{color:"primary",onClick:async()=>{if(pt){kt(!0),Ze(null);try{const e=await T(pt.id,{name:pt.name,flood_policy:pt.floodPolicy});e.success?(await Jt(),ut(!1),ht(null)):Ze(e.error||"Failed to update transport key")}catch(e){Ze(e instanceof Error?e.message:"Failed to update transport key")}finally{kt(!1)}}},disabled:Nt||!pt.name.trim(),children:Nt?t.jsxs(t.Fragment,{children:[t.jsx(l,{"data-slot":"icon",className:"animate-spin"}),"Saving..."]}):"Save"})]})]})]})]})}),mt&&yt&&t.jsx("div",{className:"fixed inset-0 z-[10010] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&xt(!1),role:"dialog","aria-modal":"true","aria-labelledby":"delete-key-modal-title",children:t.jsxs("div",{className:"surface-modal radius-card p-6 max-w-md w-full",children:[t.jsx("h3",{id:"delete-key-modal-title",className:"type-micro mb-4",children:"Delete Transport Key"}),t.jsxs("p",{className:"text-text-secondary mb-4",children:["Are you sure you want to delete ",t.jsxs("strong",{className:"text-text-primary",children:["'",yt.name,"'"]}),"?"]}),yt.children&&yt.children.length>0&&t.jsx("div",{className:"bg-accent-secondary/10 border border-accent-secondary/30 radius-inner p-3 mb-4",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Q,{className:"w-4 h-4 text-accent-secondary flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-text-secondary",children:["This key has ",yt.children.length," child key(s). Deleting will also remove all children."]})]})}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx(v,{color:"muted",outline:!0,onClick:()=>{xt(!1),bt(null)},disabled:Nt,children:"Cancel"}),t.jsx(v,{color:"danger",onClick:async()=>{if(yt){kt(!0),Ze(null);try{const e=await E(yt.id);e.success?(await Jt(),xt(!1),bt(null),nt(null)):Ze(e.error||"Failed to delete transport key")}catch(e){Ze(e instanceof Error?e.message:"Failed to delete transport key")}finally{kt(!1)}}},disabled:Nt,children:Nt?t.jsxs(t.Fragment,{children:[t.jsx(l,{"data-slot":"icon",className:"animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})}export{Pe as default};
